<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="keywords" content="在线文档、网络联机帮助、web 帮助、chm2w" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

<meta name="generator" content="chm2web Pro 2.85 (unicode)" />
<title>应用内购</title>
<meta http-equiv="X-UA-Compatible" content="IE=9">
<link rel="stylesheet" href="../../../../../files/helpindex.css"
type="text/css">
<link rel="stylesheet" href="../../../../../default.css" type=
"text/css">

<script type="text/JavaScript" src="../../../../../files/supply.js"></script>
<script type="text/JavaScript">
chmtop.c2wtopf.pageid = "_build/3_scripting/4_gml_reference/in app purchases/index.html";
</script>

</head>
<body><script type="text/JavaScript"> 
if (window.name != "content") 
  document.write(" <table width=\"100%\" bgcolor=\"#e1e1e1\"cellspacing=\"2\" cellpadding=\"0\" style=\"border-collapse: collapse; font-family: sans-serif; font-size: 14px; color: #000000; text-decoration: none;  \"> <tr> <td align=\"center\" style=\"border-bottom: 2px solid gray\" > <br>&nbsp;Click <a href=\"../../../../../index.html?page=source%2F_build%2F3_scripting%2F4_gml_reference%2Fin%20app%20purchases%2Findex.html\">here</a> to show toolbars of the Web Online Help System: <a href=\"../../../../../index.html?page=source%2F_build%2F3_scripting%2F4_gml_reference%2Fin%20app%20purchases%2Findex.html\">show toolbars</a><br>&nbsp;</td></tr></table><br> "); 
</script><!-- !chm2web! -->


<script type="text/JavaScript">
 if( typeof(chmtop.helpStyle) != 'undefined' ) { var linkNodes = document.getElementsByTagName("link");  for( var i=0; i < linkNodes.length; ++i ) { var link = linkNodes[i];    if( link.href.endsWith("default.css")) {    var style = link.href.replace("default.css", chmtop.helpStyle); document.write('<link id="newstyleLink" rel="stylesheet" href=' + style + ' type="text/css">');    break; } } } 
</script>
<h2>应用内购</h2>

<div class="body-scroll">
<p><br>
</p>

<p>In App Purchases are an important part of modern, cross platform
games, permitting you to have "freemium" content where your game is
free, but certain content is only available through a purchase from
within the game itself. For example, your puzzle game is free, but
the extra levels are going to cost the user 0.99$. This app model
is very common and can be set up with a minimum amount of work from
within <i>GameMaker Studio 2</i> , and this section of the manual
has details of all the available functions that enable you to do
just that, as well as some advice for setting up and information on
how to test on the different platforms.</p>

<p>Setting up in app purchases within your game is relatively
simple with <i>GameMaker Studio 2</i>, but it still requires some
amount of knowledge of the target platform setup as well as careful
planning before starting to create your game, so it is not
recommended that you use this functionality if you are just
starting with <i>GameMaker Studio 2</i> or if you are not sure how
the different stores for each target platform are set up.</p>

<p>Before doing anything else you will have to make sure that you
have set up the purchase details on the target store for each
platform that you wish to support, taking careful note of each of
the <b>Product IDs</b> that you define, as these ID strings are how
<i>GameMaker Studio 2</i> identifies each product and purchase.<br>
<br></p>

<p>To help those of you that have never worked with any type if IAP
services and to explain the different ways that IAP can be tested
on different devices, please see the following pages:</p>

<blockquote>
<ol>
<li><a href="http://help.yoyogames.com/entries/29734673.html"
target="_blank">IAP Example</a><br>
</li>

<li><a href="http://help.yoyogames.com/entries/29736883" target=
"_blank">IAP Testing</a><br>
</li>
</ol>
</blockquote>

<div class="note"><b>注意</b>： <i>GameMaker Studio 2</i> currently permits up to 128 distinct purchase options per title, except if you are using the Amazon Store (for Android) where it is limited to 100.

<p><b>WARNING:</b> You will not be able to make purchases when
debugging titles using the <i>GameMaker Studio 2</i> IDE. Instead
you will need to create final executables to ensure the title can
correctly communicate with the respective store servers.</p></div>

<p>Below are listed the functions that are integrated in
<i>GameMaker Studio 2</i> to enable in app purchases on iOS and
Android target devices (this is the ability to buy extra credits,
items, levels and other things from within the game itself). Many
of these functions will trigger an <a href=
"../../../2_interface/1_editors/events/async_events.html">IAP
Asynchronous Event</a>, which contains a special <tt>ds_map</tt>
with an initial key "type". This can then be queried to get the
type of IAP event that has been triggered, which will then permit
you to get further data from the map.</p>

<p>The available in app purchase functions are:</p>

<ul>
<li><a href="iap_activate.html">iap_activate</a><br>
</li>

<li><a href="iap_status.html">iap_status</a><br>
</li>

<li><a href=
"iap_enumerate_products.html">iap_enumerate_products</a><br>
</li>

<li><a href="iap_restore_all.html">iap_restore_all</a><br>
</li>

<li><a href="iap_acquire.html">iap_acquire</a><br>
</li>

<li><a href="iap_consume.html">iap_consume</a><br>
</li>

<li><a href="iap_product_details.html">iap_product_details</a><br>
</li>

<li><a href=
"iap_purchase_details.html">iap_purchase_details</a><br>
</li>
</ul>
<br>

<p>You should also be aware that <i>GameMaker Studio 2</i> does
<i><b>not</b></i> persist active purchase state across multiple
plays of the game (and thus <tt>iap_is_purchased()</tt> is
unreliable if a store has not successfully loaded). This means that
you will have to store this information yourself and retrieve it
again on each start-up of your game. You can use the special
"secure" save and load functions provided for ds_maps for this
purpose:</p>

<ul>
<li><a href=
"../data_structures/ds%20maps/ds_map_secure_save.html">ds_map_secure_save</a><br>

</li>

<li><a href=
"../data_structures/ds%20maps/ds_map_secure_load.html">ds_map_secure_load</a><br>

</li>
</ul>
<br>

<p><i>GameMaker Studio 2</i> does not persist purchase state across
multiple plays of the game because it is not appropriate for us to
provide a secure method of verifying whether or not an individual
purchase is valid and therefore any automatically stored purchase
state would be presumptuous. On most platforms "receipt" data will
be available through <a href=
"iap_purchase_details.html"><tt>iap_purchase_details()</tt></a>
which users can use to verify a purchase, although Google Play uses
"token" data instead.</p>

<p><i>GameMaker Studio 2</i> requires the <b>Google Play Public
Key</b> for simple local purchase verification and you may check
that the "payload" data returned with a purchase result matches
that used with the matching call to <tt>iap_acquire()</tt>.</p>

<p><br>
</p>
</div>

<div class="footer">
<div class="buttons">
<div class="clear">
<div style="float:left">上一页：<a href="../index.html"><i>GameMaker Studio 2</i>语言参考</a></div>

<div style="float:right">下一页: <a href=
"../asynchronous%20functions/index.html">Asynchronous Functions</a></div>
</div>
</div>

<h5>© Copyright YoYo Games Ltd. 2017 All Rights Reserved</h5>
<script type="text/javascript">
   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){   (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),   m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)   })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');   ga('create', 'UA-2711665-14', 'auto');   ga('send', 'pageview'); 
</script>
</div>

<script type="text/JavaScript">
var fe = FindFrame("toc", top);
if ((fe != null) && (chmtop.c2wtopf.jstree != null)) {
  if (chmtop.c2wtopf.FITEMS[chmtop.c2wtopf.pagenum] != chmtop.c2wtopf.pageid)
    chmtop.c2wtopf.jstree.OpenTreeNode("source/" + chmtop.c2wtopf.pageid);
}
</script>
</body>
</html>
