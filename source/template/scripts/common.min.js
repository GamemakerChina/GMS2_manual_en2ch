(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var _window = window,
    rh = _window.rh;
var _ = rh._;
var $ = rh.$;
var consts = rh.consts;


var NO_CHILD_ATTR = 'data-nochild';
var NO_CHILD_IGNORE = 'ignore';

var NodesUtil = function () {
  function NodesUtil() {
    _classCallCheck(this, NodesUtil);

    this.className = 'rh-hide';
  }

  _createClass(NodesUtil, [{
    key: 'everyChild',
    value: function everyChild(parent, callback) {
      var bRet = true;
      var _iteratorNormalCompletion = true;
      var _didIteratorError = false;
      var _iteratorError = undefined;

      try {
        for (var _iterator = Array.from(parent.children)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
          var child = _step.value;

          bRet = bRet && callback(child);
          if (!bRet) {
            break;
          }
        }
      } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion && _iterator.return) {
            _iterator.return();
          }
        } finally {
          if (_didIteratorError) {
            throw _iteratorError;
          }
        }
      }

      return bRet;
    }
  }, {
    key: 'isMarkedNode',
    value: function isMarkedNode(node) {
      return !!node && $.hasAttribute(node, NO_CHILD_ATTR);
    }
  }, {
    key: 'shouldHide',
    value: function shouldHide(node) {
      var _this = this;

      var bHide = false;
      if (node && this.isMarkedNode(node)) {
        bHide |= this.everyChild(node, function (child) {
          return $.hasClass(child, _this.className) || $.getAttribute(child, NO_CHILD_ATTR) === NO_CHILD_IGNORE;
        });
      }
      return bHide;
    }
  }, {
    key: 'onShow',
    value: function onShow(node) {
      var dontCheckChidlren = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

      var bShown = false;
      if (node && (dontCheckChidlren || !this.shouldHide(node))) {
        $.removeClass(node, this.className);
        bShown = true;
        node.parentNode && this.isMarkedNode(node.parentNode) && this.onShow(node.parentNode, true);
      }
      return bShown;
    }
  }, {
    key: 'onHide',
    value: function onHide(node) {
      if (!node) {
        return false;
      }
      $.addClass(node, this.className);
      if (this.shouldHide(node.nextElementSibling)) {
        this.onHide(node.nextElementSibling);
      }
      if (this.shouldHide(node.parentNode)) {
        this.onHide(node.parentNode);
      }
      return true;
    }
  }]);

  return NodesUtil;
}();

module.exports = new NodesUtil();

},{}],2:[function(require,module,exports){
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _nodes = require('../../common/nodes');

var _nodes2 = _interopRequireDefault(_nodes);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _window = window,
    rh = _window.rh;
var _ = rh._;
var $ = rh.$;
var consts = rh.consts;


rh.model.subscribe(consts('EVT_PROJECT_LOADED'), function () {
  return rh.model.subscribe(consts('KEY_MERGED_PROJECT_MAP'), function () {
    var origin = _.getProjectName(_.filePath());
    return rh.model.publish(consts('KEY_TOPIC_ORIGIN'), origin);
  });
});

var ContentFilter = function () {
  var nonTextNodes = undefined,
      SELECTED_CLASS = void 0;
  ContentFilter = function (_rh$Widget) {
    _inherits(ContentFilter, _rh$Widget);

    _createClass(ContentFilter, [{
      key: 'preventClick',
      value: function preventClick(e) {
        _.preventDefault(e);
        return false;
      }
    }], [{
      key: 'initClass',
      value: function initClass() {
        SELECTED_CLASS = 'selected';
        nonTextNodes = ['IMG', 'OBJECT', 'VIDEO'];
      }
    }]);

    function ContentFilter(config) {
      _classCallCheck(this, ContentFilter);

      var _this = _possibleConstructorReturn(this, (ContentFilter.__proto__ || Object.getPrototypeOf(ContentFilter)).call(this, config));

      _this.onTagExpr = _this.onTagExpr.bind(_this);
      _this.ids = config.ids;
      _this.className = config.className || 'rh-hide';
      _this.node = config.node;
      _this.hoverClass = 'rh-tag-content-hover';
      _this.supClass = 'rh-applied-tag';
      _this.createTagNode();

      if (_this.ids) {
        rh.model.subscribe(consts('EVT_TOC_SELECTED_ITEM_CHANGED'), _this.onTagExpr);
        _this.subscribe(consts('KEY_TOPIC_ORIGIN'), function () {
          return _this.subscribe(consts('KEY_TAG_EXPRESSION'), _this.onTagExpr);
        });
      } else if (rh._debug) {
        rh._d('error', 'data-tags without any tag combination');
      }
      return _this;
    }

    _createClass(ContentFilter, [{
      key: 'onTagExpr',
      value: function onTagExpr(tagExprs) {
        if (!_.isDefined(tagExprs)) {
          tagExprs = this.get(consts('KEY_TAG_EXPRESSION'));
        }
        var origin = this.get(consts('KEY_TOPIC_ORIGIN'));
        if (!this.get('tags')) {
          this.tags = _.union(this.ids, function (id) {
            return _.getTags(id, origin);
          });
          this.publish('tags', this.tags.join(','));
        }

        var apply = !_.any(this.ids, function (id) {
          return _.evalTagExpression(id, tagExprs, origin);
        });

        this.toggleClass(apply);
        if (this.className !== 'rh-hide') {
          this.toggleClick(apply);
        }
        return this.applied = apply;
      }
    }, {
      key: 'toggleClass',
      value: function toggleClass(apply) {
        if (apply) {
          if (!this.applied) {
            return _nodes2.default.onHide(this.node);
          }
        } else {
          return _nodes2.default.onShow(this.node);
        }
      }
    }, {
      key: 'toggleClick',
      value: function toggleClick(addEvent) {
        if (addEvent) {
          if (!this.applied) {
            return _.addEventListener(this.node, 'click', this.preventClick);
          }
        } else {
          if (this.applied) {
            return _.removeEventListener(this.node, 'click', this.preventClick);
          }
        }
      }
    }, {
      key: 'onHover',
      value: function onHover() {
        return $.addClass(this.node, this.hoverClass);
      }
    }, {
      key: 'onMouseOut',
      value: function onMouseOut() {
        return $.removeClass(this.node, this.hoverClass);
      }
    }, {
      key: 'appendNode',
      value: function appendNode(supNode) {
        var parentNode = this.node;
        var sibling = null;
        if (nonTextNodes.indexOf(this.node.nodeName) !== -1) {
          parentNode = this.node.parentNode;

          sibling = this.node.nextSibling;
        }
        if (sibling) {
          parentNode.insertBefore(supNode, sibling);
        } else {
          parentNode.appendChild(supNode);
        }
        return this.resolveDataAttrs(supNode);
      }
    }, {
      key: 'getAptNames',
      value: function getAptNames() {
        var _this2 = this;

        return this.subscribe('tags', function () {
          var data = [];
          _.each(_this2.tags, function (current, idx) {
            return data.push(current.replace("att_sep", ":"));
          });
          return _this2.publish('showtags', data.join(','));
        });
      }
    }, {
      key: 'createTagNode',
      value: function createTagNode() {
        var _this3 = this;

        return this.subscribe(consts('KEY_SHOW_TAGS'), function (showTags) {
          if (!showTags || $.find(_this3.node, 'sup.' + _this3.supClass).length > 0) {
            return;
          }
          var supNode = document.createElement('sup');
          _this3.getAptNames();
          $.setAttribute(supNode, 'data-text', 'showtags');
          $.setAttribute(supNode, 'data-mouseover', 'this.onHover()');
          $.setAttribute(supNode, 'data-mouseout', 'this.onMouseOut()');
          $.setAttribute(supNode, 'class', _this3.supClass);
          return _this3.appendNode(supNode);
        });
      }
    }]);

    return ContentFilter;
  }(rh.Widget);
  ContentFilter.initClass();
  return ContentFilter;
}();

window.rh.widgets.ContentFilter = ContentFilter;

},{"../../common/nodes":1}],3:[function(require,module,exports){
'use strict';

/*
 Help for Edwidget
*/

var edWidget = window.rh.edWidget;

/*
 Tab edwidget
*/

edWidget('tab', {
  attrs: {
    'data-table': 'data',
    'data-rhwidget': 'Basic',
    'data-output': 'data: edw.data.#{@index}',
    class: 'print-only'
  },
  view: {
    tag: 'div',
    attrs: {
      'data-rhwidget': 'Basic: include: edwidgets/tab/tabLayout.js',
      'data-input': 'data: edw.data.#{@index}'
    },
    model: {
      tab: '0'
    }
  }
});

/*
 Gallary edwidget
*/
//edWidget 'Gallary'

},{}],4:[function(require,module,exports){
'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var _window = window,
    rh = _window.rh;
var $ = rh.$;
var _ = rh._;
var consts = rh.consts;


var Edwidget = function () {
  var valueSeperator = undefined;
  Edwidget = function () {
    _createClass(Edwidget, null, [{
      key: 'initClass',
      value: function initClass() {
        valueSeperator = {
          'data-rhwidget': ';',
          class: ' '
        };
      }
    }]);

    function Edwidget(node, index, arg) {
      _classCallCheck(this, Edwidget);

      this.node = node;
      this.index = index;

      var _parseArg = this.parseArg(arg),
          view = _parseArg.view,
          attrs = _parseArg.attrs,
          model = _parseArg.model,
          argModel = _parseArg.argModel;

      if (attrs) {
        this.setAttributes(this.node, attrs);
      }
      if (model) {
        this.setModelArg(this.node, _.extend({}, model, argModel));
      }
      if (view) {
        this.createView(view, argModel);
      }
    }

    _createClass(Edwidget, [{
      key: 'parseArg',
      value: function parseArg(arg) {
        var argModel = void 0,
            attrs = void 0,
            config = void 0,
            model = void 0,
            view = void 0;
        var wName = arg.wName,
            wArg = arg.wArg,
            pipedArgs = arg.pipedArgs;

        if (config = rh.edWidget(wName)) {
          var vars = void 0;
          var _config = config;
          view = _config.view;
          attrs = _config.attrs;
          vars = _config.vars;
          model = _config.model;

          argModel = _.resolveNiceJSON(pipedArgs.shift());
          this.vars = _.extend({}, vars, wArg);
        }
        return { view: view, attrs: attrs, model: model, argModel: argModel };
      }
    }, {
      key: 'createView',
      value: function createView(view, argModel) {
        var viewModel = _.extend({}, view.model, argModel);
        var viewNode = document.createElement(view.tag || 'div');
        if (view.attrs) {
          this.setAttributes(viewNode, view.attrs);
        }
        this.setModelArg(viewNode, viewModel);
        return this.node.parentNode.insertBefore(viewNode, this.node);
      }
    }, {
      key: 'setAttributes',
      value: function setAttributes(node, attrs) {
        return _.each(attrs, function (value, attr) {
          return $.setAttribute(node, attr, this.resolveValue(this.mergedValue(node, attr, value)));
        }, this);
      }
    }, {
      key: 'setModelArg',
      value: function setModelArg(node, model) {
        if (!_.isEmptyObject(model)) {
          var jsonString = this.resolveValue(JSON.stringify(model));
          return $.dataset(node, 'rhwidget', ($.dataset(node, 'rhwidget') || 'Basic') + ' | ' + jsonString);
        }
      }
    }, {
      key: 'mergedValue',
      value: function mergedValue(node, attrib, value) {
        var oldValue = void 0,
            seperator = void 0;
        if (!(seperator = valueSeperator[attrib])) {
          return value;
        }
        if (oldValue = $.getAttribute(node, attrib) || '') {
          return '' + oldValue + seperator + value;
        } else {
          return value;
        }
      }
    }, {
      key: 'resolveValue',
      value: function resolveValue(value) {
        var _this = this;

        return _.resolveEnclosedVar(value, function (varName) {
          switch (varName) {
            case 'this':
              return JSON.stringify(_this.vars);
            case '@index':
              return _this.index;
            default:
              return _this.vars[varName];
          }
        });
      }
    }]);

    return Edwidget;
  }();
  Edwidget.initClass();
  return Edwidget;
}();

/*
  <div data-edwidget="Tab: <name>: <string value>, <name>: <string value>
   | <json or niceJSON>"></div>
*/

rh.model.subscribe(consts('EVT_WIDGET_BEFORELOAD'), function () {
  return _.each($.find(document, '[data-edwidget]'), function (node, index) {
    var args = _.resolveWidgetArgs($.dataset(node, 'edwidget'));
    _.each(args, function (arg) {
      return new Edwidget(node, index, arg);
    });
    return $.dataset(node, 'edwidget', null);
  });
});

rh.edWidget = _.cache(_.isObject);

},{}],5:[function(require,module,exports){
'use strict';

var _window = window,
    rh = _window.rh;
var _ = rh._;
var $ = rh.$;
var consts = rh.consts;
var model = rh.model;


var eventFire = function eventFire(el, etype) {
  if (el.fireEvent) {
    el.fireEvent('on' + etype);
  } else {
    var evObj = document.createEvent('Events');
    evObj.initEvent(etype, true, true);
    el.dispatchEvent(evObj);
  }
};

var showTarget = function showTarget(element) {
  //display a dropdown/expand text if highlighted element is inside it
  var parent = element.parentNode;
  while (typeof parent != 'undefined' && parent != null) {
    var tagname = rh._.get(parent, 'tagName').toLowerCase();
    if (tagname == 'body') break;
    var targetName = rh.$.getAttribute(parent, 'data-targetname');
    if (targetName) {
      var node = document.querySelector('[data-target="' + targetName + '"]');
      rh._.defer(function () {
        eventFire(node, 'open');
      });
    }
    parent = parent.parentNode;
  }
};

_.hookClick = function (event) {
  var href = void 0;
  if ('button' in event && event.button !== 0) {
    return;
  }
  if (event.defaultPrevented) {
    return;
  }

  var _document = document,
      body = _document.body;

  var node = event.target;
  while (true) {
    if (!node || node === document) {
      break;
    }
    href = $.getAttribute(node, 'href');
    if (href) {
      break;
    }
    node = node.parentNode;
  }
  if (!href) {
    return;
  }
  href = decodeURI(href);
  var mobileAppMode = model.get(consts('KEY_MOBILE_APP_MODE'));

  var target = $.getAttribute(node, 'target');
  if (target && target !== '_self' && !mobileAppMode) {
    return;
  }

  if (href[0] === '#' && _.isRootUrl()) {
    if (href.length > 1) {
      var bookmarkKey = '' + consts('EVT_BOOKMARK') + href;
      if (model.isSubscribed(bookmarkKey)) {
        model.publish(bookmarkKey, '');
      } else {
        model.publish(consts('EVT_NAVIGATE_TO_URL'), { absUrl: '' + _.getRootUrl() + href });
      }
    }
    return _.preventDefault(event);
  } else if (href[0] === '#') {
    var element = document.querySelector(href);
    element && showTarget(element);
    _.preventDefault(event);
    _.defer(function () {
      return element.scrollIntoView();
    });
  } else if (_.isValidFileUrl(href)) {
    var absUrl = void 0;
    if (_.isRelativeUrl(href)) {
      absUrl = window._getFullPath(_.parentPath(), href);
    }
    if (absUrl == null) {
      absUrl = href;
    }

    if ((mobileAppMode || !target) && !_.isUrlAllowdInIframe(absUrl)) {
      return $.setAttribute(node, 'target', '_blank');
    } else {
      model.publish(consts('EVT_NAVIGATE_TO_URL'), { absUrl: absUrl });
      if (!target) {
        return _.preventDefault(event);
      }
    }
  }
};

},{}],6:[function(require,module,exports){
'use strict';

var _window = window,
    rh = _window.rh;
var consts = rh.consts;

// Project specific model keys

consts('KEY_PROJECT_TOPICLIST', '.p.topiclist');
consts('KEY_PROJECT_BRSLIST', '.p.brslist');
consts('KEY_PROJECT_TAG_COMBINATIONS', '.p.tag_combinations');
consts('KEY_PROJECT_TAG_STATES', '.p.tag_states');
consts('KEY_MERGED_FILTER_KEY', '.p.tags');
consts('KEY_PROJECT_FILTER_CAPTION', '.p.filter_caption');
consts('KEY_PROJECT_FILTER_TYPE', '.p.filter_type');
consts('KEY_PROJECT_LIST', '.p.projects');
consts('KEY_MASTER_PROJECT_LIST', '.p.masterprojects');
consts('KEY_SEARCH_RESULTS', '.p.searchresults');
consts('MAX_SEARCH_RESULTS', 'max_search_results');
consts('KEY_SEARCH_RESULT_PARAMS', '.p.searchresultparams');
consts('KEY_ONSEARCH_TAG_STATES', '.p.onsearchtagstates');
consts('KEY_LNG', '.p.lng_db');
consts('KEY_DEFAULT_FILTER', '.p.deffilter');
consts('PROJECT_GLOSSARY_DATA', '.p.glodata');
consts('PROJECT_INDEX_DATA', '.p.idxdata');

// Merged Project specific
consts('KEY_MERGED_PROJECT_MAP', '.mp.tmap');

// Topic specific model keys
consts('KEY_TOPIC_URL', '.t.topicurl');
consts('KEY_TOPIC_ID', '.t.topicid');
consts('KEY_TOPIC_TITLE', '.t.topictitle');
consts('KEY_TOPIC_BRSMAP', '.t.brsmap');
consts('KEY_TOPIC_ORIGIN', '.t.origin');
consts('KEY_TOPIC_HEIGHT', '.t.topic_height');
consts('KEY_TOPIC_CONTENT_SIZE', '.t.topic_content_size');
consts('GO_TO_DEFAULT_TOPIC', '.t.gotodefaultTopic');

// Layout specific model keys
consts('KEY_SHOW_SCROLL_TO_TOP', '.l.show_scroll_to_top');
consts('KEY_DO_NOT_PRESERVE_AR', '.l.do_not_preserve_ar');
consts('KEY_SEARCH_TERM', '.l.searchterm');
consts('KEY_SEARCHED_TERM', '.l.searched_term');
consts('KEY_TAG_EXPRESSION', '.l.tag_expression');
consts('KEY_UI_MODE', '.l.uimode'); // RH11
consts('KEY_BASE_IFRAME_NAME', '.l.base_iframe_name');
consts('KEY_CAN_HANDLE_SERCH', '.l.can_handle_search'); // RH11
consts('KEY_CAN_HANDLE_SEARCH', '.l.can_handle_search');
consts('KEY_CSH_MODE', '.l.csh_mode');
consts('KEY_ONSEARCH_TAG_EXPR', '.l.onsearchtagexpr');
consts('KEY_AND_SEARCH', '.l.andsearch');
consts('KEY_FEATURE', '.l.features');
consts('KEY_SEARCH_PROGRESS', '.l.search_progress');
consts('KEY_LAYOUT_VERSION', '.l.layout_version');
consts('KEY_TOPIC_IN_IFRAME', '.l.topic_in_iframe');
consts('KEY_SHOW_TAGS', '.l.showtags');
consts('KEY_DIR', '.l.dir');
consts('KEY_SEARCH_LOCATION', '.l.search_location');
consts('KEY_DEFAULT_SEARCH_LOCATION', '.l.default_search_location');
consts('KEY_FILTER_LOCATION', '.l.filter_location');
consts('KEY_ACTIVE_TAB', '.l.active_tab');
consts('KEY_DEFAULT_TAB', '.l.default_tab');
consts('KEY_ACTIVE_TOPIC_TAB', '.l.active_topic_tab');
consts('KEY_TOC_DRILL_DOWN', '.l.toc_drilldown');
consts('KEY_MOBILE_TOC_DRILL_DOWN', '.l.mobile_toc_drilldown');
consts('KEY_PUBLISH_MODE', '.l.publish_mode');
consts('KEY_PUBLISH_BASE_URL', '.l.publish_base_url');
consts('KEY_PROJECTS_BASE_URL', '.l.projects_base_url');
consts('KEY_INDEX_FILTER', '.l.idxfilter');

// Events
consts('EVT_BASE_IFRAME_LOAD', '.e.base_iframe_load');
consts('EVT_SCROLL_TO_TOP', '.e.scroll_to_top');
consts('EVT_SEARCH_TERM', '.e.search_term');
consts('DESKTOP_SIDEBAR_VISIBLE', '.l.desktop_sidebar_visible');
consts('EVT_NAVIGATE_TO_URL', '.e.navigate_to_url');
consts('EVT_PROJECT_LOADED', '.e.project_loaded');
consts('EVT_TOC_LOADED', '.e.toc_loaded');
consts('EVT_TOPIC_LOADED', '.e.topic_loaded');
consts('EVT_TOPIC_LOADING', '.e.topic_loading');
consts('EVT_BOOKMARK', '.e.bookmark.');
consts('EVT_PRINT_TOPIC', '.e.print_topic');
consts('EVT_SEARCH_IN_PROGRESS', '.e.search_in_progress');
consts('EVT_RELOAD_TOPIC', '.e.reload_topic');
consts('EVT_QUERY_SEARCH_RESULTS', '.e.query_search_results');
consts('EVT_LOAD_IDX', '.e.load_idx');
consts('EVT_LOAD_GLO', '.e.load_glo');
consts('EVT_TOC_SELECTED_ITEM_CHANGED', 'evt.toc_select_item_changed');

// Hash and query keys
consts('HASH_KEY_RH_HIGHLIGHT', 'rhhlterm');
consts('HASH_KEY_RH_SYNS', 'rhsyns');
consts('HASH_KEY_RH_SEARCH', 'rhsearch');
consts('HASH_KEY_RH_TOCID', 'rhtocid');

// Hash keys
consts('HASH_KEY_TOPIC', 't');
consts('HASH_KEY_UIMODE', 'ux');
consts('HASH_KEY_RANDOM', 'random');

consts('PATH_PROJECT_TAGDATA_FILE', 'whxdata/whtagdata.js');
consts('CORDOVA_JS_URL', 'cordova.js');
consts('RHS_LOG_TOPIC_VIEW', { mgr: 'sys', cmd: 'logtpc' });
consts('RHS_DO_SEARCH', { mgr: 'agm', agt: 'nls', cmd: 'search' });
consts('KEY_MOBILE_APP_MODE', '.m.mobileapp');

},{}],7:[function(require,module,exports){
'use strict';

var _window = window,
    rh = _window.rh;
var _ = rh._;
var model = rh.model;
var consts = rh.consts;


var KEY_MERGED_PROJECT_MAP = consts('KEY_MERGED_PROJECT_MAP');

_.parseProjectName = function (project) {
  return project.replace(/\.\//g, '').replace(/\.$/, '').replace(/\/$/, '');
};

_.mapTagIndex = function (idx, project) {
  if (project == null) {
    project = '';
  }
  if (idx) {
    return idx + '+' + project;
  }
  return idx;
};

_.getTags = function (idx, project) {
  if (project == null) {
    project = '';
  }
  if (idx == null) {
    return idx;
  }
  var idmap = model.get(KEY_MERGED_PROJECT_MAP);
  var len = idx.indexOf('+');
  if (len !== -1) {
    project = idx.substring(len + 1, idx.length);
    idx = idx.substring(0, len);
  }
  project = _.parseProjectName(project);
  if ((idmap[project] != null ? idmap[project][idx] : undefined) != null) {
    return idmap[project][idx];
  }
  return idx;
};

_.getProjectName = function (url) {
  var idmap = model.get(KEY_MERGED_PROJECT_MAP);
  if (url != null && idmap != null) {
    url = _.parentPath(url);
    var relUrl = _.makeRelativePath(url, _.getHostFolder());
    relUrl = _.parseProjectName(relUrl);
    while (idmap[relUrl] == null) {
      var n = relUrl.lastIndexOf('/');
      if (n < 0) {
        relUrl = '';
        break;
      }
      relUrl = relUrl.substring(0, n);
    }
    url = relUrl;
  }
  return url;
};

_.evalTagExpression = function (index, groupExprs, project) {
  if (project == null) {
    project = '';
  }
  if (!groupExprs || groupExprs.length === 0) {
    return true;
  }

  var tags = _.getTags(index, project);
  if (!tags || tags.length === 0) {
    return true;
  }

  // TODO: fix empty string in robohelp
  if (tags.length === 1 && (tags[0] === '' || tags[0] === '$')) {
    return true;
  }

  var trueFlag = false;
  var falseFlag = _.any(groupExprs, function (item) {
    if (_.evalMultipleTagExpression(item.c, tags)) {
      trueFlag = true;
    } else if (item.c.length) {
      if (_.evalMultipleTagExpression(item.u, tags)) {
        return true;
      }
    }
    return false;
  });

  if (falseFlag) {
    return false;
  } else {
    return trueFlag;
  }
};

_.evalMultipleTagExpression = function (exprs, tags) {
  return _.any(exprs, function (expr) {
    return _.evalSingleTagExpression(expr, tags);
  });
};

_.evalSingleTagExpression = function () {
  var cache = {};
  var operators = ['&', '|', '!'];
  var evalAnd = function evalAnd(stack) {
    var items = stack.splice(stack.length - 2);
    return stack.push(items[0] === 1 && items[1] === 1 ? 1 : 0);
  };

  var evalOr = function evalOr(stack) {
    var items = stack.splice(stack.length - 2);
    return stack.push(items[0] === 1 || items[1] === 1 ? 1 : 0);
  };

  var evalNot = function evalNot(stack, tags) {
    var items = stack.splice(stack.length - 1);
    return stack.push(items[0] === 1 ? 0 : 1);
  };

  return function (expr, tags) {
    var key = expr + ':' + tags; // TODO: now robohelp should export tags as string
    var result = cache[key];
    if (result != null) {
      return result;
    }

    var tokens = _.map(expr.split(' '), function (item) {
      if (-1 !== operators.indexOf(item)) {
        return item;
      }
      if (-1 === tags.indexOf(item)) {
        return 0;
      } else {
        return 1;
      }
    });

    if (tokens.length > 1) {
      var stack = [];
      var _iteratorNormalCompletion = true;
      var _didIteratorError = false;
      var _iteratorError = undefined;

      try {
        for (var _iterator = Array.from(tokens)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
          var token = _step.value;

          switch (token) {
            case '&':
              evalAnd(stack);break;
            case '|':
              evalOr(stack);break;
            case '!':
              evalNot(stack);break;
            default:
              stack.push(token);
          }
        }
      } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion && _iterator.return) {
            _iterator.return();
          }
        } finally {
          if (_didIteratorError) {
            throw _iteratorError;
          }
        }
      }

      result = stack[0];
    } else {
      result = tokens[0];
    }

    return cache[key] = result;
  };
}();

},{}],8:[function(require,module,exports){
'use strict';

var rh = window.rh;
var _ = rh._;
var consts = rh.consts;

_.getHostFolder = function () {
  var hostFolder = void 0;
  hostFolder = null;
  return function () {
    if (hostFolder == null) {
      hostFolder = _.isLocal() ? window.gHostPath : document.location.protocol + '//' + window.gHost + window.gHostPath;
    }
    return hostFolder;
  };
}();

_.getHostData = function (rootPath) {
  var absFolder = void 0;
  absFolder = window._getFullPath(_.parentPath(), rootPath + '/');
  if (window._isHTTPUrl(absFolder)) {
    return {
      gHost: window._getHostNameFromURL(absFolder),
      gHostPath: window._getPathFromURL(absFolder)
    };
  } else {
    return {
      gHost: '',
      gHostPath: absFolder
    };
  }
};

_.getHashMapForRoot = function (relUrl, bCsh) {
  var hashMap = void 0;
  var urlhashMap = void 0;
  if (bCsh == null) {
    bCsh = null;
  }
  relUrl = _.fixRelativeUrl(relUrl);
  urlhashMap = _.urlParams(_.extractParamString(relUrl));
  if (bCsh) {
    urlhashMap[consts('RHMAPID')] = null;
    urlhashMap[consts('RHMAPNO')] = null;
  }
  hashMap = _.extend(_.urlParams(), urlhashMap);
  hashMap = _.fixHashMapForRoot(hashMap);
  //hashMap = _.addRHSParams(hashMap);
  return hashMap;
};

_.getParamsForRoot = function (relUrl, bCsh) {
  var queryMap = void 0;
  var queryString = void 0;
  if (bCsh == null) {
    bCsh = null;
  }
  queryMap = _.getHashMapForRoot(relUrl, bCsh);
  queryString = _.mapToEncodedString(queryMap);
  if (queryString.length === 0) {
    return '';
  } else {
    return '?' + queryString;
  }
};

_.isRootUrl = function (absUrl) {
  var fileName = void 0;
  var filePath = void 0;
  var rootUrl = void 0;
  if (absUrl == null) {
    absUrl = decodeURI(document.location.href);
  }
  rootUrl = _.getRootUrl();
  filePath = _.filePath(absUrl);
  if (filePath === _.filePath(rootUrl)) {
    return true;
  }
  fileName = _.getFileName(rootUrl);
  return (fileName === 'index.htm' || fileName === 'index.html') && filePath === _.parentPath(rootUrl);
};

_.isExternalUrl = function (absUrl) {
  var hostFolder = void 0;
  if (rh.model.get(rh.consts('KEY_PUBLISH_MODE'))) {
    hostFolder = rh.model.get(rh.consts('KEY_PROJECTS_BASE_URL'));
  } else {
    hostFolder = _.getHostFolder();
  }

  return !(_.equalUrlBase(absUrl, hostFolder) && _.urlStartsWith(absUrl, hostFolder));
};

_.fixHashMapForRoot = function (hashMap) {
  var HASH_KEY_RANDOM = void 0;
  var HASH_KEY_RH_HIGHLIGHT = void 0;
  var HASH_KEY_RH_SEARCH = void 0;
  var HASH_KEY_RH_TOCID = void 0;
  var HASH_KEY_TOPIC = void 0;
  var HASH_KEY_UIMODE = void 0;
  if (hashMap == null) {
    hashMap = {};
  }
  HASH_KEY_RH_SEARCH = consts('HASH_KEY_RH_SEARCH');
  HASH_KEY_TOPIC = consts('HASH_KEY_TOPIC');
  HASH_KEY_UIMODE = consts('HASH_KEY_UIMODE');
  HASH_KEY_RH_TOCID = consts('HASH_KEY_RH_TOCID');
  HASH_KEY_RH_HIGHLIGHT = consts('HASH_KEY_RH_HIGHLIGHT');
  HASH_KEY_RANDOM = consts('HASH_KEY_RANDOM');
  if (!hashMap[HASH_KEY_UIMODE]) {
    hashMap[HASH_KEY_UIMODE] = null;
  }
  hashMap[HASH_KEY_RANDOM] = null;
  if (!hashMap[HASH_KEY_RH_TOCID]) {
    hashMap[HASH_KEY_RH_TOCID] = null;
  }
  if (!hashMap[HASH_KEY_RH_HIGHLIGHT]) {
    hashMap[HASH_KEY_RH_HIGHLIGHT] = null;
  }
  if (!hashMap[HASH_KEY_RH_SEARCH]) {
    hashMap[HASH_KEY_RH_SEARCH] = null;
  }
  return hashMap;
};

_.fixRelativeUrl = function (filePath) {
  if (filePath == null) {
    filePath = '';
  }
  filePath = filePath.replace(/\/\.\//g, '/');
  if (filePath[0] === '.' && filePath[1] === '/') {
    filePath = filePath.substring(2);
  }
  return filePath;
};

_.ensureSlash = function (url) {
  if (url != null && url.substr(-1) !== '/') {
    url += '/';
  }
  return url;
};

_.isUrlAllowdInIframe = function () {
  var ALLOWED_EXTS_IN_IFRAME = void 0;
  ALLOWED_EXTS_IN_IFRAME = ['', '.htm', '.html', '.asp', '.aspx'];
  return function (absUrl) {
    var ext = void 0;
    var relUrl = void 0;
    if (_.isExternalUrl(absUrl)) {
      return false;
    }
    relUrl = absUrl.substring(_.getHostFolder().length);
    ext = _.getFileExtention(relUrl).toLowerCase();
    return ALLOWED_EXTS_IN_IFRAME.includes(ext);
  };
}();

_.splitUrl = function (url) {
  var element = document.createElement('a'); //any non empty element
  element.setAttribute('href', url);
  var hostname = element.hostname,
      port = element.port,
      search = element.search,
      pathname = element.pathname,
      protocol = element.protocol;

  !pathname.startsWith('/') ? pathname = '/' + pathname : '';
  return { hostname: hostname, port: port, search: search, pathname: pathname, protocol: protocol };
};

_.equalUrlBase = function (url1, url2) {
  var urlParts1 = _.splitUrl(url1);
  var urlParts2 = _.splitUrl(url2);

  return urlParts1.protocol === urlParts2.protocol && urlParts1.hostname === urlParts2.hostname && _.equalUrlPorts(urlParts1, urlParts2);
};

_.equalUrlPorts = function (parts1, parts2) {
  var defaultPort = parts1.protocol === 'http' ? rh.consts('HTTP_PORT') : parts1.protocol === 'https' ? rh.consts('HTTPS_PORT') : '';

  return parts1.port === parts2.port || !parts1.port && parts2.port === defaultPort || !parts2.port && parts1.port === defaultPort;
};

_.urlStartsWith = function (url, base) {
  var urlParts1 = _.splitUrl(url);
  var urlParts2 = _.splitUrl(base);
  var path1 = urlParts1.pathname && urlParts1.pathname.toLowerCase();
  var path2 = urlParts2.pathname && urlParts2.pathname.toLowerCase();
  return path1.startsWith(path2);
};

},{}],9:[function(require,module,exports){
'use strict';

// to support old browser

if (String.prototype.trim == null) {
  String.prototype.trim = function () {
    return String(this).replace(/^\s+|\s+$/g, '');
  };
}

if (String.prototype.trimLeft == null) {
  String.prototype.trimLeft = function () {
    return String(this).replace(/^\s+/, '');
  };
}

if (String.prototype.trimRight == null) {
  String.prototype.trimRight = function () {
    return String(this).replace(/\s+$/, '');
  };
}

if (String.prototype.trimStart == null) {
  String.prototype.trimStart = String.prototype.trimLeft;
}

if (String.prototype.trimEnd == null) {
  String.prototype.trimEnd = String.prototype.trimRight;
}

},{}],10:[function(require,module,exports){
//----------------------------------------------------------------------
//
// ECMAScript 5 Polyfills
//
//----------------------------------------------------------------------

//----------------------------------------------------------------------
// ES5 15.2 Object Objects
//----------------------------------------------------------------------

//
// ES5 15.2.3 Properties of the Object Constructor
//

// ES5 15.2.3.2 Object.getPrototypeOf ( O )
// From http://ejohn.org/blog/objectgetprototypeof/
// NOTE: won't work for typical function T() {}; T.prototype = {}; new T; case
// since the constructor property is destroyed.
if (!Object.getPrototypeOf) {
  Object.getPrototypeOf = function (o) {
    if (o !== Object(o)) { throw TypeError("Object.getPrototypeOf called on non-object"); }
    return o.__proto__ || o.constructor.prototype || Object.prototype;
  };
}

//    // ES5 15.2.3.3 Object.getOwnPropertyDescriptor ( O, P )
//    if (typeof Object.getOwnPropertyDescriptor !== "function") {
//        Object.getOwnPropertyDescriptor = function (o, name) {
//            if (o !== Object(o)) { throw TypeError(); }
//            if (o.hasOwnProperty(name)) {
//                return {
//                    value: o[name],
//                    enumerable: true,
//                    writable: true,
//                    configurable: true
//                };
//            }
//        };
//    }

// ES5 15.2.3.4 Object.getOwnPropertyNames ( O )
if (typeof Object.getOwnPropertyNames !== "function") {
  Object.getOwnPropertyNames = function (o) {
    if (o !== Object(o)) { throw TypeError("Object.getOwnPropertyNames called on non-object"); }
    var props = [], p;
    for (p in o) {
      if (Object.prototype.hasOwnProperty.call(o, p)) {
        props.push(p);
      }
    }
    return props;
  };
}

// ES5 15.2.3.5 Object.create ( O [, Properties] )
if (typeof Object.create !== "function") {
  Object.create = function (prototype, properties) {
    if (typeof prototype !== "object") { throw TypeError(); }
    function Ctor() {}
    Ctor.prototype = prototype;
    var o = new Ctor();
    if (prototype) { o.constructor = Ctor; }
    if (properties !== undefined) {
      if (properties !== Object(properties)) { throw TypeError(); }
      Object.defineProperties(o, properties);
    }
    return o;
  };
}

// ES 15.2.3.6 Object.defineProperty ( O, P, Attributes )
// Partial support for most common case - getters, setters, and values
(function() {
  if (!Object.defineProperty ||
      !(function () { try { Object.defineProperty({}, 'x', {}); return true; } catch (e) { return false; } } ())) {
    var orig = Object.defineProperty;
    Object.defineProperty = function (o, prop, desc) {
      // In IE8 try built-in implementation for defining properties on DOM prototypes.
      if (orig) { try { return orig(o, prop, desc); } catch (e) {} }

      if (o !== Object(o)) { throw TypeError("Object.defineProperty called on non-object"); }
      if (Object.prototype.__defineGetter__ && ('get' in desc)) {
        Object.prototype.__defineGetter__.call(o, prop, desc.get);
      }
      if (Object.prototype.__defineSetter__ && ('set' in desc)) {
        Object.prototype.__defineSetter__.call(o, prop, desc.set);
      }
      if ('value' in desc) {
        o[prop] = desc.value;
      }
      return o;
    };
  }
}());

// ES 15.2.3.7 Object.defineProperties ( O, Properties )
if (typeof Object.defineProperties !== "function") {
  Object.defineProperties = function (o, properties) {
    if (o !== Object(o)) { throw TypeError("Object.defineProperties called on non-object"); }
    var name;
    for (name in properties) {
      if (Object.prototype.hasOwnProperty.call(properties, name)) {
        Object.defineProperty(o, name, properties[name]);
      }
    }
    return o;
  };
}


// ES5 15.2.3.14 Object.keys ( O )
// https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/keys
if (!Object.keys) {
  Object.keys = function (o) {
    if (o !== Object(o)) { throw TypeError('Object.keys called on non-object'); }
    var ret = [], p;
    for (p in o) {
      if (Object.prototype.hasOwnProperty.call(o, p)) {
        ret.push(p);
      }
    }
    return ret;
  };
}

//----------------------------------------------------------------------
// ES5 15.3 Function Objects
//----------------------------------------------------------------------

//
// ES5 15.3.4 Properties of the Function Prototype Object
//

// ES5 15.3.4.5 Function.prototype.bind ( thisArg [, arg1 [, arg2, ... ]] )
// https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind
if (!Function.prototype.bind) {
  Function.prototype.bind = function (o) {
    if (typeof this !== 'function') { throw TypeError("Bind must be called on a function"); }

    var args = Array.prototype.slice.call(arguments, 1),
        self = this,
        nop = function() {},
        bound = function () {
          return self.apply(this instanceof nop ? this : o,
                            args.concat(Array.prototype.slice.call(arguments)));
        };

    if (this.prototype)
      nop.prototype = this.prototype;
    bound.prototype = new nop();
    return bound;
  };
}


//----------------------------------------------------------------------
// ES5 15.4 Array Objects
//----------------------------------------------------------------------

//
// ES5 15.4.3 Properties of the Array Constructor
//


// ES5 15.4.3.2 Array.isArray ( arg )
// https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/isArray
Array.isArray = Array.isArray || function (o) { return Boolean(o && Object.prototype.toString.call(Object(o)) === '[object Array]'); };


//
// ES5 15.4.4 Properties of the Array Prototype Object
//

// ES5 15.4.4.14 Array.prototype.indexOf ( searchElement [ , fromIndex ] )
// From https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/indexOf
if (!Array.prototype.indexOf) {
  Array.prototype.indexOf = function (searchElement /*, fromIndex */) {
    if (this === void 0 || this === null) { throw TypeError(); }

    var t = Object(this);
    var len = t.length >>> 0;
    if (len === 0) { return -1; }

    var n = 0;
    if (arguments.length > 0) {
      n = Number(arguments[1]);
      if (isNaN(n)) {
        n = 0;
      } else if (n !== 0 && n !== (1 / 0) && n !== -(1 / 0)) {
        n = (n > 0 || -1) * Math.floor(Math.abs(n));
      }
    }

    if (n >= len) { return -1; }

    var k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);

    for (; k < len; k++) {
      if (k in t && t[k] === searchElement) {
        return k;
      }
    }
    return -1;
  };
}

// ES5 15.4.4.15 Array.prototype.lastIndexOf ( searchElement [ , fromIndex ] )
// From https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/lastIndexOf
if (!Array.prototype.lastIndexOf) {
  Array.prototype.lastIndexOf = function (searchElement /*, fromIndex*/) {
    if (this === void 0 || this === null) { throw TypeError(); }

    var t = Object(this);
    var len = t.length >>> 0;
    if (len === 0) { return -1; }

    var n = len;
    if (arguments.length > 1) {
      n = Number(arguments[1]);
      if (n !== n) {
        n = 0;
      } else if (n !== 0 && n !== (1 / 0) && n !== -(1 / 0)) {
        n = (n > 0 || -1) * Math.floor(Math.abs(n));
      }
    }

    var k = n >= 0 ? Math.min(n, len - 1) : len - Math.abs(n);

    for (; k >= 0; k--) {
      if (k in t && t[k] === searchElement) {
        return k;
      }
    }
    return -1;
  };
}

// ES5 15.4.4.16 Array.prototype.every ( callbackfn [ , thisArg ] )
// From https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/every
if (!Array.prototype.every) {
  Array.prototype.every = function (fun /*, thisp */) {
    if (this === void 0 || this === null) { throw TypeError(); }

    var t = Object(this);
    var len = t.length >>> 0;
    if (typeof fun !== "function") { throw TypeError(); }

    var thisp = arguments[1], i;
    for (i = 0; i < len; i++) {
      if (i in t && !fun.call(thisp, t[i], i, t)) {
        return false;
      }
    }

    return true;
  };
}

// ES5 15.4.4.17 Array.prototype.some ( callbackfn [ , thisArg ] )
// From https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/some
if (!Array.prototype.some) {
  Array.prototype.some = function (fun /*, thisp */) {
    if (this === void 0 || this === null) { throw TypeError(); }

    var t = Object(this);
    var len = t.length >>> 0;
    if (typeof fun !== "function") { throw TypeError(); }

    var thisp = arguments[1], i;
    for (i = 0; i < len; i++) {
      if (i in t && fun.call(thisp, t[i], i, t)) {
        return true;
      }
    }

    return false;
  };
}

// ES5 15.4.4.18 Array.prototype.forEach ( callbackfn [ , thisArg ] )
// From https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/forEach
if (!Array.prototype.forEach) {
  Array.prototype.forEach = function (fun /*, thisp */) {
    if (this === void 0 || this === null) { throw TypeError(); }

    var t = Object(this);
    var len = t.length >>> 0;
    if (typeof fun !== "function") { throw TypeError(); }

    var thisp = arguments[1], i;
    for (i = 0; i < len; i++) {
      if (i in t) {
        fun.call(thisp, t[i], i, t);
      }
    }
  };
}


// ES5 15.4.4.19 Array.prototype.map ( callbackfn [ , thisArg ] )
// From https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/Map
if (!Array.prototype.map) {
  Array.prototype.map = function (fun /*, thisp */) {
    if (this === void 0 || this === null) { throw TypeError(); }

    var t = Object(this);
    var len = t.length >>> 0;
    if (typeof fun !== "function") { throw TypeError(); }

    var res = []; res.length = len;
    var thisp = arguments[1], i;
    for (i = 0; i < len; i++) {
      if (i in t) {
        res[i] = fun.call(thisp, t[i], i, t);
      }
    }

    return res;
  };
}

// ES5 15.4.4.20 Array.prototype.filter ( callbackfn [ , thisArg ] )
// From https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/Filter
if (!Array.prototype.filter) {
  Array.prototype.filter = function (fun /*, thisp */) {
    if (this === void 0 || this === null) { throw TypeError(); }

    var t = Object(this);
    var len = t.length >>> 0;
    if (typeof fun !== "function") { throw TypeError(); }

    var res = [];
    var thisp = arguments[1], i;
    for (i = 0; i < len; i++) {
      if (i in t) {
        var val = t[i]; // in case fun mutates this
        if (fun.call(thisp, val, i, t)) {
          res.push(val);
        }
      }
    }

    return res;
  };
}


// ES5 15.4.4.21 Array.prototype.reduce ( callbackfn [ , initialValue ] )
// From https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/Reduce
if (!Array.prototype.reduce) {
  Array.prototype.reduce = function (fun /*, initialValue */) {
    if (this === void 0 || this === null) { throw TypeError(); }

    var t = Object(this);
    var len = t.length >>> 0;
    if (typeof fun !== "function") { throw TypeError(); }

    // no value to return if no initial value and an empty array
    if (len === 0 && arguments.length === 1) { throw TypeError(); }

    var k = 0;
    var accumulator;
    if (arguments.length >= 2) {
      accumulator = arguments[1];
    } else {
      do {
        if (k in t) {
          accumulator = t[k++];
          break;
        }

        // if array contains no values, no initial value to return
        if (++k >= len) { throw TypeError(); }
      }
      while (true);
    }

    while (k < len) {
      if (k in t) {
        accumulator = fun.call(undefined, accumulator, t[k], k, t);
      }
      k++;
    }

    return accumulator;
  };
}


// ES5 15.4.4.22 Array.prototype.reduceRight ( callbackfn [, initialValue ] )
// From https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/ReduceRight
if (!Array.prototype.reduceRight) {
  Array.prototype.reduceRight = function (callbackfn /*, initialValue */) {
    if (this === void 0 || this === null) { throw TypeError(); }

    var t = Object(this);
    var len = t.length >>> 0;
    if (typeof callbackfn !== "function") { throw TypeError(); }

    // no value to return if no initial value, empty array
    if (len === 0 && arguments.length === 1) { throw TypeError(); }

    var k = len - 1;
    var accumulator;
    if (arguments.length >= 2) {
      accumulator = arguments[1];
    } else {
      do {
        if (k in this) {
          accumulator = this[k--];
          break;
        }

        // if array contains no values, no initial value to return
        if (--k < 0) { throw TypeError(); }
      }
      while (true);
    }

    while (k >= 0) {
      if (k in t) {
        accumulator = callbackfn.call(undefined, accumulator, t[k], k, t);
      }
      k--;
    }

    return accumulator;
  };
}


//----------------------------------------------------------------------
// ES5 15.5 String Objects
//----------------------------------------------------------------------

//
// ES5 15.5.4 Properties of the String Prototype Object
//


// ES5 15.5.4.20 String.prototype.trim()
if (!String.prototype.trim) {
  String.prototype.trim = function () {
    return String(this).replace(/^\s+/, '').replace(/\s+$/, '');
  };
}



//----------------------------------------------------------------------
// ES5 15.9 Date Objects
//----------------------------------------------------------------------


//
// ES 15.9.4 Properties of the Date Constructor
//

// ES5 15.9.4.4 Date.now ( )
// From https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Date/now
if (!Date.now) {
  Date.now = function now() {
    return Number(new Date());
  };
}


//
// ES5 15.9.5 Properties of the Date Prototype Object
//

// ES5 15.9.4.43 Date.prototype.toISOString ( )
// Inspired by http://www.json.org/json2.js
if (!Date.prototype.toISOString) {
  Date.prototype.toISOString = function () {
    function pad2(n) { return ('00' + n).slice(-2); }
    function pad3(n) { return ('000' + n).slice(-3); }

    return this.getUTCFullYear() + '-' +
      pad2(this.getUTCMonth() + 1) + '-' +
      pad2(this.getUTCDate()) + 'T' +
      pad2(this.getUTCHours()) + ':' +
      pad2(this.getUTCMinutes()) + ':' +
      pad2(this.getUTCSeconds()) + '.' +
      pad3(this.getUTCMilliseconds()) + 'Z';
  };
}

},{}],11:[function(require,module,exports){
//----------------------------------------------------------------------
//
// ECMAScript 2015 Polyfills
//
//----------------------------------------------------------------------

(function (global) {
  "use strict";

  // Set this to always override native implementations, for testing
  // the polyfill in browsers with partial/full ES2015 support.
  var OVERRIDE_NATIVE_FOR_TESTING = false;

  var undefined = (void 0); // Paranoia

  // Helpers

  function strict(o) {
    return o === global ? undefined : o;
  }

  function isSymbol(s) {
    return (typeof s === 'symbol') || ('Symbol' in global && s instanceof global.Symbol);
  }

  function getPropertyDescriptor(target, name) {
    var desc = Object.getOwnPropertyDescriptor(target, name);
    var proto = Object.getPrototypeOf(target);
    while (!desc && proto) {
      desc = Object.getOwnPropertyDescriptor(proto, name);
      proto = Object.getPrototypeOf(proto);
    }
    return desc;
  }

  var enqueue = (function(nativePromise, nativeSetImmediate) {
    if (nativePromise)
      return function(job) { nativePromise.resolve().then(function() { job(); }); };
    if (nativeSetImmediate)
      return function(job) { nativeSetImmediate(job); };
    return function(job) { setTimeout(job, 0); };
  }(global['Promise'], global['setImmediate']));

  function define(o, p, v, override) {
    if (p in o && !override && !OVERRIDE_NATIVE_FOR_TESTING)
      return;

    if (typeof v === 'function') {
      // Sanity check that functions are appropriately named (where possible)
      //console.assert(isSymbol(p) || !('name' in v) || v.name === p || v.name === p + '_', 'Expected function name "' + p.toString() + '", was "' + v.name + '"');
      Object.defineProperty(o, p, {
        value: v,
        configurable: true,
        enumerable: false,
        writable: true
      });
    } else {
      Object.defineProperty(o, p, {
        value: v,
        configurable: false,
        enumerable: false,
        writable: false
      });
    }
  }

  function set_internal(o, p, v) {
    Object.defineProperty(o, p, {
      value: v,
      configurable: false,
      enumerable: false,
      writable: true
    });
  }

  // Snapshot intrinsic functions
  var $isNaN = global.isNaN,
      $parseInt = global.parseInt,
      $parseFloat = global.parseFloat;

  var E = Math.E,
      LOG10E = Math.LOG10E,
      LOG2E = Math.LOG2E,
      abs = Math.abs,
      ceil = Math.ceil,
      exp = Math.exp,
      floor = Math.floor,
      log = Math.log,
      max = Math.max,
      min = Math.min,
      pow = Math.pow,
      random = Math.random,
      sqrt = Math.sqrt;

  var orig_match = String.prototype.match,
      orig_replace = String.prototype.replace,
      orig_search = String.prototype.search,
      orig_split = String.prototype.split;

  // These are used for implementing the polyfills, but not exported.

  // Inspired by https://gist.github.com/1638059
  /** @constructor */
  function EphemeronTable() {
    var secretKey = ObjectCreate(null);

    function conceal(o) {
      var oValueOf = o.valueOf, secrets = ObjectCreate(null);
      Object.defineProperty(o, 'valueOf', {
          value: (function(secretKey) {
            return function (k) {
              return (k === secretKey) ? secrets : oValueOf.apply(o, arguments);
            };
          }(secretKey)),
        configurable: true,
        writeable: true,
        enumerable: false
        });
      return secrets;
    }

    function reveal(o) {
      var v = typeof o.valueOf === 'function' && o.valueOf(secretKey);
      return v === o ? null : v;
    }

    return {
      clear: function() {
        secretKey = ObjectCreate(null);
      },
      remove: function(key) {
        var secrets = reveal(key);
        if (secrets && HasOwnProperty(secrets, 'value')) {
          delete secrets.value;
          return true;
        }
        return false;
      },
      get: function(key, defaultValue) {
        var secrets = reveal(key);
        return (secrets && HasOwnProperty(secrets, 'value')) ? secrets.value : defaultValue;
      },
      has: function(key) {
        var secrets = reveal(key);
        return Boolean(secrets && HasOwnProperty(secrets, 'value'));
      },
      set: function(key, value) {
        var secrets = reveal(key) || conceal(key);
        secrets.value = value;
      }
    };
  }

  var empty = Object.create(null);

  //----------------------------------------------------------------------
  //
  // ECMAScript 2015
  // http://www.ecma-international.org/ecma-262/6.0/
  //
  //----------------------------------------------------------------------

  // ---------------------------------------
  // 19.4 Symbol Objects
  // ---------------------------------------

  // NOTE: Symbols are defined here - out of spec order - since we need the
  // properties and prototype to be populated for other polyfills.

  // NOTE: Not secure, nor is obj[$$symbol] hidden from Object.keys()

  var symbolForKey;
  (function() {
    var secret = Object.create(null);
    var symbolMap = {};
    symbolForKey = function(k) {
      return symbolMap[k];
    };

    var GlobalSymbolRegistry = [];

    function unique(bits) {
      return Array(bits + 1).join('x').replace(/x/g, function() {
        return random() < 0.5 ? '\u200C' : '\u200D'; // JWNJ / ZWJ
      });
    }

    // 19.4.1 The Symbol Constructor
    // 19.4.1.1 Symbol ( description=undefined )
    function Symbol(description) {
      if (!(this instanceof Symbol)) return new Symbol(description, secret);
      if (this instanceof Symbol && arguments[1] !== secret) throw TypeError();

      var descString = description === undefined ? undefined : String(description);

      set_internal(this, '[[SymbolData]]', unique(128));
      set_internal(this, '[[Description]]', descString);

      symbolMap[this] = this;
      return this;
    }

    if (!('Symbol' in global) || OVERRIDE_NATIVE_FOR_TESTING)
      global.Symbol = Symbol;

    // 19.4.2 Properties of the Symbol Constructor

    // 19.4.2.1 Symbol.for (key)
    define(Symbol, 'for', function for_(key) {
      var stringKey = String(key);
      for (var i = 0; i < GlobalSymbolRegistry.length; ++i) {
        var e = GlobalSymbolRegistry[i];
        if (SameValue(e['[[key]]'], stringKey)) return e['[[symbol]]'];
      }
      var newSymbol = Symbol(key);
      GlobalSymbolRegistry.push({'[[key]]': stringKey, '[[symbol]]': newSymbol});
      return newSymbol;
    });

    // 19.4.2.2 Symbol.hasInstance
    // 19.4.2.3 Symbol.isConcatSpreadable

    // 19.4.2.4 Symbol.iterator
    define(global.Symbol, 'iterator', global.Symbol('Symbol.iterator'));

    // 19.4.2.5 Symbol.keyFor (sym)
    define(Symbol, 'keyFor', function keyFor(sym) {
      if (!(sym instanceof Symbol)) throw TypeError();
      for (var i = 0; i < GlobalSymbolRegistry.length; ++i) {
        var e = GlobalSymbolRegistry[i];
        if (SameValue(e['[[symbol]]'], sym)) return e['[[key]]'];
      }
      return undefined;
    });

    // 19.4.2.6 Symbol.match
    define(global.Symbol, 'match', global.Symbol('Symbol.match'));

    // 19.4.2.7 Symbol.prototype

    // 19.4.2.8 Symbol.replace
    define(global.Symbol, 'replace', global.Symbol('Symbol.replace'));

    // 19.4.2.9 Symbol.search
    define(global.Symbol, 'search', global.Symbol('Symbol.search'));

    // 19.4.2.10 Symbol.species

    // 19.4.2.11 Symbol.search
    define(global.Symbol, 'split', global.Symbol('Symbol.split'));

    // 19.4.2.12 Symbol.toPrimitive

    // 19.4.2.13 Symbol.toStringTag
    define(global.Symbol, 'toStringTag', global.Symbol('Symbol.toStringTag'));

    // 19.4.2.14 Symbol.unscopables

    // 19.4.3 Properties of the Symbol Prototype Object
    // 19.4.3.1 Symbol.prototype.constructor

    // 19.4.3.2 Symbol.prototype.toString ( )
    Object.defineProperty(Symbol.prototype, 'toString', {
      value: function toString() {
        var s = strict(this);
        var desc = s['[[Description]]'];
        return 'Symbol(' + (desc === undefined ? '' : desc) + s['[[SymbolData]]'] + ')';
      },
      configurable: true, writeable: true, enumerable: false });

    // 19.4.3.3 Symbol.prototype.valueOf ( )
    Object.defineProperty(Symbol.prototype, 'valueOf', {
      value: function valueOf() {
        // To prevent automatic string conversion:
        throw TypeError();

        // Spec has approximately the following:
        //var s = strict(this);
        //if (Type(s) === 'symbol') return s;
        //if (Type(s) !== 'object') throw TypeError();
        //if (!('[[SymbolData]]' in s)) throw TypeError();
        //return s['[[SymbolData]]'];
      },
      configurable: true, writeable: true, enumerable: false });

    // 19.4.3.4 Symbol.prototype [ @@toStringTag ]
    // (Done later to polyfill partial implementations)

    // 19.4.4 Properties of Symbol Instances
  }());

  console.assert(typeof global.Symbol() === 'symbol' || symbolForKey(String(global.Symbol('x'))) !== undefined);

  // Defined here so that other prototypes can reference it
  // 25.1.2 The %IteratorPrototype% Object
  var $IteratorPrototype$ = {};

  //----------------------------------------
  // 6 ECMAScript Data Types and Values
  //----------------------------------------

  // 6.1 ECMAScript Language Types

  // "Type(x)" is used as shorthand for "the type of x"...
  function Type(v) {
    switch (typeof v) {
    case 'undefined': return 'undefined';
    case 'boolean': return 'boolean';
    case 'number': return 'number';
    case 'string': return 'string';
    case 'symbol': return 'symbol';
    default:
      if (v === null) return 'null';
      if (v instanceof global.Symbol) return 'symbol';
      return 'object';
    }
  }

  // 6.1.5.1 Well-Known Symbols
  var $$iterator = global.Symbol.iterator,
      $$match = global.Symbol.match,
      $$replace = global.Symbol.replace,
      $$search = global.Symbol.search,
      $$split = global.Symbol.split,
      $$toStringTag = global.Symbol.toStringTag;

  //----------------------------------------
  // 7 Abstract Operations
  //----------------------------------------

  //----------------------------------------
  // 7.1 Type Conversion
  //----------------------------------------

  // 7.1.1 ToPrimitive ( input [, PreferredType] )
  // just use valueOf()

  // 7.1.2 ToBoolean ( argument )
  // just use Boolean()

  // 7.1.3 ToNumber ( argument )
  // just use Number()

  // 7.1.4 ToInteger ( argument )
  function ToInteger(n) {
    n = Number(n);
    if ($isNaN(n)) return 0;
    if (n === 0 || n === Infinity || n === -Infinity) return n;
    return ((n < 0) ? -1 : 1) * floor(abs(n));
  }

  // 7.1.5 ToInt32 ( argument )
  function ToInt32(v) { return v >> 0; }

  // 7.1.6 ToUint32 ( argument )
  function ToUint32(v) { return v >>> 0; }

  // 7.1.7 ToInt16 ( argument )
  function ToInt16(v) { return (v << 16) >> 16; }

  // 7.1.8 ToUint16 ( argument )
  function ToUint16(v) { return v & 0xFFFF; }

  // 7.1.9 ToInt8 ( argument )
  function ToInt8(v) { return (v << 24) >> 24; }

  // 7.1.10 ToUint8 ( argument )
  function ToUint8(v) { return v & 0xFF; }

  // 7.1.11 ToUint8Clamp ( argument )
  function ToUint8Clamp(argument) {
    var number = Number(argument);
    if ($isNaN(number)) return 0;
    if (number <= 0) return 0;
    if (number >= 255) return 255;
    var f = floor(number);
    if ((f + 0.5) < number) return f + 1;
    if (number < (f + 0.5)) return f;
    if (f % 2) return f + 1;
    return f;
  }

  // 7.1.12 ToString ( argument )
  // just use String()

  // 7.1.13 ToObject ( argument )
  function ToObject(v) {
    if (v === null || v === undefined) throw TypeError();
    return Object(v);
  }

  // 7.1.14 ToPropertyKey ( argument )
  function ToPropertyKey(v) {
    return String(v);
  }

  // 7.1.15 ToLength ( argument )
  function ToLength(v) {
    var len = ToInteger(v);
    if (len <= 0) return 0;
    if (len === Infinity) return 0x20000000000000 - 1; // 2^53-1
    return min(len, 0x20000000000000 - 1); // 2^53-1
  }

  // 7.1.16 CanonicalNumericIndexString ( argument )

  //----------------------------------------
  // 7.2 Testing and Comparison Operations
  //----------------------------------------

  // 7.2.1 RequireObjectCoercible ( argument )
  // 7.2.2 IsArray ( argument )

  // 7.2.3 IsCallable ( argument )
  function IsCallable(o) { return typeof o === 'function'; }

  // 7.2.4 IsConstructor ( argument )
  function IsConstructor(o) {
    // Hacks for Safari 7 TypedArray XXXConstructor objects
    if (/Constructor/.test(Object.prototype.toString.call(o))) return true;
    if (/Function/.test(Object.prototype.toString.call(o))) return true;
    // TODO: Can this be improved on?
    return typeof o === 'function';
  }

  // 7.2.5 IsExtensible (O)
  // 7.2.6 IsInteger ( argument )

  // 7.2.7 IsPropertyKey ( argument )
  function IsPropertyKey(argument) {
    if (Type(argument) === 'string') return true;
    if (Type(argument) === 'symbol') return true;
    return false;
  }

  // 7.2.8 IsRegExp ( argument )

  // 7.2.9 SameValue(x, y)
  function SameValue(x, y) {
    if (typeof x !== typeof y) return false;
    switch (typeof x) {
    case 'undefined':
      return true;
    case 'number':
      if (x !== x && y !== y) return true;
      if (x === 0 && y === 0) return 1/x === 1/y;
      return x === y;
    case 'boolean':
    case 'string':
    case 'object':
    default:
      return x === y;
    }
  }

  // 7.2.10 SameValueZero(x, y)
  function SameValueZero(x, y) {
    if (typeof x !== typeof y) return false;
    switch (typeof x) {
    case 'undefined':
      return true;
    case 'number':
      if (x !== x && y !== y) return true;
      return x === y;
    case 'boolean':
    case 'string':
    case 'object':
    default:
      return x === y;
    }
  }

  //----------------------------------------
  // 7.3 Operations on Objects
  //----------------------------------------

  // 7.3.1 Get (O, P)
  // - just use o.p or o[p]

  // 7.3.2 GetV (V, P)
  function GetV(v, p) {
    var o = ToObject(v);
    return o[p];
  }

  // 7.3.3 Set (O, P, V, Throw)
  // - just use o.p = v or o[p] = v




  // 7.3.9 GetMethod (O, P)
  function GetMethod(o, p) {
    var func = GetV(o, p);
    if (func === undefined || func === null) return undefined;
    if (!IsCallable(func)) throw TypeError();
    return func;
  }

  // 7.3.10 HasProperty (O, P)
  function HasProperty(o, p) {
    while (o) {
      if (Object.prototype.hasOwnProperty.call(o, p)) return true;
      if (Type(o) !== 'object') return false;
      var op = Object.getPrototypeOf(o);
      if (op === o) return false; // IE8 has self-referential prototypes
      o = op;
    }
    return false;
  }

  // 7.3.11 HasOwnProperty (O, P)
  function HasOwnProperty(o, p) {
    return Object.prototype.hasOwnProperty.call(o, p);
  }

  //----------------------------------------
  // 7.4 Operations on Iterator Objects
  //----------------------------------------

  // 7.4.1 GetIterator ( obj, method )
  function GetIterator(obj, method) {
    if (arguments.length < 2)
      method = GetMethod(obj, $$iterator);
    var iterator = method.call(obj);
    if (Type(iterator) !== 'object') throw TypeError();
    return iterator;
  }

  // 7.4.2 IteratorNext ( iterator, value )
  function IteratorNext(iterator, value) {
    if (arguments.length < 2)
      var result = iterator.next();
    else
      result = iterator.next(value);
    if (Type(result) !== 'object') throw TypeError();
    return result;
  }

  // 7.4.3 IteratorComplete ( iterResult )
  function IteratorComplete(iterResult) {
    console.assert(Type(iterResult) === 'object');
    return Boolean(iterResult.done);
  }

  // 7.4.4 IteratorValue ( iterResult )
  function IteratorValue(iterResult) {
    console.assert(Type(iterResult) === 'object');
    return iterResult.value;
  }

  // 7.4.5 IteratorStep ( iterator )
  function IteratorStep( iterator, value ) {
    var result = IteratorNext(iterator, value);
    var done = result['done'];
    if (Boolean(done) === true) return false;
    return result;
  }

  // 7.4.6 IteratorClose( iterator, completion )
  function IteratorClose( iterator, completion ) {
    console.assert(Type(iterator) === 'object');
    var _return = GetMethod(iterator, 'return');
    if (_return === undefined) return completion;
    try {
      var innerResult = _return[iterator]();
    } catch (result) {
      // TODO: If completion.[[type]] is throw, return completion
      return result;
    }
    if (Type(innerResult) !== 'object') throw TypeError();
    return completion;
  }

  // 7.4.7 CreateIterResultObject (value, done)
  function CreateIterResultObject(value, done) {
    console.assert(Type(done) === 'boolean');
    var obj = {};
    obj["value"] = value;
    obj["done"] = done;
    return obj;
  }

  // 7.4.8 CreateListIterator (list)
  // 7.4.8.1 ListIterator next( )

  //----------------------------------------
  // 8 Executable Code and Execution Contexts
  //----------------------------------------

  //----------------------------------------
  // 8.4 Jobs and Job Queues
  //----------------------------------------

  // 8.4.1 EnqueueJob ( queueName, job, arguments)
  function EnqueueJob(queueName, job, args) {
    var fn = function() { job.apply(undefined, args); };
    enqueue(fn);
  }

  // 8.4.2 NextJob result
  function NextJob(result) {
    // no-op
  }

  //----------------------------------------
  // 9 Ordinary and Exotic Objects Behaviors
  //----------------------------------------

  // 9.1.11 [[Enumerate]] ()
  function Enumerate(obj) {
    var e = [];
    if (Object(obj) !== obj) return e;
    var visited = new Set;
    while (obj !== null) {
      Object.getOwnPropertyNames(obj).forEach(function(name) {
        if (!visited.has(name)) {
          var desc = Object.getOwnPropertyDescriptor(obj, name);
          if (desc) {
            visited.add(name);
            if (desc.enumerable) e.push(name);
          }
        }
      });
      obj = Object.getPrototypeOf(obj);
    }
    return e[$$iterator]();
  }

  // 9.1.12 [[OwnPropertyKeys]] ( )
  function OwnPropertyKeys(o) {
    return Object.getOwnPropertyNames(o);
  }

  // 9.1.13 ObjectCreate(proto, internalSlotsList)
  function ObjectCreate(proto, internalSlotsList) {
    return Object.create(proto, internalSlotsList);
  }

  // ---------------------------------------
  // 19 Fundamental Objects
  // ---------------------------------------

  // ---------------------------------------
  // 19.1 Object Objects
  // ---------------------------------------

  // 19.1.1 The Object Constructor
  // 19.1.1.1 Object ( [ value ] )
  // 19.1.2 Properties of the Object Constructor
  // 19.1.2.1 Object.assign ( target, ...sources )
  define(
    Object, 'assign',
    function assign(target, /*...*/sources) {
      var to = ToObject(target);
      if (arguments.length < 2) return to;

      var sourcesIndex = 1;
      while (sourcesIndex < arguments.length) {
        var nextSource = arguments[sourcesIndex++];
        if (nextSource === undefined || nextSource === null) {
          var keys = [];
        } else {
          var from = ToObject(nextSource);
          keys = OwnPropertyKeys(from);
        }
        for (var keysIndex = 0; keysIndex < keys.length; ++keysIndex) {
          var nextKey = keys[keysIndex];
          var desc = Object.getOwnPropertyDescriptor(from, nextKey);
          if (desc !== undefined && desc.enumerable) {
            var propValue = from[nextKey];
            to[nextKey] = propValue;
          }
        }
      }
      return to;
    });

  // 19.1.2.2 Object.create ( O [ , Properties ] )
  // 19.1.2.3 Object.defineProperties ( O, Properties )
  // 19.1.2.4 Object.defineProperty ( O, P, Attributes )
  // 19.1.2.5 Object.freeze ( O )
  // 19.1.2.6 Object.getOwnPropertyDescriptor ( O, P )

  (function() {
    var nativeSymbols = (typeof global.Symbol() === 'symbol'),
        $getOwnPropertyNames = Object.getOwnPropertyNames,
        $keys = Object.keys,
        $window_names = (typeof window === 'object' ? $getOwnPropertyNames(window) : []);

    function isStringKey(k) { return !symbolForKey(k); }

    // 19.1.2.7 Object.getOwnPropertyNames ( O )
    define(
      Object, 'getOwnPropertyNames',
      function getOwnPropertyNames(o) {
        if (Object.prototype.toString.call(o) === '[object Window]') {
          // Workaround for cross-realm calling by IE itself.
          // https://github.com/inexorabletash/polyfill/issues/96
          try {
            return $getOwnPropertyNames(o).filter(isStringKey);
          } catch (_) {
            return $window_names.slice();
          }
        }
        return $getOwnPropertyNames(o).filter(isStringKey);
      }, !nativeSymbols);

    // 19.1.2.8 Object.getOwnPropertySymbols ( O )
    define(
      Object, 'getOwnPropertySymbols',
      function getOwnPropertySymbols(o) {
        return $getOwnPropertyNames(o).filter(symbolForKey).map(symbolForKey);
      }, !nativeSymbols);

    // 19.1.2.14 Object.keys ( O )
    define(
      Object, 'keys',
      function keys(o) {
        return $keys(o).filter(isStringKey);
      }, !nativeSymbols);
  }());

  // 19.1.2.9 Object.getPrototypeOf ( O )
  // 19.1.2.10 Object.is ( value1, value2 )
  define(
    Object, 'is',
    function is(value1, value2) {
      return SameValue(value1, value2);
    });

  // 19.1.2.11 Object.isExtensible ( O )
  // 19.1.2.12 Object.isFrozen ( O )
  // 19.1.2.13 Object.isSealed ( O )

  // 19.1.2.14 Object.keys ( O )
  // see above

  // 19.1.2.15 Object.preventExtensions ( O )
  // 19.1.2.16 Object.prototype
  // 19.1.2.17 Object.seal ( O )

  // 19.1.2.18 Object.setPrototypeOf ( O, proto )
  define(
    Object, 'setPrototypeOf',
    function setPrototypeOf(o, proto) {
      if (Type(o) !== 'object') throw TypeError();
      if (Type(proto) !== 'object' && Type(proto) !== 'null') throw TypeError();
      o.__proto__ = proto;
      return o;
    }
  );

  // 19.1.3 Properties of the Object Prototype Object
  // 19.1.3.1 Object.prototype.constructor
  // 19.1.3.2 Object.prototype.hasOwnProperty ( V )
  // 19.1.3.3 Object.prototype.isPrototypeOf ( V )
  // 19.1.3.4 Object.prototype.propertyIsEnumerable ( V )
  // 19.1.3.5 Object.prototype.toLocaleString ( [ reserved1 [ , reserved2 ] ] )
  // 19.1.3.6 Object.prototype.toString ( )
  var o_p_ts = Object.prototype.toString;
  define(Object.prototype, 'toString',
       function() {
         var o = strict(this);
         if (o === Object(o) && $$toStringTag in o) {
           return '[object ' + o[$$toStringTag] + ']';
         }
         return o_p_ts.apply(o, arguments);
       });

  // 19.1.3.7 Object.prototype.valueOf ( )
  // 19.1.4 Properties of Object Instances

  // ---------------------------------------
  // 19.2 Function Objects
  // ---------------------------------------

  // 19.2.1 The Function Constructor
  // 19.2.1.1 Function ( p1, p2,  , pn, body )
  // 19.2.2 Properties of the Function Constructor
  // 19.2.2.1 Function.length
  // 19.2.2.2 Function.prototype
  // 19.2.3 Properties of the Function Prototype Object
  // 19.2.3.1 Function.prototype.apply ( thisArg, argArray )
  // 19.2.3.2 Function.prototype.bind ( thisArg , ...args)
  // 19.2.3.3 Function.prototype.call (thisArg , ...args)
  // 19.2.3.4 Function.prototype.constructor
  // 19.2.3.5 Function.prototype.toString ( )
  // 19.2.3.6 Function.prototype[@@hasInstance] ( V )
  // 19.2.4 Function Instances
  // 19.2.4.1 length
  // 19.2.4.2 name
  // 19.2.4.3 prototype

  // (No polyfillable changes from ES5)

  // ---------------------------------------
  // 19.3 Boolean Objects
  // ---------------------------------------

  // 19.3.1 The Boolean Constructor
  // 19.3.1.1 Boolean ( value )
  // 19.3.2 Properties of the Boolean Constructor
  // 19.3.2.1 Boolean.prototype
  // 19.3.3 Properties of the Boolean Prototype Object
  // 19.3.3.1 Boolean.prototype.constructor
  // 19.3.3.2 Boolean.prototype.toString ( )
  // 19.3.3.3 Boolean.prototype.valueOf ( )
  // 19.3.4 Properties of Boolean Instances

  // (No polyfillable changes from ES5)

  // ---------------------------------------
  // 19.4 Symbol Objects
  // ---------------------------------------

  // Moved earlier in this script, so that other polyfills can depend on them.

  // 19.4.3.4 Symbol.prototype [ @@toStringTag ]
  define(global.Symbol.prototype, global.Symbol.toStringTag, 'Symbol');

  // ---------------------------------------
  // 19.5 Error Objects
  // ---------------------------------------

  // 19.5.1 The Error Constructor
  // 19.5.1.1 Error ( message )
  // 19.5.1.2 new Error( ...argumentsList )
  // 19.5.2 Properties of the Error Constructor
  // 19.5.2.1 Error.prototype
  // 19.5.3 Properties of the Error Prototype Object
  // 19.5.3.1 Error.prototype.constructor
  // 19.5.3.2 Error.prototype.message
  // 19.5.3.3 Error.prototype.name
  // 19.5.3.4 Error.prototype.toString ( )
  // 19.5.4 Properties of Error Instances
  // 19.5.5 Native Error Types Used in This Standard
  // 19.5.5.1 EvalError
  // 19.5.5.2 RangeError
  // 19.5.5.3 ReferenceError
  // 19.5.5.4 SyntaxError
  // 19.5.5.5 TypeError
  // 19.5.5.6 URIError
  // 19.5.6 NativeError Object Structure
  // 19.5.6.1 NativeError Constructors
  // 19.5.6.1.1 NativeError ( message )
  // 19.5.6.1.2 new NativeError ( ...argumentsList )
  // 19.5.6.2 Properties of the NativeError Constructors
  // 19.5.6.2.1 NativeError.prototype
  // 19.5.6.3 Properties of the NativeError Prototype Objects
  // 19.5.6.4 Properties of NativeError Instances

  // (No polyfillable changes from ES5)

  // ---------------------------------------
  // 20 Numbers and Dates
  // ---------------------------------------

  // ---------------------------------------
  // 20.1 Number Objects
  // ---------------------------------------

  // 20.1.1 The Number Constructor
  // 20.1.1.1 Number ( [ value ] )
  // 20.1.1.2 new Number ( ...argumentsList )
  // 20.1.2 Properties of the Number Constructor

  // 20.1.2.1 Number.EPSILON
  define(
    Number, 'EPSILON',
    (function () {
      var next, result;
      for (next = 1; 1 + next !== 1; next = next / 2)
        result = next;
      return result;
    }()));

  // 20.1.2.2 Number.isFinite ( number )
  define(
    Number, 'isFinite',
    function isFinite(number) {
      if (Type(number) !== 'number') return false;
      if (number !== number || number === +Infinity || number === -Infinity) return false;
      return true;
    });

  // 20.1.2.3 Number.isInteger ( number )
  define(
    Number, 'isInteger',
    function isInteger(number) {
      if (Type(number) !== 'number') return false;
      if (number !== number || number === +Infinity || number === -Infinity) return false;
      var integer = ToInteger(number);
      if (integer !== number) return false;
      return true;
    });

  // 20.1.2.4 Number.isNaN ( number )
  define(
    Number, 'isNaN',
    function isNaN(number) {
      if (Type(number) !== 'number') return false;
      if (number !== number) return true;
      return false;
    });

  // 20.1.2.5 Number.isSafeInteger ( number )
  define(
    Number, 'isSafeInteger',
    function isSafeInteger(number) {
      if (Type(number) !== 'number') return false;
      if (number !== number || number === +Infinity || number === -Infinity) return false;
      var integer = ToInteger(number);
      if (integer !== number) return false;
      if (abs(integer) <= (0x20000000000000 - 1)) // 2^53-1
        return true;
      return false;
    });

  // 20.1.2.6 Number.MAX_SAFE_INTEGER
  define(
    Number, 'MAX_SAFE_INTEGER',
    9007199254740991); // 2^53-1

  // 20.1.2.7 Number.MAX_VALUE

  // 20.1.2.8 Number.MIN_SAFE_INTEGER
  define(
    Number, 'MIN_SAFE_INTEGER',
    -9007199254740991); // -2^53+1

  // 20.1.2.9 Number.MIN_VALUE
  // 20.1.2.10 Number.NaN
  // 20.1.2.11 Number.NEGATIVE_INFINITY

  // 20.1.2.12 Number.parseFloat ( string )
  define(Number, 'parseFloat', $parseFloat);

  // 20.1.2.13 Number.parseInt ( string, radix )
  define(Number, 'parseInt', $parseInt);

  // 20.1.2.14 Number.POSITIVE_INFINITY
  // 20.1.2.15 Number.prototype

  // 20.1.3 Properties of the Number Prototype Object
  // 20.1.3.1 Number.prototype.constructor
  // 20.1.3.2 Number.prototype.toExponential ( fractionDigits )
  // 20.1.3.3 Number.prototype.toFixed ( fractionDigits )
  // 20.1.3.4 Number.prototype.toLocaleString( [ reserved1 [ , reserved2 ] ])
  // 20.1.3.5 Number.prototype.toPrecision ( precision )
  // 20.1.3.6 Number.prototype.toString ( [ radix ] )
  // 20.1.3.7 Number.prototype.valueOf ( )
  // 20.1.4 Properties of Number Instances

  // ---------------------------------------
  // 20.2 The Math Object
  // ---------------------------------------

  // 20.2.1 Value Properties of the Math Object
  // 20.2.1.1 Math.E
  // 20.2.1.2 Math.LN10
  // 20.2.1.3 Math.LN2
  // 20.2.1.4 Math.LOG10E
  // 20.2.1.5 Math.LOG2E
  // 20.2.1.6 Math.PI
  // 20.2.1.7 Math.SQRT1_2
  // 20.2.1.8 Math.SQRT2

  // 20.2.1.9 Math [ @@toStringTag ]
  define(Math, $$toStringTag, 'Math');

  // 20.2.2 Function Properties of the Math Object
  // 20.2.2.1 Math.abs ( x )
  // 20.2.2.2 Math.acos ( x )

  // 20.2.2.3 Math.acosh(x)
  define(
    Math, 'acosh',
    function acosh(x) {
      x = Number(x);
      return log(x + sqrt(x * x - 1));
    });

  // 20.2.2.4 Math.asin ( x )

  // 20.2.2.5 Math.asinh( x )
  define(
    Math, 'asinh',
    function asinh(x) {
      x = Number(x);
      if (SameValue(x, -0)) {
        return x;
      }
      var s = sqrt(x * x + 1);
      return (s === -x) ? log(0) : log(x + s);
    });

  // 20.2.2.6 Math.atan ( x )

  // 20.2.2.7 Math.atanh( x )
  define(
    Math, 'atanh',
    function atanh(x) {
      x = Number(x);
      return (x === 0) ? x : log((1 + x) / (1 - x)) / 2;
    });

  // 20.2.2.8 Math.atan2 ( y, x )

  // 20.2.2.9 Math.cbrt ( x )
  define(
    Math, 'cbrt',
    function cbrt(x) {
      x = Number(x);
      if ($isNaN(x/x)) {
        return x;
      }
      var r = pow(abs(x), 1/3);
      var t = x/r/r;
      return r + (r * (t-r) / (2*r + t));
    });

  // 20.2.2.10 Math.ceil ( x )

  // 20.2.2.11 Math.clz32 ( x )
  define(
    Math, 'clz32',
    function clz32(x) {
      function clz8(x) {
        return (x & 0xf0) ? (x & 0x80 ? 0 : x & 0x40 ? 1 : x & 0x20 ? 2 : 3) :
        (x & 0x08 ? 4 : x & 0x04 ? 5 : x & 0x02 ? 6 : x & 0x01 ? 7 : 8);
      }
      x = ToUint32(x);
      return x & 0xff000000 ? clz8(x >> 24) :
        x & 0xff0000 ? clz8(x >> 16) + 8 :
        x & 0xff00 ? clz8(x >> 8) + 16 : clz8(x) + 24;
    });



  // 20.2.2.12 Math.cos ( x )

  // 20.2.2.13 Math.cosh ( x )
  define(
    Math, 'cosh',
    function cosh(x) {
      x = Number(x);
      return (pow(E, x) + pow(E, -x)) / 2;
    });

  // 20.2.2.14 Math.exp ( x )

  // 20.2.2.15 Math.expm1 ( x )
  define(
    Math, 'expm1',
    function expm1(x) {
      x = Number(x);
      // from: http://www.johndcook.com/cpp_log1p.html
      if (SameValue(x, -0)) {
        return -0;
      } else if (abs(x) < 1e-5) {
        return x + 0.5 * x * x; // two terms of Taylor expansion
      } else {
        return exp(x) - 1;
      }
    });

  // 20.2.2.16 Math.floor ( x )

  // 20.2.2.17 Math.fround ( x )
  define(
    Math, 'fround',
    function fround(x) {
      if ($isNaN(x)) {
        return NaN;
      }
      if (1/x === +Infinity || 1/x === -Infinity || x === +Infinity || x === -Infinity) {
        return x;
      }
      return (new Float32Array([x]))[0];
    });

  // 20.2.2.18 Math.hypot ( value1 [, value2 [ ... ] ] )
  define(
    Math, 'hypot',
    function hypot() {
      var values = [];
      var m = 0, sawNaN = false;
      for (var i = 0; i < arguments.length; ++i) {
        var n = abs(Number(arguments[i]));
        if (n === Infinity) return n;
        if (n !== n) sawNaN = true;
        if (n > m) m = n;
        values[i] = n;
      }
      if (sawNaN) return NaN;
      if (m === 0) return +0;
      var sum = +0;
      for (i = 0; i < values.length; ++i) {
        var r = values[i] / m;
        sum = sum + r * r;
      }
      return m * sqrt(sum);
    });

  // 20.2.2.19 Math.imul ( x, y )
  define(
    Math, 'imul',
    function imul(x, y) {
      var a = ToUint32(x);
      var b = ToUint32(y);
      // (slow but accurate)
      var ah  = (a >>> 16) & 0xffff;
      var al = a & 0xffff;
      var bh  = (b >>> 16) & 0xffff;
      var bl = b & 0xffff;
      return ((al * bl) + (((ah * bl + al * bh) << 16) >>> 0)|0);
    }, ('imul' in Math && Math.imul(1, 0x80000000) === 0) // Safari 7 bug
  );

  // 20.2.2.20 Math.log ( x )

  // 20.2.2.21 Math.log1p ( x )
  define(
    Math, 'log1p',
    function log1p(x) {
      x = Number(x);
      // from: http://www.johndcook.com/cpp_expm1.html
      if (x < -1) {
        return NaN;
      } else if (SameValue(x, -0)) {
        return -0;
      } else if (abs(x) > 1e-4) {
        return log(1 + x);
      } else {
        return (-0.5 * x + 1) * x;
      }
    });

  // 20.2.2.22 Math.log10 ( x )
  define(
    Math, 'log10',
    function log10(x) {
      x = Number(x);
      return log(x) * LOG10E;
    });

  // 20.2.2.23 Math.log2 ( x )
  define(
    Math, 'log2',
    function log2(x) {
      x = Number(x);
      return log(x) * LOG2E;
    });

  // 20.2.2.24 Math.max ( value1, value2 , ...values )
  // 20.2.2.25 Math.min ( value1, value2 , ...values )
  // 20.2.2.26 Math.pow ( x, y )
  // 20.2.2.27 Math.random ( )
  // 20.2.2.28 Math.round ( x )

  // 20.2.2.29 Math.sign(x)
  define(
    Math, 'sign',
    function sign(x) {
      x = Number(x);
      return x < 0 ? -1 : x > 0 ? 1 : x;
    });

  // 20.2.2.30 Math.sin ( x )

  // 20.2.2.31 Math.sinh( x )
  define(
    Math, 'sinh',
    function sinh(x) {
      x = Number(x);
      return SameValue(x, -0) ? x : (pow(E, x) - pow(E, -x)) / 2;
    });

  // 20.2.2.32 Math.sqrt ( x )
  // 20.2.2.33 Math.tan ( x )

  // 20.2.2.34 Math.tanh ( x )
  define(
    Math, 'tanh',
    function tanh(x) {
      x = Number(x);
      var n = pow(E, 2 * x) - 1,
          d = pow(E, 2 * x) + 1;
      if (SameValue(x, -0))
        return x;
      return (n === d) ? 1 : n / d; // Handle Infinity/Infinity
    });

  // 20.2.2.35 Math.trunc ( x )
  define(
    Math, 'trunc',
    function trunc(x) {
      x = Number(x);
      return $isNaN(x) ? NaN :
        x < 0 ? ceil(x) : floor(x);
    });

  // ---------------------------------------
  // 20.3 Date Objects
  // ---------------------------------------

  // 20.3.1 Overview of Date Objects and Definitions of Abstract Operations
  // 20.3.1.1 Time Values and Time Range
  // 20.3.1.2 Day Number and Time within Day
  // 20.3.1.3 Year Number
  // 20.3.1.4 Month Number
  // 20.3.1.5 Date Number
  // 20.3.1.6 Week Day
  // 20.3.1.7 Local Time Zone Adjustment
  // 20.3.1.8 Daylight Saving Time Adjustment
  // 20.3.1.9 Local Time
  // 20.3.1.10 Hours, Minutes, Second, and Milliseconds
  // 20.3.1.11 MakeTime (hour, min, sec, ms)
  // 20.3.1.12 MakeDay (year, month, date)
  // 20.3.1.13 MakeDate (day, time)
  // 20.3.1.14 TimeClip (time)
  // 20.3.1.15 Date Time String Format
  // 20.3.1.15.1 Extended years
  // 20.3.2 The Date Constructor
  // 20.3.2.1 Date ( year, month [, date [ , hours [ , minutes [ , seconds [ , ms ] ] ] ] ] )
  // 20.3.2.2 Date ( value )
  // 20.3.2.3 Date ( )
  // 20.3.3 Properties of the Date Constructor
  // 20.3.3.1 Date.now ( )
  // 20.3.3.2 Date.parse (string)
  // 20.3.3.3 Date.prototype
  // 20.3.3.4 Date.UTC ( year, month [ , date [ , hours [ , minutes [ , seconds [ , ms ] ] ] ] ] )
  // 20.3.4 Properties of the Date Prototype Object
  // 20.3.4.1 Date.prototype.constructor
  // 20.3.4.2 Date.prototype.getDate ( )
  // 20.3.4.3 Date.prototype.getDay ( )
  // 20.3.4.4 Date.prototype.getFullYear ( )
  // 20.3.4.5 Date.prototype.getHours ( )
  // 20.3.4.6 Date.prototype.getMilliseconds ( )
  // 20.3.4.7 Date.prototype.getMinutes ( )
  // 20.3.4.8 Date.prototype.getMonth ( )
  // 20.3.4.9 Date.prototype.getSeconds ( )
  // 20.3.4.10 Date.prototype.getTime ( )
  // 20.3.4.11 Date.prototype.getTimezoneOffset ( )
  // 20.3.4.12 Date.prototype.getUTCDate ( )
  // 20.3.4.13 Date.prototype.getUTCDay ( )
  // 20.3.4.14 Date.prototype.getUTCFullYear ( )
  // 20.3.4.15 Date.prototype.getUTCHours ( )
  // 20.3.4.16 Date.prototype.getUTCMilliseconds ( )
  // 20.3.4.17 Date.prototype.getUTCMinutes ( )
  // 20.3.4.18 Date.prototype.getUTCMonth ( )
  // 20.3.4.19 Date.prototype.getUTCSeconds ( )
  // 20.3.4.20 Date.prototype.setDate ( date )
  // 20.3.4.21 Date.prototype.setFullYear ( year [ , month [ , date ] ] )
  // 20.3.4.22 Date.prototype.setHours ( hour [ , min [ , sec [ , ms ] ] ] )
  // 20.3.4.23 Date.prototype.setMilliseconds ( ms )
  // 20.3.4.24 Date.prototype.setMinutes ( min [ , sec [ , ms ] ] )
  // 20.3.4.25 Date.prototype.setMonth ( month [ , date ] )
  // 20.3.4.26 Date.prototype.setSeconds ( sec [ , ms ] )
  // 20.3.4.27 Date.prototype.setTime ( time )
  // 20.3.4.28 Date.prototype.setUTCDate ( date )
  // 20.3.4.29 Date.prototype.setUTCFullYear ( year [ , month [ , date ] ] )
  // 20.3.4.30 Date.prototype.setUTCHours ( hour [ , min [ , sec [ , ms ] ] ] )
  // 20.3.4.31 Date.prototype.setUTCMilliseconds ( ms )
  // 20.3.4.32 Date.prototype.setUTCMinutes ( min [ , sec [, ms ] ] )
  // 20.3.4.33 Date.prototype.setUTCMonth ( month [ , date ] )
  // 20.3.4.34 Date.prototype.setUTCSeconds ( sec [ , ms ] )
  // 20.3.4.35 Date.prototype.toDateString ( )
  // 20.3.4.36 Date.prototype.toISOString ( )
  // 20.3.4.37 Date.prototype.toJSON ( key )
  // 20.3.4.38 Date.prototype.toLocaleDateString ( [ reserved1 [ , reserved2 ] ] )
  // 20.3.4.39 Date.prototype.toLocaleString ( [ reserved1 [ , reserved2 ] ] )
  // 20.3.4.40 Date.prototype.toLocaleTimeString ( [ reserved1 [ , reserved2 ] ] )
  // 20.3.4.41 Date.prototype.toString ( )
  // 20.3.4.42 Date.prototype.toTimeString ( )
  // 20.3.4.43 Date.prototype.toUTCString ( )
  // 20.3.4.44 Date.prototype.valueOf ( )
  // 20.3.4.45 Date.prototype [ @@toPrimitive ] ( hint )
  // 20.3.5 Properties of Date Instances

  // (No polyfillable changes from ES5)

  // ---------------------------------------
  // 21 Text Processing
  // ---------------------------------------

  var string_regexp_dispatch = (function() {
    var faux = {}, secret = Symbol();
    faux[Symbol.match] = function() { return secret; };
    return ("").match(faux) === secret;
  }());

  // 21.1 String Objects
  // 21.1.1 The String Constructor
  // 21.1.1.1 String ( value )
  // 21.1.2 Properties of the String Constructor
  // 21.1.2.1 String.fromCharCode ( ...codeUnits )

  // 21.1.2.2 String.fromCodePoint ( ...codePoints )
  define(
    String, 'fromCodePoint',
    function fromCodePoint(/*...codePoints*/) {
      var codePoints = arguments,
          length = codePoints.length,
          elements = [],
          nextIndex = 0;
      while (nextIndex < length) {
        var next = codePoints[nextIndex];
        var nextCP = Number(next);
        if (!SameValue(nextCP, ToInteger(nextCP)) ||
            nextCP < 0 || nextCP > 0x10FFFF) {
          throw RangeError('Invalid code point ' + nextCP);
        }
        if (nextCP < 0x10000) {
          elements.push(String.fromCharCode(nextCP));
        } else {
          nextCP -= 0x10000;
          elements.push(String.fromCharCode((nextCP >> 10) + 0xD800));
          elements.push(String.fromCharCode((nextCP % 0x400) + 0xDC00));
        }
        nextIndex += 1;
      }
      return elements.join('');
    });

  // 21.1.2.3 String.prototype

  // 21.1.2.4 String.raw ( template , ...substitutions )
  define(
    String, 'raw',
    function raw(template /*, ...substitutions*/) {
      var substitutions = [].slice.call(arguments, 1);

      var cooked = Object(template);
      var rawValue = cooked['raw'];
      var raw = Object(rawValue);
      var len = raw['length'];
      var literalSegments = ToLength(len);
      if (literalSegments <= 0) return '';
      var stringElements = [];
      var nextIndex = 0;
      while (true) {
        var next = raw[nextIndex];
        var nextSeg = String(next);
        stringElements.push(nextSeg);
        if (nextIndex + 1 === literalSegments)
          return stringElements.join('');
        next = substitutions[nextIndex];
        var nextSub = String(next);
        stringElements.push(nextSub);
        nextIndex = nextIndex + 1;
      }
    });

  // See https://githib.com/inexorabletash/uate for a more useful version.

  // 21.1.3 Properties of the String Prototype Object
  // 21.1.3.1 String.prototype.charAt ( pos )
  // 21.1.3.2 String.prototype.charCodeAt ( pos )

  // 21.1.3.3 String.prototype.codePointAt ( pos )
  define(
    String.prototype, 'codePointAt',
    function codePointAt(pos) {
      var o = strict(this);
      var s = String(o);
      var position = ToInteger(pos);
      var size = s.length;
      if (position < 0 || position >= size) return undefined;
      var first = s.charCodeAt(position);
      if (first < 0xD800 || first > 0xDBFF || position + 1 === size) return first;
      var second = s.charCodeAt(position + 1);
      if (second < 0xDC00 || second > 0xDFFF) return first;
      return ((first - 0xD800) * 1024) + (second - 0xDC00) + 0x10000;
    });

  // 21.1.3.4 String.prototype.concat ( ...args )
  // 21.1.3.5 String.prototype.constructor

  // 21.1.3.6 String.prototype.endsWith ( searchString [ , endPosition] )
  define(
    String.prototype, 'endsWith',
    function endsWith(searchString) {
      var endPosition = arguments[1];

      var o = strict(this);
      var s = String(o);
      var searchStr = String(searchString);
      var len = s.length;
      var pos = (endPosition === undefined) ? len : ToInteger(endPosition);
      var end = min(max(pos, 0), len);
      var searchLength = searchStr.length;
      var start = end - searchLength;
      if (start < 0) return false;
      if (s.substring(start, start + searchLength) === searchStr) return true;
      return false;
    });

  // 21.1.3.7 String.prototype.includes ( searchString [ , position ] )
  define(
    String.prototype, 'includes',
    function includes(searchString) {
      var position = arguments[1];

      var o = strict(this);
      var s = String(o);
      var searchStr = String(searchString);
      var pos = ToInteger(position);
      var len = s.length;
      var start = min(max(pos, 0), len);
      return s.indexOf(searchStr, start) !== -1;
    });

  // 21.1.3.8 String.prototype.indexOf ( searchString [ , position ] )
  // 21.1.3.9 String.prototype.lastIndexOf ( searchString [ , position ] )
  // 21.1.3.10 String.prototype.localeCompare ( that [, reserved1 [ , reserved2 ] ] )
  // 21.1.3.11 String.prototype.match ( regexp )
  define(
    String.prototype, 'match',
    function match(regexp) {
      var o = strict(this);
      var s = String(o);
      if (HasProperty(regexp, $$match)) var rx = regexp;
      else rx = new RegExp(regexp);
      return rx[$$match](s);
    }, !string_regexp_dispatch);

  // 21.1.3.12 String.prototype.normalize ( [ form ] )

  // Not practical due to table sizes; if needed, pull in:
  // https://github.com/walling/unorm/

  // 21.1.3.13 String.prototype.repeat ( count )
  define(
    String.prototype, 'repeat',
    function repeat(count) {
      var o = strict(this);
      var s = String(o);
      var n = ToInteger(count);
      if (n < 0) throw RangeError();
      if (n === Infinity) throw RangeError();
      var t = new Array(n + 1).join(s);
      return t;
    });

  // 21.1.3.14 String.prototype.replace (searchValue, replaceValue )
  define(
    String.prototype, 'replace',
    function replace(searchValue, replaceValue) {
      var o = strict(this);
      if (HasProperty(searchValue, $$replace))
        return searchValue[$$replace](o, replaceValue);
      return orig_replace.call(o, searchValue, replaceValue);
    }, !string_regexp_dispatch);

  // 21.1.3.15 String.prototype.search ( regexp )
  define(
    String.prototype, 'search',
    function search(regexp) {
      var o = strict(this);
      var string = String(o);
      if (HasProperty(regexp, $$search)) var rx = regexp;
      else rx = new RegExp(regexp);
      return rx[$$search](string);
    }, !string_regexp_dispatch);

  // 21.1.3.16 String.prototype.slice ( start, end )
  // 21.1.3.17 String.prototype.split ( separator, limit )
  define(
    String.prototype, 'split',
    function split(separator, limit) {
      var o = strict(this);
      if (HasProperty(separator, $$split))
        return separator[$$split](o, limit);
      return orig_split.call(o, separator, limit);
    }, !string_regexp_dispatch);

  // 21.1.3.18 String.prototype.startsWith ( searchString [, position ] )
  define(
    String.prototype, 'startsWith',
    function startsWith(searchString) {
      var position = arguments[1];

      var o = strict(this);
      var s = String(o);
      var searchStr = String(searchString);
      var pos = ToInteger(position);
      var len = s.length;
      var start = min(max(pos, 0), len);
      var searchLength = searchStr.length;
      if (searchLength + start > len) return false;
      if (s.substring(start, start + searchLength) === searchStr) return true;
      return false;
    });

  // 21.1.3.19 String.prototype.substring ( start, end )
  // 21.1.3.20 String.prototype.toLocaleLowerCase ( [ reserved1 [ , reserved2 ] ] )
  // 21.1.3.21 String.prototype.toLocaleUpperCase ([ reserved1 [ , reserved2 ] ] )
  // 21.1.3.22 String.prototype.toLowerCase ( )
  // 21.1.3.23 String.prototype.toString ( )
  // 21.1.3.24 String.prototype.toUpperCase ( )
  // 21.1.3.25 String.prototype.trim ( )
  // 21.1.3.26 String.prototype.valueOf ( )

  // 21.1.3.27 String.prototype [ @@iterator ]( )
  define(
    String.prototype, $$iterator,
    function entries() {
      return CreateStringIterator(this, 'value');
    });

  // 21.1.4 Properties of String Instances
  // 21.1.4.1 length

  // 21.1.5 String Iterator Objects
  /** @constructor */
  function StringIterator() {}

  // 21.1.5.1 CreateStringIterator Abstract Operation
  function CreateStringIterator(string, kind) {
    var s = String(string);
    var iterator = new StringIterator;
    set_internal(iterator, '[[IteratedString]]', s);
    set_internal(iterator, '[[StringIteratorNextIndex]]', 0);
    set_internal(iterator, '[[StringIterationKind]]', kind);
    return iterator;
  }

  // 21.1.5.2 The %StringIteratorPrototype% Object
  var $StringIteratorPrototype$ = Object.create($IteratorPrototype$);
  StringIterator.prototype = $StringIteratorPrototype$;

  // 21.1.5.2.1 %StringIteratorPrototype%.next ( )
  define(
    $StringIteratorPrototype$, 'next',
    function next() {
      var o = ToObject(this);
      var s = String(o['[[IteratedString]]']),
          index = o['[[StringIteratorNextIndex]]'],
          len = s.length;
      if (index >= len) {
        set_internal(o, '[[StringIteratorNextIndex]]', Infinity);
        return CreateIterResultObject(undefined, true);
      }
      var cp = s.codePointAt(index);
      set_internal(o, '[[StringIteratorNextIndex]]', index + (cp > 0xFFFF ? 2 : 1));
      return CreateIterResultObject(String.fromCodePoint(cp), false);
    });

  // 21.1.5.2.2 %StringIteratorPrototype% [ @@toStringTag ]
  define($StringIteratorPrototype$, $$toStringTag, 'String Iterator');

  // 21.1.5.3 Properties of String Iterator Instances

  // ---------------------------------------
  // 21.2 RegExp (Regular Expression) Objects
  // ---------------------------------------

  // 21.2.1 Patterns
  // 21.2.2 Pattern Semantics
  // 21.2.2.1 Notation
  // 21.2.2.2 Pattern
  // 21.2.2.3 Disjunction
  // 21.2.2.4 Alternative
  // 21.2.2.5 Term
  // 21.2.2.6 Assertion
  // 21.2.2.7 Quantifier
  // 21.2.2.8 Atom
  // 21.2.2.9 AtomEscape
  // 21.2.2.10 CharacterEscape
  // 21.2.2.11 DecimalEscape
  // 21.2.2.12 CharacterClassEscape
  // 21.2.2.13 CharacterClass
  // 21.2.2.14 ClassRanges
  // 21.2.2.15 NonemptyClassRanges
  // 21.2.2.16 NonemptyClassRangesNoDash
  // 21.2.2.17 ClassAtom
  // 21.2.2.18 ClassAtomNoDash
  // 21.2.2.19 ClassEscape
  // 21.2.3 The RegExp Constructor
  // 21.2.3.1 RegExp ( pattern, flags )
  // 21.2.3.2 new RegExp( ...argumentsList )
  // 21.2.3.3 Abstract Operations for the RegExp Constructor
  // 21.2.4 Properties of the RegExp Constructor
  // 21.2.4.1 RegExp.prototype
  // 21.2.5 Properties of the RegExp Prototype Object
  // 21.2.5.1 RegExp.prototype.constructor
  // 21.2.5.2 RegExp.prototype.exec ( string )

  // 21.2.5.3 get RegExp.prototype.flags
  if (!('flags' in RegExp.prototype)) {
    Object.defineProperty(
      RegExp.prototype, 'flags', {
        get: function() {
          var s = String(this);
          return s.substring(s.lastIndexOf('/') + 1);
        }
      });
  }

  // 21.2.5.4 get RegExp.prototype.global
  // 21.2.5.5 get RegExp.prototype.ignoreCase

  // 21.2.5.6 RegExp.prototype [ @@match ] ( string )
  define(RegExp.prototype, $$match, function(string) {
    var o = strict(this);
    return orig_match.call(string, o);
  });

  // 21.2.5.7 get RegExp.prototype.multiline

  // 21.2.5.8 RegExp.prototype [ @@replace ] ( string, replaceValue )
  define(RegExp.prototype, $$replace, function(string, replaceValue) {
    var o = strict(this);
    return orig_replace.call(string, o, replaceValue);
  });

  // 21.2.5.9 RegExp.prototype [ @@search ] ( string )
  define(RegExp.prototype, $$search, function(string) {
    var o = strict(this);
    return orig_search.call(string, o);
  });

  // 21.2.5.10 get RegExp.prototype.source

  // 21.2.5.11 RegExp.prototype [ @@split ] ( string, limit )
  define(RegExp.prototype, $$split, function(string, limit) {
    var o = strict(this);
    return orig_split.call(string, o, limit);
  });

  // 21.2.5.12 get RegExp.prototype.sticky
  // 21.2.5.13 RegExp.prototype.test( S )
  // 21.2.5.14 RegExp.prototype.toString ( )
  // 21.2.5.15 get RegExp.prototype.unicode

  // 21.2.6 Properties of RegExp Instances
  // 21.2.6.1 lastIndex

  // (No polyfillable changes from ES5)

  // ---------------------------------------
  // 22 Indexed Collections
  // ---------------------------------------

  // ---------------------------------------
  // 22.1 Array Objects
  // ---------------------------------------

  // 22.1.1 The Array Constructor
  // 22.1.1.1 Array ( )
  // 22.1.1.2 Array (len)
  // 22.1.1.3 Array (...items )

  // 22.1.2 Properties of the Array Constructor

  // 22.1.2.1 Array.from ( items [ , mapfn [ , thisArg ] ] )
  define(
    Array, 'from',
    function from(items) {
      var mapfn = arguments[1];
      var thisArg = arguments[2];

      var c = strict(this);
      if (mapfn === undefined) {
        var mapping = false;
      } else {
        if (!IsCallable(mapfn)) throw TypeError();
        var t = thisArg;
        mapping = true;
      }
      var usingIterator = GetMethod(items, $$iterator);
      if (usingIterator !== undefined) {
         if (IsConstructor(c)) {
          var a = new c();
        } else {
          a = new Array(0);
        }
        var iterator = GetIterator(items, usingIterator);
        var k = 0;
        while (true) {
          var next = IteratorStep(iterator);
          if (next === false) {
            a.length = k;
            return a;
          }
          var nextValue = IteratorValue(next);
          if (mapping)
            var mappedValue = mapfn.call(t, nextValue);
          else
            mappedValue = nextValue;
          a[k] = mappedValue;
          k += 1;
        }
      }
      var arrayLike = ToObject(items);
      var lenValue = arrayLike.length;
      var len = ToLength(lenValue);
      if (IsConstructor(c)) {
        a = new c(len);
      } else {
        a = new Array(len);
      }
      k = 0;
      while (k < len) {
        var kValue = arrayLike[k];
        if (mapping)
          mappedValue = mapfn.call(t, kValue, k);
        else
          mappedValue = kValue;
        a[k] = mappedValue;
        k += 1;
      }
      a.length = len;
      return a;
    });

  // 22.1.2.2 Array.isArray ( arg )

  // 22.1.2.3 Array.of ( ...items )
  define(
    Array, 'of',
    function of() {
      var items = arguments;

      var lenValue = items.length;
      var len = ToUint32(lenValue);
      var c = strict(this), a;
      if (IsConstructor(c)) {
        a = new c(len);
        a = ToObject(a);
      } else {
        a = new Array(len);
      }
      var k = 0;
      while (k < len) {
        a[k] = items[k];
        k += 1;
      }
      a.length = len;
      return a;
    });

  // 22.1.2.4 Array.prototype
  // 22.1.2.5 get Array [ @@species ]
  // 22.1.3 Properties of the Array Prototype Object
  // 22.1.3.1 Array.prototype.concat ( ...arguments )
  // 22.1.3.1.1 Runtime Semantics: IsConcatSpreadable ( O )
  // 22.1.3.2 Array.prototype.constructor
  // 22.1.3.3 Array.prototype.copyWithin (target, start [ , end ] )
  define(
    Array.prototype, 'copyWithin',
    function copyWithin(target, start/*, end*/) {
      var end = arguments[2];

      var o = ToObject(this);
      var lenVal = o.length;
      var len = ToLength(lenVal);
      len = max(len, 0);
      var relativeTarget = ToInteger(target);
      var to;
      if (relativeTarget < 0)
        to = max(len + relativeTarget, 0);
      else
        to = min(relativeTarget, len);
      var relativeStart = ToInteger(start);
      var from;
      if (relativeStart < 0)
        from = max(len + relativeStart, 0);
      else
        from = min(relativeStart, len);
      var relativeEnd;
      if (end === undefined)
        relativeEnd = len;
      else
        relativeEnd = ToInteger(end);
      var final;
      if (relativeEnd < 0)
        final = max(len + relativeEnd, 0);
      else
        final = min(relativeEnd, len);
      var count = min(final - from, len - to);
      var direction;
      if (from < to && to < from + count) {
        direction = -1;
        from = from + count - 1;
        to = to + count - 1;
      } else {
        direction = 1;
      }
      while (count > 0) {
        var fromKey = String(from);
        var toKey = String(to);
        var fromPresent = HasProperty(o, fromKey);
        if (fromPresent) {
          var fromVal = o[fromKey];
          o[toKey] = fromVal;
        } else {
          delete o[toKey];
        }
        from = from + direction;
        to = to + direction;
        count = count - 1;
      }
      return o;
    });

  // 22.1.3.4 Array.prototype.entries ( )
  var nativeArrayIteratorMethods =
        ('entries' in Array.prototype && 'next' in [].entries());

  define(
    Array.prototype, 'entries',
    function entries() {
      return CreateArrayIterator(this, 'key+value');
    }, !nativeArrayIteratorMethods);

  // 22.1.3.5 Array.prototype.every ( callbackfn [ , thisArg] )

  // 22.1.3.6 Array.prototype.fill (value [ , start [ , end ] ] )
  define(
    Array.prototype, 'fill',
    function fill(value/*, start, end*/) {
      var start = arguments[1],
          end = arguments[2];

      var o = ToObject(this);
      var lenVal = o.length;
      var len = ToLength(lenVal);
      len = max(len, 0);
      var relativeStart = ToInteger(start);
      var k;
      if (relativeStart < 0)
        k = max((len + relativeStart), 0);
      else
        k = min(relativeStart, len);
      var relativeEnd;
      if (end === undefined)
        relativeEnd = len;
      else
        relativeEnd = ToInteger(end);
      var final;
      if (relativeEnd < 0)
        final = max((len + relativeEnd), 0);
      else
        final = min(relativeEnd, len);
      while (k < final) {
        var pk = String(k);
        o[pk] = value;
        k += 1;
      }
      return o;
    });

  // 22.1.3.7 Array.prototype.filter ( callbackfn [ , thisArg ] )

  // 22.1.3.8 Array.prototype.find ( predicate [ , thisArg ] )
  define(
    Array.prototype, 'find',
    function find(predicate) {
      var o = ToObject(this);
      var lenValue = o.length;
      var len = ToInteger(lenValue);
      if (!IsCallable(predicate)) throw TypeError();
      var t = arguments.length > 1 ? arguments[1] : undefined;
      var k = 0;
      while (k < len) {
        var pk = String(k);
        var kPresent = HasProperty(o, pk);
        if (kPresent) {
          var kValue = o[pk];
          var testResult = predicate.call(t, kValue, k, o);
          if (Boolean(testResult)) {
            return kValue;
          }
        }
        ++k;
      }
      return undefined;
    });

  // 22.1.3.9 Array.prototype.findIndex ( predicate [ , thisArg ] )
  define(
    Array.prototype, 'findIndex',
    function findIndex(predicate) {
      var o = ToObject(this);
      var lenValue = o.length;
      var len = ToLength(lenValue);
      if (!IsCallable(predicate)) throw TypeError();
      var t = arguments.length > 1 ? arguments[1] : undefined;
      var k = 0;
      while (k < len) {
        var pk = String(k);
        var kPresent = HasProperty(o, pk);
        if (kPresent) {
          var kValue = o[pk];
          var testResult = predicate.call(t, kValue, k, o);
          if (Boolean(testResult)) {
            return k;
          }
        }
        ++k;
      }
      return -1;
    });

  // 22.1.3.10 Array.prototype.forEach ( callbackfn [ , thisArg ] )
  // 22.1.3.11 Array.prototype.indexOf ( searchElement [ , fromIndex ] )
  // 22.1.3.12 Array.prototype.join (separator)

  // 22.1.3.13 Array.prototype.keys ( )
  define(
    Array.prototype, 'keys',
    function keys() {
      return CreateArrayIterator(this, 'key');
    }, !nativeArrayIteratorMethods);

  // 22.1.3.14 Array.prototype.lastIndexOf ( searchElement [ , fromIndex ] )
  // 22.1.3.15 Array.prototype.map ( callbackfn [ , thisArg ] )
  // 22.1.3.16 Array.prototype.pop ( )
  // 22.1.3.17 Array.prototype.push ( ...items )
  // 22.1.3.18 Array.prototype.reduce ( callbackfn [ , initialValue ] )
  // 22.1.3.19 Array.prototype.reduceRight ( callbackfn [ , initialValue ] )
  // 22.1.3.20 Array.prototype.reverse ( )
  // 22.1.3.21 Array.prototype.shift ( )
  // 22.1.3.22 Array.prototype.slice (start, end)
  // 22.1.3.23 Array.prototype.some ( callbackfn [ , thisArg ] )
  // 22.1.3.24 Array.prototype.sort (comparefn)
  // 22.1.3.25 Array.prototype.splice (start, deleteCount , ...items )
  // 22.1.3.26 Array.prototype.toLocaleString ( [ reserved1 [ , reserved2 ] ] )
  // 22.1.3.27 Array.prototype.toString ( )
  // 22.1.3.28 Array.prototype.unshift ( ...items )

  // 22.1.3.29 Array.prototype.values ( )
  define(
    Array.prototype, 'values',
    function values() {
      return CreateArrayIterator(this, 'value');
    }, !nativeArrayIteratorMethods);

  // 22.1.3.30 Array.prototype [ @@iterator ] ( )
  define(
    Array.prototype, $$iterator,
    Array.prototype.values
    );

  // 22.1.3.31 Array.prototype [ @@unscopables ]
  // 22.1.4 Properties of Array Instances
  // 22.1.4.1 length

  // 22.1.5 Array Iterator Objects
  function ArrayIterator() {}

  // 22.1.5.1 CreateArrayIterator Abstract Operation
  function CreateArrayIterator(array, kind) {
    var o = ToObject(array);
    var iterator = new ArrayIterator;
    set_internal(iterator, '[[IteratedObject]]', o);
    set_internal(iterator, '[[ArrayIteratorNextIndex]]', 0);
    set_internal(iterator, '[[ArrayIterationKind]]', kind);
    return iterator;
  }

  // 22.1.5.2 The %ArrayIteratorPrototype% Object
  var $ArrayIteratorPrototype$ = Object.create($IteratorPrototype$);
  ArrayIterator.prototype = $ArrayIteratorPrototype$;

  // 22.1.5.2.1 %ArrayIteratorPrototype%. next( )
  define(
    $ArrayIteratorPrototype$, 'next',
    function next() {
      var o = strict(this);
      if (Type(o) !== 'object') throw TypeError();
      var a = o['[[IteratedObject]]'],
          index = o['[[ArrayIteratorNextIndex]]'],
          itemKind = o['[[ArrayIterationKind]]'],
          lenValue = a.length,
          len = ToUint32(lenValue),
          elementKey,
          elementValue;
      if (itemKind.indexOf('sparse') !== -1) {
        var found = false;
        while (!found && index < len) {
          elementKey = String(index);
          found = HasProperty(a, elementKey);
          if (!found) {
            index += 1;
          }
        }
      }
      if (index >= len) {
        set_internal(o, '[[ArrayIteratorNextIndex]]', Infinity);
        return CreateIterResultObject(undefined, true);
      }
      elementKey = index;
      set_internal(o, '[[ArrayIteratorNextIndex]]', index + 1);
      if (itemKind.indexOf('value') !== -1)
        elementValue = a[elementKey];
      if (itemKind.indexOf('key+value') !== -1)
        return CreateIterResultObject([elementKey, elementValue], false);
      if (itemKind.indexOf('key') !== -1)
        return CreateIterResultObject(elementKey, false);
      if (itemKind === 'value')
        return CreateIterResultObject(elementValue, false);
      throw Error('Internal error');
    });

  // 22.1.5.2.2 %ArrayIteratorPrototype% [ @@toStringTag ]
  define($ArrayIteratorPrototype$, $$toStringTag, 'Array Iterator');

  // 22.1.5.3 Properties of Array Iterator Instances


  // ---------------------------------------
  // 22.2 TypedArray Objects
  // ---------------------------------------

  // See typedarray.js for TypedArray polyfill

  ['Int8Array', 'Uint8Array', 'Uint8ClampedArray',
   'Int16Array', 'Uint16Array',
   'Int32Array', 'Uint32Array',
   'Float32Array', 'Float64Array'].forEach(function ($TypedArrayName$) {
     if (!($TypedArrayName$ in global))
       return;
     var $TypedArray$ = global[$TypedArrayName$];

     // 22.2.1 The %TypedArray% Intrinsic Object
     // 22.2.1.1 %TypedArray% ( length )
     // 22.2.1.2 %TypedArray% ( typedArray )
     // 22.2.1.3 %TypedArray% ( object )
     // 22.2.1.4 %TypedArray% ( buffer [ , byteOffset [ , length ] ] )
     // 22.2.1.5 %TypedArray% ( all other argument combinations )
     // 22.2.2 Properties of the %TypedArray% Intrinsic Object

     // 22.2.2.1 %TypedArray%.from ( source [ , mapfn [ , thisArg ] ] )
     define(
       $TypedArray$, 'from',
       function from(source) {
         var mapfn = arguments[1];
         var thisArg = arguments[2];

         var c = strict(this);
         if (!IsConstructor(c)) throw TypeError();
         if (mapfn === undefined) {
           var mapping = false;
         } else {
           if (IsCallable(mapfn)) throw TypeError();
           var t = thisArg;
           mapping = true;
         }
         var usingIterator = GetMethod(source, $$iterator);
         if (usingIterator !== undefined) {
           var iterator = GetIterator(source, usingIterator);
           var values = [];
           var next = true;
           while (next !== false) {
             next = IteratorStep(iterator);
             if (next !== false) {
               var nextValue = IteratorValue(next);
               values.push(nextValue);
             }
           }
           var len = values.length;
           var newObj = new c(len);
           var k = 0;
           while (k < len) {
             var kValue = values.shift();
             if (mapping) {
               var mappedValue = mapfn.call(t, kValue);
             } else {
               mappedValue = kValue;
             }
             newObj[k] = mappedValue;
             ++k;
           }
           console.assert(values.length === 0);
           return newObj;
         }
         var arrayLike = ToObject(source);
         var lenValue = arrayLike.length;
         len = ToLength(lenValue);
         newObj = new c(len);
         k = 0;
         while (k < len) {
           kValue = arrayLike[k];
           if (mapping) {
             mappedValue = mapfn.call(t, kValue, k);
           } else {
             mappedValue = kValue;
           }
           newObj[k] = mappedValue;
           ++k;
         }
         return newObj;
       });

     // 22.2.2.2 %TypedArray%.of ( ...items )
     define(
       $TypedArray$, 'of',
       function of() {
         var items = arguments;

         var len = items.length;
         var c = strict(this);
         var newObj = new c(len);
         var k = 0;
         while (k < len) {
           newObj[k] = items[k];
           ++k;
         }
         return newObj;
       });

     // 22.2.2.3 %TypedArray%.prototype
     // 22.2.2.4 get %TypedArray% [ @@species ]
     // 22.2.3 Properties of the %TypedArrayPrototype% Object
     // 22.2.3.1 get %TypedArray%.prototype.buffer
     // 22.2.3.2 get %TypedArray%.prototype.byteLength
     // 22.2.3.3 get %TypedArray%.prototype.byteOffset
     // 22.2.3.4 %TypedArray%.prototype.constructor

     // 22.2.3.5 %TypedArray%.prototype.copyWithin (target, start [, end ] )
     define($TypedArray$.prototype, 'copyWithin', Array.prototype.copyWithin);

     // 22.2.3.6 %TypedArray%.prototype.entries ( )
     define($TypedArray$.prototype, 'entries', Array.prototype.entries);

     // 22.2.3.7 %TypedArray%.prototype.every ( callbackfn [ , thisArg ] )
     define($TypedArray$.prototype, 'every', Array.prototype.every);

     // 22.2.3.8 %TypedArray%.prototype.fill (value [ , start [ , end ] ] )
     define(
       $TypedArray$.prototype, 'fill',
       //Array.prototype.fill // Doesn't work in Safari 7
       function fill(value/*, start, end*/) {
         var start = arguments[1],
             end = arguments[2];

         var o = ToObject(this);
         var lenVal = o.length;
         var len = ToLength(lenVal);
         len = max(len, 0);
         var relativeStart = ToInteger(start);
         var k;
         if (relativeStart < 0) k = max((len + relativeStart), 0);
         else k = min(relativeStart, len);
         var relativeEnd;
         if (end === undefined) relativeEnd = len;
         else relativeEnd = ToInteger(end);
         var final;
         if (relativeEnd < 0) final = max((len + relativeEnd), 0);
         else final = min(relativeEnd, len);
         while (k < final) {
           var pk = String(k);
           o[pk] = value;
           k += 1;
         }
         return o;
       });

     // 22.2.3.9 %TypedArray%.prototype.filter ( callbackfn [ , thisArg ] )
     define(
       $TypedArray$.prototype, 'filter',
       function filter(callbackfn) {
         var thisArg = arguments[1];

         var o = ToObject(this);
         var lenVal = o.length;
         var len = ToLength(lenVal);
         if (!IsCallable(callbackfn)) throw TypeError();
         var t = thisArg;
         var c = o.constructor;
         var kept = [];
         var k = 0;
         var captured = 0;
         while (k < len) {
           var kValue = o[k];
           var selected = callbackfn.call(t, kValue, k, o);
           if (selected) {
             kept.push(kValue);
             ++captured;
           }
           ++k;
         }
         var a = new c(captured);
         var n = 0;
         for (var i = 0; i < kept.length; ++i) {
           var e = kept[i];
           a[n] = e;
           ++n;
         }
         return a;
       });

     // 22.2.3.10 %TypedArray%.prototype.find (predicate [ , thisArg ] )
     define($TypedArray$.prototype, 'find', Array.prototype.find);

     // 22.2.3.11 %TypedArray%.prototype.findIndex ( predicate [ , thisArg ] )
     define($TypedArray$.prototype, 'findIndex', Array.prototype.findIndex);

     // 22.2.3.12 %TypedArray%.prototype.forEach ( callbackfn [ , thisArg ] )
     define($TypedArray$.prototype, 'forEach', Array.prototype.forEach);

     // 22.2.3.13 %TypedArray%.prototype.indexOf (searchElement [ , fromIndex ] )
     define($TypedArray$.prototype, 'indexOf', Array.prototype.indexOf);

     // 22.2.3.14 %TypedArray%.prototype.join ( separator )
     define($TypedArray$.prototype, 'join', Array.prototype.join);

     // 22.2.3.15 %TypedArray%.prototype.keys ( )
     define($TypedArray$.prototype, 'keys', Array.prototype.keys);

     // 22.2.3.16 %TypedArray%.prototype.lastIndexOf ( searchElement [ , fromIndex ] )
     define($TypedArray$.prototype, 'lastIndexOf', Array.prototype.lastIndexOf);

     // 22.2.3.17 get %TypedArray%.prototype.length

     // 22.2.3.18 %TypedArray%.prototype.map ( callbackfn [ , thisArg ] )
     define(
       $TypedArray$.prototype, 'map',
       function map(callbackfn) {
         var thisArg = arguments[1];

         var o = ToObject(this);
         var lenValue = o.length;
         var len = ToLength(lenValue);
         if (!IsCallable(callbackfn)) throw TypeError();
         var t = thisArg;
         var a = undefined;
         var c = o.constructor;
         if (IsConstructor(c))
           a = new c(len);
         if (a === undefined)
           a = new Array(len);
         var k = 0;
         while (k < len) {
           var kPresent = HasProperty(o, k);
           if (kPresent) {
             var kValue = o[k];
             var mappedValue = callbackfn.call(t, kValue, k, o);
             a[k] = mappedValue;
           }
           ++k;
         }
         return a;
       });

     // 22.2.3.19 %TypedArray%.prototype.reduce ( callbackfn [, initialValue] )
     define($TypedArray$.prototype, 'reduce', Array.prototype.reduce);

     // 22.2.3.20 %TypedArray%.prototype.reduceRight ( callbackfn [, initialValue] )
     define($TypedArray$.prototype, 'reduceRight', Array.prototype.reduceRight);

     // 22.2.3.21 %TypedArray%.prototype.reverse ( )
     define($TypedArray$.prototype, 'reverse', Array.prototype.reverse);

     // 22.2.3.22 %TypedArray%.prototype.set ( overloaded [ , offset ])
     // 22.2.3.22.1 %TypedArray%.prototype.set (array [ , offset ] )
     // 22.2.3.22.2 %TypedArray%.prototype.set(typedArray [, offset ] )

     // 22.2.3.23 %TypedArray%.prototype.slice ( start, end )
     define(
       $TypedArray$.prototype, 'slice',
       function slice(start, end) {
         var o = ToObject(this);
         var lenVal = o.length;
         var len = ToLength(lenVal);
         var relativeStart = ToInteger(start);
         var k = (relativeStart < 0) ? max(len + relativeStart, 0) : min(relativeStart, len);
         var relativeEnd = (end === undefined) ? len : ToInteger(end);
         var final = (relativeEnd < 0) ? max(len + relativeEnd, 0) : min(relativeEnd, len);
         var count = final - k;
         var c = o.constructor;
         if (IsConstructor(c)) {
           var a = new c(count);
         } else {
           throw TypeError();
         }
         var n = 0;
         while (k < final) {
           var kValue = o[k];
           a[n] = kValue;
           ++k;
           ++n;
         }
         return a;
       });

     // 22.2.3.24 %TypedArray%.prototype.some ( callbackfn [ , thisArg ] )
     define($TypedArray$.prototype, 'some', Array.prototype.some);

     // 22.2.3.25 %TypedArray%.prototype.sort ( comparefn )
     define(
       $TypedArray$.prototype, 'sort',
       function sort() {
         var comparefn = arguments[0];

         function sortCompare(x, y) {
           console.assert(Type(x) === 'number' && Type(y) === 'number');
           if (x !== x && y !== y) return +0;
           if (x !== x) return 1;
           if (y !== y) return -1;
           if (comparefn !== undefined) {
             return comparefn(x, y);
           }
           if (x < y) return -1;
           if (x > y) return 1;
           return +0;
         }
         return Array.prototype.sort.call(this, sortCompare);
       });

     // 22.2.3.26 %TypedArray%.prototype.subarray( [ begin [ , end ] ] )
     // 22.2.3.27 %TypedArray%.prototype.toLocaleString ([ reserved1 [ , reserved2 ] ])
     // 22.2.3.28 %TypedArray%.prototype.toString ( )

     // 22.2.3.29 %TypedArray%.prototype.values ( )
     define($TypedArray$.prototype, 'values', Array.prototype.values);

     // 22.2.3.30 %TypedArray%.prototype [ @@iterator ] ( )
     define(
       $TypedArray$.prototype, $$iterator,
       $TypedArray$.prototype.values
     );

     // 22.2.3.31 get %TypedArray%.prototype [ @@toStringTag ]
     define($TypedArray$.prototype, $$toStringTag, $TypedArrayName$);

     // 22.2.4 The TypedArray Constructors
     // 22.2.4.1TypedArray( ... argumentsList)
     // 22.2.5 Properties of the TypedArray Constructors
     // 22.2.5.1 TypedArray.BYTES_PER_ELEMENT
     // 22.2.5.2 TypedArray.prototype
     // 22.2.6 Properties of TypedArray Prototype Objects
     // 22.2.6.1 TypedArray.prototype.BYTES_PER_ELEMENT
     // 22.2.6.2 TypedArray.prototype.constructor
     // 22.2.7 Properties of TypedArray Instances
   });

  // ---------------------------------------
  // 23 Keyed Collection
  // ---------------------------------------

  // ---------------------------------------
  // 23.1 Map Objects
  // ---------------------------------------

  (function() {
    // 23.1.1 The Map Constructor

    // 23.1.1.1 Map ( [ iterable ] )
    /** @constructor */
    function Map(/*iterable*/) {
      var map = strict(this);
      var iterable = arguments[0];

      if (Type(map) !== 'object') throw TypeError();
      if ('[[MapData]]' in map) throw TypeError();

      if (iterable !== undefined) {
        var adder = map['set'];
        if (!IsCallable(adder)) throw TypeError();
        var iter = GetIterator(ToObject(iterable));
      }
      set_internal(map, '[[MapData]]', { keys: [], values: [] });
      if (iter === undefined) return map;
      while (true) {
        var next = IteratorStep(iter);
        if (next === false)
          return map;
        var nextItem = IteratorValue(next);
        if (Type(nextItem) !== 'object') throw TypeError();
        var k = nextItem[0];
        var v = nextItem[1];
        adder.call(map, k, v);
      }

      return map;
    }

    if (!('Map' in global) || OVERRIDE_NATIVE_FOR_TESTING ||
        (function() { try { new global.Map([]); return false; } catch (_) { return true; } }()) ||
        (function() { try { return !new global.Map().entries().next; } catch (_) { return true; } }()) ||
        (new global.Map([['a', 1]]).size !== 1))
      global.Map = Map;


    function MapDataIndexOf(mapData, key) {
      var i;
      if (key === key) return mapData.keys.indexOf(key);
      // Slow case for NaN
      for (i = 0; i < mapData.keys.length; i += 1)
        if (SameValueZero(mapData.keys[i], key)) return i;
      return -1;
    }

    // 23.1.1.2 new Map ( ... argumentsList )
    // 23.1.2 Properties of the Map Constructor
    // 23.1.2.1 Map.prototype
    var $MapPrototype$ = {};
    Map.prototype = $MapPrototype$;

    // 23.1.2.2 get Map [ @@species ]

    // 23.1.3 Properties of the Map Prototype Object
    // 23.1.3.1 Map.prototype.clear ()
    define(
      Map.prototype, 'clear',
      function clear() {
        var m = strict(this);
        if (Type(m) !== 'object') throw TypeError();
        if (!('[[MapData]]' in m)) throw TypeError();
        if (m['[[MapData]]'] === undefined) throw TypeError();
        var entries = m['[[MapData]]'];
        entries.keys.length = 0;
        entries.values.length = 0;
        return undefined;
      });

    // 23.1.3.2 Map.prototype.constructor

    // 23.1.3.3 Map.prototype.delete ( key )
    define(
      Map.prototype, 'delete',
      function delete_(key) {
        var m = strict(this);
        if (Type(m) !== 'object') throw TypeError();
        if (!('[[MapData]]' in m)) throw TypeError();
        if (m['[[MapData]]'] === undefined) throw TypeError();
        var entries = m['[[MapData]]'];
        var i = MapDataIndexOf(entries, key);
        if (i < 0) return false;
        entries.keys[i] = empty;
        entries.values[i] = empty;
        return true;
      });

    // 23.1.3.4 Map.prototype.entries ( )
    define(
      Map.prototype, 'entries',
      function entries() {
        var m = strict(this);
        if (Type(m) !== 'object') throw TypeError();
        return CreateMapIterator(m, 'key+value');
      });

    // 23.1.3.5 Map.prototype.forEach ( callbackfn [ , thisArg ] )
    define(
      Map.prototype, 'forEach',
      function forEach(callbackfn /*, thisArg*/) {
        var thisArg = arguments[1];

        var m = strict(this);
        if (Type(m) !== 'object') throw TypeError();
        if (!('[[MapData]]' in m)) throw TypeError();
        if (m['[[MapData]]'] === undefined) throw TypeError();
        var entries = m['[[MapData]]'];

        if (!IsCallable(callbackfn)) {
          throw TypeError('First argument to forEach is not callable.');
        }
        for (var i = 0; i < entries.keys.length; ++i) {
          if (entries.keys[i] !== empty) {
            callbackfn.call(thisArg, entries.values[i], entries.keys[i], m);
          }
        }
        return undefined;
      });

    // 23.1.3.6 Map.prototype.get ( key )
    define(
      Map.prototype, 'get',
      function get(key) {
        var m = strict(this);
        if (Type(m) !== 'object') throw TypeError();
        if (!('[[MapData]]' in m)) throw TypeError();
        if (m['[[MapData]]'] === undefined) throw TypeError();
        var entries = m['[[MapData]]'];
        var i = MapDataIndexOf(entries, key);
        if (i >= 0) return entries.values[i];
        return undefined;
      });

    // 23.1.3.7 Map.prototype.has ( key )
    define(
      Map.prototype, 'has',
      function has(key) {
        var m = strict(this);
        if (Type(m) !== 'object') throw TypeError();
        if (!('[[MapData]]' in m)) throw TypeError();
        if (m['[[MapData]]'] === undefined) throw TypeError();
        var entries = m['[[MapData]]'];
        if (MapDataIndexOf(entries, key) >= 0) return true;
        return false;
      });

    // 23.1.3.8 Map.prototype.keys ( )
    define(
      Map.prototype, 'keys',
      function keys() {
        var m = strict(this);
        if (Type(m) !== 'object') throw TypeError();
        return CreateMapIterator(m, 'key');
      });

    // 23.1.3.9 Map.prototype.set ( key , value )
    define(
      Map.prototype, 'set',
      function set(key, value) {
        var m = strict(this);
        if (Type(m) !== 'object') throw TypeError();
        if (!('[[MapData]]' in m)) throw TypeError();
        if (m['[[MapData]]'] === undefined) throw TypeError();
        var entries = m['[[MapData]]'];
        var i = MapDataIndexOf(entries, key);
        if (i < 0) i = entries.keys.length;
        if (SameValue(key, -0)) key = 0;
        entries.keys[i] = key;
        entries.values[i] = value;
        return m;
      });

    // 23.1.3.10 get Map.prototype.size
    Object.defineProperty(
      Map.prototype, 'size', {
        get: function() {
          var m = strict(this);
          if (Type(m) !== 'object') throw TypeError();
          if (!('[[MapData]]' in m)) throw TypeError();
          if (m['[[MapData]]'] === undefined) throw TypeError();
          var entries = m['[[MapData]]'];
          var count = 0;
          for (var i = 0; i < entries.keys.length; ++i) {
            if (entries.keys[i] !== empty)
              count = count + 1;
          }
          return count;
        }
      });

    // 23.1.3.11 Map.prototype.values ( )
    define(
      Map.prototype, 'values',
      function values() {
        var m = strict(this);
        if (Type(m) !== 'object') throw TypeError();
        return CreateMapIterator(m, 'value');
      });

    // 23.1.3.12 Map.prototype [ @@iterator ]( )
    define(
      Map.prototype, $$iterator,
      function() {
        var m = strict(this);
        if (Type(m) !== 'object') throw TypeError();
        return CreateMapIterator(m, 'key+value');
      });

    // 23.1.3.13 Map.prototype [ @@toStringTag ]
    define(global.Map.prototype, $$toStringTag, 'Map');

    // 23.1.4 Properties of Map Instances
    // 23.1.5 Map Iterator Objects

    /** @constructor */
    function MapIterator() {}

    // 23.1.5.1 CreateMapIterator Abstract Operation
    function CreateMapIterator(map, kind) {
      if (Type(map) !== 'object') throw TypeError();
      if (!('[[MapData]]' in map)) throw TypeError();
      if (map['[[MapData]]'] === undefined) throw TypeError();
      var iterator = new MapIterator;
      set_internal(iterator, '[[Map]]', map);
      set_internal(iterator, '[[MapNextIndex]]', 0);
      set_internal(iterator, '[[MapIterationKind]]', kind);
      return iterator;
    }

    // 23.1.5.2 The %MapIteratorPrototype% Object
    var $MapIteratorPrototype$ = Object.create($IteratorPrototype$);
    MapIterator.prototype = $MapIteratorPrototype$;

    // 23.1.5.2.1 %MapIteratorPrototype%.next ( )
    define(
      $MapIteratorPrototype$, 'next',
      function next() {
        var o = strict(this);
        if (Type(o) !== 'object') throw TypeError();
        var m = o['[[Map]]'],
            index = o['[[MapNextIndex]]'],
            itemKind = o['[[MapIterationKind]]'],
            entries = m['[[MapData]]'];
        while (index < entries.keys.length) {
          var e = {key: entries.keys[index], value: entries.values[index]};
          index = index += 1;
          set_internal(o, '[[MapNextIndex]]', index);
          if (e.key !== empty) {
            if (itemKind === 'key') {
              return CreateIterResultObject(e.key, false);
            } else if (itemKind === 'value') {
              return CreateIterResultObject(e.value, false);
            } else {
              return CreateIterResultObject([e.key, e.value], false);
            }
          }
        }
        return CreateIterResultObject(undefined, true);
      });

    // 23.1.5.2.2 %MapIteratorPrototype% [ @@toStringTag ]
    define($MapIteratorPrototype$, $$toStringTag, 'Map Iterator');

    // 23.1.5.3 Properties of Map Iterator Instances
  }());

  // ---------------------------------------
  // 23.2 Set Objects
  // ---------------------------------------

  (function() {
    // 23.2.1 The Set Constructor
    // 23.2.1.1 Set ( [ iterable ] )

    /** @constructor */
    function Set(/*iterable*/) {
      var set = strict(this);
      var iterable = arguments[0];

      if (Type(set) !== 'object') throw TypeError();
      if ('[[SetData]]' in set) throw TypeError();

      if (iterable !== undefined) {
        var adder = set['add'];
        if (!IsCallable(adder)) throw TypeError();
        var iter = GetIterator(ToObject(iterable));
      }
      set_internal(set, '[[SetData]]', []);
      if (iter === undefined) return set;
      while (true) {
        var next = IteratorStep(iter);
        if (next === false)
          return set;
        var nextValue = IteratorValue(next);
        adder.call(set, nextValue);
      }

      return set;
    }

    if (!('Set' in global) || OVERRIDE_NATIVE_FOR_TESTING ||
        (function() { try { return !new global.Set().entries().next; } catch (_) { return true; } }()) ||
        (new global.Set([1]).size !== 1))
      global.Set = Set;

    function SetDataIndexOf(setData, key) {
      var i;
      if (key === key)
        return setData.indexOf(key);
      // Slow case for NaN
      for (i = 0; i < setData.length; i += 1)
        if (SameValueZero(setData[i], key)) return i;
      return -1;
    }

    // 23.2.1.2 new Set ( ...argumentsList )
    // 23.2.2 Properties of the Set Constructor

    // 23.2.2.1 Set.prototype
    var $SetPrototype$ =  {};
    Set.prototype = $SetPrototype$;

    // 23.2.2.2 get Set [ @@species ]
    // 23.2.3 Properties of the Set Prototype Object

    // 23.2.3.1 Set.prototype.add (value )
    define(
      Set.prototype, 'add',
      function add(value) {
        var s = strict(this);
        if (Type(s) !== 'object') throw TypeError();
        if (!('[[SetData]]' in s)) throw TypeError();
        if (s['[[SetData]]'] === undefined) throw TypeError();
        if (SameValue(value, -0)) value = 0;
        var entries = s['[[SetData]]'];
        var i = SetDataIndexOf(entries, value);
        if (i < 0) i = s['[[SetData]]'].length;
        s['[[SetData]]'][i] = value;

        return s;
      });

    // 23.2.3.2 Set.prototype.clear ()
    define(
      Set.prototype, 'clear',
      function clear() {
        var s = strict(this);
        if (Type(s) !== 'object') throw TypeError();
        if (!('[[SetData]]' in s)) throw TypeError();
        if (s['[[SetData]]'] === undefined) throw TypeError();
        var entries = s['[[SetData]]'];
        entries.length = 0;
        return undefined;
      });

    // 23.2.3.3 Set.prototype.constructor
    // 23.2.3.4 Set.prototype.delete ( value )
    define(
      Set.prototype, 'delete',
      function delete_(value) {
        var s = strict(this);
        if (Type(s) !== 'object') throw TypeError();
        if (!('[[SetData]]' in s)) throw TypeError();
        if (s['[[SetData]]'] === undefined) throw TypeError();
        var entries = s['[[SetData]]'];
        var i = SetDataIndexOf(entries, value);
        if (i < 0) return false;
        entries[i] = empty;
        return true;
      });

    // 23.2.3.5 Set.prototype.entries ( )
    define(
      Set.prototype, 'entries',
      function entries() {
        var s = strict(this);
        if (Type(s) !== 'object') throw TypeError();
        return CreateSetIterator(s, 'key+value');
      });

    // 23.2.3.6 Set.prototype.forEach ( callbackfn [ , thisArg ] )
    define(
      Set.prototype, 'forEach',
      function forEach(callbackfn/*, thisArg*/) {
        var thisArg = arguments[1];

        var s = strict(this);
        if (Type(s) !== 'object') throw TypeError();
        if (!('[[SetData]]' in s)) throw TypeError();
        if (s['[[SetData]]'] === undefined) throw TypeError();
        var entries = s['[[SetData]]'];

        if (!IsCallable(callbackfn)) {
          throw TypeError('First argument to forEach is not callable.');
        }
        for (var i = 0; i < entries.length; ++i) {
          if (entries[i] !== empty) {
            callbackfn.call(thisArg, entries[i], entries[i], s);
          }
        }
      });

    // 23.2.3.7 Set.prototype.has ( value )
    define(
      Set.prototype, 'has',
      function has(key) {
        var s = strict(this);
        if (Type(s) !== 'object') throw TypeError();
        if (!('[[SetData]]' in s)) throw TypeError();
        if (s['[[SetData]]'] === undefined) throw TypeError();
        var entries = s['[[SetData]]'];
        return SetDataIndexOf(entries, key) !== -1;
      });

    // 23.2.3.8 Set.prototype.keys ( )
    // See Set.prototype.values

    // 23.2.3.9 get Set.prototype.size
    Object.defineProperty(
      Set.prototype, 'size', {
        get: function() {
          var s = strict(this);
          if (Type(s) !== 'object') throw TypeError();
          if (!('[[SetData]]' in s)) throw TypeError();
          if (s['[[SetData]]'] === undefined) throw TypeError();
          var entries = s['[[SetData]]'];
          var count = 0;
          for (var i = 0; i < entries.length; ++i) {
            if (entries[i] !== empty)
              count = count + 1;
          }
          return count;
        }
      });

    // 23.2.3.10 Set.prototype.values ( )
    define(
      Set.prototype, 'values',
      function values() {
        var s = strict(this);
        if (Type(s) !== 'object') throw TypeError();
        return CreateSetIterator(s, 'value');
      });
    // NOTE: function name is still 'values':
    Set.prototype.keys = Set.prototype.values;

    // 23.2.3.11 Set.prototype [@@iterator ] ( )
    define(
      Set.prototype, $$iterator,
      function() {
        var s = strict(this);
        if (Type(s) !== 'object') throw TypeError();
        return CreateSetIterator(s);
      });

    // 23.2.3.12 Set.prototype [ @@toStringTag ]
    define(global.Set.prototype, $$toStringTag, 'Set');

    // 23.2.4 Properties of Set Instances
    // 23.2.5 Set Iterator Objects
    /** @constructor */
    function SetIterator() {}

    // 23.2.5.1 CreateSetIterator Abstract Operation
    function CreateSetIterator(set, kind) {
      if (Type(set) !== 'object') throw TypeError();
      if (!('[[SetData]]' in set)) throw TypeError();
      if (set['[[SetData]]'] === undefined) throw TypeError();
      var iterator = new SetIterator;
      set_internal(iterator, '[[IteratedSet]]', set);
      set_internal(iterator, '[[SetNextIndex]]', 0);
      set_internal(iterator, '[[SetIterationKind]]', kind);
      return iterator;
    }

    // 23.2.5.2 The %SetIteratorPrototype% Object
    var $SetIteratorPrototype$ = Object.create($IteratorPrototype$);
    SetIterator.prototype = $SetIteratorPrototype$;

    // 23.2.5.2.1 %SetIteratorPrototype%.next( )
    define(
      $SetIteratorPrototype$, 'next',
      function next() {
        var o = strict(this);
        if (Type(o) !== 'object') throw TypeError();
        var s = o['[[IteratedSet]]'],
            index = o['[[SetNextIndex]]'],
            itemKind = o['[[SetIterationKind]]'],
            entries = s['[[SetData]]'];
        while (index < entries.length) {
          var e = entries[index];
          index = index += 1;
          set_internal(o, '[[SetNextIndex]]', index);
          if (e !== empty) {
            if (itemKind === 'key+value')
              return CreateIterResultObject([e, e], false);
            return CreateIterResultObject(e, false);
          }
        }
        return CreateIterResultObject(undefined, true);
      });

    // 23.2.5.2.2 %SetIteratorPrototype% [ @@toStringTag ]
    define($SetIteratorPrototype$, $$toStringTag, 'Set Iterator');

    // 23.2.5.3 Properties of Set Iterator Instances

  }());

  // ---------------------------------------
  // 23.3 WeakMap Objects
  // ---------------------------------------

  (function() {
    // 23.3.1 The WeakMap Constructor
    // 23.3.1.1 WeakMap ( [ iterable ] )
    /** @constructor */
    function WeakMap(/*iterable*/) {
      var map = strict(this);
      var iterable = arguments[0];

      if (Type(map) !== 'object') throw TypeError();
      if ('[[WeakMapData]]' in map) throw TypeError();

      if (iterable !== undefined) {
        var adder = map['set'];
        if (!IsCallable(adder)) throw TypeError();
        var iter = GetIterator(ToObject(iterable));
      }
      set_internal(map, '[[WeakMapData]]', new EphemeronTable);
      if (iter === undefined) return map;
      while (true) {
        var next = IteratorStep(iter);
        if (next === false)
          return map;
        var nextValue = IteratorValue(next);
        if (Type(nextValue) !== 'object') throw TypeError();
        var k = nextValue[0];
        var v = nextValue[1];
        adder.call(map, k, v);
      }

      return map;
    }

    if (!('WeakMap' in global) || OVERRIDE_NATIVE_FOR_TESTING)
      global.WeakMap = WeakMap;

    // 23.3.2 Properties of the WeakMap Constructor
    // 23.3.2.1 WeakMap.prototype
    var $WeakMapPrototype$ = {};
    WeakMap.prototype = $WeakMapPrototype$;



   // 23.3.2.2 WeakMap[ @@create ] ( )
    // 23.3.3 Properties of the WeakMap Prototype Object

    // 23.3.3.1 WeakMap.prototype.constructor

    // 23.3.3.2 WeakMap.prototype.delete ( key )
    define(
      WeakMap.prototype, 'delete',
      function delete_(key) {
        var M = strict(this);
        if (Type(M) !== 'object') throw TypeError();
        if (M['[[WeakMapData]]'] === undefined) throw TypeError();
        if (Type(key) !== 'object') throw TypeError('Expected object');
        return M['[[WeakMapData]]'].remove(key);
      });

    // 23.3.3.3 WeakMap.prototype.get ( key )
    define(
      WeakMap.prototype, 'get',
      function get(key, defaultValue) {
        var M = strict(this);
        if (Type(M) !== 'object') throw TypeError();
        if (M['[[WeakMapData]]'] === undefined) throw TypeError();
        if (Type(key) !== 'object') throw TypeError('Expected object');
        return M['[[WeakMapData]]'].get(key, defaultValue);
      });

    // 23.3.3.4 WeakMap.prototype.has ( key )
    define(
      WeakMap.prototype, 'has',
      function has(key) {
        var M = strict(this);
        if (Type(M) !== 'object') throw TypeError();
        if (M['[[WeakMapData]]'] === undefined) throw TypeError();
        if (Type(key) !== 'object') throw TypeError('Expected object');
        return M['[[WeakMapData]]'].has(key);
      });

    // 23.3.3.5 WeakMap.prototype.set ( key , value )
    define(
      WeakMap.prototype, 'set',
      function set(key, value) {
        var M = strict(this);
        if (Type(M) !== 'object') throw TypeError();
        if (M['[[WeakMapData]]'] === undefined) throw TypeError();
        if (Type(key) !== 'object') throw TypeError('Expected object');
        M['[[WeakMapData]]'].set(key, value);
        return M;
      });

    // 23.3.3.6 WeakMap.prototype [ @@toStringTag ]
    define(global.WeakMap.prototype, $$toStringTag, 'WeakMap');

    // 23.3.4 Properties of WeakMap Instances

    // Polyfills for incomplete native implementations:
    (function() {
      var wm = new global.WeakMap();
      var orig = global.WeakMap.prototype.set;
      define(global.WeakMap.prototype, 'set', function set() {
        orig.apply(this, arguments);
        return this;
      }, wm.set({}, 0) !== wm);
    }());
  }());

  // ---------------------------------------
  // 23.4 WeakSet Objects
  // ---------------------------------------

  (function() {
    // 23.4.1 The WeakSet Constructor
    // 23.4.1.1 WeakSet ( [ iterable ] )
    /** @constructor */
    function WeakSet(/*iterable*/) {
      var set = strict(this);
      var iterable = arguments[0];

      if (Type(set) !== 'object') throw TypeError();
      if ('[[WeakSetData]]' in set) throw TypeError();

      if (iterable !== undefined) {
        var adder = set['add'];
        if (!IsCallable(adder)) throw TypeError();
        var iter = GetIterator(ToObject(iterable));
      }
      set_internal(set, '[[WeakSetData]]', new EphemeronTable);
      if (iter === undefined) return set;
      while (true) {
        var next = IteratorStep(iter);
        if (next === false)
          return set;
        var nextValue = IteratorValue(next);
        adder.call(set, nextValue);
      }

      return set;
    }

    if (!('WeakSet' in global) || OVERRIDE_NATIVE_FOR_TESTING)
      global.WeakSet = WeakSet;

    // 23.4.2 Properties of the WeakSet Constructor
    // 23.4.2.1 WeakSet.prototype
    var $WeakSetPrototype$ = {};
    WeakSet.prototype = $WeakSetPrototype$;

    // 23.4.3 Properties of the WeakSet Prototype Object
    // 23.4.3.1 WeakSet.prototype.add (value )
    define(
      WeakSet.prototype, 'add',
      function add(value) {
        var S = strict(this);
        if (Type(S) !== 'object') throw TypeError();
        if (S['[[WeakSetData]]'] === undefined) throw TypeError();
        if (Type(value) !== 'object') throw TypeError('Expected object');
        S['[[WeakSetData]]'].set(value, true);
        return S;
      });

    // 23.4.3.2 WeakSet.prototype.constructor
    // 23.4.3.3 WeakSet.prototype.delete ( value )
    define(
      WeakSet.prototype, 'delete',
      function delete_(value) {
        var S = strict(this);
        if (Type(S) !== 'object') throw TypeError();
        if (S['[[WeakSetData]]'] === undefined) throw TypeError();
        if (Type(value) !== 'object') throw TypeError('Expected object');
        return S['[[WeakSetData]]'].remove(value);
      });

    // 23.4.3.4 WeakSet.prototype.has ( value )
    define(
      WeakSet.prototype, 'has',
      function has(key) {
        var S = strict(this);
        if (Type(S) !== 'object') throw TypeError();
        if (S['[[WeakSetData]]'] === undefined) throw TypeError();
        if (Type(key) !== 'object') throw TypeError('Expected object');
        return S['[[WeakSetData]]'].has(key);
      });

    // 23.4.3.5 WeakSet.prototype [ @@toStringTag ]
    define(global.WeakSet.prototype, $$toStringTag, 'WeakSet');

    // 23.4.4 Properties of WeakSet Instances

    // Polyfills for incomplete native implementations:
    (function() {
      var ws = new global.WeakSet();
      var orig = global.WeakSet.prototype.add;
      define(global.WeakSet.prototype, 'add', function add() {
        orig.apply(this, arguments);
        return this;
      }, ws.add({}) !== ws);
    }());
  }());

  // ---------------------------------------
  // 24 Structured Data
  // ---------------------------------------

  // ---------------------------------------
  // 24.1 ArrayBuffer Objects
  // ---------------------------------------

  // See typedarray.js for TypedArray polyfill

  (function() {
    if (!('ArrayBuffer' in global))
      return;

    // 24.1.1 Abstract Operations For ArrayBuffer Objects
    // 24.1.1.1 AllocateArrayBuffer( constructor, byteLength )
    // 24.1.1.2 IsDetachedBuffer( arrayBuffer )
    // 24.1.1.3 DetachArrayBuffer( arrayBuffer )
    // 24.1.1.4 CloneArrayBuffer( srcBuffer, srcByteOffset [, cloneConstructor] )
    // 24.1.1.5 GetValueFromBuffer ( arrayBuffer, byteIndex, type, isLittleEndian )
    // 24.1.1.6 SetValueInBuffer ( arrayBuffer, byteIndex, type, value, isLittleEndian )
    // 24.1.2 The ArrayBuffer Constructor
    // 24.1.2.1 ArrayBuffer( length )
    // 24.1.3 Properties of the ArrayBuffer Constructor

    // 24.1.3.1 ArrayBuffer.isView ( arg )
    define(
      ArrayBuffer, 'isView',
      function isView(arg) {
        if (Type(arg) !== 'object') return false;
        if ('buffer' in arg && arg.buffer instanceof ArrayBuffer) return true;
        return false;
      });

    // 24.1.3.2 ArrayBuffer.prototype
    // 24.1.3.3 get ArrayBuffer [ @@species ]
    // 24.1.4 Properties of the ArrayBuffer Prototype Object
    // 24.1.4.1 get ArrayBuffer.prototype.byteLength
    // 24.1.4.2 ArrayBuffer.prototype.constructor
    // 24.1.4.3 ArrayBuffer.prototype.slice ( start , end)

    // 24.1.4.4 ArrayBuffer.prototype [ @@toStringTag ]
    define(ArrayBuffer.prototype, $$toStringTag, 'ArrayBuffer');

    // 24.1.5 Properties of the ArrayBuffer Instances
  }());

  // ---------------------------------------
  // 24.2 DataView Objects
  // ---------------------------------------

  // See typedarray.js for TypedArray polyfill

  (function() {
    if (!('DataView' in global))
      return;

    // 24.2.1 Abstract Operations For DataView Objects
    // 24.2.1.1 GetViewValue(view, requestIndex, isLittleEndian, type)
    // 24.2.1.2 SetViewValue(view, requestIndex, isLittleEndian, type, value)
    // 24.2.2 The DataView Constructor
    // 24.2.2.1 DataView (buffer [ , byteOffset [ , byteLength ] ] )
    // 24.2.3 Properties of the DataView Constructor
    // 24.2.3.1 DataView.prototype
    // 24.2.4 Properties of the DataView Prototype Object
    // 24.2.4.1 get DataView.prototype.buffer
    // 24.2.4.2 get DataView.prototype.byteLength
    // 24.2.4.3 get DataView.prototype.byteOffset
    // 24.2.4.4 DataView.prototype.constructor
    // 24.2.4.5 DataView.prototype.getFloat32 ( byteOffset [ , littleEndian ] )
    // 24.2.4.6 DataView.prototype.getFloat64 ( byteOffset [ , littleEndian ] )
    // 24.2.4.7 DataView.prototype.getInt8 ( byteOffset )
    // 24.2.4.8 DataView.prototype.getInt16 ( byteOffset [ , littleEndian ] )
    // 24.2.4.9 DataView.prototype.getInt32 ( byteOffset [ , littleEndian ] )
    // 24.2.4.10 DataView.prototype.getUint8 ( byteOffset )
    // 24.2.4.11 DataView.prototype.getUint16 ( byteOffset [ , littleEndian ] )
    // 24.2.4.12 DataView.prototype.getUint32 ( byteOffset [ , littleEndian ] )
    // 24.2.4.13 DataView.prototype.setFloat32 ( byteOffset, value [ , littleEndian ] )
    // 24.2.4.14 DataView.prototype.setFloat64 ( byteOffset, value [ , littleEndian ] )
    // 24.2.4.15 DataView.prototype.setInt8 ( byteOffset, value )
    // 24.2.4.16 DataView.prototype.setInt16 ( byteOffset, value [ , littleEndian ] )
    // 24.2.4.17 DataView.prototype.setInt32 ( byteOffset, value [ , littleEndian ] )
    // 24.2.4.18 DataView.prototype.setUint8 ( byteOffset, value )
    // 24.2.4.19 DataView.prototype.setUint16 ( byteOffset, value [ , littleEndian ] )
    // 24.2.4.20 DataView.prototype.setUint32 ( byteOffset, value [ , littleEndian ] )

    // 24.2.4.21 DataView.prototype[ @@toStringTag ]
    define(DataView.prototype, $$toStringTag, 'DataView');

    // 24.2.5 Properties of DataView Instances
  }());

  // ---------------------------------------
  // 24.3 The JSON Object
  // ---------------------------------------

  // 24.3.1 JSON.parse ( text [ , reviver ] )
  // 24.3.2 JSON.stringify ( value [ , replacer [ , space ] ] )
  // 24.3.3 JSON [ @@toStringTag ]
  define(JSON, $$toStringTag, 'JSON');

  // ---------------------------------------
  // 25.1 Iteration
  // ---------------------------------------

  // 25.1.1 Common Iteration Interfaces
  // 25.1.1.1 The Iterable Interface
  // 25.1.1.2 The Iterator Interface
  // 25.1.1.3 The IteratorResult Interface

  // 25.1.2 The %IteratorPrototype% Object
  // Defined earlier, so other prototypes can reference it.
  // 25.1.2.1 %IteratorPrototype% [ @@iterator ] ( )
  define($IteratorPrototype$, $$iterator, function() {
    return this;
  });


  // ---------------------------------------
  // 25.4 Promise Objects
  // ---------------------------------------

  (function() {
    // 25.4 Promise Objects

    // 25.4.1 Promise Abstract Operations

    // 25.4.1.1 PromiseCapability Records
    // 25.4.1.1.1 IfAbruptRejectPromise ( value, capability )

    function IfAbruptRejectPromise(value, capability) {
      var rejectResult = capability['[[Reject]]'].call(undefined, value);
      return capability['[[Promise]]'];
    }

    // 25.4.1.2 PromiseReaction Records

    // 25.4.1.3 CreateResolvingFunctions ( promise )

    function CreateResolvingFunctions(promise) {
      var alreadyResolved = {'[[value]]': false};
      var resolve = PromiseResolveFunction();
      set_internal(resolve, '[[Promise]]',  promise);
      set_internal(resolve, '[[AlreadyResolved]]', alreadyResolved);
      var reject = PromiseRejectFunction();
      set_internal(reject, '[[Promise]]', promise);
      set_internal(reject, '[[AlreadyResolved]]', alreadyResolved);
      return { '[[Resolve]]': resolve, '[[Reject]]': reject};
    }

    // 25.4.1.3.1 Promise Reject Functions

    function PromiseRejectFunction() {
      var F = function(reason) {
        console.assert(Type(F['[[Promise]]']) === 'object');
        var promise = F['[[Promise]]'];
        var alreadyResolved = F['[[AlreadyResolved]]'];
        if (alreadyResolved['[[value]]']) return undefined;
        set_internal(alreadyResolved, '[[value]]', true);
        return RejectPromise(promise, reason);
      };
      return F;
    }

    // 25.4.1.3.2 Promise Resolve Functions

    function PromiseResolveFunction() {
      var F = function(resolution) {
        console.assert(Type(F['[[Promise]]']) === 'object');
        var promise = F['[[Promise]]'];
        var alreadyResolved = F['[[AlreadyResolved]]'];
        if (alreadyResolved['[[value]]']) return undefined;
        set_internal(alreadyResolved, '[[value]]', true);

        if (SameValue(resolution, promise))  {
          var selfResolutionError = TypeError();
          return RejectPromise(promise, selfResolutionError);
        }
        if (Type(resolution) !== 'object')
          return FulfillPromise(promise, resolution);
        try {
          var then = resolution['then'];
        } catch(then) {
          return RejectPromise(promise, then);
        }
        if (!IsCallable(then))
          return FulfillPromise(promise, resolution);
        EnqueueJob('PromiseJobs', PromiseResolveThenableJob, [promise, resolution, then]);
        return undefined;
      };
      return F;
    }

    // 25.4.1.4 FulfillPromise ( promise, value )

    function FulfillPromise(promise, value) {
      console.assert(promise['[[PromiseState]]'] === 'pending');
      var reactions = promise['[[PromiseFulfillReactions]]'];
      set_internal(promise, '[[PromiseResult]]', value);
      set_internal(promise, '[[PromiseFulfillReactions]]', undefined);
      set_internal(promise, '[[PromiseRejectReactions]]', undefined);
      set_internal(promise, '[[PromiseState]]', 'fulfilled');
      return TriggerPromiseReactions(reactions, value);
    }

    // 25.4.1.5 NewPromiseCapability ( C )

    function NewPromiseCapability(c) {
      // To keep Promise hermetic, this doesn't look much like the spec.
      return CreatePromiseCapabilityRecord(undefined, c);
    }

    // 25.4.1.5.1 CreatePromiseCapabilityRecord ( promise, constructor )

    function CreatePromiseCapabilityRecord(promise, constructor) {
      // To keep Promise hermetic, this doesn't look much like the spec.
      console.assert(IsConstructor(constructor));
      var promiseCapability = {};
      set_internal(promiseCapability, '[[Promise]]', promise);
      set_internal(promiseCapability, '[[Resolve]]', undefined);
      set_internal(promiseCapability, '[[Reject]]', undefined);
      var executor = GetCapabilitiesExecutor();
      set_internal(executor, '[[Capability]]', promiseCapability);

      // NOTE: Differs from spec; object is constructed here
      var constructorResult = promise = new constructor(executor);
      set_internal(promiseCapability, '[[Promise]]', promise);

      if (!IsCallable(promiseCapability['[[Resolve]]'])) throw TypeError();
      if (!IsCallable(promiseCapability['[[Reject]]'])) throw TypeError();
      if (Type(constructorResult) === 'object' && !SameValue(promise, constructorResult)) throw TypeError();
      return promiseCapability;
    }

    // 25.4.1.5.2 GetCapabilitiesExecutor Functions

    function GetCapabilitiesExecutor() {
      var F = function(resolve, reject) {
        console.assert(F['[[Capability]]']);
        var promiseCapability = F['[[Capability]]'];
        if (promiseCapability['[[Resolve]]'] !== undefined) throw TypeError();
        if (promiseCapability['[[Reject]]'] !== undefined) throw TypeError();
        set_internal(promiseCapability, '[[Resolve]]', resolve);
        set_internal(promiseCapability, '[[Reject]]', reject);
        return undefined;
      };
      return F;
    }

    // 25.4.1.6 IsPromise ( x )

    function IsPromise(x) {
      if (Type(x) !== 'object') return false;
      if (!('[[PromiseState]]' in x)) return false;
      if (x['[[PromiseState]]'] === undefined) return false;
      return true;
    }

    // 25.4.1.7 RejectPromise ( promise, reason )

    function RejectPromise(promise, reason) {
      console.assert(promise['[[PromiseState]]'] === 'pending');
      var reactions = promise['[[PromiseRejectReactions]]'];
      set_internal(promise, '[[PromiseResult]]', reason);
      set_internal(promise, '[[PromiseFulfillReactions]]', undefined);
      set_internal(promise, '[[PromiseRejectReactions]]', undefined);
      set_internal(promise, '[[PromiseState]]', 'rejected');
      return TriggerPromiseReactions(reactions, reason);
    }

    // 25.4.1.8 TriggerPromiseReactions ( reactions, argument )

    function TriggerPromiseReactions(reactions, argument) {
      for (var i = 0, len = reactions.length; i < len; ++i)
        EnqueueJob('PromiseJobs', PromiseReactionJob, [reactions[i], argument]);
      return undefined;
    }

    // 25.4.2 Promise Jobs

    // 25.4.2.1 PromiseReactionJob ( reaction, argument )

    function PromiseReactionJob(reaction, argument) {
      var promiseCapability = reaction['[[Capabilities]]'];
      var handler = reaction['[[Handler]]'];
      var handlerResult, status;
      try {
        if (handler === 'Identity') handlerResult = argument;
        else if (handler === 'Thrower') throw argument;
        else handlerResult = handler.call(undefined, argument);
      } catch (handlerResult) {
        status = promiseCapability['[[Reject]]'].call(undefined, handlerResult);
        NextJob(status); return;
      }
      status = promiseCapability['[[Resolve]]'].call(undefined, handlerResult);
      NextJob(status);
    }

    // 25.4.2.2 PromiseResolveThenableJob ( promiseToResolve, thenable, then)

    function PromiseResolveThenableJob(promiseToResolve, thenable, then) {
      // SPEC BUG: promise vs. promiseToResolve
      var resolvingFunctions = CreateResolvingFunctions(promiseToResolve);
      try {
        var thenCallResult = then.call(thenable, resolvingFunctions['[[Resolve]]'],
                                       resolvingFunctions['[[Reject]]']);
      } catch (thenCallResult) {
        var status = resolvingFunctions['[[Reject]]'].call(undefined, thenCallResult);
        NextJob(status); return;
      }
      NextJob(thenCallResult);
    }

    // 25.4.3 The Promise Constructor

    // 25.4.3.1 Promise ( executor )

    function Promise(executor) {
      var config = { configurable: false, enumerable: false, writable: true, value: undefined };
      Object.defineProperty(this, '[[PromiseState]]', config);
      Object.defineProperty(this, '[[PromiseConstructor]]', config);
      Object.defineProperty(this, '[[PromiseResult]]', config);
      Object.defineProperty(this, '[[PromiseFulfillReactions]]', config);
      Object.defineProperty(this, '[[PromiseRejectReactions]]', config);

      var promise = this;
      if (Type(promise) !== 'object') throw new TypeError();
      if (!('[[PromiseState]]' in promise)) throw TypeError();
      if (promise['[[PromiseState]]'] !== undefined) throw TypeError();
      if (!IsCallable(executor)) throw TypeError();

      set_internal(promise, '[[PromiseConstructor]]', Promise);

      return InitializePromise(promise, executor);
    }

    // 25.4.3.1.1 InitializePromise ( promise, executor )

    function InitializePromise(promise, executor) {
      console.assert('[[PromiseState]]' in promise);
      console.assert(IsCallable(executor));
      set_internal(promise, '[[PromiseState]]', 'pending');
      set_internal(promise, '[[PromiseFulfillReactions]]', []);
      set_internal(promise, '[[PromiseRejectReactions]]', []);
      var resolvingFunctions = CreateResolvingFunctions(promise);
      try {
        var completion = executor.call(undefined, resolvingFunctions['[[Resolve]]'],
                                       resolvingFunctions['[[Reject]]']);
      } catch (completion) {
        var status = resolvingFunctions['[[Reject]]'].call(undefined, completion);
      }
      return promise;
    }

    // 25.4.4 Properties of the Promise Constructor
    // 25.4.4.1 Promise.all ( iterable )

    define(Promise, 'all', function all(iterable) {
      var c = strict(this);
      var promiseCapability = NewPromiseCapability(c);
      try {
        var iterator = GetIterator(iterable);
      } catch (value) {
        promiseCapability['[[Reject]]'].call(undefined, value);
        return promiseCapability['[[Promise]]'];
      }
      var values = [];
      var remainingElementsCount = { value: 1 };
      var index = 0;
      while (true) {
        try {
          var next = IteratorStep(iterator);
        } catch (value) {
          promiseCapability['[[Reject]]'].call(undefined, value);
          return promiseCapability['[[Promise]]'];
        }
        if (!next) {
          remainingElementsCount.value -= 1;
          if (remainingElementsCount.value === 0) {
            var resolveResult = promiseCapability['[[Resolve]]'].apply(undefined, values);


          }
          return promiseCapability['[[Promise]]'];
        }
        try {
          var nextValue = IteratorValue(next);
        } catch (value) {
          promiseCapability['[[Reject]]'].call(undefined, value);
          return promiseCapability['[[Promise]]'];
        }
        try {
          var nextPromise = c.resolve(nextValue);
        } catch (value) {
          promiseCapability['[[Reject]]'].call(undefined, value);
          return promiseCapability['[[Promise]]'];
        }
        var resolveElement = PromiseAllResolveElementFunction();
        set_internal(resolveElement, '[[AlreadyCalled]]', { value: false });
        set_internal(resolveElement, '[[Index]]', index);
        set_internal(resolveElement, '[[Values]]', values);
        set_internal(resolveElement, '[[Capabilities]]', promiseCapability);
        set_internal(resolveElement, '[[RemainingElements]]', remainingElementsCount);
        remainingElementsCount.value += 1;
        try {
          var result = nextPromise.then(resolveElement, promiseCapability['[[Reject]]']);
        } catch (value) {
          promiseCapability['[[Reject]]'].call(undefined, value);
          return promiseCapability['[[Promise]]'];
        }
        index += 1;
      }
    });

    // 25.4.4.1.1 Promise.all Resolve Element Functions

    function PromiseAllResolveElementFunction() {
      var F = function(x) {
        var alreadyCalled = F['[[AlreadyCalled]]'];
        if (alreadyCalled.value) return undefined;
        alreadyCalled.value = true;
        var index = F['[[Index]]'];
        var values = F['[[Values]]'];
        var promiseCapability = F['[[Capabilities]]'];
        var remainingElementsCount = F['[[RemainingElements]]'];
        try {
          values[index] = x;
        } catch (result) {
          promiseCapability['[[Reject]]'].call(undefined, result);
          return promiseCapability['[[Promise]]'];
        }
        remainingElementsCount.value -= 1;
        if (remainingElementsCount.value === 0)
          return promiseCapability['[[Resolve]]'].call(undefined, values);
        return undefined;
      };
      return F;
    }

    // 25.4.4.2 Promise.prototype

    Promise.prototype = {};

    // 25.4.4.3 Promise.race ( iterable )

    define(Promise, 'race', function race(iterable) {
      var c = strict(this);
      var promiseCapability = NewPromiseCapability(c);
      try {
        var iterator = GetIterator(iterable);
      } catch (value) {
        promiseCapability['[[Reject]]'].call(undefined, value);
        return promiseCapability['[[Promise]]'];
      }
      while (true) {
        try {
          var next = IteratorStep(iterator);
        } catch (value) {
          promiseCapability['[[Reject]]'].call(undefined, value);
          return promiseCapability['[[Promise]]'];
        }
        if (!next) return promiseCapability['[[Promise]]'];
        try {
          var nextValue = IteratorValue(next);
        } catch (value) {
          promiseCapability['[[Reject]]'].call(undefined, value);
          return promiseCapability['[[Promise]]'];
        }
        try {
          var nextPromise = c.resolve(nextValue);
        } catch (value) {
          promiseCapability['[[Reject]]'].call(undefined, value);
          return promiseCapability['[[Promise]]'];
        }
        try {
          nextPromise.then(promiseCapability['[[Resolve]]'], promiseCapability['[[Reject]]']);
        } catch (value) {
          promiseCapability['[[Reject]]'].call(undefined, value);
          return promiseCapability['[[Promise]]'];
        }
      }
    });

    // 25.4.4.4 Promise.reject ( r )

    define(Promise, 'reject', function reject(r) {
      var c = strict(this);
      var promiseCapability = NewPromiseCapability(c);
      var rejectResult = promiseCapability['[[Reject]]'].call(undefined, r);
      return promiseCapability['[[Promise]]'];
    });

    // 25.4.4.5 Promise.resolve ( x )

    define(Promise, 'resolve', function resolve(x) {
      var c = strict(this);
      if (IsPromise(x)) {
        var constructor = x['[[PromiseConstructor]]'];
        if (SameValue(constructor, c)) return x;
      }
      var promiseCapability = NewPromiseCapability(c);
      var resolveResult = promiseCapability['[[Resolve]]'].call(undefined, x);
      return promiseCapability['[[Promise]]'];
    });

    // 25.4.4.6 Promise [ @@create ] ( )
    // 25.4.4.6.1 AllocatePromise ( constructor )
    // 25.4.5 Properties of the Promise Prototype Object
    // 25.4.5.1 Promise.prototype.catch ( onRejected )

    define(Promise.prototype, 'catch', function catch_(onRejected) {
      var promise = this;
      return promise.then(undefined, onRejected);
    });

    // 25.4.5.2 Promise.prototype.constructor

    Promise.prototype.constructor = Promise;

    // 25.4.5.3 Promise.prototype.then ( onFulfilled , onRejected )

    define(Promise.prototype, 'then', function then(onFulfilled, onRejected) {
      var promise = this;
      if (!IsPromise(promise)) throw TypeError();
      if (!IsCallable(onFulfilled)) onFulfilled = 'Identity';
      if (!IsCallable(onRejected)) onRejected = 'Thrower';
      var c = promise.constructor;
      var promiseCapability = NewPromiseCapability(c);
      var fulfillReaction = { '[[Capabilities]]': promiseCapability,
                              '[[Handler]]': onFulfilled };
      var rejectReaction = { '[[Capabilities]]': promiseCapability,
                             '[[Handler]]': onRejected };
      if (promise['[[PromiseState]]'] === 'pending') {
        promise['[[PromiseFulfillReactions]]'].push(fulfillReaction);
        promise['[[PromiseRejectReactions]]'].push(rejectReaction);
      } else if (promise['[[PromiseState]]'] === 'fulfilled') {
        var value = promise['[[PromiseResult]]'];
        EnqueueJob('PromiseJobs', PromiseReactionJob, [fulfillReaction, value]);
      } else if (promise['[[PromiseState]]'] === 'rejected') {
        var reason = promise['[[PromiseResult]]'];
        EnqueueJob('PromiseJobs', PromiseReactionJob, [rejectReaction, reason]);
      }
      return promiseCapability['[[Promise]]'];
    });

    // 25.4.6 Properties of Promise Instances

    if (!('Promise' in global) || OVERRIDE_NATIVE_FOR_TESTING)
      global.Promise = Promise;

    // Patch early Promise.cast vs. Promise.resolve implementations
    if ('cast' in global.Promise) global.Promise.resolve = global.Promise.cast;
  }());

  // 25.4.5.1 Promise.prototype [ @@toStringTag ]
  define(Promise.prototype, $$toStringTag, 'Promise');

  // ---------------------------------------
  // 26 Reflection
  // ---------------------------------------

  (function() {
    // 26.1 The Reflect Object
    if (!('Reflect' in global) || OVERRIDE_NATIVE_FOR_TESTING)
      global.Reflect = {};

    // 26.1.1 Reflect.apply ( target, thisArgument, argumentsList )
    define(
      Reflect, 'apply',
      function apply(target, thisArgument, argumentsList) {
        if (!IsCallable(target)) throw TypeError();
        return Function.prototype.apply.call(target, thisArgument, argumentsList);
      });

    // 26.1.2 Reflect.construct ( target, argumentsList [, newTarget] )
    define(
      Reflect, 'construct',
      function construct(target, argumentsList) {
        return __cons(target, argumentsList);
      });

    // 26.1.3 Reflect.defineProperty ( target, propertyKey, attributes )
    define(
      Reflect, 'defineProperty',
      function defineProperty(target, propertyKey, attributes) {
        try {
          Object.defineProperty(target, propertyKey, attributes);
          return true;
        } catch (_) {
          return false;
        }
      });

    // 26.1.4 Reflect.deleteProperty ( target, propertyKey )
    define(
      Reflect, 'deleteProperty',
      function deleteProperty(target,name) {
        try {
          delete target[name];
          return !HasOwnProperty(target, name);
        } catch (_) {
          return false;
        }
      });

    // 26.1.5 Reflect.enumerate ( target )
    define(
      Reflect, 'enumerate',
      function enumerate(target) {
        target = ToObject(target);
        var iterator = Enumerate(target);
        return iterator;
      });

    // 26.1.6 Reflect.get ( target, propertyKey [ , receiver ])
    define(
      Reflect, 'get',
      function get(target, name, receiver) {
        target = ToObject(target);
        name = String(name);
        receiver = (receiver === undefined) ? target : ToObject(receiver);
        var desc = getPropertyDescriptor(target, name);
        if (desc && 'get' in desc)
          return Function.prototype.call.call(desc['get'], receiver);
        return target[name];
      });

    // 26.1.7 Reflect.getOwnPropertyDescriptor ( target, propertyKey )
    define(
      Reflect, 'getOwnPropertyDescriptor',
      Object.getOwnPropertyDescriptor);

    // 26.1.8 Reflect.getPrototypeOf ( target )
    define(
      Reflect, 'getPrototypeOf',
      Object.getPrototypeOf);

    // 26.1.9 Reflect.has ( target, propertyKey )
    define(
      Reflect, 'has',
      function has(target,name) {
        return String(name) in ToObject(target);
      });

    // 26.1.10 Reflect.isExtensible (target)
    define(
      Reflect, 'isExtensible',
      Object.isExtensible);

    // 26.1.11 Reflect.ownKeys ( target )
    define(
      Reflect, 'ownKeys',
      function ownKeys(target) {
        var obj = ToObject(target);
        return Object.getOwnPropertyNames(obj);
      });

    // 26.1.12 Reflect.preventExtensions ( target )
    define(
      Reflect, 'preventExtensions',
      function preventExtensions(target) {
        try { Object.preventExtensions(target); return true; } catch (_) { return false; }
      });

    // 26.1.13 Reflect.set ( target, propertyKey, V [ , receiver ] )
    define(
      Reflect, 'set',
      function set(target, name, value, receiver) {
        target = ToObject(target);
        name = String(name);
        receiver = (receiver === undefined) ? target : ToObject(receiver);
        var desc = getPropertyDescriptor(target, name);
        try {
          if (desc && 'set' in desc)
            Function.prototype.call.call(desc['set'], receiver, value);
          else
            target[name] = value;
          return true;
        } catch (_) {
          return false;
        }
      });

    // 26.1.14 Reflect.setPrototypeOf ( target, proto )
    define(
      Reflect, 'setPrototypeOf',
      function setPrototypeOf(target, proto) {
        try {
          target.__proto__ = proto;
          return Reflect.getPrototypeOf(target) === proto;
        } catch(_) {
          return false;
        }
      });

  }());

  // ---------------------------------------
  // 26.2 Proxy Objects
  // ---------------------------------------

  // Not polyfillable.

}(self));

// This helper is defined outside the main scope so that the use of
// 'eval' does not taint the scope for minifiers.
function __cons(t, a) {
  return eval('new t(' + a.map(function(_, i) { return 'a[' + i + ']'; }).join(',') + ')');
}

},{}],12:[function(require,module,exports){
"use strict";

require("./shim/array");
require("./shim/object");

},{"./shim/array":13,"./shim/object":14}],13:[function(require,module,exports){
'use strict';

// https://tc39.github.io/ecma262/#sec-array.prototype.includes
if (!Array.prototype.includes) {
  Object.defineProperty(Array.prototype, 'includes', {
    value: function value(searchElement, fromIndex) {
      return this.indexOf(searchElement, fromIndex) !== -1;
    }
  });
}

},{}],14:[function(require,module,exports){
"use strict";

//https://tc39.es/proposal-object-values-entries/
//https://github.com/tc39/proposal-object-values-entries
if (!Object.entries) {
  Object.entries = function (obj) {
    var ownProps = Object.keys(obj),
        i = ownProps.length,
        resArray = new Array(i); // preallocate the Array
    while (i--) {
      resArray[i] = [ownProps[i], obj[ownProps[i]]];
    }

    return resArray;
  };
}

},{}],15:[function(require,module,exports){
'use strict';

var rh = require("./rh");
var consts = rh.consts;

consts('RHMAPID', 'rhmapid');
consts('RH_FULL_LAYOUT_PARAM', 'rhfulllayout');

consts('EVT_TOPIC_WIDGET_LOADED', '.e.topic_widget_loaded');
consts('EVT_CLOSE_SEARCH_SUGGESTION', '.e.close_search_suggestion');

consts('KEY_TOC_BREADCRUMBS', '.p.toc_breadcrumbs');
consts('KEY_TOC_SELECT_ITEM', '.p.toc_select_item');
consts('KEY_TOC_BACK_BUTTON_PRESSED', '.p.toc_back_pressed_button');
consts('KEY_SHOW_TOC_BACK_BUTTON', '.p.show_toc_back_button');

consts('KEY_TOC_ORDER', '.p.toc_order');
consts('KEY_TOC_CHILD_ORDER', '.p.toc_child_order');
//Search specific
consts('SEARCH_MAP_ADDR', "whxdata/search_auto_map_0.js");
consts('SEARCH_MAP_ADDR_OLD', "whxdata/searchAuto_Map_0.js");
consts('SEARCH_MODEL_ADDR', "whxdata/search_auto_model_");
consts('SEARCH_MODEL_ADDR_OLD', "whxdata/searchAuto_Model_");
consts('SEARCH_INDEX_DATA', ".l.search_index_data");
consts('SEARCH_INDEX_FILE', "whxdata/search_auto_index.js");
consts('SEARCH_INDEX_FILE_OLD', "whxdata/searchAuto_Index.js");
consts('SEARCH_DB_FILE', "whxdata/search_db.js");
consts('SEARCH_METADATA_FILE', "whxdata/search_topics.js");
consts('SEARCH_TEXT_FILE', "whxdata/text");
consts('SEARCH_TINY_SEGMENTER', "whxdata/languages/tinysegmenter.js");
consts('SEARCH_STEMMER_SUPPORT', "whxdata/languages/stemmer.js");
consts('SEARCH_LNG_SUPPORT', "whxdata/languages/lng_support.js");

consts('SEARCH_MODEL_KEY', '.l.search_model.');
consts('SEARCH_MAP_KEY', '.l.search_map.');
consts('SEARCH_MAX_TOPICS', 20);
consts('SEARCH_RESULTS_KEY', 'search_results');
consts('STOP_NAVIGATE_TO_TOPIC', '.l.stoptopicnav');
consts('SEARCH_WORDS_MAP', '.l.search_words_map');
consts("MAX_SEARCH_INPUT", 3);
consts("KEY_BREADCRUMBS", '.l.breadcrumbs');
consts('HASH_HOMEPAGE_MODE', 'homepage');
consts('KEY_VIEW_MODE', '.l.mode');
consts('HELP_LAYOUT_MODE', 'layout');
consts('HELP_SEARCH_MODE', 'search');
consts('HELP_TOPIC_MODE', 'topic');
consts('PREV_SEARCH_KEY', 'data-prev-search');
consts('KEY_SUBSTR_SEARCH', '.substr_search');
consts('KEY_SHOW_CONTEXT', '.show_srxh_ctxt');

/* favorites constants */
consts('FAVATTRIBUTE', 'data-favwidget');
consts('FAVBUTTON', 'fav-button');
consts('FAVLIST', 'fav-list');
consts('FAVSTORAGE', 'fav-store');

consts('FAVLINKCLASS', 'favorite');
consts('UNFAVLINKCLASS', 'unfavorite');
consts('FAVTABLECLASS', 'favoritesholder');
consts('FAVTABLETITLECLASS', 'favorite');
consts('FAVTABLEREMOVECLASS', 'removelink');
consts('FAVLISTINTROCLASS', 'favoritesintro');
consts('FAVLISTTABLEINTROCLASS', 'favoritestableintro');
consts('EVENTFAVCHANGE', 'favorite-changed-in-script');
consts('TOPIC_FAVORITE', '.l.topic_favorite');
consts('KEY_FAVORITES', '.l.favorites');
consts('FAVORITES_BUTTON_TITLE', '.l.favorites_title');
consts('KEY_GLOSSARY_RESULT', '.p.glossary_search_result');
consts('KEY_GLOSSARY_RESULT_TERM', '.p.glossary_search_term');

consts('EVT_WINDOW_LOADED', '.e.win_loaded');

consts('KEY_SHOW_SCROLL_TO_TOP', '.l.show_scroll_to_top');
consts('KEY_DO_NOT_PRESERVE_AR', '.l.do_not_preserve_ar');
consts('KEY_LNG_NAME', '.p.lng_name');
consts('SHOW_MODAL', '.l.show_modal');
consts('SHOW_MODAL_IN_TOPIC', '.l.show_modal_in_topic');

consts('KEY_HEADER_LOGO_PATH', '.l.header.logo');
consts('KEY_HEADER_TITLE', '.l.header.title');
consts('KEY_HEADER_TITLE_COLOR', '.l.header.title_color');
consts('KEY_HEADER_BACKGROUND_COLOR', '.l.header.background_color');
consts('KEY_LAYOUT_FONT_FAMILY', '.l.layout.font_family');
consts('KEY_HEADER_HTML', '.l.header.html');
consts('KEY_HEADER_CSS', '.l.header.css');
consts('KEY_HEADER_DEFAULT_BACKGROUND_COLOR', '.l.header.default_background_color');
consts('KEY_HEADER_DEFAULT_TITLE_COLOR', '.l.header.default_title_color');
consts('KEY_LAYOUT_DEFAULT_FONT_FAMILY', '.l.layout.default_font_family');

consts('KEY_CUSTOM_BUTTONS', '.l.custom_buttons');
consts('KEY_CUSTOM_BUTTONS_CONFIG', '.l.custom_buttons_config');
consts('KEY_SEARCH_HIGHLIGHT_COLOR', '.l.search_result.highlight_color');
consts('KEY_SEARCH_BG_COLOR', '.l.search_result.highlight_bccolor');
consts('TOPIC_HIGHLIGHTED', '.l.search_result.topic_highlighted');
consts('EVT_REMOVE_HIGHLIGHT', '.e.remove_highlight');

consts('EVT_EXPAND_COLLAPSE_ALL', '.e.expand_collapse_all');
consts('EVT_EXPAND_ALL', '.e.expand_all');
consts('EVT_COLLAPSE_ALL', '.e.collapse_all');
consts('ALL_ARE_EXPANDED', '.l.all_are_expanded');
consts('KEY_CLASSIC_OUTPUT', '.p.classic_output');

},{"./rh":16}],16:[function(require,module,exports){
(function (global){
'use strict';

require('../frameworks/shim');
require('js-polyfills/es5');
require('js-polyfills/es6');

if (global.rh === undefined) {
  global.rh = {};
}

module.exports = global.rh;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"../frameworks/shim":12,"js-polyfills/es5":10,"js-polyfills/es6":11}],17:[function(require,module,exports){
"use strict";

require("../lib/rh");
require("../../lenient_src/utils/shim");
require("../../lenient_src/robohelp/common/rh_consts");
require("../../lenient_src/robohelp/common/tag_expression_utils");
require("../../lenient_src/robohelp/common/hook_click");
require("../../lenient_src/robohelp/common/content_filter");
require("../../lenient_src/robohelp/common/ed_widgets");
require("../../lenient_src/robohelp/common/ed_widget_configs");
require("../../lenient_src/robohelp/common/url_utils");
require("../../lenient_src/robohelp/common/tag_expression_utils");
require("../../lenient_src/robohelp/common/hook_click");
require("../../lenient_src/robohelp/common/content_filter");
require("../../lenient_src/robohelp/common/ed_widgets");
require("../../lenient_src/robohelp/common/ed_widget_configs");
require("../lib/consts");
require("../../lenient_src/robohelp/common/url_utils");
require("./utils/home_utils");
require("./utils/url_utils");
require("./utils/io_utils");
require("./utils/html_resolver");
require("./utils/iframe_utils");
require("./layout/data_attrs/popup_image");
require("./layout/data_attrs/focusif");
require("./common/init");

},{"../../lenient_src/robohelp/common/content_filter":2,"../../lenient_src/robohelp/common/ed_widget_configs":3,"../../lenient_src/robohelp/common/ed_widgets":4,"../../lenient_src/robohelp/common/hook_click":5,"../../lenient_src/robohelp/common/rh_consts":6,"../../lenient_src/robohelp/common/tag_expression_utils":7,"../../lenient_src/robohelp/common/url_utils":8,"../../lenient_src/utils/shim":9,"../lib/consts":15,"../lib/rh":16,"./common/init":18,"./layout/data_attrs/focusif":19,"./layout/data_attrs/popup_image":20,"./utils/home_utils":21,"./utils/html_resolver":22,"./utils/iframe_utils":23,"./utils/io_utils":24,"./utils/url_utils":26}],18:[function(require,module,exports){
'use strict';

var rh = require("../../lib/rh");
var consts = rh.consts;
var $ = rh.$;
var model = rh.model;

model.subscribe(consts('EVT_PROJECT_LOADED'), function () {
  var $html = $('html', 0);
  var lang = model.get(consts('KEY_LNG_NAME'));
  if ($html && lang && lang !== '') {
    $.setAttribute($html, 'lang', lang);
  }
});

model.subscribe(consts('KEY_AND_SEARCH'), function (value) {
  return value === '' && model.publish(consts('KEY_AND_SEARCH'), '1');
});

},{"../../lib/rh":16}],19:[function(require,module,exports){
"use strict";

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var rh = require("../../../lib/rh");

var Focusif = function Focusif(widget, node, rawExpr) {
  _classCallCheck(this, Focusif);

  widget.subscribeDataExpr(rawExpr, function (result) {
    if (result) {
      node.focus();
    }
  });
};

rh.registerDataAttr('focusif', Focusif);

},{"../../../lib/rh":16}],20:[function(require,module,exports){
"use strict";

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var rh = require("../../../lib/rh");
var _ = rh._;
var $ = rh.$;
var HtmlResolver = require("../../utils/html_resolver");
var nodeUtils = require("../../utils/node_utils");

var PopupImage = function () {
  function PopupImage(widget, node, rawExpr) {
    _classCallCheck(this, PopupImage);

    $.addClass(node, "popup-image-thumbnail");
    this.node = node;
    rh.model.csubscribe('EVT_PROJECT_LOADED', this._addEnlargeButton.bind(this));
    this.rawExpr = rawExpr;
    _.addEventListener(node, "click", this._getClickFn.bind(this));
  }

  _createClass(PopupImage, [{
    key: "_content",
    value: function _content(rawExpr) {
      var nodes = [];
      var imgNode = $.createElement('img');
      $.setAttribute(imgNode, 'src', rawExpr);
      nodes.push(imgNode);

      if ($.hasAttribute(this.node, "usemap")) {
        var mapId = $.getAttribute(this.node, "usemap");
        $.setAttribute(imgNode, 'usemap', mapId);
        nodes.push($(mapId, 0));
      }

      var html_resolver = new HtmlResolver();
      var isInIFrame = _.isIframe();
      if (isInIFrame) {
        return { content: html_resolver.resolve(_.map(nodes, function (node) {
            return nodeUtils.outerHTML(node);
          }).join(' ')), showInTopic: !isInIFrame };
      }
      return { content: _.map(nodes, function (node) {
          return nodeUtils.outerHTML(node);
        }).join(' '), showInTopic: !isInIFrame };
    }
  }, {
    key: "_getClickFn",
    value: function _getClickFn() {
      var _content2 = this._content(this.rawExpr),
          content = _content2.content,
          showInTopic = _content2.showInTopic;

      if (!showInTopic) {
        rh.model.cpublish('SHOW_MODAL', { content: content, isImage: true });
      } else {
        rh.model.cpublish('SHOW_MODAL_IN_TOPIC', { content: content, isImage: true });
      }
    }
  }, {
    key: "_addEnlargeButton",
    value: function _addEnlargeButton() {

      var img = $.createElement('img', this.node);
      $.setAttribute(img, "src", this.expandImagePath);
      $.addClass(img, "rh-expand-icon");
      nodeUtils.insertAfter(this.node, img);
      _.addEventListener(img, "click", this._getClickFn.bind(this));
    }
  }, {
    key: "expandImagePath",
    get: function get() {
      var html_resolver = new HtmlResolver();
      var fullImagePath = html_resolver.makeFullPath('template/images/expand.png', _.getRootUrl());
      return _.makeRelativeUrl(fullImagePath);
    }
  }]);

  return PopupImage;
}();

rh.registerDataAttr('popupimage', PopupImage);

},{"../../../lib/rh":16,"../../utils/html_resolver":22,"../../utils/node_utils":25}],21:[function(require,module,exports){
'use strict';

var rh = require("../../lib/rh");
var _ = rh._;
var consts = rh.consts;

_.goToHome = function (hash_map, params_map) {
  var home_path = consts('HOME_FILEPATH');
  if (home_path) {
    var home_url = _.makeFullUrl(home_path);
    var paramsStr = params_map === undefined ? '' : '?' + _.mapToEncodedString(params_map);
    var hashStr = hash_map === undefined ? '' : '#' + _.mapToEncodedString(hash_map);

    home_url = '' + home_url + paramsStr + hashStr;
    document.location = home_url;
  }
};

_.isHomeUrl = function (url) {
  var home_path = consts('HOME_FILEPATH');
  var rootUrl = _.getRootUrl();
  var relativePath = _.makeRelativePath(url, rootUrl);
  var filePath = _.filePath(relativePath);
  return home_path === filePath;
};

_.compare = function (word1, word2) {
  return word1 === word2 ? 0 : -1;
};

},{"../../lib/rh":16}],22:[function(require,module,exports){
"use strict";

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var rh = require("../../lib/rh");
var $ = rh.$;
var _ = rh._;
var nodeUtils = require("./node_utils");
var util = {
  scheme: function scheme(url) {
    var index = void 0,
        scheme = void 0;
    index = url.indexOf(':');
    if (index !== -1) {
      scheme = url.substring(0, index + 1).toLowerCase().trim();
    }
    return scheme;
  }
};

var HtmlResolver = function () {
  _createClass(HtmlResolver, [{
    key: "paths",
    get: function get() {
      return ['src', 'href'];
    }
  }, {
    key: "links",
    get: function get() {
      return ['href'];
    }
  }]);

  function HtmlResolver() {
    _classCallCheck(this, HtmlResolver);
  }

  _createClass(HtmlResolver, [{
    key: "resolve",
    value: function resolve(html) {
      var _this = this;

      var nodes = nodeUtils.toHtmlNode(html);
      _.each(nodes, function (node) {
        if (nodeUtils.isElementNode(node)) {
          $.traverseNode(node, function (node) {
            return _this.resolveNode(node);
          });
        }
      });
      return _.reduce(nodes, function (result, node) {
        result += nodeUtils.outerHTML(node);
        return result;
      }, '');
    }
  }, {
    key: "resolveNode",
    value: function resolveNode(node) {
      var _this2 = this;

      _.each(this.paths, function (attribute) {
        return _this2.resovePaths(node, attribute);
      });
      _.each(this.links, function (attribute) {
        return _this2.resoveLinks(node, attribute);
      });
      return true;
    }
  }, {
    key: "resovePaths",
    value: function resovePaths(node, attribute) {
      if (!$.hasAttribute(node, attribute)) {
        return;
      }
      var value = $.getAttribute(node, attribute);
      $.setAttribute(node, attribute, this.resovePath(value));
    }
  }, {
    key: "resoveLinks",
    value: function resoveLinks(node, attribute) {
      if (!$.hasAttribute(node, attribute)) {
        return;
      }
      $.setAttribute(node, "data-click", "@close(true)");
    }
  }, {
    key: "resovePath",
    value: function resovePath(path) {
      if (!_.isRelativeUrl(path)) {
        return path;
      }
      var baseUrl = _.getRootUrl();
      var fullUrl = _.makeFullUrl(path);
      return _.makeRelativeUrl(fullUrl, baseUrl);
    }
  }, {
    key: "makeFullPath",
    value: function makeFullPath(relUrl, baseUrl) {
      if (!this.isRelativeUrl(relUrl) || this.isRelativeUrl(baseUrl)) {
        return relUrl;
      }
      var baseParts = this.filePath(baseUrl).split('/'),
          relPath = this.filePath(relUrl),
          params = relUrl.substring(relPath.length),
          relParts = relPath.split('/');

      if (relParts.length > 1 || relParts[0]) {
        baseParts.pop();
        _.each(relParts, function (relPart) {
          if (relPart === '..') {
            baseParts.pop();
          } else if (relPart !== '.') {
            baseParts.push(relPart);
          }
        });
      }

      return "" + baseParts.join('/') + params;
    }
  }, {
    key: "isRelativeUrl",
    value: function isRelativeUrl(url) {
      return !url || !util.scheme(url) && url.trim().indexOf('/');
    }
  }, {
    key: "filePath",
    value: function filePath(url) {
      var index = void 0;
      url = url || '';
      index = url.indexOf('?');
      if (index !== -1) {
        url = url.substring(0, index);
      }
      index = url.indexOf('#');
      if (index !== -1) {
        url = url.substring(0, index);
      }
      return url;
    }
  }]);

  return HtmlResolver;
}();

module.exports = HtmlResolver;

},{"../../lib/rh":16,"./node_utils":25}],23:[function(require,module,exports){
'use strict';

var rh = require('../../lib/rh'),
    _ = rh._,
    $ = rh.$;

_.resetIframeSize = function (selector) {
  var iframe = $(selector, 0);
  return iframe;
};

},{"../../lib/rh":16}],24:[function(require,module,exports){
"use strict";

var rh = require("../../lib/rh");
var _ = rh._;
var keyHash = {
  8: "backspace",
  13: "return",
  27: "escape",
  38: "down",
  40: "up",
  39: "right"
};

_.getKeyIndex = function (keyCode) {
  if (keyHash[keyCode]) {
    return keyHash[keyCode];
  } else {
    return "default";
  }
};

},{"../../lib/rh":16}],25:[function(require,module,exports){
'use strict';

var rh = require("../../lib/rh");
var $ = rh.$;
module.exports = {

  nodeType: {
    ELEMENT_NODE: 1,
    ATTRIBUTE_NODE: 2,
    TEXT_NODE: 3,
    CDATA_SECTION_NODE: 4,
    ENTITY_REFERENCE_NODE: 5,
    ENTITY_NODE: 6,
    PROCESSING_INSTRUCTION_NODE: 7,
    COMMENT_NODE: 8,
    DOCUMENT_NODE: 9,
    DOCUMENT_TYPE_NODE: 10,
    DOCUMENT_FRAGMENT_NODE: 11,
    NOTATION_NODE: 12
  },

  removeChild: function removeChild(node) {
    var parent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.parentNode(node);

    return parent && parent.removeChild && parent.removeChild(node);
  },
  appendChild: function appendChild(parent, newNode) {
    return parent && parent.appendChild && parent.appendChild(newNode);
  },
  parentNode: function parentNode(node) {
    return node && node.parentNode;
  },
  childNodes: function childNodes(node) {
    return node && node.childNodes || [];
  },
  toHtmlNode: function toHtmlNode(html) {
    return this.childNodes($.createElement('div', html));
  },
  outerHTML: function outerHTML(node) {
    return node && node.outerHTML || '';
  },
  insertAfter: function insertAfter(node, newNode) {
    return node.parentNode.insertBefore(newNode, node.nextSibling);
  },
  value: function value(node) {
    return node && node.nodeValue;
  },
  name: function name(node) {
    return node && node.nodeName;
  },
  type: function type(node) {
    return node && node.nodeType;
  },
  isElementNode: function isElementNode(node) {
    return this.type(node) === this.nodeType.ELEMENT_NODE;
  },
  isTextNode: function isTextNode(node) {
    return this.type(node) === this.nodeType.TEXT_NODE;
  }
};

},{"../../lib/rh":16}],26:[function(require,module,exports){
'use strict';

var rh = require("../../lib/rh");
var _ = rh._;

_.addParam = function (url, key, value) {
  var hashStr = _.extractHashString(url);
  var paramsStr = _.extractParamString(url);
  var paramsMap = _.urlParams(paramsStr);
  paramsMap[key] = value;
  var strippedUrl = _.stripBookmark(url);
  strippedUrl = _.stripParam(strippedUrl);

  var urlHashStr = hashStr === '' ? hashStr : '#' + hashStr;

  var updatedParamsStr = rh._.mapToEncodedString(paramsMap);
  var urlParamsStr = updatedParamsStr === '' ? updatedParamsStr : '?' + updatedParamsStr;
  return strippedUrl + urlParamsStr + urlHashStr;
};

_.removeParam = function (url, param) {
  var hashStr = _.extractHashString(url);
  var paramsStr = _.extractParamString(url);
  var paramsMap = _.urlParams(paramsStr);
  paramsMap[param] = null;
  var strippedUrl = _.stripBookmark(url);
  strippedUrl = _.stripParam(strippedUrl);

  var urlHashStr = hashStr === '' ? hashStr : '#' + hashStr;

  var updatedParamsStr = rh._.mapToEncodedString(paramsMap);
  var urlParamsStr = updatedParamsStr === '' ? updatedParamsStr : '?' + updatedParamsStr;
  return strippedUrl + urlParamsStr + urlHashStr;
};

_.createHashedUrl = function (url) {
  //let hashedUrl = url
  var relUrl = void 0,
      params = void 0;
  if (!_.isRootUrl(url)) {
    var rootUrl = _.getRootUrl();
    if (_.isExternalUrl(url)) {
      relUrl = url;
    } else {
      params = _.getParamsForRoot(url, true);
      relUrl = _.fixRelativeUrl(_.makeRelativePath(url, rootUrl));
      url = '' + rootUrl + params + '#t=' + encodeURIComponent(relUrl);
    }
  }
  return url;
};

_.getOrigin = function (srcWindow) {
  return _.isLocal() || !srcWindow ? '*' : srcWindow.location.origin;
};

},{"../../lib/rh":16}]},{},[17])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJsZW5pZW50X3NyYy9jb21tb24vbm9kZXMuanMiLCJsZW5pZW50X3NyYy9yb2JvaGVscC9jb21tb24vY29udGVudF9maWx0ZXIuanMiLCJsZW5pZW50X3NyYy9yb2JvaGVscC9jb21tb24vZWRfd2lkZ2V0X2NvbmZpZ3MuanMiLCJsZW5pZW50X3NyYy9yb2JvaGVscC9jb21tb24vZWRfd2lkZ2V0cy5qcyIsImxlbmllbnRfc3JjL3JvYm9oZWxwL2NvbW1vbi9ob29rX2NsaWNrLmpzIiwibGVuaWVudF9zcmMvcm9ib2hlbHAvY29tbW9uL3JoX2NvbnN0cy5qcyIsImxlbmllbnRfc3JjL3JvYm9oZWxwL2NvbW1vbi90YWdfZXhwcmVzc2lvbl91dGlscy5qcyIsImxlbmllbnRfc3JjL3JvYm9oZWxwL2NvbW1vbi91cmxfdXRpbHMuanMiLCJsZW5pZW50X3NyYy91dGlscy9zaGltLmpzIiwibm9kZV9tb2R1bGVzL2pzLXBvbHlmaWxscy9lczUuanMiLCJub2RlX21vZHVsZXMvanMtcG9seWZpbGxzL2VzNi5qcyIsInNyYy9mcmFtZXdvcmtzL3NoaW0uanMiLCJzcmMvZnJhbWV3b3Jrcy9zaGltL2FycmF5LmpzIiwic3JjL2ZyYW1ld29ya3Mvc2hpbS9vYmplY3QuanMiLCJzcmMvbGliL2NvbnN0cy5qcyIsInNyYy9saWIvcmguanMiLCJzcmMvcmVzcG9uc2l2ZV9oZWxwL2NvbW1vbi5qcyIsInNyYy9yZXNwb25zaXZlX2hlbHAvY29tbW9uL2luaXQuanMiLCJzcmMvcmVzcG9uc2l2ZV9oZWxwL2xheW91dC9kYXRhX2F0dHJzL2ZvY3VzaWYuanMiLCJzcmMvcmVzcG9uc2l2ZV9oZWxwL2xheW91dC9kYXRhX2F0dHJzL3BvcHVwX2ltYWdlLmpzIiwic3JjL3Jlc3BvbnNpdmVfaGVscC91dGlscy9ob21lX3V0aWxzLmpzIiwic3JjL3Jlc3BvbnNpdmVfaGVscC91dGlscy9odG1sX3Jlc29sdmVyLmpzIiwic3JjL3Jlc3BvbnNpdmVfaGVscC91dGlscy9pZnJhbWVfdXRpbHMuanMiLCJzcmMvcmVzcG9uc2l2ZV9oZWxwL3V0aWxzL2lvX3V0aWxzLmpzIiwic3JjL3Jlc3BvbnNpdmVfaGVscC91dGlscy9ub2RlX3V0aWxzLmpzIiwic3JjL3Jlc3BvbnNpdmVfaGVscC91dGlscy91cmxfdXRpbHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Y0NBYSxNO0lBQVAsRSxXQUFBLEU7SUFDQSxDLEdBQU0sRSxDQUFOLEM7SUFDQSxDLEdBQU0sRSxDQUFOLEM7SUFDQSxNLEdBQVcsRSxDQUFYLE07OztBQUVOLElBQU0sZ0JBQWdCLGNBQXRCO0FBQ0EsSUFBTSxrQkFBa0IsUUFBeEI7O0lBRU0sUztBQUNKLHVCQUFjO0FBQUE7O0FBQ1osU0FBSyxTQUFMLEdBQWlCLFNBQWpCO0FBQ0Q7Ozs7K0JBR1UsTSxFQUFRLFEsRUFBVTtBQUMzQixVQUFJLE9BQU8sSUFBWDtBQUQyQjtBQUFBO0FBQUE7O0FBQUE7QUFFM0IsNkJBQWtCLE1BQU0sSUFBTixDQUFXLE9BQU8sUUFBbEIsQ0FBbEIsOEhBQStDO0FBQUEsY0FBdEMsS0FBc0M7O0FBQzdDLGlCQUFPLFFBQVEsU0FBUyxLQUFULENBQWY7QUFDQSxjQUFHLENBQUMsSUFBSixFQUFVO0FBQ1I7QUFDRDtBQUNGO0FBUDBCO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBUTNCLGFBQU8sSUFBUDtBQUNEOzs7aUNBRVksSSxFQUFNO0FBQ2pCLGFBQU8sQ0FBQyxDQUFDLElBQUYsSUFBVSxFQUFFLFlBQUYsQ0FBZSxJQUFmLEVBQXFCLGFBQXJCLENBQWpCO0FBQ0Q7OzsrQkFFVSxJLEVBQU07QUFBQTs7QUFDZixVQUFJLFFBQVEsS0FBWjtBQUNBLFVBQUcsUUFBUSxLQUFLLFlBQUwsQ0FBa0IsSUFBbEIsQ0FBWCxFQUFvQztBQUNsQyxpQkFBUyxLQUFLLFVBQUwsQ0FB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LE9BQU8sU0FBUCxDQUFpQixPQUFqQixJQUE0QixJQUFoQyxFQUFzQztBQUNwQyxTQUFPLFNBQVAsQ0FBaUIsT0FBakIsR0FBMkIsT0FBTyxTQUFQLENBQWlCLFNBQTVDO0FBQ0Q7OztBQzNCRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZlQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNoc0hBLFFBQVEsY0FBUjtBQUNBLFFBQVEsZUFBUjs7Ozs7QUNEQTtBQUNBLElBQUksQ0FBQyxNQUFNLFNBQU4sQ0FBZ0IsUUFBckIsRUFBK0I7QUFDN0IsU0FBTyxjQUFQLENBQXNCLE1BQU0sU0FBNUIsRUFBdUMsVUFBdkMsRUFBbUQ7QUFDakQsV0FBTyxlQUFTLGFBQVQsRUFBd0IsU0FB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SSxtQkFBbUIsR0FBRyxDQUFILENBQUssa0JBQUwsQ0FBd0IsU0FBeEIsQ0FBdkI7QUFDQSxNQUFJLGVBQWdCLHFCQUFxQixFQUF0QixHQUEwQixnQkFBMUIsR0FBNEMsTUFBTSxnQkFBckU7QUFDQSxTQUFPLGNBQWMsWUFBZCxHQUE2QixVQUFwQztBQUNELENBYkQ7O0FBZUEsRUFBRSxlQUFGLEdBQW9CLFVBQUMsR0FBRCxFQUFRO0FBQzFCO0FBQ0EsTUFBSSxlQUFKO0FBQUEsTUFBWSxlQUFaO0FBQ0EsTUFBRyxDQUFDLEVBQUUsU0FBRixDQUFZLEdBQVosQ0FBSixFQUFxQjtBQUNuQixRQUFJLFVBQVUsRUFBRSxVQUFGLEVBQWQ7QUFDQSxRQUFHLEVBQUUsYUFBRixDQUFnQixHQUFoQixDQUFILEVBQXdCO0FBQ3RCLGVBQVMsR0FBVDtBQUNELEtBRkQsTUFHSTtBQUNGLGVBQVMsRUFBRSxnQkFBRixDQUFtQixHQUFuQixFQUF3QixJQUF4QixDQUFUO0FBQ0EsZUFBUyxFQUFFLGNBQUYsQ0FBa0IsRUFBRSxnQkFBRixDQUFvQixHQUFwQixFQUF5QixPQUF6QixDQUFsQixDQUFUO0FBQ0EsaUJBQVMsT0FBVCxHQUFtQixNQUFuQixXQUErQixtQkFBbUIsTUFBbkIsQ0FBL0I7QUFDRDtBQUNGO0FBQ0QsU0FBTyxHQUFQO0FBQ0QsQ0FmRDs7QUFpQkEsRUFBRSxTQUFGLEdBQWMsVUFBQyxTQUFELEVBQWU7QUFDM0IsU0FBTyxFQUFFLE9BQUYsTUFBZSxDQUFDLFNBQWhCLEdBQTRCLEdBQTVCLEdBQWtDLFVBQVUsUUFBVixDQUFtQixNQUE1RDtBQUNELENBRkQiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJsZXQgeyByaCB9ID0gd2luZG93O1xyXG5sZXQgeyBfIH0gPSByaDtcclxubGV0IHsgJCB9ID0gcmg7XHJcbmxldCB7IGNvbnN0cyB9ID0gcmg7XHJcblxyXG5jb25zdCBOT19DSElMRF9BVFRSID0gJ2RhdGEtbm9jaGlsZCdcclxuY29uc3QgTk9fQ0hJTERfSUdOT1JFID0gJ2lnbm9yZSdcclxuXHJcbmNsYXNzIE5vZGVzVXRpbCB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLmNsYXNzTmFtZSA9ICdyaC1oaWRlJ1xyXG4gIH1cclxuXHJcblxyXG4gIGV2ZXJ5Q2hpbGQocGFyZW50LCBjYWxsYmFjaykge1xyXG4gICAgbGV0IGJSZXQgPSB0cnVlO1xyXG4gICAgZm9yIChsZXQgY2hpbGQgb2YgQXJyYXkuZnJvbShwYXJlbnQuY2hpbGRyZW4pKSB7XHJcbiAgICAgIGJSZXQgPSBiUmV0ICYmIGNhbGxiYWNrKGNoaWxkKTtcclxuICAgICAgaWYoIWJSZXQpIHtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGJSZXRcclxuICB9XHJcblxyXG4gIGlzTWFya2VkTm9kZShub2RlKSB7XHJcbiAgICByZXR1cm4gISFub2RlICYmICQuaGFzQXR0cmlidXRlKG5vZGUsIE5PX0NISUxEX0FUVFIpXHJcbiAgfVxyXG5cclxuICBzaG91bGRIaWRlKG5vZGUpIHtcclxuICAgIGxldCBiSGlkZSA9IGZhbHNlXHJcbiAgICBpZihub2RlICYmIHRoaXMuaXNNYXJrZWROb2RlKG5vZGUpKSB7XHJcbiAgICAgIGJIaWRlIHw9IHRoaXMuZXZlcnlDaGlsZChub2RlLCBjaGlsZCA9PiB7XHJcbiAgICAgICAgcmV0dXJuICQuaGFzQ2xhc3MoY2hpbGQsIHRoaXMuY2xhc3NOYW1lKSB8fCAoJC5nZXRBdHRyaWJ1dGUoY2hpbGQsIE5PX0NISUxEX0FUVFIpID09PSBOT19DSElMRF9JR05PUkUpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiBiSGlkZVxyXG4gIH1cclxuXHJcbiAgb25TaG93KG5vZGUsIGRvbnRDaGVja0NoaWRscmVuID0gZmFsc2UpIHtcclxuICAgIGxldCBiU2hvd24gPSBmYWxzZTtcclxuICAgIGlmKG5vZGUgJiYgKGRvbnRDaGVja0NoaWRscmVuIHx8ICF0aGlzLnNob3VsZEhpZGUobm9kZSkpKSB7XHJcbiAgICAgICQucmVtb3ZlQ2xhc3Mobm9kZSwgdGhpcy5jbGFzc05hbWUpO1xyXG4gICAgICBiU2hvd24gPSB0cnVlO1xyXG4gICAgICBub2RlLnBhcmVudE5vZGUgJiYgdGhpcy5pc01hcmtlZE5vZGUobm9kZS5wYXJlbnROb2RlKSAmJiB0aGlzLm9uU2hvdyhub2RlLnBhcmVudE5vZGUsIHRydWUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGJTaG93blxyXG4gIH1cclxuXHJcbiAgb25IaWRlKG5vZGUpIHtcclxuICAgIGlmKCFub2RlKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgICQuYWRkQ2xhc3Mobm9kZSwgdGhpcy5jbGFzc05hbWUpO1xyXG4gICAgaWYodGhpcy5zaG91bGRIaWRlKG5vZGUubmV4dEVsZW1lbnRTaWJsaW5nKSkge1xyXG4gICAgICB0aGlzLm9uSGlkZShub2RlLm5leHRFbGVtZW50U2libGluZyk7XHJcbiAgICB9XHJcbiAgICBpZih0aGlzLnNob3VsZEhpZGUobm9kZS5wYXJlbnROb2RlKSkge1xyXG4gICAgICB0aGlzLm9uSGlkZShub2RlLnBhcmVudE5vZGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBOb2Rlc1V0aWwiLCJsZXQgeyByaCB9ID0gd2luZG93O1xyXG5sZXQgeyBfIH0gPSByaDtcclxubGV0IHsgJCB9ID0gcmg7XHJcbmxldCB7IGNvbnN0cyB9ID0gcmg7XHJcbmltcG9ydCBOb2Rlc1V0aWwgZnJvbSAnLi4vLi4vY29tbW9uL25vZGVzJ1xyXG5cclxucmgubW9kZWwuc3Vic2NyaWJlKGNvbnN0cygnRVZUX1BST0pFQ1RfTE9BREVEJyksICAoKSA9PlxyXG4gIHJoLm1vZGVsLnN1YnNjcmliZShjb25zdHMoJ0tFWV9NRVJHRURfUFJPSkVDVF9NQVAnKSwgZnVuY3Rpb24oKSB7XHJcbiAgICBsZXQgb3JpZ2luID0gXy5nZXRQcm9qZWN0TmFtZShfLmZpbGVQYXRoKCkpO1xyXG4gICAgcmV0dXJuIHJoLm1vZGVsLnB1Ymxpc2goY29uc3RzKCdLRVlfVE9QSUNfT1JJR0lOJyksIG9yaWdpbik7XHJcbiAgfSlcclxuKTtcclxuXHJcbnZhciBDb250ZW50RmlsdGVyID0gKGZ1bmN0aW9uKCkge1xyXG4gIGxldCBub25UZXh0Tm9kZXMgPSB1bmRlZmluZWQsU0VMRUNURURfQ0xBU1M7XHJcbiAgQ29udGVudEZpbHRlciA9IGNsYXNzIENvbnRlbnRGaWx0ZXIgZXh0ZW5kcyByaC5XaWRnZXQge1xyXG4gICAgc3RhdGljIGluaXRDbGFzcygpIHtcclxuICAgICAgU0VMRUNURURfQ0xBU1MgPSAnc2VsZWN0ZWQnXHJcbiAgICAgIG5vblRleHROb2RlcyA9IFsnSU1HJywnT0JKRUNUJywnVklERU8nXTtcclxuICAgIH1cclxuXHJcbiAgICBwcmV2ZW50Q2xpY2soZSkge1xyXG4gICAgICBfLnByZXZlbnREZWZhdWx0KGUpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0b3IoY29uZmlnKSB7XHJcbiAgICAgIHN1cGVyKGNvbmZpZyk7XHJcbiAgICAgIHRoaXMub25UYWdFeHByID0gdGhpcy5vblRhZ0V4cHIuYmluZCh0aGlzKTtcclxuICAgICAgdGhpcy5pZHMgPSBjb25maWcuaWRzO1xyXG4gICAgICB0aGlzLmNsYXNzTmFtZSA9IGNvbmZpZy5jbGFzc05hbWUgfHwgJ3JoLWhpZGUnO1xyXG4gICAgICB0aGlzLm5vZGUgPSBjb25maWcubm9kZTtcclxuICAgICAgdGhpcy5ob3ZlckNsYXNzID0gJ3JoLXRhZy1jb250ZW50LWhvdmVyJztcclxuICAgICAgdGhpcy5zdXBDbGFzcyA9ICdyaC1hcHBsaWVkLXRhZyc7XHJcbiAgICAgIHRoaXMuY3JlYXRlVGFnTm9kZSgpO1xyXG5cclxuICAgICAgaWYgKHRoaXMuaWRzKSB7XHJcbiAgICAgICAgcmgubW9kZWwuc3Vic2NyaWJlKGNvbnN0cygnRVZUX1RPQ19TRUxFQ1RFRF9JVEVNX0NIQU5HRUQnKSwgdGhpcy5vblRhZ0V4cHIpICAgICAgICBcclxuICAgICAgICB0aGlzLnN1YnNjcmliZShjb25zdHMoJ0tFWV9UT1BJQ19PUklHSU4nKSwgKCkgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuc3Vic2NyaWJlKGNvbnN0cygnS0VZX1RBR19FWFBSRVNTSU9OJyksIHRoaXMub25UYWdFeHByKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIGlmIChyaC5fZGVidWcpIHtcclxuICAgICAgICByaC5fZCgnZXJyb3InLCAnZGF0YS10YWdzIHdpdGhvdXQgYW55IHRhZyBjb21iaW5hdGlvbicpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25UYWdFeHByKHRhZ0V4cHJzKSB7XHJcbiAgICAgIGlmICghXy5pc0RlZmluZWQodGFnRXhwcnMpKSB7IFxyXG4gICAgICAgIHRhZ0V4cHJzID0gdGhpcy5nZXQoY29uc3RzKCdLRVlfVEFHX0VYUFJFU1NJT04nKSlcclxuICAgICAgfVxyXG4gICAgICBsZXQgb3JpZ2luID0gdGhpcy5nZXQoY29uc3RzKCdLRVlfVE9QSUNfT1JJR0lOJykpO1xyXG4gICAgICBpZiAoIXRoaXMuZ2V0KCd0YWdzJykpIHtcclxuICAgICAgICB0aGlzLnRhZ3MgPSBfLnVuaW9uKHRoaXMuaWRzLCBpZCA9PiBfLmdldFRhZ3MoaWQsIG9yaWdpbikpO1xyXG4gICAgICAgIHRoaXMucHVibGlzaCgndGFncycsIHRoaXMudGFncy5qb2luKCcsJykpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBsZXQgYXBwbHkgPSAhXy5hbnkodGhpcy5pZHMsIGlkID0+IF8uZXZhbFRhZ0V4cHJlc3Npb24oaWQsIHRhZ0V4cHJzLCBvcmlnaW4pKTtcclxuXHJcbiAgICAgIHRoaXMudG9nZ2xlQ2xhc3MoYXBwbHkpO1xyXG4gICAgICBpZiAodGhpcy5jbGFzc05hbWUgIT09ICdyaC1oaWRlJykgeyB0aGlzLnRvZ2dsZUNsaWNrKGFwcGx5KTsgfVxyXG4gICAgICByZXR1cm4gdGhpcy5hcHBsaWVkID0gYXBwbHk7XHJcbiAgICB9XHJcblxyXG4gICAgdG9nZ2xlQ2xhc3MoYXBwbHkpIHtcclxuICAgICAgaWYgKGFwcGx5KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmFwcGxpZWQpIHsgcmV0dXJuIE5vZGVzVXRpbC5vbkhpZGUodGhpcy5ub2RlKTsgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBOb2Rlc1V0aWwub25TaG93KHRoaXMubm9kZSlcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZUNsaWNrKGFkZEV2ZW50KSB7XHJcbiAgICAgIGlmIChhZGRFdmVudCkge1xyXG4gICAgICAgIGlmICghdGhpcy5hcHBsaWVkKSB7IHJldHVybiBfLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5ub2RlLCAnY2xpY2snLCB0aGlzLnByZXZlbnRDbGljayk7IH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAodGhpcy5hcHBsaWVkKSB7IHJldHVybiBfLnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5ub2RlLCAnY2xpY2snLCB0aGlzLnByZXZlbnRDbGljayk7IH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uSG92ZXIoKSB7XHJcbiAgICAgIHJldHVybiAkLmFkZENsYXNzKHRoaXMubm9kZSwgdGhpcy5ob3ZlckNsYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICBvbk1vdXNlT3V0KCkge1xyXG4gICAgICByZXR1cm4gJC5yZW1vdmVDbGFzcyh0aGlzLm5vZGUsIHRoaXMuaG92ZXJDbGFzcyk7XHJcbiAgICB9XHJcblxyXG4gICAgYXBwZW5kTm9kZShzdXBOb2RlKSB7XHJcbiAgICAgIGxldCBwYXJlbnROb2RlID0gdGhpcy5ub2RlO1xyXG4gICAgICBsZXQgc2libGluZyA9IG51bGw7XHJcbiAgICAgIGlmIChub25UZXh0Tm9kZXMuaW5kZXhPZih0aGlzLm5vZGUubm9kZU5hbWUpICE9PSAtMSkge1xyXG4gICAgICAgICh7IHBhcmVudE5vZGUgfSA9IHRoaXMubm9kZSk7XHJcbiAgICAgICAgc2libGluZyA9IHRoaXMubm9kZS5uZXh0U2libGluZztcclxuICAgICAgfVxyXG4gICAgICBpZiAoc2libGluZykge1xyXG4gICAgICAgIHBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHN1cE5vZGUsIHNpYmxpbmcpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoc3VwTm9kZSk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRoaXMucmVzb2x2ZURhdGFBdHRycyhzdXBOb2RlKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRBcHROYW1lcygpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuc3Vic2NyaWJlKCd0YWdzJywgKCkgPT4ge1xyXG4gICAgICAgIGxldCBkYXRhID0gW107XHJcbiAgICAgICAgXy5lYWNoKHRoaXMudGFncywgKGN1cnJlbnQsIGlkeCkgPT4gZGF0YS5wdXNoKGN1cnJlbnQucmVwbGFjZShcImF0dF9zZXBcIiwgXCI6XCIpKSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucHVibGlzaCgnc2hvd3RhZ3MnLCBkYXRhLmpvaW4oJywnKSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZVRhZ05vZGUoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLnN1YnNjcmliZShjb25zdHMoJ0tFWV9TSE9XX1RBR1MnKSwgIHNob3dUYWdzID0+IHtcclxuICAgICAgICBpZiAoIXNob3dUYWdzIHx8ICgkLmZpbmQodGhpcy5ub2RlLCBgc3VwLiR7dGhpcy5zdXBDbGFzc31gKS5sZW5ndGggPiAwKSkgeyByZXR1cm47IH1cclxuICAgICAgICBsZXQgc3VwTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N1cCcpO1xyXG4gICAgICAgICh0aGlzLmdldEFwdE5hbWVzKSgpO1xyXG4gICAgICAgICQuc2V0QXR0cmlidXRlKHN1cE5vZGUsICdkYXRhLXRleHQnLCAnc2hvd3RhZ3MnKTtcclxuICAgICAgICAkLnNldEF0dHJpYnV0ZShzdXBOb2RlLCAnZGF0YS1tb3VzZW92ZXInLCAndGhpcy5vbkhvdmVyKCknKTtcclxuICAgICAgICAkLnNldEF0dHJpYnV0ZShzdXBOb2RlLCAnZGF0YS1tb3VzZW91dCcsICd0aGlzLm9uTW91c2VPdXQoKScpO1xyXG4gICAgICAgICQuc2V0QXR0cmlidXRlKHN1cE5vZGUsICdjbGFzcycsIHRoaXMuc3VwQ2xhc3MpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGVuZE5vZGUoc3VwTm9kZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcbiAgQ29udGVudEZpbHRlci5pbml0Q2xhc3MoKTtcclxuICByZXR1cm4gQ29udGVudEZpbHRlcjtcclxufSkoKTtcclxuXHJcbndpbmRvdy5yaC53aWRnZXRzLkNvbnRlbnRGaWx0ZXIgPSBDb250ZW50RmlsdGVyO1xyXG4iLCIvKlxyXG4gSGVscCBmb3IgRWR3aWRnZXRcclxuKi9cclxuXHJcbmxldCB7IGVkV2lkZ2V0IH0gPSB3aW5kb3cucmg7XHJcblxyXG4vKlxyXG4gVGFiIGVkd2lkZ2V0XHJcbiovXHJcbmVkV2lkZ2V0KCd0YWInLCB7XHJcbiAgYXR0cnM6IHtcclxuICAgICdkYXRhLXRhYmxlJzogJ2RhdGEnLFxyXG4gICAgJ2RhdGEtcmh3aWRnZXQnOiAnQmFzaWMnLFxyXG4gICAgJ2RhdGEtb3V0cHV0JzogJ2RhdGE6IGVkdy5kYXRhLiN7QGluZGV4fScsXHJcbiAgICBjbGFzczogJ3ByaW50LW9ubHknXHJcbiAgfSxcclxuICB2aWV3OiB7XHJcbiAgICB0YWc6ICdkaXYnLFxyXG4gICAgYXR0cnM6IHtcclxuICAgICAgJ2RhdGEtcmh3aWRnZXQnOiAnQmFzaWM6IGluY2x1ZGU6IGVkd2lkZ2V0cy90YWIvdGFiTGF5b3V0LmpzJyxcclxuICAgICAgJ2RhdGEtaW5wdXQnOiAnZGF0YTogZWR3LmRhdGEuI3tAaW5kZXh9J1xyXG4gICAgfSxcclxuICAgIG1vZGVsOiB7XHJcbiAgICAgIHRhYjogJzAnXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbik7XHJcblxyXG4vKlxyXG4gR2FsbGFyeSBlZHdpZGdldFxyXG4qL1xyXG4vL2VkV2lkZ2V0ICdHYWxsYXJ5JyIsImxldCB7IHJoIH0gPSB3aW5kb3c7XHJcbmxldCB7ICQgfSA9IHJoO1xyXG5sZXQgeyBfIH0gPSByaDtcclxubGV0IHsgY29uc3RzIH0gPSByaDtcclxuXHJcbnZhciBFZHdpZGdldCA9IChmdW5jdGlvbigpIHtcclxuICBsZXQgdmFsdWVTZXBlcmF0b3IgPSB1bmRlZmluZWQ7XHJcbiAgRWR3aWRnZXQgPSBjbGFzcyBFZHdpZGdldCB7XHJcbiAgICBzdGF0aWMgaW5pdENsYXNzKCkge1xyXG4gICAgICB2YWx1ZVNlcGVyYXRvciA9IHtcclxuICAgICAgICAnZGF0YS1yaHdpZGdldCc6ICc7JyxcclxuICAgICAgICBjbGFzczogJyAnXHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0b3Iobm9kZSwgaW5kZXgsIGFyZykge1xyXG4gICAgICB0aGlzLm5vZGUgPSBub2RlO1xyXG4gICAgICB0aGlzLmluZGV4ID0gaW5kZXg7XHJcbiAgICAgIGxldCB7dmlldywgYXR0cnMsIG1vZGVsLCBhcmdNb2RlbH0gPSB0aGlzLnBhcnNlQXJnKGFyZyk7XHJcbiAgICAgIGlmIChhdHRycykgeyB0aGlzLnNldEF0dHJpYnV0ZXModGhpcy5ub2RlLCBhdHRycyk7IH1cclxuICAgICAgaWYgKG1vZGVsKSB7IHRoaXMuc2V0TW9kZWxBcmcodGhpcy5ub2RlLCBfLmV4dGVuZCh7fSwgbW9kZWwsIGFyZ01vZGVsKSk7IH1cclxuICAgICAgaWYgKHZpZXcpIHsgdGhpcy5jcmVhdGVWaWV3KHZpZXcsIGFyZ01vZGVsKTsgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwYXJzZUFyZyhhcmcpIHtcclxuICAgICAgbGV0IGFyZ01vZGVsLCBhdHRycywgY29uZmlnLCBtb2RlbCwgdmlldztcclxuICAgICAgbGV0IHt3TmFtZSwgd0FyZywgcGlwZWRBcmdzfSA9IGFyZztcclxuICAgICAgaWYgKGNvbmZpZyA9IHJoLmVkV2lkZ2V0KHdOYW1lKSkge1xyXG4gICAgICAgIGxldCB2YXJzO1xyXG4gICAgICAgICh7dmlldywgYXR0cnMsIHZhcnMsIG1vZGVsfSA9IGNvbmZpZyk7XHJcbiAgICAgICAgYXJnTW9kZWwgPSBfLnJlc29sdmVOaWNlSlNPTihwaXBlZEFyZ3Muc2hpZnQoKSk7XHJcbiAgICAgICAgdGhpcy52YXJzID0gXy5leHRlbmQoe30sIHZhcnMsIHdBcmcpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB7dmlldywgYXR0cnMsIG1vZGVsLCBhcmdNb2RlbH07XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlVmlldyh2aWV3LCBhcmdNb2RlbCkge1xyXG4gICAgICBsZXQgdmlld01vZGVsID0gXy5leHRlbmQoe30sIHZpZXcubW9kZWwsIGFyZ01vZGVsKTtcclxuICAgICAgbGV0IHZpZXdOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh2aWV3LnRhZyB8fCAnZGl2Jyk7XHJcbiAgICAgIGlmICh2aWV3LmF0dHJzKSB7IHRoaXMuc2V0QXR0cmlidXRlcyh2aWV3Tm9kZSwgdmlldy5hdHRycyk7IH1cclxuICAgICAgdGhpcy5zZXRNb2RlbEFyZyh2aWV3Tm9kZSwgdmlld01vZGVsKTtcclxuICAgICAgcmV0dXJuIHRoaXMubm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh2aWV3Tm9kZSwgdGhpcy5ub2RlKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRBdHRyaWJ1dGVzKG5vZGUsIGF0dHJzKSB7XHJcbiAgICAgIHJldHVybiBfLmVhY2goYXR0cnMsIGZ1bmN0aW9uKHZhbHVlLCBhdHRyKSB7XHJcbiAgICAgICAgcmV0dXJuICQuc2V0QXR0cmlidXRlKG5vZGUsIGF0dHIsIHRoaXMucmVzb2x2ZVZhbHVlKHRoaXMubWVyZ2VkVmFsdWUobm9kZSwgYXR0ciwgdmFsdWUpKSk7XHJcbiAgICAgIH1cclxuICAgICAgLCB0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRNb2RlbEFyZyhub2RlLCBtb2RlbCkge1xyXG4gICAgICBpZiAoIV8uaXNFbXB0eU9iamVjdChtb2RlbCkpIHtcclxuICAgICAgICBsZXQganNvblN0cmluZyA9IHRoaXMucmVzb2x2ZVZhbHVlKEpTT04uc3RyaW5naWZ5KG1vZGVsKSk7XHJcbiAgICAgICAgcmV0dXJuICQuZGF0YXNldChub2RlLCAncmh3aWRnZXQnLFxyXG4gICAgICAgICAgYCR7JC5kYXRhc2V0KG5vZGUsICdyaHdpZGdldCcpIHx8ICdCYXNpYyd9IHwgJHtqc29uU3RyaW5nfWApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbWVyZ2VkVmFsdWUobm9kZSwgYXR0cmliLCB2YWx1ZSkge1xyXG4gICAgICBsZXQgb2xkVmFsdWUsIHNlcGVyYXRvcjtcclxuICAgICAgaWYgKCEoc2VwZXJhdG9yID0gdmFsdWVTZXBlcmF0b3JbYXR0cmliXSkpIHsgcmV0dXJuIHZhbHVlOyB9XHJcbiAgICAgIGlmICgob2xkVmFsdWUgPSAkLmdldEF0dHJpYnV0ZShub2RlLCBhdHRyaWIpIHx8ICcnKSkge1xyXG4gICAgICAgIHJldHVybiBgJHtvbGRWYWx1ZX0ke3NlcGVyYXRvcn0ke3ZhbHVlfWA7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVzb2x2ZVZhbHVlKHZhbHVlKSB7XHJcbiAgICAgIHJldHVybiBfLnJlc29sdmVFbmNsb3NlZFZhcih2YWx1ZSwgdmFyTmFtZSA9PiB7XHJcbiAgICAgICAgc3dpdGNoICh2YXJOYW1lKSB7XHJcbiAgICAgICAgICBjYXNlICd0aGlzJzpcclxuICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMudmFycyk7XHJcbiAgICAgICAgICBjYXNlICdAaW5kZXgnOlxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbmRleDtcclxuICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnZhcnNbdmFyTmFtZV07XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB9XHJcbiAgfTtcclxuICBFZHdpZGdldC5pbml0Q2xhc3MoKTtcclxuICByZXR1cm4gRWR3aWRnZXQ7XHJcbn0pKCk7XHJcblxyXG4vKlxyXG4gIDxkaXYgZGF0YS1lZHdpZGdldD1cIlRhYjogPG5hbWU+OiA8c3RyaW5nIHZhbHVlPiwgPG5hbWU+OiA8c3RyaW5nIHZhbHVlPlxyXG4gICB8IDxqc29uIG9yIG5pY2VKU09OPlwiPjwvZGl2PlxyXG4qL1xyXG5cclxucmgubW9kZWwuc3Vic2NyaWJlKGNvbnN0cygnRVZUX1dJREdFVF9CRUZPUkVMT0FEJyksICgpID0+XHJcbiAgXy5lYWNoKCQuZmluZChkb2N1bWVudCwgJ1tkYXRhLWVkd2lkZ2V0XScpLCBmdW5jdGlvbihub2RlLCBpbmRleCkge1xyXG4gICAgbGV0IGFyZ3MgPSBfLnJlc29sdmVXaWRnZXRBcmdzKCQuZGF0YXNldChub2RlLCAnZWR3aWRnZXQnKSk7XHJcbiAgICBfLmVhY2goYXJncywgYXJnID0+IG5ldyBFZHdpZGdldChub2RlLCBpbmRleCwgYXJnKSk7XHJcbiAgICByZXR1cm4gJC5kYXRhc2V0KG5vZGUsICdlZHdpZGdldCcsIG51bGwpO1xyXG4gIH0pXHJcbik7XHJcblxyXG5yaC5lZFdpZGdldCA9IF8uY2FjaGUoXy5pc09iamVjdCk7XHJcbiIsImxldCB7IHJoIH0gPSB3aW5kb3c7XHJcbmxldCB7IF8gfSA9IHJoO1xyXG5sZXQgeyAkIH0gPSByaDtcclxubGV0IHsgY29uc3RzIH0gPSByaDtcclxubGV0IHsgbW9kZWwgfSA9IHJoO1xyXG5cclxubGV0IGV2ZW50RmlyZSA9IChlbCwgZXR5cGUpPT57XHJcblx0aWYgKGVsLmZpcmVFdmVudCkge1xyXG5cdFx0ZWwuZmlyZUV2ZW50KCdvbicgKyBldHlwZSk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHZhciBldk9iaiA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudHMnKVxyXG5cdFx0ZXZPYmouaW5pdEV2ZW50KGV0eXBlLCB0cnVlLCB0cnVlKVxyXG5cdFx0ZWwuZGlzcGF0Y2hFdmVudChldk9iailcclxuXHR9XHJcbn1cclxuXHJcbmxldCBzaG93VGFyZ2V0ID0gKGVsZW1lbnQpPT4ge1xyXG5cdC8vZGlzcGxheSBhIGRyb3Bkb3duL2V4cGFuZCB0ZXh0IGlmIGhpZ2hsaWdodGVkIGVsZW1lbnQgaXMgaW5zaWRlIGl0XHJcblx0dmFyIHBhcmVudCA9IGVsZW1lbnQucGFyZW50Tm9kZVxyXG5cdHdoaWxlICgodHlwZW9mIHBhcmVudCAhPSAndW5kZWZpbmVkJykgJiYgcGFyZW50ICE9IG51bGwpIHtcclxuXHRcdHZhciB0YWduYW1lID0gcmguXy5nZXQocGFyZW50LCAndGFnTmFtZScpLnRvTG93ZXJDYXNlKClcclxuXHRcdGlmICh0YWduYW1lID09ICdib2R5JylcclxuXHRcdFx0YnJlYWs7XHJcblx0XHR2YXIgdGFyZ2V0TmFtZSA9IHJoLiQuZ2V0QXR0cmlidXRlKHBhcmVudCwgJ2RhdGEtdGFyZ2V0bmFtZScpXHJcblx0XHRpZiAodGFyZ2V0TmFtZSkge1xyXG5cdFx0XHR2YXIgbm9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRhcmdldD1cIicgKyB0YXJnZXROYW1lICsgJ1wiXScpXHJcblx0XHRcdHJoLl8uZGVmZXIoZnVuY3Rpb24gKCkgeyBldmVudEZpcmUobm9kZSwgJ29wZW4nKSB9KVxyXG5cdFx0fVxyXG5cdFx0cGFyZW50ID0gcGFyZW50LnBhcmVudE5vZGVcclxuXHR9XHJcbn1cclxuXHJcblxyXG5cclxuXy5ob29rQ2xpY2sgPSBmdW5jdGlvbihldmVudCkge1xyXG4gIGxldCBocmVmO1xyXG4gIGlmICgnYnV0dG9uJyBpbiBldmVudCAmJiAoZXZlbnQuYnV0dG9uICE9PSAwKSkgeyByZXR1cm47IH1cclxuICBpZiAoZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkgeyByZXR1cm47IH1cclxuICBcclxuICBsZXQgeyBib2R5IH0gPSBkb2N1bWVudDtcclxuICBsZXQgbm9kZSA9IGV2ZW50LnRhcmdldDtcclxuICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgaWYgKCFub2RlIHx8IChub2RlID09PSBkb2N1bWVudCkpIHsgYnJlYWs7IH1cclxuICAgIGhyZWYgPSAkLmdldEF0dHJpYnV0ZShub2RlLCAnaHJlZicpO1xyXG4gICAgaWYgKGhyZWYpIHsgYnJlYWs7IH1cclxuICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7XHJcbiAgfVxyXG4gIGlmICghaHJlZikgeyByZXR1cm47IH1cclxuICBocmVmID0gZGVjb2RlVVJJKGhyZWYpO1xyXG4gIGxldCBtb2JpbGVBcHBNb2RlID0gbW9kZWwuZ2V0KGNvbnN0cygnS0VZX01PQklMRV9BUFBfTU9ERScpKTtcclxuXHJcbiAgbGV0IHRhcmdldCA9ICQuZ2V0QXR0cmlidXRlKG5vZGUsICd0YXJnZXQnKTtcclxuICBpZiAodGFyZ2V0ICYmICh0YXJnZXQgIT09ICdfc2VsZicpICYmICFtb2JpbGVBcHBNb2RlKSB7IHJldHVybjsgfVxyXG4gIFxyXG4gIGlmICgoaHJlZlswXSA9PT0gJyMnKSAmJiBfLmlzUm9vdFVybCgpKSB7XHJcbiAgICBpZiAoaHJlZi5sZW5ndGggPiAxKSB7XHJcbiAgICAgIGxldCBib29rbWFya0tleSA9IGAke2NvbnN0cygnRVZUX0JPT0tNQVJLJyl9JHtocmVmfWA7XHJcbiAgICAgIGlmIChtb2RlbC5pc1N1YnNjcmliZWQoYm9va21hcmtLZXkpKSB7XHJcbiAgICAgICAgbW9kZWwucHVibGlzaChib29rbWFya0tleSwgJycpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIG1vZGVsLnB1Ymxpc2goY29uc3RzKCdFVlRfTkFWSUdBVEVfVE9fVVJMJyksXHJcbiAgICAgICAgICB7YWJzVXJsOiBgJHsoXy5nZXRSb290VXJsKSgpfSR7aHJlZn1gfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBfLnByZXZlbnREZWZhdWx0KGV2ZW50KTtcclxuICB9ZWxzZSBpZigoaHJlZlswXSA9PT0gJyMnKSl7XHJcbiAgICBsZXQgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoaHJlZilcclxuICAgIGVsZW1lbnQgJiYgc2hvd1RhcmdldChlbGVtZW50KVxyXG4gICAgXy5wcmV2ZW50RGVmYXVsdChldmVudClcclxuICAgIF8uZGVmZXIoKCk9PmVsZW1lbnQuc2Nyb2xsSW50b1ZpZXcoKSlcclxuICB9XHJcbiAgIGVsc2UgaWYgKF8uaXNWYWxpZEZpbGVVcmwoaHJlZikpIHtcclxuICAgIGxldCBhYnNVcmw7XHJcbiAgICBpZiAoXy5pc1JlbGF0aXZlVXJsKGhyZWYpKSB7IGFic1VybCA9IHdpbmRvdy5fZ2V0RnVsbFBhdGgoXy5wYXJlbnRQYXRoKCksIGhyZWYpOyB9XHJcbiAgICBpZiAoYWJzVXJsID09IG51bGwpIHsgYWJzVXJsID0gaHJlZjsgfVxyXG5cclxuICAgIGlmICgobW9iaWxlQXBwTW9kZSB8fCAhdGFyZ2V0KSAmJiAhXy5pc1VybEFsbG93ZEluSWZyYW1lKGFic1VybCkpIHtcclxuICAgICAgcmV0dXJuICQuc2V0QXR0cmlidXRlKG5vZGUsICd0YXJnZXQnLCAnX2JsYW5rJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBtb2RlbC5wdWJsaXNoKGNvbnN0cygnRVZUX05BVklHQVRFX1RPX1VSTCcpLCB7YWJzVXJsfSk7XHJcbiAgICAgIGlmICghdGFyZ2V0KSB7IHJldHVybiBfLnByZXZlbnREZWZhdWx0KGV2ZW50KTsgfVxyXG4gICAgfVxyXG4gIH1cclxufTtcclxuXHJcbiIsImxldCB7IHJoIH0gPSB3aW5kb3c7XHJcbmxldCB7IGNvbnN0cyB9ID0gcmg7XHJcblxyXG4vLyBQcm9qZWN0IHNwZWNpZmljIG1vZGVsIGtleXNcclxuY29uc3RzKCdLRVlfUFJPSkVDVF9UT1BJQ0xJU1QnLCAgICAgICAgICAnLnAudG9waWNsaXN0Jyk7XHJcbmNvbnN0cygnS0VZX1BST0pFQ1RfQlJTTElTVCcsICAgICAgICAgICAgJy5wLmJyc2xpc3QnKTtcclxuY29uc3RzKCdLRVlfUFJPSkVDVF9UQUdfQ09NQklOQVRJT05TJywgICAnLnAudGFnX2NvbWJpbmF0aW9ucycpO1xyXG5jb25zdHMoJ0tFWV9QUk9KRUNUX1RBR19TVEFURVMnLCAgICAgICAgICcucC50YWdfc3RhdGVzJyk7XHJcbmNvbnN0cygnS0VZX01FUkdFRF9GSUxURVJfS0VZJywgICAgICAgICAgJy5wLnRhZ3MnKTtcclxuY29uc3RzKCdLRVlfUFJPSkVDVF9GSUxURVJfQ0FQVElPTicsICAgICAnLnAuZmlsdGVyX2NhcHRpb24nKTtcclxuY29uc3RzKCdLRVlfUFJPSkVDVF9GSUxURVJfVFlQRScsICAgICAgICAnLnAuZmlsdGVyX3R5cGUnKTtcclxuY29uc3RzKCdLRVlfUFJPSkVDVF9MSVNUJywgICAgICAgICAgICAgICAnLnAucHJvamVjdHMnKTtcclxuY29uc3RzKCdLRVlfTUFTVEVSX1BST0pFQ1RfTElTVCcsICAgICAgICAnLnAubWFzdGVycHJvamVjdHMnKTtcclxuY29uc3RzKCdLRVlfU0VBUkNIX1JFU1VMVFMnLCAnLnAuc2VhcmNocmVzdWx0cycpO1xyXG5jb25zdHMoJ01BWF9TRUFSQ0hfUkVTVUxUUycsICdtYXhfc2VhcmNoX3Jlc3VsdHMnKVxyXG5jb25zdHMoJ0tFWV9TRUFSQ0hfUkVTVUxUX1BBUkFNUycsICAgICAgICcucC5zZWFyY2hyZXN1bHRwYXJhbXMnKTtcclxuY29uc3RzKCdLRVlfT05TRUFSQ0hfVEFHX1NUQVRFUycsICAgICAgICAnLnAub25zZWFyY2h0YWdzdGF0ZXMnKTtcclxuY29uc3RzKCdLRVlfTE5HJywgICAgICAgICAgICAgICAgICAgICAgICAnLnAubG5nX2RiJyk7XHJcbmNvbnN0cygnS0VZX0RFRkFVTFRfRklMVEVSJywgICAgICAgICAgICAgJy5wLmRlZmZpbHRlcicpO1xyXG5jb25zdHMoJ1BST0pFQ1RfR0xPU1NBUllfREFUQScsICAgICAgICAgICcucC5nbG9kYXRhJyk7XHJcbmNvbnN0cygnUFJPSkVDVF9JTkRFWF9EQVRBJywgICAgICAgICAgICAgJy5wLmlkeGRhdGEnKTtcclxuXHJcbi8vIE1lcmdlZCBQcm9qZWN0IHNwZWNpZmljXHJcbmNvbnN0cygnS0VZX01FUkdFRF9QUk9KRUNUX01BUCcsICAgICAgICAgJy5tcC50bWFwJyk7XHJcblxyXG4vLyBUb3BpYyBzcGVjaWZpYyBtb2RlbCBrZXlzXHJcbmNvbnN0cygnS0VZX1RPUElDX1VSTCcsICAgICAgICAgICAgICAgICAnLnQudG9waWN1cmwnKTtcclxuY29uc3RzKCdLRVlfVE9QSUNfSUQnLCAgICAgICAgICAgICAgICAgICcudC50b3BpY2lkJyk7XHJcbmNvbnN0cygnS0VZX1RPUElDX1RJVExFJywgICAgICAgICAgICAgICAnLnQudG9waWN0aXRsZScpO1xyXG5jb25zdHMoJ0tFWV9UT1BJQ19CUlNNQVAnLCAgICAgICAgICAgICAgJy50LmJyc21hcCcpO1xyXG5jb25zdHMoJ0tFWV9UT1BJQ19PUklHSU4nLCAgICAgICAgICAgICAgJy50Lm9yaWdpbicpO1xyXG5jb25zdHMoJ0tFWV9UT1BJQ19IRUlHSFQnLCAgICAgICAgICAgICAgJy50LnRvcGljX2hlaWdodCcpO1xyXG5jb25zdHMoJ0tFWV9UT1BJQ19DT05URU5UX1NJWkUnLCAgICAgICAgJy50LnRvcGljX2NvbnRlbnRfc2l6ZScpO1xyXG5jb25zdHMoJ0dPX1RPX0RFRkFVTFRfVE9QSUMnLCAgICAgICAgICAgJy50LmdvdG9kZWZhdWx0VG9waWMnKTtcclxuXHJcblxyXG4vLyBMYXlvdXQgc3BlY2lmaWMgbW9kZWwga2V5c1xyXG5jb25zdHMoJ0tFWV9TSE9XX1NDUk9MTF9UT19UT1AnLCAgICAgICAgJy5sLnNob3dfc2Nyb2xsX3RvX3RvcCcpO1xyXG5jb25zdHMoJ0tFWV9ET19OT1RfUFJFU0VSVkVfQVInLCAgICAgICAgJy5sLmRvX25vdF9wcmVzZXJ2ZV9hcicpO1xyXG5jb25zdHMoJ0tFWV9TRUFSQ0hfVEVSTScsICAgICAgICAgICAgICAgJy5sLnNlYXJjaHRlcm0nKTtcclxuY29uc3RzKCdLRVlfU0VBUkNIRURfVEVSTScsICAgICAgICAgICAgICcubC5zZWFyY2hlZF90ZXJtJyk7XHJcbmNvbnN0cygnS0VZX1RBR19FWFBSRVNTSU9OJywgICAgICAgICAgICAnLmwudGFnX2V4cHJlc3Npb24nKTtcclxuY29uc3RzKCdLRVlfVUlfTU9ERScsICAgICAgICAgICAgICAgICAgICcubC51aW1vZGUnKTsgICAgICAgICAgICAvLyBSSDExXHJcbmNvbnN0cygnS0VZX0JBU0VfSUZSQU1FX05BTUUnLCAgICAgICAgICAnLmwuYmFzZV9pZnJhbWVfbmFtZScpO1xyXG5jb25zdHMoJ0tFWV9DQU5fSEFORExFX1NFUkNIJywgICAgICAgICAgJy5sLmNhbl9oYW5kbGVfc2VhcmNoJyk7IC8vIFJIMTFcclxuY29uc3RzKCdLRVlfQ0FOX0hBTkRMRV9TRUFSQ0gnLCAgICAgICAgICcubC5jYW5faGFuZGxlX3NlYXJjaCcpO1xyXG5jb25zdHMoJ0tFWV9DU0hfTU9ERScsICAgICAgICAgICAgICAgICAgJy5sLmNzaF9tb2RlJyk7XHJcbmNvbnN0cygnS0VZX09OU0VBUkNIX1RBR19FWFBSJywgICAgICAgICAnLmwub25zZWFyY2h0YWdleHByJyk7XHJcbmNvbnN0cygnS0VZX0FORF9TRUFSQ0gnLCAgICAgICAgICAgICAgICAnLmwuYW5kc2VhcmNoJyk7XHJcbmNvbnN0cygnS0VZX0ZFQVRVUkUnLCAgICAgICAgICAgICAgICAgICAnLmwuZmVhdHVyZXMnKTtcclxuY29uc3RzKCdLRVlfU0VBUkNIX1BST0dSRVNTJywgICAgICAgICAgICcubC5zZWFyY2hfcHJvZ3Jlc3MnKTtcclxuY29uc3RzKCdLRVlfTEFZT1VUX1ZFUlNJT04nLCAgICAgICAgICAgICcubC5sYXlvdXRfdmVyc2lvbicpO1xyXG5jb25zdHMoJ0tFWV9UT1BJQ19JTl9JRlJBTUUnLCAgICAgICAgICAgJy5sLnRvcGljX2luX2lmcmFtZScpO1xyXG5jb25zdHMoJ0tFWV9TSE9XX1RBR1MnLCAgICAgICAgICAgICAgICAgJy5sLnNob3d0YWdzJyk7XHJcbmNvbnN0cygnS0VZX0RJUicsICAgICAgICAgICAgICAgICAgICAgICAnLmwuZGlyJyk7XHJcbmNvbnN0cygnS0VZX1NFQVJDSF9MT0NBVElPTicsICAgICAgICAgICAnLmwuc2VhcmNoX2xvY2F0aW9uJyk7XHJcbmNvbnN0cygnS0VZX0RFRkFVTFRfU0VBUkNIX0xPQ0FUSU9OJywgICAnLmwuZGVmYXVsdF9zZWFyY2hfbG9jYXRpb24nKTtcclxuY29uc3RzKCdLRVlfRklMVEVSX0xPQ0FUSU9OJywgICAgICAgICAgICcubC5maWx0ZXJfbG9jYXRpb24nKTtcclxuY29uc3RzKCdLRVlfQUNUSVZFX1RBQicsICAgICAgICAgICAgICAgICcubC5hY3RpdmVfdGFiJyk7XHJcbmNvbnN0cygnS0VZX0RFRkFVTFRfVEFCJywgICAgICAgICAgICAgICAnLmwuZGVmYXVsdF90YWInKTtcclxuY29uc3RzKCdLRVlfQUNUSVZFX1RPUElDX1RBQicsICAgICAgICAgICcubC5hY3RpdmVfdG9waWNfdGFiJyk7XHJcbmNvbnN0cygnS0VZX1RPQ19EUklMTF9ET1dOJywgICAgICAgICAgICAnLmwudG9jX2RyaWxsZG93bicpO1xyXG5jb25zdHMoJ0tFWV9NT0JJTEVfVE9DX0RSSUxMX0RPV04nLCAgICAgJy5sLm1vYmlsZV90b2NfZHJpbGxkb3duJyk7XHJcbmNvbnN0cygnS0VZX1BVQkxJU0hfTU9ERScsICAgICAgICAgICAgICAnLmwucHVibGlzaF9tb2RlJyk7XHJcbmNvbnN0cygnS0VZX1BVQkxJU0hfQkFTRV9VUkwnLCAgICAgICAgICAnLmwucHVibGlzaF9iYXNlX3VybCcpO1xyXG5jb25zdHMoJ0tFWV9QUk9KRUNUU19CQVNFX1VSTCcsICAgICAgICAgJy5sLnByb2plY3RzX2Jhc2VfdXJsJyk7XHJcbmNvbnN0cygnS0VZX0lOREVYX0ZJTFRFUicsICAgICAgICAgICAgICAnLmwuaWR4ZmlsdGVyJyk7XHJcblxyXG4vLyBFdmVudHNcclxuY29uc3RzKCdFVlRfQkFTRV9JRlJBTUVfTE9BRCcsICAgICAgICAgICAnLmUuYmFzZV9pZnJhbWVfbG9hZCcpO1xyXG5jb25zdHMoJ0VWVF9TQ1JPTExfVE9fVE9QJywgICAgICAgICAgICAgICcuZS5zY3JvbGxfdG9fdG9wJyk7XHJcbmNvbnN0cygnRVZUX1NFQVJDSF9URVJNJywgICAgICAgICAgICAgICAgJy5lLnNlYXJjaF90ZXJtJyk7XHJcbmNvbnN0cygnREVTS1RPUF9TSURFQkFSX1ZJU0lCTEUnLCAgICAgICAgJy5sLmRlc2t0b3Bfc2lkZWJhcl92aXNpYmxlJyk7XHJcbmNvbnN0cygnRVZUX05BVklHQVRFX1RPX1VSTCcsICAgICAgICAgICAgJy5lLm5hdmlnYXRlX3RvX3VybCcpO1xyXG5jb25zdHMoJ0VWVF9QUk9KRUNUX0xPQURFRCcsICAgICAgICAgICAgICcuZS5wcm9qZWN0X2xvYWRlZCcpO1xyXG5jb25zdHMoJ0VWVF9UT0NfTE9BREVEJywgICAgICAgICAgICAgICAgICcuZS50b2NfbG9hZGVkJyk7XHJcbmNvbnN0cygnRVZUX1RPUElDX0xPQURFRCcsICAgICAgICAgICAgICAgJy5lLnRvcGljX2xvYWRlZCcpO1xyXG5jb25zdHMoJ0VWVF9UT1BJQ19MT0FESU5HJywgICAgICAgICAgICAgICcuZS50b3BpY19sb2FkaW5nJyk7XHJcbmNvbnN0cygnRVZUX0JPT0tNQVJLJywgICAgICAgICAgICAgICAgICAgJy5lLmJvb2ttYXJrLicpO1xyXG5jb25zdHMoJ0VWVF9QUklOVF9UT1BJQycsICAgICAgICAgICAgICAgICcuZS5wcmludF90b3BpYycpO1xyXG5jb25zdHMoJ0VWVF9TRUFSQ0hfSU5fUFJPR1JFU1MnLCAgICAgICAgICcuZS5zZWFyY2hfaW5fcHJvZ3Jlc3MnKTtcclxuY29uc3RzKCdFVlRfUkVMT0FEX1RPUElDJywgICAgICAgICAgICAgICAnLmUucmVsb2FkX3RvcGljJyk7XHJcbmNvbnN0cygnRVZUX1FVRVJZX1NFQVJDSF9SRVNVTFRTJywgICAgICAgJy5lLnF1ZXJ5X3NlYXJjaF9yZXN1bHRzJyk7XHJcbmNvbnN0cygnRVZUX0xPQURfSURYJywgICAgICAgICAgICAgICAgICAgJy5lLmxvYWRfaWR4Jyk7XHJcbmNvbnN0cygnRVZUX0xPQURfR0xPJywgICAgICAgICAgICAgICAgICAgJy5lLmxvYWRfZ2xvJyk7XHJcbmNvbnN0cygnRVZUX1RPQ19TRUxFQ1RFRF9JVEVNX0NIQU5HRUQnLCAnZXZ0LnRvY19zZWxlY3RfaXRlbV9jaGFuZ2VkJylcclxuXHJcbi8vIEhhc2ggYW5kIHF1ZXJ5IGtleXNcclxuY29uc3RzKCdIQVNIX0tFWV9SSF9ISUdITElHSFQnLCAgICAgICAgICAncmhobHRlcm0nKTtcclxuY29uc3RzKCdIQVNIX0tFWV9SSF9TWU5TJywgICAgICAgICAgICAgICAncmhzeW5zJyk7XHJcbmNvbnN0cygnSEFTSF9LRVlfUkhfU0VBUkNIJywgICAgICAgICAgICAgJ3Joc2VhcmNoJyk7XHJcbmNvbnN0cygnSEFTSF9LRVlfUkhfVE9DSUQnLCAgICAgICAgICAgICAgJ3JodG9jaWQnKTtcclxuXHJcbi8vIEhhc2gga2V5c1xyXG5jb25zdHMoJ0hBU0hfS0VZX1RPUElDJywgICAgICAgICAgICAgICAgICd0Jyk7XHJcbmNvbnN0cygnSEFTSF9LRVlfVUlNT0RFJywgICAgICAgICAgICAgICAgJ3V4Jyk7XHJcbmNvbnN0cygnSEFTSF9LRVlfUkFORE9NJywgICAgICAgICAgICAgICAgJ3JhbmRvbScpO1xyXG5cclxuY29uc3RzKCdQQVRIX1BST0pFQ1RfVEFHREFUQV9GSUxFJywgICAgICAnd2h4ZGF0YS93aHRhZ2RhdGEuanMnKTtcclxuY29uc3RzKCdDT1JET1ZBX0pTX1VSTCcsICAgICAgICAgICAgICAgICAnY29yZG92YS5qcycpO1xyXG5jb25zdHMoJ1JIU19MT0dfVE9QSUNfVklFVycsICAgICAgICAgICAgICB7bWdyOiAnc3lzJywgY21kOiAnbG9ndHBjJ30pO1xyXG5jb25zdHMoJ1JIU19ET19TRUFSQ0gnLCAgICAgICAgICAgICAgICAgICB7bWdyOiAnYWdtJywgYWd0OiAnbmxzJywgY21kOiAnc2VhcmNoJ30pO1xyXG5jb25zdHMoJ0tFWV9NT0JJTEVfQVBQX01PREUnLCAgICAgICAgICAgJy5tLm1vYmlsZWFwcCcpO1xyXG4iLCJsZXQgeyByaCB9ID0gd2luZG93O1xyXG5sZXQgeyBfIH0gPSByaDtcclxubGV0IHsgbW9kZWwgfSA9IHJoO1xyXG5sZXQgeyBjb25zdHMgfSA9IHJoO1xyXG5cclxubGV0IEtFWV9NRVJHRURfUFJPSkVDVF9NQVAgPSBjb25zdHMoJ0tFWV9NRVJHRURfUFJPSkVDVF9NQVAnKTtcclxuXHJcbl8ucGFyc2VQcm9qZWN0TmFtZSA9IHByb2plY3QgPT4gcHJvamVjdC5yZXBsYWNlKC9cXC5cXC8vZywgJycpLnJlcGxhY2UoL1xcLiQvLCAnJykucmVwbGFjZSgvXFwvJC8sICcnKTtcclxuXHJcbl8ubWFwVGFnSW5kZXggPSBmdW5jdGlvbihpZHgsIHByb2plY3QpIHtcclxuICBpZiAocHJvamVjdCA9PSBudWxsKSB7IHByb2plY3QgPSAnJzsgfVxyXG4gIGlmIChpZHgpIHtcclxuICAgIHJldHVybiBpZHggKyAnKycgKyBwcm9qZWN0O1xyXG4gIH1cclxuICByZXR1cm4gaWR4O1xyXG59O1xyXG5cclxuXy5nZXRUYWdzID0gZnVuY3Rpb24oaWR4LCBwcm9qZWN0KSB7XHJcbiAgaWYgKHByb2plY3QgPT0gbnVsbCkgeyBwcm9qZWN0ID0gJyc7IH1cclxuICBpZiAoaWR4ID09IG51bGwpIHsgcmV0dXJuIGlkeDsgfVxyXG4gIGxldCBpZG1hcCA9IG1vZGVsLmdldChLRVlfTUVSR0VEX1BST0pFQ1RfTUFQKTtcclxuICBsZXQgbGVuID0gaWR4LmluZGV4T2YoJysnKTtcclxuICBpZiAobGVuICE9PSAtMSkge1xyXG4gICAgcHJvamVjdCA9IGlkeC5zdWJzdHJpbmcobGVuICsgMSwgaWR4Lmxlbmd0aCk7XHJcbiAgICBpZHggPSBpZHguc3Vic3RyaW5nKDAsIGxlbik7XHJcbiAgfVxyXG4gIHByb2plY3QgPSBfLnBhcnNlUHJvamVjdE5hbWUocHJvamVjdCk7XHJcbiAgaWYgKChpZG1hcFtwcm9qZWN0XSAhPSBudWxsID8gaWRtYXBbcHJvamVjdF1baWR4XSA6IHVuZGVmaW5lZCkgIT0gbnVsbCkgeyByZXR1cm4gaWRtYXBbcHJvamVjdF1baWR4XTsgfVxyXG4gIHJldHVybiBpZHg7XHJcbn07XHJcblxyXG5fLmdldFByb2plY3ROYW1lID0gZnVuY3Rpb24odXJsKSB7XHJcbiAgbGV0IGlkbWFwID0gbW9kZWwuZ2V0KEtFWV9NRVJHRURfUFJPSkVDVF9NQVApO1xyXG4gIGlmICgodXJsICE9IG51bGwpICYmIChpZG1hcCAhPSBudWxsKSkge1xyXG4gICAgdXJsID0gXy5wYXJlbnRQYXRoKHVybCk7XHJcbiAgICBsZXQgcmVsVXJsID0gXy5tYWtlUmVsYXRpdmVQYXRoKHVybCwgXy5nZXRIb3N0Rm9sZGVyKCkpO1xyXG4gICAgcmVsVXJsID0gXy5wYXJzZVByb2plY3ROYW1lKHJlbFVybCk7XHJcbiAgICB3aGlsZSAoKGlkbWFwW3JlbFVybF0gPT0gbnVsbCkpIHtcclxuICAgICAgbGV0IG4gPSByZWxVcmwubGFzdEluZGV4T2YoJy8nKTtcclxuICAgICAgaWYgKG4gPCAwKSB7XHJcbiAgICAgICAgcmVsVXJsID0gJyc7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgcmVsVXJsID0gcmVsVXJsLnN1YnN0cmluZygwLG4pO1xyXG4gICAgfVxyXG4gICAgdXJsID0gcmVsVXJsO1xyXG4gIH1cclxuICByZXR1cm4gdXJsO1xyXG59O1xyXG5cclxuXy5ldmFsVGFnRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKGluZGV4LCBncm91cEV4cHJzLCBwcm9qZWN0KSB7XHJcbiAgaWYgKHByb2plY3QgPT0gbnVsbCkgeyBwcm9qZWN0ID0gJyc7IH1cclxuICBpZiAoIWdyb3VwRXhwcnMgfHwgKGdyb3VwRXhwcnMubGVuZ3RoID09PSAwKSkgeyByZXR1cm4gdHJ1ZTsgfVxyXG4gIFxyXG4gIGxldCB0YWdzID0gXy5nZXRUYWdzKGluZGV4LCBwcm9qZWN0KTtcclxuICBpZiAoIXRhZ3MgfHwgKHRhZ3MubGVuZ3RoID09PSAwKSkgeyByZXR1cm4gdHJ1ZTsgfVxyXG4gIFxyXG4gIC8vIFRPRE86IGZpeCBlbXB0eSBzdHJpbmcgaW4gcm9ib2hlbHBcclxuICBpZiAoKHRhZ3MubGVuZ3RoID09PSAxKSAmJiAoKHRhZ3NbMF0gPT09ICcnKSB8fCAodGFnc1swXSA9PT0gJyQnKSkpIHsgcmV0dXJuIHRydWU7IH1cclxuXHJcbiAgbGV0IHRydWVGbGFnID0gZmFsc2U7XHJcbiAgbGV0IGZhbHNlRmxhZyA9IF8uYW55KGdyb3VwRXhwcnMsIGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgIGlmIChfLmV2YWxNdWx0aXBsZVRhZ0V4cHJlc3Npb24oaXRlbS5jLCB0YWdzKSkge1xyXG4gICAgICB0cnVlRmxhZyA9IHRydWU7XHJcbiAgICB9IGVsc2UgaWYgKGl0ZW0uYy5sZW5ndGgpIHtcclxuICAgICAgaWYgKF8uZXZhbE11bHRpcGxlVGFnRXhwcmVzc2lvbihpdGVtLnUsIHRhZ3MpKSB7IHJldHVybiB0cnVlOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfSk7XHJcbiAgXHJcbiAgaWYgKGZhbHNlRmxhZykgeyByZXR1cm4gZmFsc2U7IH0gZWxzZSB7IHJldHVybiB0cnVlRmxhZzsgfVxyXG59O1xyXG5cclxuXy5ldmFsTXVsdGlwbGVUYWdFeHByZXNzaW9uID0gKGV4cHJzLCB0YWdzKSA9PiBfLmFueShleHBycywgZXhwciA9PiBfLmV2YWxTaW5nbGVUYWdFeHByZXNzaW9uKGV4cHIsIHRhZ3MpKTtcclxuXHJcbl8uZXZhbFNpbmdsZVRhZ0V4cHJlc3Npb24gPSAoZnVuY3Rpb24oKSB7XHJcbiAgbGV0IGNhY2hlID0ge307XHJcbiAgbGV0IG9wZXJhdG9ycyA9IFsnJicsICd8JywgJyEnXTtcclxuICBsZXQgZXZhbEFuZCA9IGZ1bmN0aW9uKHN0YWNrKSB7XHJcbiAgICBsZXQgaXRlbXMgPSBzdGFjay5zcGxpY2Uoc3RhY2subGVuZ3RoIC0gMik7XHJcbiAgICByZXR1cm4gc3RhY2sucHVzaCgoaXRlbXNbMF0gPT09IDEpICYmIChpdGVtc1sxXSA9PT0gMSkgPyAxIDogMCk7XHJcbiAgfTtcclxuXHJcbiAgbGV0IGV2YWxPciA9IGZ1bmN0aW9uKHN0YWNrKSB7XHJcbiAgICBsZXQgaXRlbXMgPSBzdGFjay5zcGxpY2Uoc3RhY2subGVuZ3RoIC0gMik7XHJcbiAgICByZXR1cm4gc3RhY2sucHVzaCgoaXRlbXNbMF0gPT09IDEpIHx8IChpdGVtc1sxXSA9PT0gMSkgPyAxIDogMCk7XHJcbiAgfTtcclxuXHJcbiAgbGV0IGV2YWxOb3QgPSBmdW5jdGlvbihzdGFjaywgdGFncykge1xyXG4gICAgbGV0IGl0ZW1zID0gc3RhY2suc3BsaWNlKHN0YWNrLmxlbmd0aCAtIDEpO1xyXG4gICAgcmV0dXJuIHN0YWNrLnB1c2goaXRlbXNbMF0gPT09IDEgPyAwIDogMSk7XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIGZ1bmN0aW9uKGV4cHIsIHRhZ3MpIHtcclxuICAgIGxldCBrZXkgPSBgJHtleHByfToke3RhZ3N9YDsgLy8gVE9ETzogbm93IHJvYm9oZWxwIHNob3VsZCBleHBvcnQgdGFncyBhcyBzdHJpbmdcclxuICAgIGxldCByZXN1bHQgPSBjYWNoZVtrZXldO1xyXG4gICAgaWYgKHJlc3VsdCAhPSBudWxsKSB7IHJldHVybiByZXN1bHQ7IH1cclxuXHJcbiAgICBsZXQgdG9rZW5zID0gXy5tYXAoZXhwci5zcGxpdCgnICcpLCBmdW5jdGlvbihpdGVtKSB7XHJcbiAgICAgIGlmICgtMSAhPT0gb3BlcmF0b3JzLmluZGV4T2YoaXRlbSkpIHsgcmV0dXJuIGl0ZW07IH1cclxuICAgICAgaWYgKC0xID09PSB0YWdzLmluZGV4T2YoaXRlbSkpIHsgcmV0dXJuIDA7IH0gZWxzZSB7IHJldHVybiAxOyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAodG9rZW5zLmxlbmd0aCA+IDEpIHtcclxuICAgICAgbGV0IHN0YWNrID0gW107XHJcbiAgICAgIGZvciAobGV0IHRva2VuIG9mIEFycmF5LmZyb20odG9rZW5zKSkge1xyXG4gICAgICAgIHN3aXRjaCAodG9rZW4pIHtcclxuICAgICAgICAgIGNhc2UgJyYnOiBldmFsQW5kKHN0YWNrKTsgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlICd8JzogZXZhbE9yKHN0YWNrKTsgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlICchJzogZXZhbE5vdChzdGFjayk7IGJyZWFrO1xyXG4gICAgICAgICAgZGVmYXVsdDogc3RhY2sucHVzaCh0b2tlbik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJlc3VsdCA9IHN0YWNrWzBdO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzdWx0ID0gdG9rZW5zWzBdO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gY2FjaGVba2V5XSA9IHJlc3VsdDtcclxuICB9O1xyXG59KSgpO1xyXG4iLCJcclxubGV0IHJoID0gd2luZG93LnJoO1xyXG5sZXQgXyA9IHJoLl87XHJcbmxldCBjb25zdHMgPSByaC5jb25zdHM7XHJcblxyXG5fLmdldEhvc3RGb2xkZXIgPSAoKCgpID0+IHtcclxuICBsZXQgaG9zdEZvbGRlcjtcclxuICBob3N0Rm9sZGVyID0gbnVsbDtcclxuICByZXR1cm4gKCkgPT4ge1xyXG4gICAgaWYgKGhvc3RGb2xkZXIgPT0gbnVsbCkge1xyXG4gICAgICBob3N0Rm9sZGVyID0gXy5pc0xvY2FsKCkgPyB3aW5kb3cuZ0hvc3RQYXRoIDogYCR7ZG9jdW1lbnQubG9jYXRpb24ucHJvdG9jb2x9Ly8ke3dpbmRvdy5nSG9zdH0ke3dpbmRvdy5nSG9zdFBhdGh9YDtcclxuICAgIH1cclxuICAgIHJldHVybiBob3N0Rm9sZGVyO1xyXG4gIH07XHJcbn0pKSgpO1xyXG5cclxuXy5nZXRIb3N0RGF0YSA9IHJvb3RQYXRoID0+IHtcclxuICBsZXQgYWJzRm9sZGVyO1xyXG4gIGFic0ZvbGRlciA9IHdpbmRvdy5fZ2V0RnVsbFBhdGgoXy5wYXJlbnRQYXRoKCksIGAke3Jvb3RQYXRofS9gKTtcclxuICBpZiAod2luZG93Ll9pc0hUVFBVcmwoYWJzRm9sZGVyKSkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgZ0hvc3Q6IHdpbmRvdy5fZ2V0SG9zdE5hbWVGcm9tVVJMKGFic0ZvbGRlciksXHJcbiAgICAgIGdIb3N0UGF0aDogd2luZG93Ll9nZXRQYXRoRnJvbVVSTChhYnNGb2xkZXIpXHJcbiAgICB9O1xyXG4gIH0gZWxzZSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBnSG9zdDogJycsXHJcbiAgICAgIGdIb3N0UGF0aDogYWJzRm9sZGVyXHJcbiAgICB9O1xyXG4gIH1cclxufTtcclxuXHJcbl8uZ2V0SGFzaE1hcEZvclJvb3QgPSAocmVsVXJsLCBiQ3NoKSA9PiB7XHJcbiAgbGV0IGhhc2hNYXA7XHJcbiAgbGV0IHVybGhhc2hNYXA7XHJcbiAgaWYgKGJDc2ggPT0gbnVsbCkge1xyXG4gICAgYkNzaCA9IG51bGw7XHJcbiAgfVxyXG4gIHJlbFVybCA9IF8uZml4UmVsYXRpdmVVcmwocmVsVXJsKTtcclxuICB1cmxoYXNoTWFwID0gXy51cmxQYXJhbXMoXy5leHRyYWN0UGFyYW1TdHJpbmcocmVsVXJsKSk7XHJcbiAgaWYgKGJDc2gpIHtcclxuICAgIHVybGhhc2hNYXBbY29uc3RzKCdSSE1BUElEJyldID0gbnVsbDtcclxuICAgIHVybGhhc2hNYXBbY29uc3RzKCdSSE1BUE5PJyldID0gbnVsbDtcclxuICB9XHJcbiAgaGFzaE1hcCA9IF8uZXh0ZW5kKF8udXJsUGFyYW1zKCksIHVybGhhc2hNYXApO1xyXG4gIGhhc2hNYXAgPSBfLmZpeEhhc2hNYXBGb3JSb290KGhhc2hNYXApO1xyXG4gIC8vaGFzaE1hcCA9IF8uYWRkUkhTUGFyYW1zKGhhc2hNYXApO1xyXG4gIHJldHVybiBoYXNoTWFwO1xyXG59O1xyXG5cclxuXy5nZXRQYXJhbXNGb3JSb290ID0gKHJlbFVybCwgYkNzaCkgPT4ge1xyXG4gIGxldCBxdWVyeU1hcDtcclxuICBsZXQgcXVlcnlTdHJpbmc7XHJcbiAgaWYgKGJDc2ggPT0gbnVsbCkge1xyXG4gICAgYkNzaCA9IG51bGw7XHJcbiAgfVxyXG4gIHF1ZXJ5TWFwID0gXy5nZXRIYXNoTWFwRm9yUm9vdChyZWxVcmwsIGJDc2gpO1xyXG4gIHF1ZXJ5U3RyaW5nID0gXy5tYXBUb0VuY29kZWRTdHJpbmcocXVlcnlNYXApO1xyXG4gIGlmIChxdWVyeVN0cmluZy5sZW5ndGggPT09IDApIHtcclxuICAgIHJldHVybiAnJztcclxuICB9IGVsc2Uge1xyXG4gICAgcmV0dXJuIGA/JHtxdWVyeVN0cmluZ31gO1xyXG4gIH1cclxufTtcclxuXHJcbl8uaXNSb290VXJsID0gYWJzVXJsID0+IHtcclxuICBsZXQgZmlsZU5hbWU7XHJcbiAgbGV0IGZpbGVQYXRoO1xyXG4gIGxldCByb290VXJsO1xyXG4gIGlmIChhYnNVcmwgPT0gbnVsbCkge1xyXG4gICAgYWJzVXJsID0gZGVjb2RlVVJJKGRvY3VtZW50LmxvY2F0aW9uLmhyZWYpO1xyXG4gIH1cclxuICByb290VXJsID0gXy5nZXRSb290VXJsKCk7XHJcbiAgZmlsZVBhdGggPSBfLmZpbGVQYXRoKGFic1VybCk7XHJcbiAgaWYgKGZpbGVQYXRoID09PSBfLmZpbGVQYXRoKHJvb3RVcmwpKSB7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcbiAgZmlsZU5hbWUgPSBfLmdldEZpbGVOYW1lKHJvb3RVcmwpO1xyXG4gIHJldHVybiAoZmlsZU5hbWUgPT09ICdpbmRleC5odG0nIHx8IGZpbGVOYW1lID09PSAnaW5kZXguaHRtbCcpICYmIGZpbGVQYXRoID09PSBfLnBhcmVudFBhdGgocm9vdFVybCk7XHJcbn07XHJcblxyXG5fLmlzRXh0ZXJuYWxVcmwgPSBhYnNVcmwgPT4ge1xyXG4gIGxldCBob3N0Rm9sZGVyO1xyXG4gIGlmIChyaC5tb2RlbC5nZXQocmguY29uc3RzKCdLRVlfUFVCTElTSF9NT0RFJykpKSB7XHJcbiAgICBob3N0Rm9sZGVyID0gcmgubW9kZWwuZ2V0KHJoLmNvbnN0cygnS0VZX1BST0pFQ1RTX0JBU0VfVVJMJykpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBob3N0Rm9sZGVyID0gXy5nZXRIb3N0Rm9sZGVyKCk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gIShfLmVxdWFsVXJsQmFzZShhYnNVcmwsIGhvc3RGb2xkZXIpICYmIF8udXJsU3RhcnRzV2l0aChhYnNVcmwsIGhvc3RGb2xkZXIpKVxyXG59O1xyXG5cclxuXy5maXhIYXNoTWFwRm9yUm9vdCA9IGhhc2hNYXAgPT4ge1xyXG4gIGxldCBIQVNIX0tFWV9SQU5ET007XHJcbiAgbGV0IEhBU0hfS0VZX1JIX0hJR0hMSUdIVDtcclxuICBsZXQgSEFTSF9LRVlfUkhfU0VBUkNIO1xyXG4gIGxldCBIQVNIX0tFWV9SSF9UT0NJRDtcclxuICBsZXQgSEFTSF9LRVlfVE9QSUM7XHJcbiAgbGV0IEhBU0hfS0VZX1VJTU9ERTtcclxuICBpZiAoaGFzaE1hcCA9PSBudWxsKSB7XHJcbiAgICBoYXNoTWFwID0ge307XHJcbiAgfVxyXG4gIEhBU0hfS0VZX1JIX1NFQVJDSCA9IGNvbnN0cygnSEFTSF9LRVlfUkhfU0VBUkNIJyk7XHJcbiAgSEFTSF9LRVlfVE9QSUMgPSBjb25zdHMoJ0hBU0hfS0VZX1RPUElDJyk7XHJcbiAgSEFTSF9LRVlfVUlNT0RFID0gY29uc3RzKCdIQVNIX0tFWV9VSU1PREUnKTtcclxuICBIQVNIX0tFWV9SSF9UT0NJRCA9IGNvbnN0cygnSEFTSF9LRVlfUkhfVE9DSUQnKTtcclxuICBIQVNIX0tFWV9SSF9ISUdITElHSFQgPSBjb25zdHMoJ0hBU0hfS0VZX1JIX0hJR0hMSUdIVCcpO1xyXG4gIEhBU0hfS0VZX1JBTkRPTSA9IGNvbnN0cygnSEFTSF9LRVlfUkFORE9NJyk7XHJcbiAgaWYgKCFoYXNoTWFwW0hBU0hfS0VZX1VJTU9ERV0pIHtcclxuICAgIGhhc2hNYXBbSEFTSF9LRVlfVUlNT0RFXSA9IG51bGw7XHJcbiAgfVxyXG4gIGhhc2hNYXBbSEFTSF9LRVlfUkFORE9NXSA9IG51bGw7XHJcbiAgaWYgKCFoYXNoTWFwW0hBU0hfS0VZX1JIX1RPQ0lEXSkge1xyXG4gICAgaGFzaE1hcFtIQVNIX0tFWV9SSF9UT0NJRF0gPSBudWxsO1xyXG4gIH1cclxuICBpZiAoIWhhc2hNYXBbSEFTSF9LRVlfUkhfSElHSExJR0hUXSkge1xyXG4gICAgaGFzaE1hcFtIQVNIX0tFWV9SSF9ISUdITElHSFRdID0gbnVsbDtcclxuICB9XHJcbiAgaWYgKCFoYXNoTWFwW0hBU0hfS0VZX1JIX1NFQVJDSF0pIHtcclxuICAgIGhhc2hNYXBbSEFTSF9LRVlfUkhfU0VBUkNIXSA9IG51bGw7XHJcbiAgfVxyXG4gIHJldHVybiBoYXNoTWFwO1xyXG59O1xyXG5cclxuXy5maXhSZWxhdGl2ZVVybCA9IGZpbGVQYXRoID0+IHtcclxuICBpZiAoZmlsZVBhdGggPT0gbnVsbCkge1xyXG4gICAgZmlsZVBhdGggPSAnJztcclxuICB9XHJcbiAgZmlsZVBhdGggPSBmaWxlUGF0aC5yZXBsYWNlKC9cXC9cXC5cXC8vZywgJy8nKTtcclxuICBpZiAoZmlsZVBhdGhbMF0gPT09ICcuJyAmJiBmaWxlUGF0aFsxXSA9PT0gJy8nKSB7XHJcbiAgICBmaWxlUGF0aCA9IGZpbGVQYXRoLnN1YnN0cmluZygyKTtcclxuICB9XHJcbiAgcmV0dXJuIGZpbGVQYXRoO1xyXG59O1xyXG5cclxuXy5lbnN1cmVTbGFzaCA9IHVybCA9PiB7XHJcbiAgaWYgKCh1cmwgIT0gbnVsbCkgJiYgdXJsLnN1YnN0cigtMSkgIT09ICcvJykge1xyXG4gICAgdXJsICs9ICcvJztcclxuICB9XHJcbiAgcmV0dXJuIHVybDtcclxufTtcclxuXHJcbl8uaXNVcmxBbGxvd2RJbklmcmFtZSA9ICgoKCkgPT4ge1xyXG4gIGxldCBBTExPV0VEX0VYVFNfSU5fSUZSQU1FO1xyXG4gIEFMTE9XRURfRVhUU19JTl9JRlJBTUUgPSBbJycsICcuaHRtJywgJy5odG1sJywgJy5hc3AnLCAnLmFzcHgnXTtcclxuICByZXR1cm4gYWJzVXJsID0+IHtcclxuICAgIGxldCBleHQ7XHJcbiAgICBsZXQgcmVsVXJsO1xyXG4gICAgaWYgKF8uaXNFeHRlcm5hbFVybChhYnNVcmwpKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJlbFVybCA9IGFic1VybC5zdWJzdHJpbmcoXy5nZXRIb3N0Rm9sZGVyKCkubGVuZ3RoKTtcclxuICAgIGV4dCA9IF8uZ2V0RmlsZUV4dGVudGlvbihyZWxVcmwpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICByZXR1cm4gQUxMT1dFRF9FWFRTX0lOX0lGUkFNRS5pbmNsdWRlcyhleHQpO1xyXG4gIH07XHJcbn0pKSgpO1xyXG5cclxuXy5zcGxpdFVybCA9IHVybCA9PiB7XHJcbiAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsvL2FueSBub24gZW1wdHkgZWxlbWVudFxyXG4gIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdocmVmJywgdXJsKTtcclxuICBsZXQgeyBob3N0bmFtZSwgcG9ydCwgc2VhcmNoLCBwYXRobmFtZSwgcHJvdG9jb2wgfSA9IGVsZW1lbnRcclxuICAhcGF0aG5hbWUuc3RhcnRzV2l0aCgnLycpID8gcGF0aG5hbWUgPSAnLycgKyBwYXRobmFtZSA6ICcnXHJcbiAgcmV0dXJuIHsgaG9zdG5hbWUsIHBvcnQsIHNlYXJjaCwgcGF0aG5hbWUsIHByb3RvY29sIH1cclxufTtcclxuXHJcbl8uZXF1YWxVcmxCYXNlID0gKHVybDEsIHVybDIpID0+IHtcclxuICBsZXQgdXJsUGFydHMxID0gXy5zcGxpdFVybCh1cmwxKTtcclxuICBsZXQgdXJsUGFydHMyID0gXy5zcGxpdFVybCh1cmwyKTtcclxuXHJcbiAgcmV0dXJuIHVybFBhcnRzMS5wcm90b2NvbCA9PT0gdXJsUGFydHMyLnByb3RvY29sICYmIHVybFBhcnRzMS5ob3N0bmFtZSA9PT0gdXJsUGFydHMyLmhvc3RuYW1lICYmIF8uZXF1YWxVcmxQb3J0cyh1cmxQYXJ0czEsIHVybFBhcnRzMilcclxufTtcclxuXHJcbl8uZXF1YWxVcmxQb3J0cyA9IChwYXJ0czEsIHBhcnRzMikgPT4ge1xyXG4gIGxldCBkZWZhdWx0UG9ydCA9IHBhcnRzMS5wcm90b2NvbCA9PT0gJ2h0dHAnID8gcmguY29uc3RzKCdIVFRQX1BPUlQnKSA6IChwYXJ0czEucHJvdG9jb2wgPT09ICdodHRwcycgPyByaC5jb25zdHMoJ0hUVFBTX1BPUlQnKSA6ICcnKVxyXG5cclxuICByZXR1cm4gcGFydHMxLnBvcnQgPT09IHBhcnRzMi5wb3J0IHx8ICghcGFydHMxLnBvcnQgJiYgcGFydHMyLnBvcnQgPT09IGRlZmF1bHRQb3J0KSB8fFxyXG4gICAgKCFwYXJ0czIucG9ydCAmJiBwYXJ0czEucG9ydCA9PT0gZGVmYXVsdFBvcnQpXHJcbn07XHJcblxyXG5fLnVybFN0YXJ0c1dpdGggPSAodXJsLCBiYXNlKSA9PiB7XHJcbiAgbGV0IHVybFBhcnRzMSA9IF8uc3BsaXRVcmwodXJsKTtcclxuICBsZXQgdXJsUGFydHMyID0gXy5zcGxpdFVybChiYXNlKTtcclxuICBsZXQgcGF0aDEgPSB1cmxQYXJ0czEucGF0aG5hbWUgJiYgdXJsUGFydHMxLnBhdGhuYW1lLnRvTG93ZXJDYXNlKClcclxuICBsZXQgcGF0aDIgPSB1cmxQYXJ0czIucGF0aG5hbWUgJiYgdXJsUGFydHMyLnBhdGhuYW1lLnRvTG93ZXJDYXNlKClcclxuICByZXR1cm4gcGF0aDEuc3RhcnRzV2l0aChwYXRoMilcclxufTsiLCJcclxuLy8gdG8gc3VwcG9ydCBvbGQgYnJvd3NlclxyXG5cclxuaWYgKFN0cmluZy5wcm90b3R5cGUudHJpbSA9PSBudWxsKSB7XHJcbiAgU3RyaW5nLnByb3RvdHlwZS50cmltID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gU3RyaW5nKHRoaXMpLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKVxyXG4gIH07XHJcbn1cclxuXHJcbmlmIChTdHJpbmcucHJvdG90eXBlLnRyaW1MZWZ0ID09IG51bGwpIHtcclxuICBTdHJpbmcucHJvdG90eXBlLnRyaW1MZWZ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIFN0cmluZyh0aGlzKS5yZXBsYWNlKC9eXFxzKy8sICcnKVxyXG4gIH1cclxufVxyXG5cclxuaWYgKFN0cmluZy5wcm90b3R5cGUudHJpbVJpZ2h0ID09IG51bGwpIHtcclxuICBTdHJpbmcucHJvdG90eXBlLnRyaW1SaWdodCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiBTdHJpbmcodGhpcykucmVwbGFjZSgvXFxzKyQvLCAnJylcclxuICB9XHJcbn1cclxuXHJcbmlmIChTdHJpbmcucHJvdG90eXBlLnRyaW1TdGFydCA9PSBudWxsKSB7XHJcbiAgU3RyaW5nLnByb3RvdHlwZS50cmltU3RhcnQgPSBTdHJpbmcucHJvdG90eXBlLnRyaW1MZWZ0XHJcbn1cclxuXHJcbmlmIChTdHJpbmcucHJvdG90eXBlLnRyaW1FbmQgPT0gbnVsbCkge1xyXG4gIFN0cmluZy5wcm90b3R5cGUudHJpbUVuZCA9IFN0cmluZy5wcm90b3R5cGUudHJpbVJpZ2h0XHJcbn1cclxuIiwiLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vXHJcbi8vIEVDTUFTY3JpcHQgNSBQb2x5ZmlsbHNcclxuLy9cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gRVM1IDE1LjIgT2JqZWN0IE9iamVjdHNcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vL1xyXG4vLyBFUzUgMTUuMi4zIFByb3BlcnRpZXMgb2YgdGhlIE9iamVjdCBDb25zdHJ1Y3RvclxyXG4vL1xyXG5cclxuLy8gRVM1IDE1LjIuMy4yIE9iamVjdC5nZXRQcm90b3R5cGVPZiAoIE8gKVxyXG4vLyBGcm9tIGh0dHA6Ly9lam9obi5vcmcvYmxvZy9vYmplY3RnZXRwcm90b3R5cGVvZi9cclxuLy8gTk9URTogd29uJ3Qgd29yayBmb3IgdHlwaWNhbCBmdW5jdGlvbiBUKCkge307IFQucHJvdG90eXBlID0ge307IG5ldyBUOyBjYXNlXHJcbi8vIHNpbmNlIHRoZSBjb25zdHJ1Y3RvciBwcm9wZXJ0eSBpcyBkZXN0cm95ZWQuXHJcbmlmICghT2JqZWN0LmdldFByb3RvdHlwZU9mKSB7XHJcbiAgT2JqZWN0LmdldFByb3RvdHlwZU9mID0gZnVuY3Rpb24gKG8pIHtcclxuICAgIGlmIChvICE9PSBPYmplY3QobykpIHsgdGhyb3cgVHlwZUVycm9yKFwiT2JqZWN0LmdldFByb3RvdHlwZU9mIGNhbGxlZCBvbiBub24tb2JqZWN0XCIpOyB9XHJcbiAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgby5jb25zdHJ1Y3Rvci5wcm90b3R5cGUgfHwgT2JqZWN0LnByb3RvdHlwZTtcclxuICB9O1xyXG59XHJcblxyXG4vLyAgICAvLyBFUzUgMTUuMi4zLjMgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciAoIE8sIFAgKVxyXG4vLyAgICBpZiAodHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgIT09IFwiZnVuY3Rpb25cIikge1xyXG4vLyAgICAgICAgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IGZ1bmN0aW9uIChvLCBuYW1lKSB7XHJcbi8vICAgICAgICAgICAgaWYgKG8gIT09IE9iamVjdChvKSkgeyB0aHJvdyBUeXBlRXJyb3IoKTsgfVxyXG4vLyAgICAgICAgICAgIGlmIChvLmhhc093blByb3BlcnR5KG5hbWUpKSB7XHJcbi8vICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbi8vICAgICAgICAgICAgICAgICAgICB2YWx1ZTogb1tuYW1lXSxcclxuLy8gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbi8vICAgICAgICAgICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcclxuLy8gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4vLyAgICAgICAgICAgICAgICB9O1xyXG4vLyAgICAgICAgICAgIH1cclxuLy8gICAgICAgIH07XHJcbi8vICAgIH1cclxuXHJcbi8vIEVTNSAxNS4yLjMuNCBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyAoIE8gKVxyXG5pZiAodHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzICE9PSBcImZ1bmN0aW9uXCIpIHtcclxuICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyA9IGZ1bmN0aW9uIChvKSB7XHJcbiAgICBpZiAobyAhPT0gT2JqZWN0KG8pKSB7IHRocm93IFR5cGVFcnJvcihcIk9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzIGNhbGxlZCBvbiBub24tb2JqZWN0XCIpOyB9XHJcbiAgICB2YXIgcHJvcHMgPSBbXSwgcDtcclxuICAgIGZvciAocCBpbiBvKSB7XHJcbiAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobywgcCkpIHtcclxuICAgICAgICBwcm9wcy5wdXNoKHApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcHJvcHM7XHJcbiAgfTtcclxufVxyXG5cclxuLy8gRVM1IDE1LjIuMy41IE9iamVjdC5jcmVhdGUgKCBPIFssIFByb3BlcnRpZXNdIClcclxuaWYgKHR5cGVvZiBPYmplY3QuY3JlYXRlICE9PSBcImZ1bmN0aW9uXCIpIHtcclxuICBPYmplY3QuY3JlYXRlID0gZnVuY3Rpb24gKHByb3RvdHlwZSwgcHJvcGVydGllcykge1xyXG4gICAgaWYgKHR5cGVvZiBwcm90b3R5cGUgIT09IFwib2JqZWN0XCIpIHsgdGhyb3cgVHlwZUVycm9yKCk7IH1cclxuICAgIGZ1bmN0aW9uIEN0b3IoKSB7fVxyXG4gICAgQ3Rvci5wcm90b3R5cGUgPSBwcm90b3R5cGU7XHJcbiAgICB2YXIgbyA9IG5ldyBDdG9yKCk7XHJcbiAgICBpZiAocHJvdG90eXBlKSB7IG8uY29uc3RydWN0b3IgPSBDdG9yOyB9XHJcbiAgICBpZiAocHJvcGVydGllcyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIGlmIChwcm9wZXJ0aWVzICE9PSBPYmplY3QocHJvcGVydGllcykpIHsgdGhyb3cgVHlwZUVycm9yKCk7IH1cclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMobywgcHJvcGVydGllcyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbztcclxuICB9O1xyXG59XHJcblxyXG4vLyBFUyAxNS4yLjMuNiBPYmplY3QuZGVmaW5lUHJvcGVydHkgKCBPLCBQLCBBdHRyaWJ1dGVzIClcclxuLy8gUGFydGlhbCBzdXBwb3J0IGZvciBtb3N0IGNvbW1vbiBjYXNlIC0gZ2V0dGVycywgc2V0dGVycywgYW5kIHZhbHVlc1xyXG4oZnVuY3Rpb24oKSB7XHJcbiAgaWYgKCFPYmplY3QuZGVmaW5lUHJvcGVydHkgfHxcclxuICAgICAgIShmdW5jdGlvbiAoKSB7IHRyeSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgJ3gnLCB7fSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9ICgpKSkge1xyXG4gICAgdmFyIG9yaWcgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbiAobywgcHJvcCwgZGVzYykge1xyXG4gICAgICAvLyBJbiBJRTggdHJ5IGJ1aWx0LWluIGltcGxlbWVudGF0aW9uIGZvciBkZWZpbmluZyBwcm9wZXJ0aWVzIG9uIERPTSBwcm90b3R5cGVzLlxyXG4gICAgICBpZiAob3JpZykgeyB0cnkgeyByZXR1cm4gb3JpZyhvLCBwcm9wLCBkZXNjKTsgfSBjYXRjaCAoZSkge30gfVxyXG5cclxuICAgICAgaWYgKG8gIT09IE9iamVjdChvKSkgeyB0aHJvdyBUeXBlRXJyb3IoXCJPYmplY3QuZGVmaW5lUHJvcGVydHkgY2FsbGVkIG9uIG5vbi1vYmplY3RcIik7IH1cclxuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuX19kZWZpbmVHZXR0ZXJfXyAmJiAoJ2dldCcgaW4gZGVzYykpIHtcclxuICAgICAgICBPYmplY3QucHJvdG90eXBlLl9fZGVmaW5lR2V0dGVyX18uY2FsbChvLCBwcm9wLCBkZXNjLmdldCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuX19kZWZpbmVTZXR0ZXJfXyAmJiAoJ3NldCcgaW4gZGVzYykpIHtcclxuICAgICAgICBPYmplY3QucHJvdG90eXBlLl9fZGVmaW5lU2V0dGVyX18uY2FsbChvLCBwcm9wLCBkZXNjLnNldCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKCd2YWx1ZScgaW4gZGVzYykge1xyXG4gICAgICAgIG9bcHJvcF0gPSBkZXNjLnZhbHVlO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBvO1xyXG4gICAgfTtcclxuICB9XHJcbn0oKSk7XHJcblxyXG4vLyBFUyAxNS4yLjMuNyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyAoIE8sIFByb3BlcnRpZXMgKVxyXG5pZiAodHlwZW9mIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzICE9PSBcImZ1bmN0aW9uXCIpIHtcclxuICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA9IGZ1bmN0aW9uIChvLCBwcm9wZXJ0aWVzKSB7XHJcbiAgICBpZiAobyAhPT0gT2JqZWN0KG8pKSB7IHRocm93IFR5cGVFcnJvcihcIk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzIGNhbGxlZCBvbiBub24tb2JqZWN0XCIpOyB9XHJcbiAgICB2YXIgbmFtZTtcclxuICAgIGZvciAobmFtZSBpbiBwcm9wZXJ0aWVzKSB7XHJcbiAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocHJvcGVydGllcywgbmFtZSkpIHtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgbmFtZSwgcHJvcGVydGllc1tuYW1lXSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBvO1xyXG4gIH07XHJcbn1cclxuXHJcblxyXG4vLyBFUzUgMTUuMi4zLjE0IE9iamVjdC5rZXlzICggTyApXHJcbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL09iamVjdC9rZXlzXHJcbmlmICghT2JqZWN0LmtleXMpIHtcclxuICBPYmplY3Qua2V5cyA9IGZ1bmN0aW9uIChvKSB7XHJcbiAgICBpZiAobyAhPT0gT2JqZWN0KG8pKSB7IHRocm93IFR5cGVFcnJvcignT2JqZWN0LmtleXMgY2FsbGVkIG9uIG5vbi1vYmplY3QnKTsgfVxyXG4gICAgdmFyIHJldCA9IFtdLCBwO1xyXG4gICAgZm9yIChwIGluIG8pIHtcclxuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvLCBwKSkge1xyXG4gICAgICAgIHJldC5wdXNoKHApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmV0O1xyXG4gIH07XHJcbn1cclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBFUzUgMTUuMyBGdW5jdGlvbiBPYmplY3RzXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLy9cclxuLy8gRVM1IDE1LjMuNCBQcm9wZXJ0aWVzIG9mIHRoZSBGdW5jdGlvbiBQcm90b3R5cGUgT2JqZWN0XHJcbi8vXHJcblxyXG4vLyBFUzUgMTUuMy40LjUgRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQgKCB0aGlzQXJnIFssIGFyZzEgWywgYXJnMiwgLi4uIF1dIClcclxuLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvRnVuY3Rpb24vYmluZFxyXG5pZiAoIUZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kKSB7XHJcbiAgRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAobykge1xyXG4gICAgaWYgKHR5cGVvZiB0aGlzICE9PSAnZnVuY3Rpb24nKSB7IHRocm93IFR5cGVFcnJvcihcIkJpbmQgbXVzdCBiZSBjYWxsZWQgb24gYSBmdW5jdGlvblwiKTsgfVxyXG5cclxuICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSxcclxuICAgICAgICBzZWxmID0gdGhpcyxcclxuICAgICAgICBub3AgPSBmdW5jdGlvbigpIHt9LFxyXG4gICAgICAgIGJvdW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgcmV0dXJuIHNlbGYuYXBwbHkodGhpcyBpbnN0YW5jZW9mIG5vcCA/IHRoaXMgOiBvLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5jb25jYXQoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKSkpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgaWYgKHRoaXMucHJvdG90eXBlKVxyXG4gICAgICBub3AucHJvdG90eXBlID0gdGhpcy5wcm90b3R5cGU7XHJcbiAgICBib3VuZC5wcm90b3R5cGUgPSBuZXcgbm9wKCk7XHJcbiAgICByZXR1cm4gYm91bmQ7XHJcbiAgfTtcclxufVxyXG5cclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBFUzUgMTUuNCBBcnJheSBPYmplY3RzXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLy9cclxuLy8gRVM1IDE1LjQuMyBQcm9wZXJ0aWVzIG9mIHRoZSBBcnJheSBDb25zdHJ1Y3RvclxyXG4vL1xyXG5cclxuXHJcbi8vIEVTNSAxNS40LjMuMiBBcnJheS5pc0FycmF5ICggYXJnIClcclxuLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvaXNBcnJheVxyXG5BcnJheS5pc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAobykgeyByZXR1cm4gQm9vbGVhbihvICYmIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChPYmplY3QobykpID09PSAnW29iamVjdCBBcnJheV0nKTsgfTtcclxuXHJcblxyXG4vL1xyXG4vLyBFUzUgMTUuNC40IFByb3BlcnRpZXMgb2YgdGhlIEFycmF5IFByb3RvdHlwZSBPYmplY3RcclxuLy9cclxuXHJcbi8vIEVTNSAxNS40LjQuMTQgQXJyYXkucHJvdG90eXBlLmluZGV4T2YgKCBzZWFyY2hFbGVtZW50IFsgLCBmcm9tSW5kZXggXSApXHJcbi8vIEZyb20gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvaW5kZXhPZlxyXG5pZiAoIUFycmF5LnByb3RvdHlwZS5pbmRleE9mKSB7XHJcbiAgQXJyYXkucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiAoc2VhcmNoRWxlbWVudCAvKiwgZnJvbUluZGV4ICovKSB7XHJcbiAgICBpZiAodGhpcyA9PT0gdm9pZCAwIHx8IHRoaXMgPT09IG51bGwpIHsgdGhyb3cgVHlwZUVycm9yKCk7IH1cclxuXHJcbiAgICB2YXIgdCA9IE9iamVjdCh0aGlzKTtcclxuICAgIHZhciBsZW4gPSB0Lmxlbmd0aCA+Pj4gMDtcclxuICAgIGlmIChsZW4gPT09IDApIHsgcmV0dXJuIC0xOyB9XHJcblxyXG4gICAgdmFyIG4gPSAwO1xyXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIG4gPSBOdW1iZXIoYXJndW1lbnRzWzFdKTtcclxuICAgICAgaWYgKGlzTmFOKG4pKSB7XHJcbiAgICAgICAgbiA9IDA7XHJcbiAgICAgIH0gZWxzZSBpZiAobiAhPT0gMCAmJiBuICE9PSAoMSAvIDApICYmIG4gIT09IC0oMSAvIDApKSB7XHJcbiAgICAgICAgbiA9IChuID4gMCB8fCAtMSkgKiBNYXRoLmZsb29yKE1hdGguYWJzKG4pKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChuID49IGxlbikgeyByZXR1cm4gLTE7IH1cclxuXHJcbiAgICB2YXIgayA9IG4gPj0gMCA/IG4gOiBNYXRoLm1heChsZW4gLSBNYXRoLmFicyhuKSwgMCk7XHJcblxyXG4gICAgZm9yICg7IGsgPCBsZW47IGsrKykge1xyXG4gICAgICBpZiAoayBpbiB0ICYmIHRba10gPT09IHNlYXJjaEVsZW1lbnQpIHtcclxuICAgICAgICByZXR1cm4gaztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIC0xO1xyXG4gIH07XHJcbn1cclxuXHJcbi8vIEVTNSAxNS40LjQuMTUgQXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mICggc2VhcmNoRWxlbWVudCBbICwgZnJvbUluZGV4IF0gKVxyXG4vLyBGcm9tIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0FycmF5L2xhc3RJbmRleE9mXHJcbmlmICghQXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mKSB7XHJcbiAgQXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mID0gZnVuY3Rpb24gKHNlYXJjaEVsZW1lbnQgLyosIGZyb21JbmRleCovKSB7XHJcbiAgICBpZiAodGhpcyA9PT0gdm9pZCAwIHx8IHRoaXMgPT09IG51bGwpIHsgdGhyb3cgVHlwZUVycm9yKCk7IH1cclxuXHJcbiAgICB2YXIgdCA9IE9iamVjdCh0aGlzKTtcclxuICAgIHZhciBsZW4gPSB0Lmxlbmd0aCA+Pj4gMDtcclxuICAgIGlmIChsZW4gPT09IDApIHsgcmV0dXJuIC0xOyB9XHJcblxyXG4gICAgdmFyIG4gPSBsZW47XHJcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgbiA9IE51bWJlcihhcmd1bWVudHNbMV0pO1xyXG4gICAgICBpZiAobiAhPT0gbikge1xyXG4gICAgICAgIG4gPSAwO1xyXG4gICAgICB9IGVsc2UgaWYgKG4gIT09IDAgJiYgbiAhPT0gKDEgLyAwKSAmJiBuICE9PSAtKDEgLyAwKSkge1xyXG4gICAgICAgIG4gPSAobiA+IDAgfHwgLTEpICogTWF0aC5mbG9vcihNYXRoLmFicyhuKSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB2YXIgayA9IG4gPj0gMCA/IE1hdGgubWluKG4sIGxlbiAtIDEpIDogbGVuIC0gTWF0aC5hYnMobik7XHJcblxyXG4gICAgZm9yICg7IGsgPj0gMDsgay0tKSB7XHJcbiAgICAgIGlmIChrIGluIHQgJiYgdFtrXSA9PT0gc2VhcmNoRWxlbWVudCkge1xyXG4gICAgICAgIHJldHVybiBrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gLTE7XHJcbiAgfTtcclxufVxyXG5cclxuLy8gRVM1IDE1LjQuNC4xNiBBcnJheS5wcm90b3R5cGUuZXZlcnkgKCBjYWxsYmFja2ZuIFsgLCB0aGlzQXJnIF0gKVxyXG4vLyBGcm9tIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0FycmF5L2V2ZXJ5XHJcbmlmICghQXJyYXkucHJvdG90eXBlLmV2ZXJ5KSB7XHJcbiAgQXJyYXkucHJvdG90eXBlLmV2ZXJ5ID0gZnVuY3Rpb24gKGZ1biAvKiwgdGhpc3AgKi8pIHtcclxuICAgIGlmICh0aGlzID09PSB2b2lkIDAgfHwgdGhpcyA9PT0gbnVsbCkgeyB0aHJvdyBUeXBlRXJyb3IoKTsgfVxyXG5cclxuICAgIHZhciB0ID0gT2JqZWN0KHRoaXMpO1xyXG4gICAgdmFyIGxlbiA9IHQubGVuZ3RoID4+PiAwO1xyXG4gICAgaWYgKHR5cGVvZiBmdW4gIT09IFwiZnVuY3Rpb25cIikgeyB0aHJvdyBUeXBlRXJyb3IoKTsgfVxyXG5cclxuICAgIHZhciB0aGlzcCA9IGFyZ3VtZW50c1sxXSwgaTtcclxuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICBpZiAoaSBpbiB0ICYmICFmdW4uY2FsbCh0aGlzcCwgdFtpXSwgaSwgdCkpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9O1xyXG59XHJcblxyXG4vLyBFUzUgMTUuNC40LjE3IEFycmF5LnByb3RvdHlwZS5zb21lICggY2FsbGJhY2tmbiBbICwgdGhpc0FyZyBdIClcclxuLy8gRnJvbSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9BcnJheS9zb21lXHJcbmlmICghQXJyYXkucHJvdG90eXBlLnNvbWUpIHtcclxuICBBcnJheS5wcm90b3R5cGUuc29tZSA9IGZ1bmN0aW9uIChmdW4gLyosIHRoaXNwICovKSB7XHJcbiAgICBpZiAodGhpcyA9PT0gdm9pZCAwIHx8IHRoaXMgPT09IG51bGwpIHsgdGhyb3cgVHlwZUVycm9yKCk7IH1cclxuXHJcbiAgICB2YXIgdCA9IE9iamVjdCh0aGlzKTtcclxuICAgIHZhciBsZW4gPSB0Lmxlbmd0aCA+Pj4gMDtcclxuICAgIGlmICh0eXBlb2YgZnVuICE9PSBcImZ1bmN0aW9uXCIpIHsgdGhyb3cgVHlwZUVycm9yKCk7IH1cclxuXHJcbiAgICB2YXIgdGhpc3AgPSBhcmd1bWVudHNbMV0sIGk7XHJcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgaWYgKGkgaW4gdCAmJiBmdW4uY2FsbCh0aGlzcCwgdFtpXSwgaSwgdCkpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9O1xyXG59XHJcblxyXG4vLyBFUzUgMTUuNC40LjE4IEFycmF5LnByb3RvdHlwZS5mb3JFYWNoICggY2FsbGJhY2tmbiBbICwgdGhpc0FyZyBdIClcclxuLy8gRnJvbSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9BcnJheS9mb3JFYWNoXHJcbmlmICghQXJyYXkucHJvdG90eXBlLmZvckVhY2gpIHtcclxuICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChmdW4gLyosIHRoaXNwICovKSB7XHJcbiAgICBpZiAodGhpcyA9PT0gdm9pZCAwIHx8IHRoaXMgPT09IG51bGwpIHsgdGhyb3cgVHlwZUVycm9yKCk7IH1cclxuXHJcbiAgICB2YXIgdCA9IE9iamVjdCh0aGlzKTtcclxuICAgIHZhciBsZW4gPSB0Lmxlbmd0aCA+Pj4gMDtcclxuICAgIGlmICh0eXBlb2YgZnVuICE9PSBcImZ1bmN0aW9uXCIpIHsgdGhyb3cgVHlwZUVycm9yKCk7IH1cclxuXHJcbiAgICB2YXIgdGhpc3AgPSBhcmd1bWVudHNbMV0sIGk7XHJcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgaWYgKGkgaW4gdCkge1xyXG4gICAgICAgIGZ1bi5jYWxsKHRoaXNwLCB0W2ldLCBpLCB0KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuXHJcblxyXG4vLyBFUzUgMTUuNC40LjE5IEFycmF5LnByb3RvdHlwZS5tYXAgKCBjYWxsYmFja2ZuIFsgLCB0aGlzQXJnIF0gKVxyXG4vLyBGcm9tIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0FycmF5L01hcFxyXG5pZiAoIUFycmF5LnByb3RvdHlwZS5tYXApIHtcclxuICBBcnJheS5wcm90b3R5cGUubWFwID0gZnVuY3Rpb24gKGZ1biAvKiwgdGhpc3AgKi8pIHtcclxuICAgIGlmICh0aGlzID09PSB2b2lkIDAgfHwgdGhpcyA9PT0gbnVsbCkgeyB0aHJvdyBUeXBlRXJyb3IoKTsgfVxyXG5cclxuICAgIHZhciB0ID0gT2JqZWN0KHRoaXMpO1xyXG4gICAgdmFyIGxlbiA9IHQubGVuZ3RoID4+PiAwO1xyXG4gICAgaWYgKHR5cGVvZiBmdW4gIT09IFwiZnVuY3Rpb25cIikgeyB0aHJvdyBUeXBlRXJyb3IoKTsgfVxyXG5cclxuICAgIHZhciByZXMgPSBbXTsgcmVzLmxlbmd0aCA9IGxlbjtcclxuICAgIHZhciB0aGlzcCA9IGFyZ3VtZW50c1sxXSwgaTtcclxuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICBpZiAoaSBpbiB0KSB7XHJcbiAgICAgICAgcmVzW2ldID0gZnVuLmNhbGwodGhpc3AsIHRbaV0sIGksIHQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlcztcclxuICB9O1xyXG59XHJcblxyXG4vLyBFUzUgMTUuNC40LjIwIEFycmF5LnByb3RvdHlwZS5maWx0ZXIgKCBjYWxsYmFja2ZuIFsgLCB0aGlzQXJnIF0gKVxyXG4vLyBGcm9tIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0FycmF5L0ZpbHRlclxyXG5pZiAoIUFycmF5LnByb3RvdHlwZS5maWx0ZXIpIHtcclxuICBBcnJheS5wcm90b3R5cGUuZmlsdGVyID0gZnVuY3Rpb24gKGZ1biAvKiwgdGhpc3AgKi8pIHtcclxuICAgIGlmICh0aGlzID09PSB2b2lkIDAgfHwgdGhpcyA9PT0gbnVsbCkgeyB0aHJvdyBUeXBlRXJyb3IoKTsgfVxyXG5cclxuICAgIHZhciB0ID0gT2JqZWN0KHRoaXMpO1xyXG4gICAgdmFyIGxlbiA9IHQubGVuZ3RoID4+PiAwO1xyXG4gICAgaWYgKHR5cGVvZiBmdW4gIT09IFwiZnVuY3Rpb25cIikgeyB0aHJvdyBUeXBlRXJyb3IoKTsgfVxyXG5cclxuICAgIHZhciByZXMgPSBbXTtcclxuICAgIHZhciB0aGlzcCA9IGFyZ3VtZW50c1sxXSwgaTtcclxuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICBpZiAoaSBpbiB0KSB7XHJcbiAgICAgICAgdmFyIHZhbCA9IHRbaV07IC8vIGluIGNhc2UgZnVuIG11dGF0ZXMgdGhpc1xyXG4gICAgICAgIGlmIChmdW4uY2FsbCh0aGlzcCwgdmFsLCBpLCB0KSkge1xyXG4gICAgICAgICAgcmVzLnB1c2godmFsKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmVzO1xyXG4gIH07XHJcbn1cclxuXHJcblxyXG4vLyBFUzUgMTUuNC40LjIxIEFycmF5LnByb3RvdHlwZS5yZWR1Y2UgKCBjYWxsYmFja2ZuIFsgLCBpbml0aWFsVmFsdWUgXSApXHJcbi8vIEZyb20gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvUmVkdWNlXHJcbmlmICghQXJyYXkucHJvdG90eXBlLnJlZHVjZSkge1xyXG4gIEFycmF5LnByb3RvdHlwZS5yZWR1Y2UgPSBmdW5jdGlvbiAoZnVuIC8qLCBpbml0aWFsVmFsdWUgKi8pIHtcclxuICAgIGlmICh0aGlzID09PSB2b2lkIDAgfHwgdGhpcyA9PT0gbnVsbCkgeyB0aHJvdyBUeXBlRXJyb3IoKTsgfVxyXG5cclxuICAgIHZhciB0ID0gT2JqZWN0KHRoaXMpO1xyXG4gICAgdmFyIGxlbiA9IHQubGVuZ3RoID4+PiAwO1xyXG4gICAgaWYgKHR5cGVvZiBmdW4gIT09IFwiZnVuY3Rpb25cIikgeyB0aHJvdyBUeXBlRXJyb3IoKTsgfVxyXG5cclxuICAgIC8vIG5vIHZhbHVlIHRvIHJldHVybiBpZiBubyBpbml0aWFsIHZhbHVlIGFuZCBhbiBlbXB0eSBhcnJheVxyXG4gICAgaWYgKGxlbiA9PT0gMCAmJiBhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7IHRocm93IFR5cGVFcnJvcigpOyB9XHJcblxyXG4gICAgdmFyIGsgPSAwO1xyXG4gICAgdmFyIGFjY3VtdWxhdG9yO1xyXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gMikge1xyXG4gICAgICBhY2N1bXVsYXRvciA9IGFyZ3VtZW50c1sxXTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGRvIHtcclxuICAgICAgICBpZiAoayBpbiB0KSB7XHJcbiAgICAgICAgICBhY2N1bXVsYXRvciA9IHRbaysrXTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gaWYgYXJyYXkgY29udGFpbnMgbm8gdmFsdWVzLCBubyBpbml0aWFsIHZhbHVlIHRvIHJldHVyblxyXG4gICAgICAgIGlmICgrK2sgPj0gbGVuKSB7IHRocm93IFR5cGVFcnJvcigpOyB9XHJcbiAgICAgIH1cclxuICAgICAgd2hpbGUgKHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIHdoaWxlIChrIDwgbGVuKSB7XHJcbiAgICAgIGlmIChrIGluIHQpIHtcclxuICAgICAgICBhY2N1bXVsYXRvciA9IGZ1bi5jYWxsKHVuZGVmaW5lZCwgYWNjdW11bGF0b3IsIHRba10sIGssIHQpO1xyXG4gICAgICB9XHJcbiAgICAgIGsrKztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gYWNjdW11bGF0b3I7XHJcbiAgfTtcclxufVxyXG5cclxuXHJcbi8vIEVTNSAxNS40LjQuMjIgQXJyYXkucHJvdG90eXBlLnJlZHVjZVJpZ2h0ICggY2FsbGJhY2tmbiBbLCBpbml0aWFsVmFsdWUgXSApXHJcbi8vIEZyb20gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvUmVkdWNlUmlnaHRcclxuaWYgKCFBcnJheS5wcm90b3R5cGUucmVkdWNlUmlnaHQpIHtcclxuICBBcnJheS5wcm90b3R5cGUucmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoY2FsbGJhY2tmbiAvKiwgaW5pdGlhbFZhbHVlICovKSB7XHJcbiAgICBpZiAodGhpcyA9PT0gdm9pZCAwIHx8IHRoaXMgPT09IG51bGwpIHsgdGhyb3cgVHlwZUVycm9yKCk7IH1cclxuXHJcbiAgICB2YXIgdCA9IE9iamVjdCh0aGlzKTtcclxuICAgIHZhciBsZW4gPSB0Lmxlbmd0aCA+Pj4gMDtcclxuICAgIGlmICh0eXBlb2YgY2FsbGJhY2tmbiAhPT0gXCJmdW5jdGlvblwiKSB7IHRocm93IFR5cGVFcnJvcigpOyB9XHJcblxyXG4gICAgLy8gbm8gdmFsdWUgdG8gcmV0dXJuIGlmIG5vIGluaXRpYWwgdmFsdWUsIGVtcHR5IGFycmF5XHJcbiAgICBpZiAobGVuID09PSAwICYmIGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHsgdGhyb3cgVHlwZUVycm9yKCk7IH1cclxuXHJcbiAgICB2YXIgayA9IGxlbiAtIDE7XHJcbiAgICB2YXIgYWNjdW11bGF0b3I7XHJcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+PSAyKSB7XHJcbiAgICAgIGFjY3VtdWxhdG9yID0gYXJndW1lbnRzWzFdO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZG8ge1xyXG4gICAgICAgIGlmIChrIGluIHRoaXMpIHtcclxuICAgICAgICAgIGFjY3VtdWxhdG9yID0gdGhpc1trLS1dO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBpZiBhcnJheSBjb250YWlucyBubyB2YWx1ZXMsIG5vIGluaXRpYWwgdmFsdWUgdG8gcmV0dXJuXHJcbiAgICAgICAgaWYgKC0tayA8IDApIHsgdGhyb3cgVHlwZUVycm9yKCk7IH1cclxuICAgICAgfVxyXG4gICAgICB3aGlsZSAodHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgd2hpbGUgKGsgPj0gMCkge1xyXG4gICAgICBpZiAoayBpbiB0KSB7XHJcbiAgICAgICAgYWNjdW11bGF0b3IgPSBjYWxsYmFja2ZuLmNhbGwodW5kZWZpbmVkLCBhY2N1bXVsYXRvciwgdFtrXSwgaywgdCk7XHJcbiAgICAgIH1cclxuICAgICAgay0tO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBhY2N1bXVsYXRvcjtcclxuICB9O1xyXG59XHJcblxyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIEVTNSAxNS41IFN0cmluZyBPYmplY3RzXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuLy9cclxuLy8gRVM1IDE1LjUuNCBQcm9wZXJ0aWVzIG9mIHRoZSBTdHJpbmcgUHJvdG90eXBlIE9iamVjdFxyXG4vL1xyXG5cclxuXHJcbi8vIEVTNSAxNS41LjQuMjAgU3RyaW5nLnByb3RvdHlwZS50cmltKClcclxuaWYgKCFTdHJpbmcucHJvdG90eXBlLnRyaW0pIHtcclxuICBTdHJpbmcucHJvdG90eXBlLnRyaW0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gU3RyaW5nKHRoaXMpLnJlcGxhY2UoL15cXHMrLywgJycpLnJlcGxhY2UoL1xccyskLywgJycpO1xyXG4gIH07XHJcbn1cclxuXHJcblxyXG5cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIEVTNSAxNS45IERhdGUgT2JqZWN0c1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcblxyXG4vL1xyXG4vLyBFUyAxNS45LjQgUHJvcGVydGllcyBvZiB0aGUgRGF0ZSBDb25zdHJ1Y3RvclxyXG4vL1xyXG5cclxuLy8gRVM1IDE1LjkuNC40IERhdGUubm93ICggKVxyXG4vLyBGcm9tIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL0NvcmVfSmF2YVNjcmlwdF8xLjVfUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0RhdGUvbm93XHJcbmlmICghRGF0ZS5ub3cpIHtcclxuICBEYXRlLm5vdyA9IGZ1bmN0aW9uIG5vdygpIHtcclxuICAgIHJldHVybiBOdW1iZXIobmV3IERhdGUoKSk7XHJcbiAgfTtcclxufVxyXG5cclxuXHJcbi8vXHJcbi8vIEVTNSAxNS45LjUgUHJvcGVydGllcyBvZiB0aGUgRGF0ZSBQcm90b3R5cGUgT2JqZWN0XHJcbi8vXHJcblxyXG4vLyBFUzUgMTUuOS40LjQzIERhdGUucHJvdG90eXBlLnRvSVNPU3RyaW5nICggKVxyXG4vLyBJbnNwaXJlZCBieSBodHRwOi8vd3d3Lmpzb24ub3JnL2pzb24yLmpzXHJcbmlmICghRGF0ZS5wcm90b3R5cGUudG9JU09TdHJpbmcpIHtcclxuICBEYXRlLnByb3RvdHlwZS50b0lTT1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIHBhZDIobikgeyByZXR1cm4gKCcwMCcgKyBuKS5zbGljZSgtMik7IH1cclxuICAgIGZ1bmN0aW9uIHBhZDMobikgeyByZXR1cm4gKCcwMDAnICsgbikuc2xpY2UoLTMpOyB9XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuZ2V0VVRDRnVsbFllYXIoKSArICctJyArXHJcbiAgICAgIHBhZDIodGhpcy5nZXRVVENNb250aCgpICsgMSkgKyAnLScgK1xyXG4gICAgICBwYWQyKHRoaXMuZ2V0VVRDRGF0ZSgpKSArICdUJyArXHJcbiAgICAgIHBhZDIodGhpcy5nZXRVVENIb3VycygpKSArICc6JyArXHJcbiAgICAgIHBhZDIodGhpcy5nZXRVVENNaW51dGVzKCkpICsgJzonICtcclxuICAgICAgcGFkMih0aGlzLmdldFVUQ1NlY29uZHMoKSkgKyAnLicgK1xyXG4gICAgICBwYWQzKHRoaXMuZ2V0VVRDTWlsbGlzZWNvbmRzKCkpICsgJ1onO1xyXG4gIH07XHJcbn1cclxuIiwiLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vXHJcbi8vIEVDTUFTY3JpcHQgMjAxNSBQb2x5ZmlsbHNcclxuLy9cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4oZnVuY3Rpb24gKGdsb2JhbCkge1xyXG4gIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAvLyBTZXQgdGhpcyB0byBhbHdheXMgb3ZlcnJpZGUgbmF0aXZlIGltcGxlbWVudGF0aW9ucywgZm9yIHRlc3RpbmdcclxuICAvLyB0aGUgcG9seWZpbGwgaW4gYnJvd3NlcnMgd2l0aCBwYXJ0aWFsL2Z1bGwgRVMyMDE1IHN1cHBvcnQuXHJcbiAgdmFyIE9WRVJSSURFX05BVElWRV9GT1JfVEVTVElORyA9IGZhbHNlO1xyXG5cclxuICB2YXIgdW5kZWZpbmVkID0gKHZvaWQgMCk7IC8vIFBhcmFub2lhXHJcblxyXG4gIC8vIEhlbHBlcnNcclxuXHJcbiAgZnVuY3Rpb24gc3RyaWN0KG8pIHtcclxuICAgIHJldHVybiBvID09PSBnbG9iYWwgPyB1bmRlZmluZWQgOiBvO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gaXNTeW1ib2wocykge1xyXG4gICAgcmV0dXJuICh0eXBlb2YgcyA9PT0gJ3N5bWJvbCcpIHx8ICgnU3ltYm9sJyBpbiBnbG9iYWwgJiYgcyBpbnN0YW5jZW9mIGdsb2JhbC5TeW1ib2wpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0UHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwgbmFtZSkge1xyXG4gICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwgbmFtZSk7XHJcbiAgICB2YXIgcHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KTtcclxuICAgIHdoaWxlICghZGVzYyAmJiBwcm90bykge1xyXG4gICAgICBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihwcm90bywgbmFtZSk7XHJcbiAgICAgIHByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHByb3RvKTtcclxuICAgIH1cclxuICAgIHJldHVybiBkZXNjO1xyXG4gIH1cclxuXHJcbiAgdmFyIGVucXVldWUgPSAoZnVuY3Rpb24obmF0aXZlUHJvbWlzZSwgbmF0aXZlU2V0SW1tZWRpYXRlKSB7XHJcbiAgICBpZiAobmF0aXZlUHJvbWlzZSlcclxuICAgICAgcmV0dXJuIGZ1bmN0aW9uKGpvYikgeyBuYXRpdmVQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCkgeyBqb2IoKTsgfSk7IH07XHJcbiAgICBpZiAobmF0aXZlU2V0SW1tZWRpYXRlKVxyXG4gICAgICByZXR1cm4gZnVuY3Rpb24oam9iKSB7IG5hdGl2ZVNldEltbWVkaWF0ZShqb2IpOyB9O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKGpvYikgeyBzZXRUaW1lb3V0KGpvYiwgMCk7IH07XHJcbiAgfShnbG9iYWxbJ1Byb21pc2UnXSwgZ2xvYmFsWydzZXRJbW1lZGlhdGUnXSkpO1xyXG5cclxuICBmdW5jdGlvbiBkZWZpbmUobywgcCwgdiwgb3ZlcnJpZGUpIHtcclxuICAgIGlmIChwIGluIG8gJiYgIW92ZXJyaWRlICYmICFPVkVSUklERV9OQVRJVkVfRk9SX1RFU1RJTkcpXHJcbiAgICAgIHJldHVybjtcclxuXHJcbiAgICBpZiAodHlwZW9mIHYgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgLy8gU2FuaXR5IGNoZWNrIHRoYXQgZnVuY3Rpb25zIGFyZSBhcHByb3ByaWF0ZWx5IG5hbWVkICh3aGVyZSBwb3NzaWJsZSlcclxuICAgICAgLy9jb25zb2xlLmFzc2VydChpc1N5bWJvbChwKSB8fCAhKCduYW1lJyBpbiB2KSB8fCB2Lm5hbWUgPT09IHAgfHwgdi5uYW1lID09PSBwICsgJ18nLCAnRXhwZWN0ZWQgZnVuY3Rpb24gbmFtZSBcIicgKyBwLnRvU3RyaW5nKCkgKyAnXCIsIHdhcyBcIicgKyB2Lm5hbWUgKyAnXCInKTtcclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIHAsIHtcclxuICAgICAgICB2YWx1ZTogdixcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgd3JpdGFibGU6IHRydWVcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgcCwge1xyXG4gICAgICAgIHZhbHVlOiB2LFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgd3JpdGFibGU6IGZhbHNlXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gc2V0X2ludGVybmFsKG8sIHAsIHYpIHtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBwLCB7XHJcbiAgICAgIHZhbHVlOiB2LFxyXG4gICAgICBjb25maWd1cmFibGU6IGZhbHNlLFxyXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgd3JpdGFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gU25hcHNob3QgaW50cmluc2ljIGZ1bmN0aW9uc1xyXG4gIHZhciAkaXNOYU4gPSBnbG9iYWwuaXNOYU4sXHJcbiAgICAgICRwYXJzZUludCA9IGdsb2JhbC5wYXJzZUludCxcclxuICAgICAgJHBhcnNlRmxvYXQgPSBnbG9iYWwucGFyc2VGbG9hdDtcclxuXHJcbiAgdmFyIEUgPSBNYXRoLkUsXHJcbiAgICAgIExPRzEwRSA9IE1hdGguTE9HMTBFLFxyXG4gICAgICBMT0cyRSA9IE1hdGguTE9HMkUsXHJcbiAgICAgIGFicyA9IE1hdGguYWJzLFxyXG4gICAgICBjZWlsID0gTWF0aC5jZWlsLFxyXG4gICAgICBleHAgPSBNYXRoLmV4cCxcclxuICAgICAgZmxvb3IgPSBNYXRoLmZsb29yLFxyXG4gICAgICBsb2cgPSBNYXRoLmxvZyxcclxuICAgICAgbWF4ID0gTWF0aC5tYXgsXHJcbiAgICAgIG1pbiA9IE1hdGgubWluLFxyXG4gICAgICBwb3cgPSBNYXRoLnBvdyxcclxuICAgICAgcmFuZG9tID0gTWF0aC5yYW5kb20sXHJcbiAgICAgIHNxcnQgPSBNYXRoLnNxcnQ7XHJcblxyXG4gIHZhciBvcmlnX21hdGNoID0gU3RyaW5nLnByb3RvdHlwZS5tYXRjaCxcclxuICAgICAgb3JpZ19yZXBsYWNlID0gU3RyaW5nLnByb3RvdHlwZS5yZXBsYWNlLFxyXG4gICAgICBvcmlnX3NlYXJjaCA9IFN0cmluZy5wcm90b3R5cGUuc2VhcmNoLFxyXG4gICAgICBvcmlnX3NwbGl0ID0gU3RyaW5nLnByb3RvdHlwZS5zcGxpdDtcclxuXHJcbiAgLy8gVGhlc2UgYXJlIHVzZWQgZm9yIGltcGxlbWVudGluZyB0aGUgcG9seWZpbGxzLCBidXQgbm90IGV4cG9ydGVkLlxyXG5cclxuICAvLyBJbnNwaXJlZCBieSBodHRwczovL2dpc3QuZ2l0aHViLmNvbS8xNjM4MDU5XHJcbiAgLyoqIEBjb25zdHJ1Y3RvciAqL1xyXG4gIGZ1bmN0aW9uIEVwaGVtZXJvblRhYmxlKCkge1xyXG4gICAgdmFyIHNlY3JldEtleSA9IE9iamVjdENyZWF0ZShudWxsKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb25jZWFsKG8pIHtcclxuICAgICAgdmFyIG9WYWx1ZU9mID0gby52YWx1ZU9mLCBzZWNyZXRzID0gT2JqZWN0Q3JlYXRlKG51bGwpO1xyXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgJ3ZhbHVlT2YnLCB7XHJcbiAgICAgICAgICB2YWx1ZTogKGZ1bmN0aW9uKHNlY3JldEtleSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGspIHtcclxuICAgICAgICAgICAgICByZXR1cm4gKGsgPT09IHNlY3JldEtleSkgPyBzZWNyZXRzIDogb1ZhbHVlT2YuYXBwbHkobywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgIH0oc2VjcmV0S2V5KSksXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIHdyaXRlYWJsZTogdHJ1ZSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gc2VjcmV0cztcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByZXZlYWwobykge1xyXG4gICAgICB2YXIgdiA9IHR5cGVvZiBvLnZhbHVlT2YgPT09ICdmdW5jdGlvbicgJiYgby52YWx1ZU9mKHNlY3JldEtleSk7XHJcbiAgICAgIHJldHVybiB2ID09PSBvID8gbnVsbCA6IHY7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgY2xlYXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHNlY3JldEtleSA9IE9iamVjdENyZWF0ZShudWxsKTtcclxuICAgICAgfSxcclxuICAgICAgcmVtb3ZlOiBmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICB2YXIgc2VjcmV0cyA9IHJldmVhbChrZXkpO1xyXG4gICAgICAgIGlmIChzZWNyZXRzICYmIEhhc093blByb3BlcnR5KHNlY3JldHMsICd2YWx1ZScpKSB7XHJcbiAgICAgICAgICBkZWxldGUgc2VjcmV0cy52YWx1ZTtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH0sXHJcbiAgICAgIGdldDogZnVuY3Rpb24oa2V5LCBkZWZhdWx0VmFsdWUpIHtcclxuICAgICAgICB2YXIgc2VjcmV0cyA9IHJldmVhbChrZXkpO1xyXG4gICAgICAgIHJldHVybiAoc2VjcmV0cyAmJiBIYXNPd25Qcm9wZXJ0eShzZWNyZXRzLCAndmFsdWUnKSkgPyBzZWNyZXRzLnZhbHVlIDogZGVmYXVsdFZhbHVlO1xyXG4gICAgICB9LFxyXG4gICAgICBoYXM6IGZ1bmN0aW9uKGtleSkge1xyXG4gICAgICAgIHZhciBzZWNyZXRzID0gcmV2ZWFsKGtleSk7XHJcbiAgICAgICAgcmV0dXJuIEJvb2xlYW4oc2VjcmV0cyAmJiBIYXNPd25Qcm9wZXJ0eShzZWNyZXRzLCAndmFsdWUnKSk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHNldDogZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciBzZWNyZXRzID0gcmV2ZWFsKGtleSkgfHwgY29uY2VhbChrZXkpO1xyXG4gICAgICAgIHNlY3JldHMudmFsdWUgPSB2YWx1ZTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHZhciBlbXB0eSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XHJcblxyXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vXHJcbiAgLy8gRUNNQVNjcmlwdCAyMDE1XHJcbiAgLy8gaHR0cDovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzYuMC9cclxuICAvL1xyXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyAxOS40IFN5bWJvbCBPYmplY3RzXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIC8vIE5PVEU6IFN5bWJvbHMgYXJlIGRlZmluZWQgaGVyZSAtIG91dCBvZiBzcGVjIG9yZGVyIC0gc2luY2Ugd2UgbmVlZCB0aGVcclxuICAvLyBwcm9wZXJ0aWVzIGFuZCBwcm90b3R5cGUgdG8gYmUgcG9wdWxhdGVkIGZvciBvdGhlciBwb2x5ZmlsbHMuXHJcblxyXG4gIC8vIE5PVEU6IE5vdCBzZWN1cmUsIG5vciBpcyBvYmpbJCRzeW1ib2xdIGhpZGRlbiBmcm9tIE9iamVjdC5rZXlzKClcclxuXHJcbiAgdmFyIHN5bWJvbEZvcktleTtcclxuICAoZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VjcmV0ID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuICAgIHZhciBzeW1ib2xNYXAgPSB7fTtcclxuICAgIHN5bWJvbEZvcktleSA9IGZ1bmN0aW9uKGspIHtcclxuICAgICAgcmV0dXJuIHN5bWJvbE1hcFtrXTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIEdsb2JhbFN5bWJvbFJlZ2lzdHJ5ID0gW107XHJcblxyXG4gICAgZnVuY3Rpb24gdW5pcXVlKGJpdHMpIHtcclxuICAgICAgcmV0dXJuIEFycmF5KGJpdHMgKyAxKS5qb2luKCd4JykucmVwbGFjZSgveC9nLCBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gcmFuZG9tKCkgPCAwLjUgPyAnXFx1MjAwQycgOiAnXFx1MjAwRCc7IC8vIEpXTkogLyBaV0pcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMTkuNC4xIFRoZSBTeW1ib2wgQ29uc3RydWN0b3JcclxuICAgIC8vIDE5LjQuMS4xIFN5bWJvbCAoIGRlc2NyaXB0aW9uPXVuZGVmaW5lZCApXHJcbiAgICBmdW5jdGlvbiBTeW1ib2woZGVzY3JpcHRpb24pIHtcclxuICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFN5bWJvbCkpIHJldHVybiBuZXcgU3ltYm9sKGRlc2NyaXB0aW9uLCBzZWNyZXQpO1xyXG4gICAgICBpZiAodGhpcyBpbnN0YW5jZW9mIFN5bWJvbCAmJiBhcmd1bWVudHNbMV0gIT09IHNlY3JldCkgdGhyb3cgVHlwZUVycm9yKCk7XHJcblxyXG4gICAgICB2YXIgZGVzY1N0cmluZyA9IGRlc2NyaXB0aW9uID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBTdHJpbmcoZGVzY3JpcHRpb24pO1xyXG5cclxuICAgICAgc2V0X2ludGVybmFsKHRoaXMsICdbW1N5bWJvbERhdGFdXScsIHVuaXF1ZSgxMjgpKTtcclxuICAgICAgc2V0X2ludGVybmFsKHRoaXMsICdbW0Rlc2NyaXB0aW9uXV0nLCBkZXNjU3RyaW5nKTtcclxuXHJcbiAgICAgIHN5bWJvbE1hcFt0aGlzXSA9IHRoaXM7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghKCdTeW1ib2wnIGluIGdsb2JhbCkgfHwgT1ZFUlJJREVfTkFUSVZFX0ZPUl9URVNUSU5HKVxyXG4gICAgICBnbG9iYWwuU3ltYm9sID0gU3ltYm9sO1xyXG5cclxuICAgIC8vIDE5LjQuMiBQcm9wZXJ0aWVzIG9mIHRoZSBTeW1ib2wgQ29uc3RydWN0b3JcclxuXHJcbiAgICAvLyAxOS40LjIuMSBTeW1ib2wuZm9yIChrZXkpXHJcbiAgICBkZWZpbmUoU3ltYm9sLCAnZm9yJywgZnVuY3Rpb24gZm9yXyhrZXkpIHtcclxuICAgICAgdmFyIHN0cmluZ0tleSA9IFN0cmluZyhrZXkpO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEdsb2JhbFN5bWJvbFJlZ2lzdHJ5Lmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgdmFyIGUgPSBHbG9iYWxTeW1ib2xSZWdpc3RyeVtpXTtcclxuICAgICAgICBpZiAoU2FtZVZhbHVlKGVbJ1tba2V5XV0nXSwgc3RyaW5nS2V5KSkgcmV0dXJuIGVbJ1tbc3ltYm9sXV0nXTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgbmV3U3ltYm9sID0gU3ltYm9sKGtleSk7XHJcbiAgICAgIEdsb2JhbFN5bWJvbFJlZ2lzdHJ5LnB1c2goeydbW2tleV1dJzogc3RyaW5nS2V5LCAnW1tzeW1ib2xdXSc6IG5ld1N5bWJvbH0pO1xyXG4gICAgICByZXR1cm4gbmV3U3ltYm9sO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gMTkuNC4yLjIgU3ltYm9sLmhhc0luc3RhbmNlXHJcbiAgICAvLyAxOS40LjIuMyBTeW1ib2wuaXNDb25jYXRTcHJlYWRhYmxlXHJcblxyXG4gICAgLy8gMTkuNC4yLjQgU3ltYm9sLml0ZXJhdG9yXHJcbiAgICBkZWZpbmUoZ2xvYmFsLlN5bWJvbCwgJ2l0ZXJhdG9yJywgZ2xvYmFsLlN5bWJvbCgnU3ltYm9sLml0ZXJhdG9yJykpO1xyXG5cclxuICAgIC8vIDE5LjQuMi41IFN5bWJvbC5rZXlGb3IgKHN5bSlcclxuICAgIGRlZmluZShTeW1ib2wsICdrZXlGb3InLCBmdW5jdGlvbiBrZXlGb3Ioc3ltKSB7XHJcbiAgICAgIGlmICghKHN5bSBpbnN0YW5jZW9mIFN5bWJvbCkpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEdsb2JhbFN5bWJvbFJlZ2lzdHJ5Lmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgdmFyIGUgPSBHbG9iYWxTeW1ib2xSZWdpc3RyeVtpXTtcclxuICAgICAgICBpZiAoU2FtZVZhbHVlKGVbJ1tbc3ltYm9sXV0nXSwgc3ltKSkgcmV0dXJuIGVbJ1tba2V5XV0nXTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gMTkuNC4yLjYgU3ltYm9sLm1hdGNoXHJcbiAgICBkZWZpbmUoZ2xvYmFsLlN5bWJvbCwgJ21hdGNoJywgZ2xvYmFsLlN5bWJvbCgnU3ltYm9sLm1hdGNoJykpO1xyXG5cclxuICAgIC8vIDE5LjQuMi43IFN5bWJvbC5wcm90b3R5cGVcclxuXHJcbiAgICAvLyAxOS40LjIuOCBTeW1ib2wucmVwbGFjZVxyXG4gICAgZGVmaW5lKGdsb2JhbC5TeW1ib2wsICdyZXBsYWNlJywgZ2xvYmFsLlN5bWJvbCgnU3ltYm9sLnJlcGxhY2UnKSk7XHJcblxyXG4gICAgLy8gMTkuNC4yLjkgU3ltYm9sLnNlYXJjaFxyXG4gICAgZGVmaW5lKGdsb2JhbC5TeW1ib2wsICdzZWFyY2gnLCBnbG9iYWwuU3ltYm9sKCdTeW1ib2wuc2VhcmNoJykpO1xyXG5cclxuICAgIC8vIDE5LjQuMi4xMCBTeW1ib2wuc3BlY2llc1xyXG5cclxuICAgIC8vIDE5LjQuMi4xMSBTeW1ib2wuc2VhcmNoXHJcbiAgICBkZWZpbmUoZ2xvYmFsLlN5bWJvbCwgJ3NwbGl0JywgZ2xvYmFsLlN5bWJvbCgnU3ltYm9sLnNwbGl0JykpO1xyXG5cclxuICAgIC8vIDE5LjQuMi4xMiBTeW1ib2wudG9QcmltaXRpdmVcclxuXHJcbiAgICAvLyAxOS40LjIuMTMgU3ltYm9sLnRvU3RyaW5nVGFnXHJcbiAgICBkZWZpbmUoZ2xvYmFsLlN5bWJvbCwgJ3RvU3RyaW5nVGFnJywgZ2xvYmFsLlN5bWJvbCgnU3ltYm9sLnRvU3RyaW5nVGFnJykpO1xyXG5cclxuICAgIC8vIDE5LjQuMi4xNCBTeW1ib2wudW5zY29wYWJsZXNcclxuXHJcbiAgICAvLyAxOS40LjMgUHJvcGVydGllcyBvZiB0aGUgU3ltYm9sIFByb3RvdHlwZSBPYmplY3RcclxuICAgIC8vIDE5LjQuMy4xIFN5bWJvbC5wcm90b3R5cGUuY29uc3RydWN0b3JcclxuXHJcbiAgICAvLyAxOS40LjMuMiBTeW1ib2wucHJvdG90eXBlLnRvU3RyaW5nICggKVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN5bWJvbC5wcm90b3R5cGUsICd0b1N0cmluZycsIHtcclxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xyXG4gICAgICAgIHZhciBzID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICAgIHZhciBkZXNjID0gc1snW1tEZXNjcmlwdGlvbl1dJ107XHJcbiAgICAgICAgcmV0dXJuICdTeW1ib2woJyArIChkZXNjID09PSB1bmRlZmluZWQgPyAnJyA6IGRlc2MpICsgc1snW1tTeW1ib2xEYXRhXV0nXSArICcpJztcclxuICAgICAgfSxcclxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0ZWFibGU6IHRydWUsIGVudW1lcmFibGU6IGZhbHNlIH0pO1xyXG5cclxuICAgIC8vIDE5LjQuMy4zIFN5bWJvbC5wcm90b3R5cGUudmFsdWVPZiAoIClcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTeW1ib2wucHJvdG90eXBlLCAndmFsdWVPZicsIHtcclxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlT2YoKSB7XHJcbiAgICAgICAgLy8gVG8gcHJldmVudCBhdXRvbWF0aWMgc3RyaW5nIGNvbnZlcnNpb246XHJcbiAgICAgICAgdGhyb3cgVHlwZUVycm9yKCk7XHJcblxyXG4gICAgICAgIC8vIFNwZWMgaGFzIGFwcHJveGltYXRlbHkgdGhlIGZvbGxvd2luZzpcclxuICAgICAgICAvL3ZhciBzID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICAgIC8vaWYgKFR5cGUocykgPT09ICdzeW1ib2wnKSByZXR1cm4gcztcclxuICAgICAgICAvL2lmIChUeXBlKHMpICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgLy9pZiAoISgnW1tTeW1ib2xEYXRhXV0nIGluIHMpKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICAvL3JldHVybiBzWydbW1N5bWJvbERhdGFdXSddO1xyXG4gICAgICB9LFxyXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsIHdyaXRlYWJsZTogdHJ1ZSwgZW51bWVyYWJsZTogZmFsc2UgfSk7XHJcblxyXG4gICAgLy8gMTkuNC4zLjQgU3ltYm9sLnByb3RvdHlwZSBbIEBAdG9TdHJpbmdUYWcgXVxyXG4gICAgLy8gKERvbmUgbGF0ZXIgdG8gcG9seWZpbGwgcGFydGlhbCBpbXBsZW1lbnRhdGlvbnMpXHJcblxyXG4gICAgLy8gMTkuNC40IFByb3BlcnRpZXMgb2YgU3ltYm9sIEluc3RhbmNlc1xyXG4gIH0oKSk7XHJcblxyXG4gIGNvbnNvbGUuYXNzZXJ0KHR5cGVvZiBnbG9iYWwuU3ltYm9sKCkgPT09ICdzeW1ib2wnIHx8IHN5bWJvbEZvcktleShTdHJpbmcoZ2xvYmFsLlN5bWJvbCgneCcpKSkgIT09IHVuZGVmaW5lZCk7XHJcblxyXG4gIC8vIERlZmluZWQgaGVyZSBzbyB0aGF0IG90aGVyIHByb3RvdHlwZXMgY2FuIHJlZmVyZW5jZSBpdFxyXG4gIC8vIDI1LjEuMiBUaGUgJUl0ZXJhdG9yUHJvdG90eXBlJSBPYmplY3RcclxuICB2YXIgJEl0ZXJhdG9yUHJvdG90eXBlJCA9IHt9O1xyXG5cclxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyA2IEVDTUFTY3JpcHQgRGF0YSBUeXBlcyBhbmQgVmFsdWVzXHJcbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIC8vIDYuMSBFQ01BU2NyaXB0IExhbmd1YWdlIFR5cGVzXHJcblxyXG4gIC8vIFwiVHlwZSh4KVwiIGlzIHVzZWQgYXMgc2hvcnRoYW5kIGZvciBcInRoZSB0eXBlIG9mIHhcIi4uLlxyXG4gIGZ1bmN0aW9uIFR5cGUodikge1xyXG4gICAgc3dpdGNoICh0eXBlb2Ygdikge1xyXG4gICAgY2FzZSAndW5kZWZpbmVkJzogcmV0dXJuICd1bmRlZmluZWQnO1xyXG4gICAgY2FzZSAnYm9vbGVhbic6IHJldHVybiAnYm9vbGVhbic7XHJcbiAgICBjYXNlICdudW1iZXInOiByZXR1cm4gJ251bWJlcic7XHJcbiAgICBjYXNlICdzdHJpbmcnOiByZXR1cm4gJ3N0cmluZyc7XHJcbiAgICBjYXNlICdzeW1ib2wnOiByZXR1cm4gJ3N5bWJvbCc7XHJcbiAgICBkZWZhdWx0OlxyXG4gICAgICBpZiAodiA9PT0gbnVsbCkgcmV0dXJuICdudWxsJztcclxuICAgICAgaWYgKHYgaW5zdGFuY2VvZiBnbG9iYWwuU3ltYm9sKSByZXR1cm4gJ3N5bWJvbCc7XHJcbiAgICAgIHJldHVybiAnb2JqZWN0JztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIDYuMS41LjEgV2VsbC1Lbm93biBTeW1ib2xzXHJcbiAgdmFyICQkaXRlcmF0b3IgPSBnbG9iYWwuU3ltYm9sLml0ZXJhdG9yLFxyXG4gICAgICAkJG1hdGNoID0gZ2xvYmFsLlN5bWJvbC5tYXRjaCxcclxuICAgICAgJCRyZXBsYWNlID0gZ2xvYmFsLlN5bWJvbC5yZXBsYWNlLFxyXG4gICAgICAkJHNlYXJjaCA9IGdsb2JhbC5TeW1ib2wuc2VhcmNoLFxyXG4gICAgICAkJHNwbGl0ID0gZ2xvYmFsLlN5bWJvbC5zcGxpdCxcclxuICAgICAgJCR0b1N0cmluZ1RhZyA9IGdsb2JhbC5TeW1ib2wudG9TdHJpbmdUYWc7XHJcblxyXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIDcgQWJzdHJhY3QgT3BlcmF0aW9uc1xyXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyA3LjEgVHlwZSBDb252ZXJzaW9uXHJcbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIC8vIDcuMS4xIFRvUHJpbWl0aXZlICggaW5wdXQgWywgUHJlZmVycmVkVHlwZV0gKVxyXG4gIC8vIGp1c3QgdXNlIHZhbHVlT2YoKVxyXG5cclxuICAvLyA3LjEuMiBUb0Jvb2xlYW4gKCBhcmd1bWVudCApXHJcbiAgLy8ganVzdCB1c2UgQm9vbGVhbigpXHJcblxyXG4gIC8vIDcuMS4zIFRvTnVtYmVyICggYXJndW1lbnQgKVxyXG4gIC8vIGp1c3QgdXNlIE51bWJlcigpXHJcblxyXG4gIC8vIDcuMS40IFRvSW50ZWdlciAoIGFyZ3VtZW50IClcclxuICBmdW5jdGlvbiBUb0ludGVnZXIobikge1xyXG4gICAgbiA9IE51bWJlcihuKTtcclxuICAgIGlmICgkaXNOYU4obikpIHJldHVybiAwO1xyXG4gICAgaWYgKG4gPT09IDAgfHwgbiA9PT0gSW5maW5pdHkgfHwgbiA9PT0gLUluZmluaXR5KSByZXR1cm4gbjtcclxuICAgIHJldHVybiAoKG4gPCAwKSA/IC0xIDogMSkgKiBmbG9vcihhYnMobikpO1xyXG4gIH1cclxuXHJcbiAgLy8gNy4xLjUgVG9JbnQzMiAoIGFyZ3VtZW50IClcclxuICBmdW5jdGlvbiBUb0ludDMyKHYpIHsgcmV0dXJuIHYgPj4gMDsgfVxyXG5cclxuICAvLyA3LjEuNiBUb1VpbnQzMiAoIGFyZ3VtZW50IClcclxuICBmdW5jdGlvbiBUb1VpbnQzMih2KSB7IHJldHVybiB2ID4+PiAwOyB9XHJcblxyXG4gIC8vIDcuMS43IFRvSW50MTYgKCBhcmd1bWVudCApXHJcbiAgZnVuY3Rpb24gVG9JbnQxNih2KSB7IHJldHVybiAodiA8PCAxNikgPj4gMTY7IH1cclxuXHJcbiAgLy8gNy4xLjggVG9VaW50MTYgKCBhcmd1bWVudCApXHJcbiAgZnVuY3Rpb24gVG9VaW50MTYodikgeyByZXR1cm4gdiAmIDB4RkZGRjsgfVxyXG5cclxuICAvLyA3LjEuOSBUb0ludDggKCBhcmd1bWVudCApXHJcbiAgZnVuY3Rpb24gVG9JbnQ4KHYpIHsgcmV0dXJuICh2IDw8IDI0KSA+PiAyNDsgfVxyXG5cclxuICAvLyA3LjEuMTAgVG9VaW50OCAoIGFyZ3VtZW50IClcclxuICBmdW5jdGlvbiBUb1VpbnQ4KHYpIHsgcmV0dXJuIHYgJiAweEZGOyB9XHJcblxyXG4gIC8vIDcuMS4xMSBUb1VpbnQ4Q2xhbXAgKCBhcmd1bWVudCApXHJcbiAgZnVuY3Rpb24gVG9VaW50OENsYW1wKGFyZ3VtZW50KSB7XHJcbiAgICB2YXIgbnVtYmVyID0gTnVtYmVyKGFyZ3VtZW50KTtcclxuICAgIGlmICgkaXNOYU4obnVtYmVyKSkgcmV0dXJuIDA7XHJcbiAgICBpZiAobnVtYmVyIDw9IDApIHJldHVybiAwO1xyXG4gICAgaWYgKG51bWJlciA+PSAyNTUpIHJldHVybiAyNTU7XHJcbiAgICB2YXIgZiA9IGZsb29yKG51bWJlcik7XHJcbiAgICBpZiAoKGYgKyAwLjUpIDwgbnVtYmVyKSByZXR1cm4gZiArIDE7XHJcbiAgICBpZiAobnVtYmVyIDwgKGYgKyAwLjUpKSByZXR1cm4gZjtcclxuICAgIGlmIChmICUgMikgcmV0dXJuIGYgKyAxO1xyXG4gICAgcmV0dXJuIGY7XHJcbiAgfVxyXG5cclxuICAvLyA3LjEuMTIgVG9TdHJpbmcgKCBhcmd1bWVudCApXHJcbiAgLy8ganVzdCB1c2UgU3RyaW5nKClcclxuXHJcbiAgLy8gNy4xLjEzIFRvT2JqZWN0ICggYXJndW1lbnQgKVxyXG4gIGZ1bmN0aW9uIFRvT2JqZWN0KHYpIHtcclxuICAgIGlmICh2ID09PSBudWxsIHx8IHYgPT09IHVuZGVmaW5lZCkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICByZXR1cm4gT2JqZWN0KHYpO1xyXG4gIH1cclxuXHJcbiAgLy8gNy4xLjE0IFRvUHJvcGVydHlLZXkgKCBhcmd1bWVudCApXHJcbiAgZnVuY3Rpb24gVG9Qcm9wZXJ0eUtleSh2KSB7XHJcbiAgICByZXR1cm4gU3RyaW5nKHYpO1xyXG4gIH1cclxuXHJcbiAgLy8gNy4xLjE1IFRvTGVuZ3RoICggYXJndW1lbnQgKVxyXG4gIGZ1bmN0aW9uIFRvTGVuZ3RoKHYpIHtcclxuICAgIHZhciBsZW4gPSBUb0ludGVnZXIodik7XHJcbiAgICBpZiAobGVuIDw9IDApIHJldHVybiAwO1xyXG4gICAgaWYgKGxlbiA9PT0gSW5maW5pdHkpIHJldHVybiAweDIwMDAwMDAwMDAwMDAwIC0gMTsgLy8gMl41My0xXHJcbiAgICByZXR1cm4gbWluKGxlbiwgMHgyMDAwMDAwMDAwMDAwMCAtIDEpOyAvLyAyXjUzLTFcclxuICB9XHJcblxyXG4gIC8vIDcuMS4xNiBDYW5vbmljYWxOdW1lcmljSW5kZXhTdHJpbmcgKCBhcmd1bWVudCApXHJcblxyXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIDcuMiBUZXN0aW5nIGFuZCBDb21wYXJpc29uIE9wZXJhdGlvbnNcclxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgLy8gNy4yLjEgUmVxdWlyZU9iamVjdENvZXJjaWJsZSAoIGFyZ3VtZW50IClcclxuICAvLyA3LjIuMiBJc0FycmF5ICggYXJndW1lbnQgKVxyXG5cclxuICAvLyA3LjIuMyBJc0NhbGxhYmxlICggYXJndW1lbnQgKVxyXG4gIGZ1bmN0aW9uIElzQ2FsbGFibGUobykgeyByZXR1cm4gdHlwZW9mIG8gPT09ICdmdW5jdGlvbic7IH1cclxuXHJcbiAgLy8gNy4yLjQgSXNDb25zdHJ1Y3RvciAoIGFyZ3VtZW50IClcclxuICBmdW5jdGlvbiBJc0NvbnN0cnVjdG9yKG8pIHtcclxuICAgIC8vIEhhY2tzIGZvciBTYWZhcmkgNyBUeXBlZEFycmF5IFhYWENvbnN0cnVjdG9yIG9iamVjdHNcclxuICAgIGlmICgvQ29uc3RydWN0b3IvLnRlc3QoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pKSkgcmV0dXJuIHRydWU7XHJcbiAgICBpZiAoL0Z1bmN0aW9uLy50ZXN0KE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKSkpIHJldHVybiB0cnVlO1xyXG4gICAgLy8gVE9ETzogQ2FuIHRoaXMgYmUgaW1wcm92ZWQgb24/XHJcbiAgICByZXR1cm4gdHlwZW9mIG8gPT09ICdmdW5jdGlvbic7XHJcbiAgfVxyXG5cclxuICAvLyA3LjIuNSBJc0V4dGVuc2libGUgKE8pXHJcbiAgLy8gNy4yLjYgSXNJbnRlZ2VyICggYXJndW1lbnQgKVxyXG5cclxuICAvLyA3LjIuNyBJc1Byb3BlcnR5S2V5ICggYXJndW1lbnQgKVxyXG4gIGZ1bmN0aW9uIElzUHJvcGVydHlLZXkoYXJndW1lbnQpIHtcclxuICAgIGlmIChUeXBlKGFyZ3VtZW50KSA9PT0gJ3N0cmluZycpIHJldHVybiB0cnVlO1xyXG4gICAgaWYgKFR5cGUoYXJndW1lbnQpID09PSAnc3ltYm9sJykgcmV0dXJuIHRydWU7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvLyA3LjIuOCBJc1JlZ0V4cCAoIGFyZ3VtZW50IClcclxuXHJcbiAgLy8gNy4yLjkgU2FtZVZhbHVlKHgsIHkpXHJcbiAgZnVuY3Rpb24gU2FtZVZhbHVlKHgsIHkpIHtcclxuICAgIGlmICh0eXBlb2YgeCAhPT0gdHlwZW9mIHkpIHJldHVybiBmYWxzZTtcclxuICAgIHN3aXRjaCAodHlwZW9mIHgpIHtcclxuICAgIGNhc2UgJ3VuZGVmaW5lZCc6XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgY2FzZSAnbnVtYmVyJzpcclxuICAgICAgaWYgKHggIT09IHggJiYgeSAhPT0geSkgcmV0dXJuIHRydWU7XHJcbiAgICAgIGlmICh4ID09PSAwICYmIHkgPT09IDApIHJldHVybiAxL3ggPT09IDEveTtcclxuICAgICAgcmV0dXJuIHggPT09IHk7XHJcbiAgICBjYXNlICdib29sZWFuJzpcclxuICAgIGNhc2UgJ3N0cmluZyc6XHJcbiAgICBjYXNlICdvYmplY3QnOlxyXG4gICAgZGVmYXVsdDpcclxuICAgICAgcmV0dXJuIHggPT09IHk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyA3LjIuMTAgU2FtZVZhbHVlWmVybyh4LCB5KVxyXG4gIGZ1bmN0aW9uIFNhbWVWYWx1ZVplcm8oeCwgeSkge1xyXG4gICAgaWYgKHR5cGVvZiB4ICE9PSB0eXBlb2YgeSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgc3dpdGNoICh0eXBlb2YgeCkge1xyXG4gICAgY2FzZSAndW5kZWZpbmVkJzpcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICBjYXNlICdudW1iZXInOlxyXG4gICAgICBpZiAoeCAhPT0geCAmJiB5ICE9PSB5KSByZXR1cm4gdHJ1ZTtcclxuICAgICAgcmV0dXJuIHggPT09IHk7XHJcbiAgICBjYXNlICdib29sZWFuJzpcclxuICAgIGNhc2UgJ3N0cmluZyc6XHJcbiAgICBjYXNlICdvYmplY3QnOlxyXG4gICAgZGVmYXVsdDpcclxuICAgICAgcmV0dXJuIHggPT09IHk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyA3LjMgT3BlcmF0aW9ucyBvbiBPYmplY3RzXHJcbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIC8vIDcuMy4xIEdldCAoTywgUClcclxuICAvLyAtIGp1c3QgdXNlIG8ucCBvciBvW3BdXHJcblxyXG4gIC8vIDcuMy4yIEdldFYgKFYsIFApXHJcbiAgZnVuY3Rpb24gR2V0Vih2LCBwKSB7XHJcbiAgICB2YXIgbyA9IFRvT2JqZWN0KHYpO1xyXG4gICAgcmV0dXJuIG9bcF07XHJcbiAgfVxyXG5cclxuICAvLyA3LjMuMyBTZXQgKE8sIFAsIFYsIFRocm93KVxyXG4gIC8vIC0ganVzdCB1c2Ugby5wID0gdiBvciBvW3BdID0gdlxyXG5cclxuXHJcblxyXG5cclxuICAvLyA3LjMuOSBHZXRNZXRob2QgKE8sIFApXHJcbiAgZnVuY3Rpb24gR2V0TWV0aG9kKG8sIHApIHtcclxuICAgIHZhciBmdW5jID0gR2V0VihvLCBwKTtcclxuICAgIGlmIChmdW5jID09PSB1bmRlZmluZWQgfHwgZnVuYyA9PT0gbnVsbCkgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIGlmICghSXNDYWxsYWJsZShmdW5jKSkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICByZXR1cm4gZnVuYztcclxuICB9XHJcblxyXG4gIC8vIDcuMy4xMCBIYXNQcm9wZXJ0eSAoTywgUClcclxuICBmdW5jdGlvbiBIYXNQcm9wZXJ0eShvLCBwKSB7XHJcbiAgICB3aGlsZSAobykge1xyXG4gICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIHApKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgaWYgKFR5cGUobykgIT09ICdvYmplY3QnKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgIHZhciBvcCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTtcclxuICAgICAgaWYgKG9wID09PSBvKSByZXR1cm4gZmFsc2U7IC8vIElFOCBoYXMgc2VsZi1yZWZlcmVudGlhbCBwcm90b3R5cGVzXHJcbiAgICAgIG8gPSBvcDtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8vIDcuMy4xMSBIYXNPd25Qcm9wZXJ0eSAoTywgUClcclxuICBmdW5jdGlvbiBIYXNPd25Qcm9wZXJ0eShvLCBwKSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIHApO1xyXG4gIH1cclxuXHJcbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gNy40IE9wZXJhdGlvbnMgb24gSXRlcmF0b3IgT2JqZWN0c1xyXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvLyA3LjQuMSBHZXRJdGVyYXRvciAoIG9iaiwgbWV0aG9kIClcclxuICBmdW5jdGlvbiBHZXRJdGVyYXRvcihvYmosIG1ldGhvZCkge1xyXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAyKVxyXG4gICAgICBtZXRob2QgPSBHZXRNZXRob2Qob2JqLCAkJGl0ZXJhdG9yKTtcclxuICAgIHZhciBpdGVyYXRvciA9IG1ldGhvZC5jYWxsKG9iaik7XHJcbiAgICBpZiAoVHlwZShpdGVyYXRvcikgIT09ICdvYmplY3QnKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgIHJldHVybiBpdGVyYXRvcjtcclxuICB9XHJcblxyXG4gIC8vIDcuNC4yIEl0ZXJhdG9yTmV4dCAoIGl0ZXJhdG9yLCB2YWx1ZSApXHJcbiAgZnVuY3Rpb24gSXRlcmF0b3JOZXh0KGl0ZXJhdG9yLCB2YWx1ZSkge1xyXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAyKVxyXG4gICAgICB2YXIgcmVzdWx0ID0gaXRlcmF0b3IubmV4dCgpO1xyXG4gICAgZWxzZVxyXG4gICAgICByZXN1bHQgPSBpdGVyYXRvci5uZXh0KHZhbHVlKTtcclxuICAgIGlmIChUeXBlKHJlc3VsdCkgIT09ICdvYmplY3QnKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfVxyXG5cclxuICAvLyA3LjQuMyBJdGVyYXRvckNvbXBsZXRlICggaXRlclJlc3VsdCApXHJcbiAgZnVuY3Rpb24gSXRlcmF0b3JDb21wbGV0ZShpdGVyUmVzdWx0KSB7XHJcbiAgICBjb25zb2xlLmFzc2VydChUeXBlKGl0ZXJSZXN1bHQpID09PSAnb2JqZWN0Jyk7XHJcbiAgICByZXR1cm4gQm9vbGVhbihpdGVyUmVzdWx0LmRvbmUpO1xyXG4gIH1cclxuXHJcbiAgLy8gNy40LjQgSXRlcmF0b3JWYWx1ZSAoIGl0ZXJSZXN1bHQgKVxyXG4gIGZ1bmN0aW9uIEl0ZXJhdG9yVmFsdWUoaXRlclJlc3VsdCkge1xyXG4gICAgY29uc29sZS5hc3NlcnQoVHlwZShpdGVyUmVzdWx0KSA9PT0gJ29iamVjdCcpO1xyXG4gICAgcmV0dXJuIGl0ZXJSZXN1bHQudmFsdWU7XHJcbiAgfVxyXG5cclxuICAvLyA3LjQuNSBJdGVyYXRvclN0ZXAgKCBpdGVyYXRvciApXHJcbiAgZnVuY3Rpb24gSXRlcmF0b3JTdGVwKCBpdGVyYXRvciwgdmFsdWUgKSB7XHJcbiAgICB2YXIgcmVzdWx0ID0gSXRlcmF0b3JOZXh0KGl0ZXJhdG9yLCB2YWx1ZSk7XHJcbiAgICB2YXIgZG9uZSA9IHJlc3VsdFsnZG9uZSddO1xyXG4gICAgaWYgKEJvb2xlYW4oZG9uZSkgPT09IHRydWUpIHJldHVybiBmYWxzZTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfVxyXG5cclxuICAvLyA3LjQuNiBJdGVyYXRvckNsb3NlKCBpdGVyYXRvciwgY29tcGxldGlvbiApXHJcbiAgZnVuY3Rpb24gSXRlcmF0b3JDbG9zZSggaXRlcmF0b3IsIGNvbXBsZXRpb24gKSB7XHJcbiAgICBjb25zb2xlLmFzc2VydChUeXBlKGl0ZXJhdG9yKSA9PT0gJ29iamVjdCcpO1xyXG4gICAgdmFyIF9yZXR1cm4gPSBHZXRNZXRob2QoaXRlcmF0b3IsICdyZXR1cm4nKTtcclxuICAgIGlmIChfcmV0dXJuID09PSB1bmRlZmluZWQpIHJldHVybiBjb21wbGV0aW9uO1xyXG4gICAgdHJ5IHtcclxuICAgICAgdmFyIGlubmVyUmVzdWx0ID0gX3JldHVybltpdGVyYXRvcl0oKTtcclxuICAgIH0gY2F0Y2ggKHJlc3VsdCkge1xyXG4gICAgICAvLyBUT0RPOiBJZiBjb21wbGV0aW9uLltbdHlwZV1dIGlzIHRocm93LCByZXR1cm4gY29tcGxldGlvblxyXG4gICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgaWYgKFR5cGUoaW5uZXJSZXN1bHQpICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICByZXR1cm4gY29tcGxldGlvbjtcclxuICB9XHJcblxyXG4gIC8vIDcuNC43IENyZWF0ZUl0ZXJSZXN1bHRPYmplY3QgKHZhbHVlLCBkb25lKVxyXG4gIGZ1bmN0aW9uIENyZWF0ZUl0ZXJSZXN1bHRPYmplY3QodmFsdWUsIGRvbmUpIHtcclxuICAgIGNvbnNvbGUuYXNzZXJ0KFR5cGUoZG9uZSkgPT09ICdib29sZWFuJyk7XHJcbiAgICB2YXIgb2JqID0ge307XHJcbiAgICBvYmpbXCJ2YWx1ZVwiXSA9IHZhbHVlO1xyXG4gICAgb2JqW1wiZG9uZVwiXSA9IGRvbmU7XHJcbiAgICByZXR1cm4gb2JqO1xyXG4gIH1cclxuXHJcbiAgLy8gNy40LjggQ3JlYXRlTGlzdEl0ZXJhdG9yIChsaXN0KVxyXG4gIC8vIDcuNC44LjEgTGlzdEl0ZXJhdG9yIG5leHQoIClcclxuXHJcbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gOCBFeGVjdXRhYmxlIENvZGUgYW5kIEV4ZWN1dGlvbiBDb250ZXh0c1xyXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyA4LjQgSm9icyBhbmQgSm9iIFF1ZXVlc1xyXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvLyA4LjQuMSBFbnF1ZXVlSm9iICggcXVldWVOYW1lLCBqb2IsIGFyZ3VtZW50cylcclxuICBmdW5jdGlvbiBFbnF1ZXVlSm9iKHF1ZXVlTmFtZSwgam9iLCBhcmdzKSB7XHJcbiAgICB2YXIgZm4gPSBmdW5jdGlvbigpIHsgam9iLmFwcGx5KHVuZGVmaW5lZCwgYXJncyk7IH07XHJcbiAgICBlbnF1ZXVlKGZuKTtcclxuICB9XHJcblxyXG4gIC8vIDguNC4yIE5leHRKb2IgcmVzdWx0XHJcbiAgZnVuY3Rpb24gTmV4dEpvYihyZXN1bHQpIHtcclxuICAgIC8vIG5vLW9wXHJcbiAgfVxyXG5cclxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyA5IE9yZGluYXJ5IGFuZCBFeG90aWMgT2JqZWN0cyBCZWhhdmlvcnNcclxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgLy8gOS4xLjExIFtbRW51bWVyYXRlXV0gKClcclxuICBmdW5jdGlvbiBFbnVtZXJhdGUob2JqKSB7XHJcbiAgICB2YXIgZSA9IFtdO1xyXG4gICAgaWYgKE9iamVjdChvYmopICE9PSBvYmopIHJldHVybiBlO1xyXG4gICAgdmFyIHZpc2l0ZWQgPSBuZXcgU2V0O1xyXG4gICAgd2hpbGUgKG9iaiAhPT0gbnVsbCkge1xyXG4gICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvYmopLmZvckVhY2goZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgIGlmICghdmlzaXRlZC5oYXMobmFtZSkpIHtcclxuICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIG5hbWUpO1xyXG4gICAgICAgICAgaWYgKGRlc2MpIHtcclxuICAgICAgICAgICAgdmlzaXRlZC5hZGQobmFtZSk7XHJcbiAgICAgICAgICAgIGlmIChkZXNjLmVudW1lcmFibGUpIGUucHVzaChuYW1lKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICBvYmogPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKTtcclxuICAgIH1cclxuICAgIHJldHVybiBlWyQkaXRlcmF0b3JdKCk7XHJcbiAgfVxyXG5cclxuICAvLyA5LjEuMTIgW1tPd25Qcm9wZXJ0eUtleXNdXSAoIClcclxuICBmdW5jdGlvbiBPd25Qcm9wZXJ0eUtleXMobykge1xyXG4gICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG8pO1xyXG4gIH1cclxuXHJcbiAgLy8gOS4xLjEzIE9iamVjdENyZWF0ZShwcm90bywgaW50ZXJuYWxTbG90c0xpc3QpXHJcbiAgZnVuY3Rpb24gT2JqZWN0Q3JlYXRlKHByb3RvLCBpbnRlcm5hbFNsb3RzTGlzdCkge1xyXG4gICAgcmV0dXJuIE9iamVjdC5jcmVhdGUocHJvdG8sIGludGVybmFsU2xvdHNMaXN0KTtcclxuICB9XHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIDE5IEZ1bmRhbWVudGFsIE9iamVjdHNcclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gMTkuMSBPYmplY3QgT2JqZWN0c1xyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvLyAxOS4xLjEgVGhlIE9iamVjdCBDb25zdHJ1Y3RvclxyXG4gIC8vIDE5LjEuMS4xIE9iamVjdCAoIFsgdmFsdWUgXSApXHJcbiAgLy8gMTkuMS4yIFByb3BlcnRpZXMgb2YgdGhlIE9iamVjdCBDb25zdHJ1Y3RvclxyXG4gIC8vIDE5LjEuMi4xIE9iamVjdC5hc3NpZ24gKCB0YXJnZXQsIC4uLnNvdXJjZXMgKVxyXG4gIGRlZmluZShcclxuICAgIE9iamVjdCwgJ2Fzc2lnbicsXHJcbiAgICBmdW5jdGlvbiBhc3NpZ24odGFyZ2V0LCAvKi4uLiovc291cmNlcykge1xyXG4gICAgICB2YXIgdG8gPSBUb09iamVjdCh0YXJnZXQpO1xyXG4gICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDIpIHJldHVybiB0bztcclxuXHJcbiAgICAgIHZhciBzb3VyY2VzSW5kZXggPSAxO1xyXG4gICAgICB3aGlsZSAoc291cmNlc0luZGV4IDwgYXJndW1lbnRzLmxlbmd0aCkge1xyXG4gICAgICAgIHZhciBuZXh0U291cmNlID0gYXJndW1lbnRzW3NvdXJjZXNJbmRleCsrXTtcclxuICAgICAgICBpZiAobmV4dFNvdXJjZSA9PT0gdW5kZWZpbmVkIHx8IG5leHRTb3VyY2UgPT09IG51bGwpIHtcclxuICAgICAgICAgIHZhciBrZXlzID0gW107XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHZhciBmcm9tID0gVG9PYmplY3QobmV4dFNvdXJjZSk7XHJcbiAgICAgICAgICBrZXlzID0gT3duUHJvcGVydHlLZXlzKGZyb20pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBrZXlzSW5kZXggPSAwOyBrZXlzSW5kZXggPCBrZXlzLmxlbmd0aDsgKytrZXlzSW5kZXgpIHtcclxuICAgICAgICAgIHZhciBuZXh0S2V5ID0ga2V5c1trZXlzSW5kZXhdO1xyXG4gICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGZyb20sIG5leHRLZXkpO1xyXG4gICAgICAgICAgaWYgKGRlc2MgIT09IHVuZGVmaW5lZCAmJiBkZXNjLmVudW1lcmFibGUpIHtcclxuICAgICAgICAgICAgdmFyIHByb3BWYWx1ZSA9IGZyb21bbmV4dEtleV07XHJcbiAgICAgICAgICAgIHRvW25leHRLZXldID0gcHJvcFZhbHVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdG87XHJcbiAgICB9KTtcclxuXHJcbiAgLy8gMTkuMS4yLjIgT2JqZWN0LmNyZWF0ZSAoIE8gWyAsIFByb3BlcnRpZXMgXSApXHJcbiAgLy8gMTkuMS4yLjMgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMgKCBPLCBQcm9wZXJ0aWVzIClcclxuICAvLyAxOS4xLjIuNCBPYmplY3QuZGVmaW5lUHJvcGVydHkgKCBPLCBQLCBBdHRyaWJ1dGVzIClcclxuICAvLyAxOS4xLjIuNSBPYmplY3QuZnJlZXplICggTyApXHJcbiAgLy8gMTkuMS4yLjYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciAoIE8sIFAgKVxyXG5cclxuICAoZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgbmF0aXZlU3ltYm9scyA9ICh0eXBlb2YgZ2xvYmFsLlN5bWJvbCgpID09PSAnc3ltYm9sJyksXHJcbiAgICAgICAgJGdldE93blByb3BlcnR5TmFtZXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyxcclxuICAgICAgICAka2V5cyA9IE9iamVjdC5rZXlzLFxyXG4gICAgICAgICR3aW5kb3dfbmFtZXMgPSAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcgPyAkZ2V0T3duUHJvcGVydHlOYW1lcyh3aW5kb3cpIDogW10pO1xyXG5cclxuICAgIGZ1bmN0aW9uIGlzU3RyaW5nS2V5KGspIHsgcmV0dXJuICFzeW1ib2xGb3JLZXkoayk7IH1cclxuXHJcbiAgICAvLyAxOS4xLjIuNyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyAoIE8gKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICBPYmplY3QsICdnZXRPd25Qcm9wZXJ0eU5hbWVzJyxcclxuICAgICAgZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhvKSB7XHJcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvKSA9PT0gJ1tvYmplY3QgV2luZG93XScpIHtcclxuICAgICAgICAgIC8vIFdvcmthcm91bmQgZm9yIGNyb3NzLXJlYWxtIGNhbGxpbmcgYnkgSUUgaXRzZWxmLlxyXG4gICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2luZXhvcmFibGV0YXNoL3BvbHlmaWxsL2lzc3Vlcy85NlxyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuICRnZXRPd25Qcm9wZXJ0eU5hbWVzKG8pLmZpbHRlcihpc1N0cmluZ0tleSk7XHJcbiAgICAgICAgICB9IGNhdGNoIChfKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkd2luZG93X25hbWVzLnNsaWNlKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAkZ2V0T3duUHJvcGVydHlOYW1lcyhvKS5maWx0ZXIoaXNTdHJpbmdLZXkpO1xyXG4gICAgICB9LCAhbmF0aXZlU3ltYm9scyk7XHJcblxyXG4gICAgLy8gMTkuMS4yLjggT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyAoIE8gKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICBPYmplY3QsICdnZXRPd25Qcm9wZXJ0eVN5bWJvbHMnLFxyXG4gICAgICBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eVN5bWJvbHMobykge1xyXG4gICAgICAgIHJldHVybiAkZ2V0T3duUHJvcGVydHlOYW1lcyhvKS5maWx0ZXIoc3ltYm9sRm9yS2V5KS5tYXAoc3ltYm9sRm9yS2V5KTtcclxuICAgICAgfSwgIW5hdGl2ZVN5bWJvbHMpO1xyXG5cclxuICAgIC8vIDE5LjEuMi4xNCBPYmplY3Qua2V5cyAoIE8gKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICBPYmplY3QsICdrZXlzJyxcclxuICAgICAgZnVuY3Rpb24ga2V5cyhvKSB7XHJcbiAgICAgICAgcmV0dXJuICRrZXlzKG8pLmZpbHRlcihpc1N0cmluZ0tleSk7XHJcbiAgICAgIH0sICFuYXRpdmVTeW1ib2xzKTtcclxuICB9KCkpO1xyXG5cclxuICAvLyAxOS4xLjIuOSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgKCBPIClcclxuICAvLyAxOS4xLjIuMTAgT2JqZWN0LmlzICggdmFsdWUxLCB2YWx1ZTIgKVxyXG4gIGRlZmluZShcclxuICAgIE9iamVjdCwgJ2lzJyxcclxuICAgIGZ1bmN0aW9uIGlzKHZhbHVlMSwgdmFsdWUyKSB7XHJcbiAgICAgIHJldHVybiBTYW1lVmFsdWUodmFsdWUxLCB2YWx1ZTIpO1xyXG4gICAgfSk7XHJcblxyXG4gIC8vIDE5LjEuMi4xMSBPYmplY3QuaXNFeHRlbnNpYmxlICggTyApXHJcbiAgLy8gMTkuMS4yLjEyIE9iamVjdC5pc0Zyb3plbiAoIE8gKVxyXG4gIC8vIDE5LjEuMi4xMyBPYmplY3QuaXNTZWFsZWQgKCBPIClcclxuXHJcbiAgLy8gMTkuMS4yLjE0IE9iamVjdC5rZXlzICggTyApXHJcbiAgLy8gc2VlIGFib3ZlXHJcblxyXG4gIC8vIDE5LjEuMi4xNSBPYmplY3QucHJldmVudEV4dGVuc2lvbnMgKCBPIClcclxuICAvLyAxOS4xLjIuMTYgT2JqZWN0LnByb3RvdHlwZVxyXG4gIC8vIDE5LjEuMi4xNyBPYmplY3Quc2VhbCAoIE8gKVxyXG5cclxuICAvLyAxOS4xLjIuMTggT2JqZWN0LnNldFByb3RvdHlwZU9mICggTywgcHJvdG8gKVxyXG4gIGRlZmluZShcclxuICAgIE9iamVjdCwgJ3NldFByb3RvdHlwZU9mJyxcclxuICAgIGZ1bmN0aW9uIHNldFByb3RvdHlwZU9mKG8sIHByb3RvKSB7XHJcbiAgICAgIGlmIChUeXBlKG8pICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgIGlmIChUeXBlKHByb3RvKSAhPT0gJ29iamVjdCcgJiYgVHlwZShwcm90bykgIT09ICdudWxsJykgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgIG8uX19wcm90b19fID0gcHJvdG87XHJcbiAgICAgIHJldHVybiBvO1xyXG4gICAgfVxyXG4gICk7XHJcblxyXG4gIC8vIDE5LjEuMyBQcm9wZXJ0aWVzIG9mIHRoZSBPYmplY3QgUHJvdG90eXBlIE9iamVjdFxyXG4gIC8vIDE5LjEuMy4xIE9iamVjdC5wcm90b3R5cGUuY29uc3RydWN0b3JcclxuICAvLyAxOS4xLjMuMiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5ICggViApXHJcbiAgLy8gMTkuMS4zLjMgT2JqZWN0LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mICggViApXHJcbiAgLy8gMTkuMS4zLjQgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZSAoIFYgKVxyXG4gIC8vIDE5LjEuMy41IE9iamVjdC5wcm90b3R5cGUudG9Mb2NhbGVTdHJpbmcgKCBbIHJlc2VydmVkMSBbICwgcmVzZXJ2ZWQyIF0gXSApXHJcbiAgLy8gMTkuMS4zLjYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyAoIClcclxuICB2YXIgb19wX3RzID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcclxuICBkZWZpbmUoT2JqZWN0LnByb3RvdHlwZSwgJ3RvU3RyaW5nJyxcclxuICAgICAgIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICB2YXIgbyA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgICAgaWYgKG8gPT09IE9iamVjdChvKSAmJiAkJHRvU3RyaW5nVGFnIGluIG8pIHtcclxuICAgICAgICAgICByZXR1cm4gJ1tvYmplY3QgJyArIG9bJCR0b1N0cmluZ1RhZ10gKyAnXSc7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgcmV0dXJuIG9fcF90cy5hcHBseShvLCBhcmd1bWVudHMpO1xyXG4gICAgICAgfSk7XHJcblxyXG4gIC8vIDE5LjEuMy43IE9iamVjdC5wcm90b3R5cGUudmFsdWVPZiAoIClcclxuICAvLyAxOS4xLjQgUHJvcGVydGllcyBvZiBPYmplY3QgSW5zdGFuY2VzXHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIDE5LjIgRnVuY3Rpb24gT2JqZWN0c1xyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvLyAxOS4yLjEgVGhlIEZ1bmN0aW9uIENvbnN0cnVjdG9yXHJcbiAgLy8gMTkuMi4xLjEgRnVuY3Rpb24gKCBwMSwgcDIsIOKApiAsIHBuLCBib2R5IClcclxuICAvLyAxOS4yLjIgUHJvcGVydGllcyBvZiB0aGUgRnVuY3Rpb24gQ29uc3RydWN0b3JcclxuICAvLyAxOS4yLjIuMSBGdW5jdGlvbi5sZW5ndGhcclxuICAvLyAxOS4yLjIuMiBGdW5jdGlvbi5wcm90b3R5cGVcclxuICAvLyAxOS4yLjMgUHJvcGVydGllcyBvZiB0aGUgRnVuY3Rpb24gUHJvdG90eXBlIE9iamVjdFxyXG4gIC8vIDE5LjIuMy4xIEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseSAoIHRoaXNBcmcsIGFyZ0FycmF5IClcclxuICAvLyAxOS4yLjMuMiBGdW5jdGlvbi5wcm90b3R5cGUuYmluZCAoIHRoaXNBcmcgLCAuLi5hcmdzKVxyXG4gIC8vIDE5LjIuMy4zIEZ1bmN0aW9uLnByb3RvdHlwZS5jYWxsICh0aGlzQXJnICwgLi4uYXJncylcclxuICAvLyAxOS4yLjMuNCBGdW5jdGlvbi5wcm90b3R5cGUuY29uc3RydWN0b3JcclxuICAvLyAxOS4yLjMuNSBGdW5jdGlvbi5wcm90b3R5cGUudG9TdHJpbmcgKCApXHJcbiAgLy8gMTkuMi4zLjYgRnVuY3Rpb24ucHJvdG90eXBlW0BAaGFzSW5zdGFuY2VdICggViApXHJcbiAgLy8gMTkuMi40IEZ1bmN0aW9uIEluc3RhbmNlc1xyXG4gIC8vIDE5LjIuNC4xIGxlbmd0aFxyXG4gIC8vIDE5LjIuNC4yIG5hbWVcclxuICAvLyAxOS4yLjQuMyBwcm90b3R5cGVcclxuXHJcbiAgLy8gKE5vIHBvbHlmaWxsYWJsZSBjaGFuZ2VzIGZyb20gRVM1KVxyXG5cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyAxOS4zIEJvb2xlYW4gT2JqZWN0c1xyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvLyAxOS4zLjEgVGhlIEJvb2xlYW4gQ29uc3RydWN0b3JcclxuICAvLyAxOS4zLjEuMSBCb29sZWFuICggdmFsdWUgKVxyXG4gIC8vIDE5LjMuMiBQcm9wZXJ0aWVzIG9mIHRoZSBCb29sZWFuIENvbnN0cnVjdG9yXHJcbiAgLy8gMTkuMy4yLjEgQm9vbGVhbi5wcm90b3R5cGVcclxuICAvLyAxOS4zLjMgUHJvcGVydGllcyBvZiB0aGUgQm9vbGVhbiBQcm90b3R5cGUgT2JqZWN0XHJcbiAgLy8gMTkuMy4zLjEgQm9vbGVhbi5wcm90b3R5cGUuY29uc3RydWN0b3JcclxuICAvLyAxOS4zLjMuMiBCb29sZWFuLnByb3RvdHlwZS50b1N0cmluZyAoIClcclxuICAvLyAxOS4zLjMuMyBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mICggKVxyXG4gIC8vIDE5LjMuNCBQcm9wZXJ0aWVzIG9mIEJvb2xlYW4gSW5zdGFuY2VzXHJcblxyXG4gIC8vIChObyBwb2x5ZmlsbGFibGUgY2hhbmdlcyBmcm9tIEVTNSlcclxuXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gMTkuNCBTeW1ib2wgT2JqZWN0c1xyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvLyBNb3ZlZCBlYXJsaWVyIGluIHRoaXMgc2NyaXB0LCBzbyB0aGF0IG90aGVyIHBvbHlmaWxscyBjYW4gZGVwZW5kIG9uIHRoZW0uXHJcblxyXG4gIC8vIDE5LjQuMy40IFN5bWJvbC5wcm90b3R5cGUgWyBAQHRvU3RyaW5nVGFnIF1cclxuICBkZWZpbmUoZ2xvYmFsLlN5bWJvbC5wcm90b3R5cGUsIGdsb2JhbC5TeW1ib2wudG9TdHJpbmdUYWcsICdTeW1ib2wnKTtcclxuXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gMTkuNSBFcnJvciBPYmplY3RzXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIC8vIDE5LjUuMSBUaGUgRXJyb3IgQ29uc3RydWN0b3JcclxuICAvLyAxOS41LjEuMSBFcnJvciAoIG1lc3NhZ2UgKVxyXG4gIC8vIDE5LjUuMS4yIG5ldyBFcnJvciggLi4uYXJndW1lbnRzTGlzdCApXHJcbiAgLy8gMTkuNS4yIFByb3BlcnRpZXMgb2YgdGhlIEVycm9yIENvbnN0cnVjdG9yXHJcbiAgLy8gMTkuNS4yLjEgRXJyb3IucHJvdG90eXBlXHJcbiAgLy8gMTkuNS4zIFByb3BlcnRpZXMgb2YgdGhlIEVycm9yIFByb3RvdHlwZSBPYmplY3RcclxuICAvLyAxOS41LjMuMSBFcnJvci5wcm90b3R5cGUuY29uc3RydWN0b3JcclxuICAvLyAxOS41LjMuMiBFcnJvci5wcm90b3R5cGUubWVzc2FnZVxyXG4gIC8vIDE5LjUuMy4zIEVycm9yLnByb3RvdHlwZS5uYW1lXHJcbiAgLy8gMTkuNS4zLjQgRXJyb3IucHJvdG90eXBlLnRvU3RyaW5nICggKVxyXG4gIC8vIDE5LjUuNCBQcm9wZXJ0aWVzIG9mIEVycm9yIEluc3RhbmNlc1xyXG4gIC8vIDE5LjUuNSBOYXRpdmUgRXJyb3IgVHlwZXMgVXNlZCBpbiBUaGlzIFN0YW5kYXJkXHJcbiAgLy8gMTkuNS41LjEgRXZhbEVycm9yXHJcbiAgLy8gMTkuNS41LjIgUmFuZ2VFcnJvclxyXG4gIC8vIDE5LjUuNS4zIFJlZmVyZW5jZUVycm9yXHJcbiAgLy8gMTkuNS41LjQgU3ludGF4RXJyb3JcclxuICAvLyAxOS41LjUuNSBUeXBlRXJyb3JcclxuICAvLyAxOS41LjUuNiBVUklFcnJvclxyXG4gIC8vIDE5LjUuNiBOYXRpdmVFcnJvciBPYmplY3QgU3RydWN0dXJlXHJcbiAgLy8gMTkuNS42LjEgTmF0aXZlRXJyb3IgQ29uc3RydWN0b3JzXHJcbiAgLy8gMTkuNS42LjEuMSBOYXRpdmVFcnJvciAoIG1lc3NhZ2UgKVxyXG4gIC8vIDE5LjUuNi4xLjIgbmV3IE5hdGl2ZUVycm9yICggLi4uYXJndW1lbnRzTGlzdCApXHJcbiAgLy8gMTkuNS42LjIgUHJvcGVydGllcyBvZiB0aGUgTmF0aXZlRXJyb3IgQ29uc3RydWN0b3JzXHJcbiAgLy8gMTkuNS42LjIuMSBOYXRpdmVFcnJvci5wcm90b3R5cGVcclxuICAvLyAxOS41LjYuMyBQcm9wZXJ0aWVzIG9mIHRoZSBOYXRpdmVFcnJvciBQcm90b3R5cGUgT2JqZWN0c1xyXG4gIC8vIDE5LjUuNi40IFByb3BlcnRpZXMgb2YgTmF0aXZlRXJyb3IgSW5zdGFuY2VzXHJcblxyXG4gIC8vIChObyBwb2x5ZmlsbGFibGUgY2hhbmdlcyBmcm9tIEVTNSlcclxuXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gMjAgTnVtYmVycyBhbmQgRGF0ZXNcclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gMjAuMSBOdW1iZXIgT2JqZWN0c1xyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvLyAyMC4xLjEgVGhlIE51bWJlciBDb25zdHJ1Y3RvclxyXG4gIC8vIDIwLjEuMS4xIE51bWJlciAoIFsgdmFsdWUgXSApXHJcbiAgLy8gMjAuMS4xLjIgbmV3IE51bWJlciAoIC4uLmFyZ3VtZW50c0xpc3QgKVxyXG4gIC8vIDIwLjEuMiBQcm9wZXJ0aWVzIG9mIHRoZSBOdW1iZXIgQ29uc3RydWN0b3JcclxuXHJcbiAgLy8gMjAuMS4yLjEgTnVtYmVyLkVQU0lMT05cclxuICBkZWZpbmUoXHJcbiAgICBOdW1iZXIsICdFUFNJTE9OJyxcclxuICAgIChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBuZXh0LCByZXN1bHQ7XHJcbiAgICAgIGZvciAobmV4dCA9IDE7IDEgKyBuZXh0ICE9PSAxOyBuZXh0ID0gbmV4dCAvIDIpXHJcbiAgICAgICAgcmVzdWx0ID0gbmV4dDtcclxuICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0oKSkpO1xyXG5cclxuICAvLyAyMC4xLjIuMiBOdW1iZXIuaXNGaW5pdGUgKCBudW1iZXIgKVxyXG4gIGRlZmluZShcclxuICAgIE51bWJlciwgJ2lzRmluaXRlJyxcclxuICAgIGZ1bmN0aW9uIGlzRmluaXRlKG51bWJlcikge1xyXG4gICAgICBpZiAoVHlwZShudW1iZXIpICE9PSAnbnVtYmVyJykgcmV0dXJuIGZhbHNlO1xyXG4gICAgICBpZiAobnVtYmVyICE9PSBudW1iZXIgfHwgbnVtYmVyID09PSArSW5maW5pdHkgfHwgbnVtYmVyID09PSAtSW5maW5pdHkpIHJldHVybiBmYWxzZTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9KTtcclxuXHJcbiAgLy8gMjAuMS4yLjMgTnVtYmVyLmlzSW50ZWdlciAoIG51bWJlciApXHJcbiAgZGVmaW5lKFxyXG4gICAgTnVtYmVyLCAnaXNJbnRlZ2VyJyxcclxuICAgIGZ1bmN0aW9uIGlzSW50ZWdlcihudW1iZXIpIHtcclxuICAgICAgaWYgKFR5cGUobnVtYmVyKSAhPT0gJ251bWJlcicpIHJldHVybiBmYWxzZTtcclxuICAgICAgaWYgKG51bWJlciAhPT0gbnVtYmVyIHx8IG51bWJlciA9PT0gK0luZmluaXR5IHx8IG51bWJlciA9PT0gLUluZmluaXR5KSByZXR1cm4gZmFsc2U7XHJcbiAgICAgIHZhciBpbnRlZ2VyID0gVG9JbnRlZ2VyKG51bWJlcik7XHJcbiAgICAgIGlmIChpbnRlZ2VyICE9PSBudW1iZXIpIHJldHVybiBmYWxzZTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9KTtcclxuXHJcbiAgLy8gMjAuMS4yLjQgTnVtYmVyLmlzTmFOICggbnVtYmVyIClcclxuICBkZWZpbmUoXHJcbiAgICBOdW1iZXIsICdpc05hTicsXHJcbiAgICBmdW5jdGlvbiBpc05hTihudW1iZXIpIHtcclxuICAgICAgaWYgKFR5cGUobnVtYmVyKSAhPT0gJ251bWJlcicpIHJldHVybiBmYWxzZTtcclxuICAgICAgaWYgKG51bWJlciAhPT0gbnVtYmVyKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSk7XHJcblxyXG4gIC8vIDIwLjEuMi41IE51bWJlci5pc1NhZmVJbnRlZ2VyICggbnVtYmVyIClcclxuICBkZWZpbmUoXHJcbiAgICBOdW1iZXIsICdpc1NhZmVJbnRlZ2VyJyxcclxuICAgIGZ1bmN0aW9uIGlzU2FmZUludGVnZXIobnVtYmVyKSB7XHJcbiAgICAgIGlmIChUeXBlKG51bWJlcikgIT09ICdudW1iZXInKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgIGlmIChudW1iZXIgIT09IG51bWJlciB8fCBudW1iZXIgPT09ICtJbmZpbml0eSB8fCBudW1iZXIgPT09IC1JbmZpbml0eSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB2YXIgaW50ZWdlciA9IFRvSW50ZWdlcihudW1iZXIpO1xyXG4gICAgICBpZiAoaW50ZWdlciAhPT0gbnVtYmVyKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgIGlmIChhYnMoaW50ZWdlcikgPD0gKDB4MjAwMDAwMDAwMDAwMDAgLSAxKSkgLy8gMl41My0xXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICAvLyAyMC4xLjIuNiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUlxyXG4gIGRlZmluZShcclxuICAgIE51bWJlciwgJ01BWF9TQUZFX0lOVEVHRVInLFxyXG4gICAgOTAwNzE5OTI1NDc0MDk5MSk7IC8vIDJeNTMtMVxyXG5cclxuICAvLyAyMC4xLjIuNyBOdW1iZXIuTUFYX1ZBTFVFXHJcblxyXG4gIC8vIDIwLjEuMi44IE51bWJlci5NSU5fU0FGRV9JTlRFR0VSXHJcbiAgZGVmaW5lKFxyXG4gICAgTnVtYmVyLCAnTUlOX1NBRkVfSU5URUdFUicsXHJcbiAgICAtOTAwNzE5OTI1NDc0MDk5MSk7IC8vIC0yXjUzKzFcclxuXHJcbiAgLy8gMjAuMS4yLjkgTnVtYmVyLk1JTl9WQUxVRVxyXG4gIC8vIDIwLjEuMi4xMCBOdW1iZXIuTmFOXHJcbiAgLy8gMjAuMS4yLjExIE51bWJlci5ORUdBVElWRV9JTkZJTklUWVxyXG5cclxuICAvLyAyMC4xLjIuMTIgTnVtYmVyLnBhcnNlRmxvYXQgKCBzdHJpbmcgKVxyXG4gIGRlZmluZShOdW1iZXIsICdwYXJzZUZsb2F0JywgJHBhcnNlRmxvYXQpO1xyXG5cclxuICAvLyAyMC4xLjIuMTMgTnVtYmVyLnBhcnNlSW50ICggc3RyaW5nLCByYWRpeCApXHJcbiAgZGVmaW5lKE51bWJlciwgJ3BhcnNlSW50JywgJHBhcnNlSW50KTtcclxuXHJcbiAgLy8gMjAuMS4yLjE0IE51bWJlci5QT1NJVElWRV9JTkZJTklUWVxyXG4gIC8vIDIwLjEuMi4xNSBOdW1iZXIucHJvdG90eXBlXHJcblxyXG4gIC8vIDIwLjEuMyBQcm9wZXJ0aWVzIG9mIHRoZSBOdW1iZXIgUHJvdG90eXBlIE9iamVjdFxyXG4gIC8vIDIwLjEuMy4xIE51bWJlci5wcm90b3R5cGUuY29uc3RydWN0b3JcclxuICAvLyAyMC4xLjMuMiBOdW1iZXIucHJvdG90eXBlLnRvRXhwb25lbnRpYWwgKCBmcmFjdGlvbkRpZ2l0cyApXHJcbiAgLy8gMjAuMS4zLjMgTnVtYmVyLnByb3RvdHlwZS50b0ZpeGVkICggZnJhY3Rpb25EaWdpdHMgKVxyXG4gIC8vIDIwLjEuMy40IE51bWJlci5wcm90b3R5cGUudG9Mb2NhbGVTdHJpbmcoIFsgcmVzZXJ2ZWQxIFsgLCByZXNlcnZlZDIgXSBdKVxyXG4gIC8vIDIwLjEuMy41IE51bWJlci5wcm90b3R5cGUudG9QcmVjaXNpb24gKCBwcmVjaXNpb24gKVxyXG4gIC8vIDIwLjEuMy42IE51bWJlci5wcm90b3R5cGUudG9TdHJpbmcgKCBbIHJhZGl4IF0gKVxyXG4gIC8vIDIwLjEuMy43IE51bWJlci5wcm90b3R5cGUudmFsdWVPZiAoIClcclxuICAvLyAyMC4xLjQgUHJvcGVydGllcyBvZiBOdW1iZXIgSW5zdGFuY2VzXHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIDIwLjIgVGhlIE1hdGggT2JqZWN0XHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIC8vIDIwLjIuMSBWYWx1ZSBQcm9wZXJ0aWVzIG9mIHRoZSBNYXRoIE9iamVjdFxyXG4gIC8vIDIwLjIuMS4xIE1hdGguRVxyXG4gIC8vIDIwLjIuMS4yIE1hdGguTE4xMFxyXG4gIC8vIDIwLjIuMS4zIE1hdGguTE4yXHJcbiAgLy8gMjAuMi4xLjQgTWF0aC5MT0cxMEVcclxuICAvLyAyMC4yLjEuNSBNYXRoLkxPRzJFXHJcbiAgLy8gMjAuMi4xLjYgTWF0aC5QSVxyXG4gIC8vIDIwLjIuMS43IE1hdGguU1FSVDFfMlxyXG4gIC8vIDIwLjIuMS44IE1hdGguU1FSVDJcclxuXHJcbiAgLy8gMjAuMi4xLjkgTWF0aCBbIEBAdG9TdHJpbmdUYWcgXVxyXG4gIGRlZmluZShNYXRoLCAkJHRvU3RyaW5nVGFnLCAnTWF0aCcpO1xyXG5cclxuICAvLyAyMC4yLjIgRnVuY3Rpb24gUHJvcGVydGllcyBvZiB0aGUgTWF0aCBPYmplY3RcclxuICAvLyAyMC4yLjIuMSBNYXRoLmFicyAoIHggKVxyXG4gIC8vIDIwLjIuMi4yIE1hdGguYWNvcyAoIHggKVxyXG5cclxuICAvLyAyMC4yLjIuMyBNYXRoLmFjb3NoKHgpXHJcbiAgZGVmaW5lKFxyXG4gICAgTWF0aCwgJ2Fjb3NoJyxcclxuICAgIGZ1bmN0aW9uIGFjb3NoKHgpIHtcclxuICAgICAgeCA9IE51bWJlcih4KTtcclxuICAgICAgcmV0dXJuIGxvZyh4ICsgc3FydCh4ICogeCAtIDEpKTtcclxuICAgIH0pO1xyXG5cclxuICAvLyAyMC4yLjIuNCBNYXRoLmFzaW4gKCB4IClcclxuXHJcbiAgLy8gMjAuMi4yLjUgTWF0aC5hc2luaCggeCApXHJcbiAgZGVmaW5lKFxyXG4gICAgTWF0aCwgJ2FzaW5oJyxcclxuICAgIGZ1bmN0aW9uIGFzaW5oKHgpIHtcclxuICAgICAgeCA9IE51bWJlcih4KTtcclxuICAgICAgaWYgKFNhbWVWYWx1ZSh4LCAtMCkpIHtcclxuICAgICAgICByZXR1cm4geDtcclxuICAgICAgfVxyXG4gICAgICB2YXIgcyA9IHNxcnQoeCAqIHggKyAxKTtcclxuICAgICAgcmV0dXJuIChzID09PSAteCkgPyBsb2coMCkgOiBsb2coeCArIHMpO1xyXG4gICAgfSk7XHJcblxyXG4gIC8vIDIwLjIuMi42IE1hdGguYXRhbiAoIHggKVxyXG5cclxuICAvLyAyMC4yLjIuNyBNYXRoLmF0YW5oKCB4IClcclxuICBkZWZpbmUoXHJcbiAgICBNYXRoLCAnYXRhbmgnLFxyXG4gICAgZnVuY3Rpb24gYXRhbmgoeCkge1xyXG4gICAgICB4ID0gTnVtYmVyKHgpO1xyXG4gICAgICByZXR1cm4gKHggPT09IDApID8geCA6IGxvZygoMSArIHgpIC8gKDEgLSB4KSkgLyAyO1xyXG4gICAgfSk7XHJcblxyXG4gIC8vIDIwLjIuMi44IE1hdGguYXRhbjIgKCB5LCB4IClcclxuXHJcbiAgLy8gMjAuMi4yLjkgTWF0aC5jYnJ0ICggeCApXHJcbiAgZGVmaW5lKFxyXG4gICAgTWF0aCwgJ2NicnQnLFxyXG4gICAgZnVuY3Rpb24gY2JydCh4KSB7XHJcbiAgICAgIHggPSBOdW1iZXIoeCk7XHJcbiAgICAgIGlmICgkaXNOYU4oeC94KSkge1xyXG4gICAgICAgIHJldHVybiB4O1xyXG4gICAgICB9XHJcbiAgICAgIHZhciByID0gcG93KGFicyh4KSwgMS8zKTtcclxuICAgICAgdmFyIHQgPSB4L3IvcjtcclxuICAgICAgcmV0dXJuIHIgKyAociAqICh0LXIpIC8gKDIqciArIHQpKTtcclxuICAgIH0pO1xyXG5cclxuICAvLyAyMC4yLjIuMTAgTWF0aC5jZWlsICggeCApXHJcblxyXG4gIC8vIDIwLjIuMi4xMSBNYXRoLmNsejMyICggeCApXHJcbiAgZGVmaW5lKFxyXG4gICAgTWF0aCwgJ2NsejMyJyxcclxuICAgIGZ1bmN0aW9uIGNsejMyKHgpIHtcclxuICAgICAgZnVuY3Rpb24gY2x6OCh4KSB7XHJcbiAgICAgICAgcmV0dXJuICh4ICYgMHhmMCkgPyAoeCAmIDB4ODAgPyAwIDogeCAmIDB4NDAgPyAxIDogeCAmIDB4MjAgPyAyIDogMykgOlxyXG4gICAgICAgICh4ICYgMHgwOCA/IDQgOiB4ICYgMHgwNCA/IDUgOiB4ICYgMHgwMiA/IDYgOiB4ICYgMHgwMSA/IDcgOiA4KTtcclxuICAgICAgfVxyXG4gICAgICB4ID0gVG9VaW50MzIoeCk7XHJcbiAgICAgIHJldHVybiB4ICYgMHhmZjAwMDAwMCA/IGNsejgoeCA+PiAyNCkgOlxyXG4gICAgICAgIHggJiAweGZmMDAwMCA/IGNsejgoeCA+PiAxNikgKyA4IDpcclxuICAgICAgICB4ICYgMHhmZjAwID8gY2x6OCh4ID4+IDgpICsgMTYgOiBjbHo4KHgpICsgMjQ7XHJcbiAgICB9KTtcclxuXHJcblxyXG5cclxuICAvLyAyMC4yLjIuMTIgTWF0aC5jb3MgKCB4IClcclxuXHJcbiAgLy8gMjAuMi4yLjEzIE1hdGguY29zaCAoIHggKVxyXG4gIGRlZmluZShcclxuICAgIE1hdGgsICdjb3NoJyxcclxuICAgIGZ1bmN0aW9uIGNvc2goeCkge1xyXG4gICAgICB4ID0gTnVtYmVyKHgpO1xyXG4gICAgICByZXR1cm4gKHBvdyhFLCB4KSArIHBvdyhFLCAteCkpIC8gMjtcclxuICAgIH0pO1xyXG5cclxuICAvLyAyMC4yLjIuMTQgTWF0aC5leHAgKCB4IClcclxuXHJcbiAgLy8gMjAuMi4yLjE1IE1hdGguZXhwbTEgKCB4IClcclxuICBkZWZpbmUoXHJcbiAgICBNYXRoLCAnZXhwbTEnLFxyXG4gICAgZnVuY3Rpb24gZXhwbTEoeCkge1xyXG4gICAgICB4ID0gTnVtYmVyKHgpO1xyXG4gICAgICAvLyBmcm9tOiBodHRwOi8vd3d3LmpvaG5kY29vay5jb20vY3BwX2xvZzFwLmh0bWxcclxuICAgICAgaWYgKFNhbWVWYWx1ZSh4LCAtMCkpIHtcclxuICAgICAgICByZXR1cm4gLTA7XHJcbiAgICAgIH0gZWxzZSBpZiAoYWJzKHgpIDwgMWUtNSkge1xyXG4gICAgICAgIHJldHVybiB4ICsgMC41ICogeCAqIHg7IC8vIHR3byB0ZXJtcyBvZiBUYXlsb3IgZXhwYW5zaW9uXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGV4cCh4KSAtIDE7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAvLyAyMC4yLjIuMTYgTWF0aC5mbG9vciAoIHggKVxyXG5cclxuICAvLyAyMC4yLjIuMTcgTWF0aC5mcm91bmQgKCB4IClcclxuICBkZWZpbmUoXHJcbiAgICBNYXRoLCAnZnJvdW5kJyxcclxuICAgIGZ1bmN0aW9uIGZyb3VuZCh4KSB7XHJcbiAgICAgIGlmICgkaXNOYU4oeCkpIHtcclxuICAgICAgICByZXR1cm4gTmFOO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICgxL3ggPT09ICtJbmZpbml0eSB8fCAxL3ggPT09IC1JbmZpbml0eSB8fCB4ID09PSArSW5maW5pdHkgfHwgeCA9PT0gLUluZmluaXR5KSB7XHJcbiAgICAgICAgcmV0dXJuIHg7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIChuZXcgRmxvYXQzMkFycmF5KFt4XSkpWzBdO1xyXG4gICAgfSk7XHJcblxyXG4gIC8vIDIwLjIuMi4xOCBNYXRoLmh5cG90ICggdmFsdWUxIFssIHZhbHVlMiBbIC4uLiBdIF0gKVxyXG4gIGRlZmluZShcclxuICAgIE1hdGgsICdoeXBvdCcsXHJcbiAgICBmdW5jdGlvbiBoeXBvdCgpIHtcclxuICAgICAgdmFyIHZhbHVlcyA9IFtdO1xyXG4gICAgICB2YXIgbSA9IDAsIHNhd05hTiA9IGZhbHNlO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgIHZhciBuID0gYWJzKE51bWJlcihhcmd1bWVudHNbaV0pKTtcclxuICAgICAgICBpZiAobiA9PT0gSW5maW5pdHkpIHJldHVybiBuO1xyXG4gICAgICAgIGlmIChuICE9PSBuKSBzYXdOYU4gPSB0cnVlO1xyXG4gICAgICAgIGlmIChuID4gbSkgbSA9IG47XHJcbiAgICAgICAgdmFsdWVzW2ldID0gbjtcclxuICAgICAgfVxyXG4gICAgICBpZiAoc2F3TmFOKSByZXR1cm4gTmFOO1xyXG4gICAgICBpZiAobSA9PT0gMCkgcmV0dXJuICswO1xyXG4gICAgICB2YXIgc3VtID0gKzA7XHJcbiAgICAgIGZvciAoaSA9IDA7IGkgPCB2YWx1ZXMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICB2YXIgciA9IHZhbHVlc1tpXSAvIG07XHJcbiAgICAgICAgc3VtID0gc3VtICsgciAqIHI7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG0gKiBzcXJ0KHN1bSk7XHJcbiAgICB9KTtcclxuXHJcbiAgLy8gMjAuMi4yLjE5IE1hdGguaW11bCAoIHgsIHkgKVxyXG4gIGRlZmluZShcclxuICAgIE1hdGgsICdpbXVsJyxcclxuICAgIGZ1bmN0aW9uIGltdWwoeCwgeSkge1xyXG4gICAgICB2YXIgYSA9IFRvVWludDMyKHgpO1xyXG4gICAgICB2YXIgYiA9IFRvVWludDMyKHkpO1xyXG4gICAgICAvLyAoc2xvdyBidXQgYWNjdXJhdGUpXHJcbiAgICAgIHZhciBhaCAgPSAoYSA+Pj4gMTYpICYgMHhmZmZmO1xyXG4gICAgICB2YXIgYWwgPSBhICYgMHhmZmZmO1xyXG4gICAgICB2YXIgYmggID0gKGIgPj4+IDE2KSAmIDB4ZmZmZjtcclxuICAgICAgdmFyIGJsID0gYiAmIDB4ZmZmZjtcclxuICAgICAgcmV0dXJuICgoYWwgKiBibCkgKyAoKChhaCAqIGJsICsgYWwgKiBiaCkgPDwgMTYpID4+PiAwKXwwKTtcclxuICAgIH0sICgnaW11bCcgaW4gTWF0aCAmJiBNYXRoLmltdWwoMSwgMHg4MDAwMDAwMCkgPT09IDApIC8vIFNhZmFyaSA3IGJ1Z1xyXG4gICk7XHJcblxyXG4gIC8vIDIwLjIuMi4yMCBNYXRoLmxvZyAoIHggKVxyXG5cclxuICAvLyAyMC4yLjIuMjEgTWF0aC5sb2cxcCAoIHggKVxyXG4gIGRlZmluZShcclxuICAgIE1hdGgsICdsb2cxcCcsXHJcbiAgICBmdW5jdGlvbiBsb2cxcCh4KSB7XHJcbiAgICAgIHggPSBOdW1iZXIoeCk7XHJcbiAgICAgIC8vIGZyb206IGh0dHA6Ly93d3cuam9obmRjb29rLmNvbS9jcHBfZXhwbTEuaHRtbFxyXG4gICAgICBpZiAoeCA8IC0xKSB7XHJcbiAgICAgICAgcmV0dXJuIE5hTjtcclxuICAgICAgfSBlbHNlIGlmIChTYW1lVmFsdWUoeCwgLTApKSB7XHJcbiAgICAgICAgcmV0dXJuIC0wO1xyXG4gICAgICB9IGVsc2UgaWYgKGFicyh4KSA+IDFlLTQpIHtcclxuICAgICAgICByZXR1cm4gbG9nKDEgKyB4KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gKC0wLjUgKiB4ICsgMSkgKiB4O1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgLy8gMjAuMi4yLjIyIE1hdGgubG9nMTAgKCB4IClcclxuICBkZWZpbmUoXHJcbiAgICBNYXRoLCAnbG9nMTAnLFxyXG4gICAgZnVuY3Rpb24gbG9nMTAoeCkge1xyXG4gICAgICB4ID0gTnVtYmVyKHgpO1xyXG4gICAgICByZXR1cm4gbG9nKHgpICogTE9HMTBFO1xyXG4gICAgfSk7XHJcblxyXG4gIC8vIDIwLjIuMi4yMyBNYXRoLmxvZzIgKCB4IClcclxuICBkZWZpbmUoXHJcbiAgICBNYXRoLCAnbG9nMicsXHJcbiAgICBmdW5jdGlvbiBsb2cyKHgpIHtcclxuICAgICAgeCA9IE51bWJlcih4KTtcclxuICAgICAgcmV0dXJuIGxvZyh4KSAqIExPRzJFO1xyXG4gICAgfSk7XHJcblxyXG4gIC8vIDIwLjIuMi4yNCBNYXRoLm1heCAoIHZhbHVlMSwgdmFsdWUyICwgLi4udmFsdWVzIClcclxuICAvLyAyMC4yLjIuMjUgTWF0aC5taW4gKCB2YWx1ZTEsIHZhbHVlMiAsIC4uLnZhbHVlcyApXHJcbiAgLy8gMjAuMi4yLjI2IE1hdGgucG93ICggeCwgeSApXHJcbiAgLy8gMjAuMi4yLjI3IE1hdGgucmFuZG9tICggKVxyXG4gIC8vIDIwLjIuMi4yOCBNYXRoLnJvdW5kICggeCApXHJcblxyXG4gIC8vIDIwLjIuMi4yOSBNYXRoLnNpZ24oeClcclxuICBkZWZpbmUoXHJcbiAgICBNYXRoLCAnc2lnbicsXHJcbiAgICBmdW5jdGlvbiBzaWduKHgpIHtcclxuICAgICAgeCA9IE51bWJlcih4KTtcclxuICAgICAgcmV0dXJuIHggPCAwID8gLTEgOiB4ID4gMCA/IDEgOiB4O1xyXG4gICAgfSk7XHJcblxyXG4gIC8vIDIwLjIuMi4zMCBNYXRoLnNpbiAoIHggKVxyXG5cclxuICAvLyAyMC4yLjIuMzEgTWF0aC5zaW5oKCB4IClcclxuICBkZWZpbmUoXHJcbiAgICBNYXRoLCAnc2luaCcsXHJcbiAgICBmdW5jdGlvbiBzaW5oKHgpIHtcclxuICAgICAgeCA9IE51bWJlcih4KTtcclxuICAgICAgcmV0dXJuIFNhbWVWYWx1ZSh4LCAtMCkgPyB4IDogKHBvdyhFLCB4KSAtIHBvdyhFLCAteCkpIC8gMjtcclxuICAgIH0pO1xyXG5cclxuICAvLyAyMC4yLjIuMzIgTWF0aC5zcXJ0ICggeCApXHJcbiAgLy8gMjAuMi4yLjMzIE1hdGgudGFuICggeCApXHJcblxyXG4gIC8vIDIwLjIuMi4zNCBNYXRoLnRhbmggKCB4IClcclxuICBkZWZpbmUoXHJcbiAgICBNYXRoLCAndGFuaCcsXHJcbiAgICBmdW5jdGlvbiB0YW5oKHgpIHtcclxuICAgICAgeCA9IE51bWJlcih4KTtcclxuICAgICAgdmFyIG4gPSBwb3coRSwgMiAqIHgpIC0gMSxcclxuICAgICAgICAgIGQgPSBwb3coRSwgMiAqIHgpICsgMTtcclxuICAgICAgaWYgKFNhbWVWYWx1ZSh4LCAtMCkpXHJcbiAgICAgICAgcmV0dXJuIHg7XHJcbiAgICAgIHJldHVybiAobiA9PT0gZCkgPyAxIDogbiAvIGQ7IC8vIEhhbmRsZSBJbmZpbml0eS9JbmZpbml0eVxyXG4gICAgfSk7XHJcblxyXG4gIC8vIDIwLjIuMi4zNSBNYXRoLnRydW5jICggeCApXHJcbiAgZGVmaW5lKFxyXG4gICAgTWF0aCwgJ3RydW5jJyxcclxuICAgIGZ1bmN0aW9uIHRydW5jKHgpIHtcclxuICAgICAgeCA9IE51bWJlcih4KTtcclxuICAgICAgcmV0dXJuICRpc05hTih4KSA/IE5hTiA6XHJcbiAgICAgICAgeCA8IDAgPyBjZWlsKHgpIDogZmxvb3IoeCk7XHJcbiAgICB9KTtcclxuXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gMjAuMyBEYXRlIE9iamVjdHNcclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgLy8gMjAuMy4xIE92ZXJ2aWV3IG9mIERhdGUgT2JqZWN0cyBhbmQgRGVmaW5pdGlvbnMgb2YgQWJzdHJhY3QgT3BlcmF0aW9uc1xyXG4gIC8vIDIwLjMuMS4xIFRpbWUgVmFsdWVzIGFuZCBUaW1lIFJhbmdlXHJcbiAgLy8gMjAuMy4xLjIgRGF5IE51bWJlciBhbmQgVGltZSB3aXRoaW4gRGF5XHJcbiAgLy8gMjAuMy4xLjMgWWVhciBOdW1iZXJcclxuICAvLyAyMC4zLjEuNCBNb250aCBOdW1iZXJcclxuICAvLyAyMC4zLjEuNSBEYXRlIE51bWJlclxyXG4gIC8vIDIwLjMuMS42IFdlZWsgRGF5XHJcbiAgLy8gMjAuMy4xLjcgTG9jYWwgVGltZSBab25lIEFkanVzdG1lbnRcclxuICAvLyAyMC4zLjEuOCBEYXlsaWdodCBTYXZpbmcgVGltZSBBZGp1c3RtZW50XHJcbiAgLy8gMjAuMy4xLjkgTG9jYWwgVGltZVxyXG4gIC8vIDIwLjMuMS4xMCBIb3VycywgTWludXRlcywgU2Vjb25kLCBhbmQgTWlsbGlzZWNvbmRzXHJcbiAgLy8gMjAuMy4xLjExIE1ha2VUaW1lIChob3VyLCBtaW4sIHNlYywgbXMpXHJcbiAgLy8gMjAuMy4xLjEyIE1ha2VEYXkgKHllYXIsIG1vbnRoLCBkYXRlKVxyXG4gIC8vIDIwLjMuMS4xMyBNYWtlRGF0ZSAoZGF5LCB0aW1lKVxyXG4gIC8vIDIwLjMuMS4xNCBUaW1lQ2xpcCAodGltZSlcclxuICAvLyAyMC4zLjEuMTUgRGF0ZSBUaW1lIFN0cmluZyBGb3JtYXRcclxuICAvLyAyMC4zLjEuMTUuMSBFeHRlbmRlZCB5ZWFyc1xyXG4gIC8vIDIwLjMuMiBUaGUgRGF0ZSBDb25zdHJ1Y3RvclxyXG4gIC8vIDIwLjMuMi4xIERhdGUgKCB5ZWFyLCBtb250aCBbLCBkYXRlIFsgLCBob3VycyBbICwgbWludXRlcyBbICwgc2Vjb25kcyBbICwgbXMgXSBdIF0gXSBdIClcclxuICAvLyAyMC4zLjIuMiBEYXRlICggdmFsdWUgKVxyXG4gIC8vIDIwLjMuMi4zIERhdGUgKCApXHJcbiAgLy8gMjAuMy4zIFByb3BlcnRpZXMgb2YgdGhlIERhdGUgQ29uc3RydWN0b3JcclxuICAvLyAyMC4zLjMuMSBEYXRlLm5vdyAoIClcclxuICAvLyAyMC4zLjMuMiBEYXRlLnBhcnNlIChzdHJpbmcpXHJcbiAgLy8gMjAuMy4zLjMgRGF0ZS5wcm90b3R5cGVcclxuICAvLyAyMC4zLjMuNCBEYXRlLlVUQyAoIHllYXIsIG1vbnRoIFsgLCBkYXRlIFsgLCBob3VycyBbICwgbWludXRlcyBbICwgc2Vjb25kcyBbICwgbXMgXSBdIF0gXSBdIClcclxuICAvLyAyMC4zLjQgUHJvcGVydGllcyBvZiB0aGUgRGF0ZSBQcm90b3R5cGUgT2JqZWN0XHJcbiAgLy8gMjAuMy40LjEgRGF0ZS5wcm90b3R5cGUuY29uc3RydWN0b3JcclxuICAvLyAyMC4zLjQuMiBEYXRlLnByb3RvdHlwZS5nZXREYXRlICggKVxyXG4gIC8vIDIwLjMuNC4zIERhdGUucHJvdG90eXBlLmdldERheSAoIClcclxuICAvLyAyMC4zLjQuNCBEYXRlLnByb3RvdHlwZS5nZXRGdWxsWWVhciAoIClcclxuICAvLyAyMC4zLjQuNSBEYXRlLnByb3RvdHlwZS5nZXRIb3VycyAoIClcclxuICAvLyAyMC4zLjQuNiBEYXRlLnByb3RvdHlwZS5nZXRNaWxsaXNlY29uZHMgKCApXHJcbiAgLy8gMjAuMy40LjcgRGF0ZS5wcm90b3R5cGUuZ2V0TWludXRlcyAoIClcclxuICAvLyAyMC4zLjQuOCBEYXRlLnByb3RvdHlwZS5nZXRNb250aCAoIClcclxuICAvLyAyMC4zLjQuOSBEYXRlLnByb3RvdHlwZS5nZXRTZWNvbmRzICggKVxyXG4gIC8vIDIwLjMuNC4xMCBEYXRlLnByb3RvdHlwZS5nZXRUaW1lICggKVxyXG4gIC8vIDIwLjMuNC4xMSBEYXRlLnByb3RvdHlwZS5nZXRUaW1lem9uZU9mZnNldCAoIClcclxuICAvLyAyMC4zLjQuMTIgRGF0ZS5wcm90b3R5cGUuZ2V0VVRDRGF0ZSAoIClcclxuICAvLyAyMC4zLjQuMTMgRGF0ZS5wcm90b3R5cGUuZ2V0VVRDRGF5ICggKVxyXG4gIC8vIDIwLjMuNC4xNCBEYXRlLnByb3RvdHlwZS5nZXRVVENGdWxsWWVhciAoIClcclxuICAvLyAyMC4zLjQuMTUgRGF0ZS5wcm90b3R5cGUuZ2V0VVRDSG91cnMgKCApXHJcbiAgLy8gMjAuMy40LjE2IERhdGUucHJvdG90eXBlLmdldFVUQ01pbGxpc2Vjb25kcyAoIClcclxuICAvLyAyMC4zLjQuMTcgRGF0ZS5wcm90b3R5cGUuZ2V0VVRDTWludXRlcyAoIClcclxuICAvLyAyMC4zLjQuMTggRGF0ZS5wcm90b3R5cGUuZ2V0VVRDTW9udGggKCApXHJcbiAgLy8gMjAuMy40LjE5IERhdGUucHJvdG90eXBlLmdldFVUQ1NlY29uZHMgKCApXHJcbiAgLy8gMjAuMy40LjIwIERhdGUucHJvdG90eXBlLnNldERhdGUgKCBkYXRlIClcclxuICAvLyAyMC4zLjQuMjEgRGF0ZS5wcm90b3R5cGUuc2V0RnVsbFllYXIgKCB5ZWFyIFsgLCBtb250aCBbICwgZGF0ZSBdIF0gKVxyXG4gIC8vIDIwLjMuNC4yMiBEYXRlLnByb3RvdHlwZS5zZXRIb3VycyAoIGhvdXIgWyAsIG1pbiBbICwgc2VjIFsgLCBtcyBdIF0gXSApXHJcbiAgLy8gMjAuMy40LjIzIERhdGUucHJvdG90eXBlLnNldE1pbGxpc2Vjb25kcyAoIG1zIClcclxuICAvLyAyMC4zLjQuMjQgRGF0ZS5wcm90b3R5cGUuc2V0TWludXRlcyAoIG1pbiBbICwgc2VjIFsgLCBtcyBdIF0gKVxyXG4gIC8vIDIwLjMuNC4yNSBEYXRlLnByb3RvdHlwZS5zZXRNb250aCAoIG1vbnRoIFsgLCBkYXRlIF0gKVxyXG4gIC8vIDIwLjMuNC4yNiBEYXRlLnByb3RvdHlwZS5zZXRTZWNvbmRzICggc2VjIFsgLCBtcyBdIClcclxuICAvLyAyMC4zLjQuMjcgRGF0ZS5wcm90b3R5cGUuc2V0VGltZSAoIHRpbWUgKVxyXG4gIC8vIDIwLjMuNC4yOCBEYXRlLnByb3RvdHlwZS5zZXRVVENEYXRlICggZGF0ZSApXHJcbiAgLy8gMjAuMy40LjI5IERhdGUucHJvdG90eXBlLnNldFVUQ0Z1bGxZZWFyICggeWVhciBbICwgbW9udGggWyAsIGRhdGUgXSBdIClcclxuICAvLyAyMC4zLjQuMzAgRGF0ZS5wcm90b3R5cGUuc2V0VVRDSG91cnMgKCBob3VyIFsgLCBtaW4gWyAsIHNlYyBbICwgbXMgXSBdIF0gKVxyXG4gIC8vIDIwLjMuNC4zMSBEYXRlLnByb3RvdHlwZS5zZXRVVENNaWxsaXNlY29uZHMgKCBtcyApXHJcbiAgLy8gMjAuMy40LjMyIERhdGUucHJvdG90eXBlLnNldFVUQ01pbnV0ZXMgKCBtaW4gWyAsIHNlYyBbLCBtcyBdIF0gKVxyXG4gIC8vIDIwLjMuNC4zMyBEYXRlLnByb3RvdHlwZS5zZXRVVENNb250aCAoIG1vbnRoIFsgLCBkYXRlIF0gKVxyXG4gIC8vIDIwLjMuNC4zNCBEYXRlLnByb3RvdHlwZS5zZXRVVENTZWNvbmRzICggc2VjIFsgLCBtcyBdIClcclxuICAvLyAyMC4zLjQuMzUgRGF0ZS5wcm90b3R5cGUudG9EYXRlU3RyaW5nICggKVxyXG4gIC8vIDIwLjMuNC4zNiBEYXRlLnByb3RvdHlwZS50b0lTT1N0cmluZyAoIClcclxuICAvLyAyMC4zLjQuMzcgRGF0ZS5wcm90b3R5cGUudG9KU09OICgga2V5IClcclxuICAvLyAyMC4zLjQuMzggRGF0ZS5wcm90b3R5cGUudG9Mb2NhbGVEYXRlU3RyaW5nICggWyByZXNlcnZlZDEgWyAsIHJlc2VydmVkMiBdIF0gKVxyXG4gIC8vIDIwLjMuNC4zOSBEYXRlLnByb3RvdHlwZS50b0xvY2FsZVN0cmluZyAoIFsgcmVzZXJ2ZWQxIFsgLCByZXNlcnZlZDIgXSBdIClcclxuICAvLyAyMC4zLjQuNDAgRGF0ZS5wcm90b3R5cGUudG9Mb2NhbGVUaW1lU3RyaW5nICggWyByZXNlcnZlZDEgWyAsIHJlc2VydmVkMiBdIF0gKVxyXG4gIC8vIDIwLjMuNC40MSBEYXRlLnByb3RvdHlwZS50b1N0cmluZyAoIClcclxuICAvLyAyMC4zLjQuNDIgRGF0ZS5wcm90b3R5cGUudG9UaW1lU3RyaW5nICggKVxyXG4gIC8vIDIwLjMuNC40MyBEYXRlLnByb3RvdHlwZS50b1VUQ1N0cmluZyAoIClcclxuICAvLyAyMC4zLjQuNDQgRGF0ZS5wcm90b3R5cGUudmFsdWVPZiAoIClcclxuICAvLyAyMC4zLjQuNDUgRGF0ZS5wcm90b3R5cGUgWyBAQHRvUHJpbWl0aXZlIF0gKCBoaW50IClcclxuICAvLyAyMC4zLjUgUHJvcGVydGllcyBvZiBEYXRlIEluc3RhbmNlc1xyXG5cclxuICAvLyAoTm8gcG9seWZpbGxhYmxlIGNoYW5nZXMgZnJvbSBFUzUpXHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIDIxIFRleHQgUHJvY2Vzc2luZ1xyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICB2YXIgc3RyaW5nX3JlZ2V4cF9kaXNwYXRjaCA9IChmdW5jdGlvbigpIHtcclxuICAgIHZhciBmYXV4ID0ge30sIHNlY3JldCA9IFN5bWJvbCgpO1xyXG4gICAgZmF1eFtTeW1ib2wubWF0Y2hdID0gZnVuY3Rpb24oKSB7IHJldHVybiBzZWNyZXQ7IH07XHJcbiAgICByZXR1cm4gKFwiXCIpLm1hdGNoKGZhdXgpID09PSBzZWNyZXQ7XHJcbiAgfSgpKTtcclxuXHJcbiAgLy8gMjEuMSBTdHJpbmcgT2JqZWN0c1xyXG4gIC8vIDIxLjEuMSBUaGUgU3RyaW5nIENvbnN0cnVjdG9yXHJcbiAgLy8gMjEuMS4xLjEgU3RyaW5nICggdmFsdWUgKVxyXG4gIC8vIDIxLjEuMiBQcm9wZXJ0aWVzIG9mIHRoZSBTdHJpbmcgQ29uc3RydWN0b3JcclxuICAvLyAyMS4xLjIuMSBTdHJpbmcuZnJvbUNoYXJDb2RlICggLi4uY29kZVVuaXRzIClcclxuXHJcbiAgLy8gMjEuMS4yLjIgU3RyaW5nLmZyb21Db2RlUG9pbnQgKCAuLi5jb2RlUG9pbnRzIClcclxuICBkZWZpbmUoXHJcbiAgICBTdHJpbmcsICdmcm9tQ29kZVBvaW50JyxcclxuICAgIGZ1bmN0aW9uIGZyb21Db2RlUG9pbnQoLyouLi5jb2RlUG9pbnRzKi8pIHtcclxuICAgICAgdmFyIGNvZGVQb2ludHMgPSBhcmd1bWVudHMsXHJcbiAgICAgICAgICBsZW5ndGggPSBjb2RlUG9pbnRzLmxlbmd0aCxcclxuICAgICAgICAgIGVsZW1lbnRzID0gW10sXHJcbiAgICAgICAgICBuZXh0SW5kZXggPSAwO1xyXG4gICAgICB3aGlsZSAobmV4dEluZGV4IDwgbGVuZ3RoKSB7XHJcbiAgICAgICAgdmFyIG5leHQgPSBjb2RlUG9pbnRzW25leHRJbmRleF07XHJcbiAgICAgICAgdmFyIG5leHRDUCA9IE51bWJlcihuZXh0KTtcclxuICAgICAgICBpZiAoIVNhbWVWYWx1ZShuZXh0Q1AsIFRvSW50ZWdlcihuZXh0Q1ApKSB8fFxyXG4gICAgICAgICAgICBuZXh0Q1AgPCAwIHx8IG5leHRDUCA+IDB4MTBGRkZGKSB7XHJcbiAgICAgICAgICB0aHJvdyBSYW5nZUVycm9yKCdJbnZhbGlkIGNvZGUgcG9pbnQgJyArIG5leHRDUCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChuZXh0Q1AgPCAweDEwMDAwKSB7XHJcbiAgICAgICAgICBlbGVtZW50cy5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUobmV4dENQKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIG5leHRDUCAtPSAweDEwMDAwO1xyXG4gICAgICAgICAgZWxlbWVudHMucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKChuZXh0Q1AgPj4gMTApICsgMHhEODAwKSk7XHJcbiAgICAgICAgICBlbGVtZW50cy5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoKG5leHRDUCAlIDB4NDAwKSArIDB4REMwMCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBuZXh0SW5kZXggKz0gMTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZWxlbWVudHMuam9pbignJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgLy8gMjEuMS4yLjMgU3RyaW5nLnByb3RvdHlwZVxyXG5cclxuICAvLyAyMS4xLjIuNCBTdHJpbmcucmF3ICggdGVtcGxhdGUgLCAuLi5zdWJzdGl0dXRpb25zIClcclxuICBkZWZpbmUoXHJcbiAgICBTdHJpbmcsICdyYXcnLFxyXG4gICAgZnVuY3Rpb24gcmF3KHRlbXBsYXRlIC8qLCAuLi5zdWJzdGl0dXRpb25zKi8pIHtcclxuICAgICAgdmFyIHN1YnN0aXR1dGlvbnMgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XHJcblxyXG4gICAgICB2YXIgY29va2VkID0gT2JqZWN0KHRlbXBsYXRlKTtcclxuICAgICAgdmFyIHJhd1ZhbHVlID0gY29va2VkWydyYXcnXTtcclxuICAgICAgdmFyIHJhdyA9IE9iamVjdChyYXdWYWx1ZSk7XHJcbiAgICAgIHZhciBsZW4gPSByYXdbJ2xlbmd0aCddO1xyXG4gICAgICB2YXIgbGl0ZXJhbFNlZ21lbnRzID0gVG9MZW5ndGgobGVuKTtcclxuICAgICAgaWYgKGxpdGVyYWxTZWdtZW50cyA8PSAwKSByZXR1cm4gJyc7XHJcbiAgICAgIHZhciBzdHJpbmdFbGVtZW50cyA9IFtdO1xyXG4gICAgICB2YXIgbmV4dEluZGV4ID0gMDtcclxuICAgICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgICB2YXIgbmV4dCA9IHJhd1tuZXh0SW5kZXhdO1xyXG4gICAgICAgIHZhciBuZXh0U2VnID0gU3RyaW5nKG5leHQpO1xyXG4gICAgICAgIHN0cmluZ0VsZW1lbnRzLnB1c2gobmV4dFNlZyk7XHJcbiAgICAgICAgaWYgKG5leHRJbmRleCArIDEgPT09IGxpdGVyYWxTZWdtZW50cylcclxuICAgICAgICAgIHJldHVybiBzdHJpbmdFbGVtZW50cy5qb2luKCcnKTtcclxuICAgICAgICBuZXh0ID0gc3Vic3RpdHV0aW9uc1tuZXh0SW5kZXhdO1xyXG4gICAgICAgIHZhciBuZXh0U3ViID0gU3RyaW5nKG5leHQpO1xyXG4gICAgICAgIHN0cmluZ0VsZW1lbnRzLnB1c2gobmV4dFN1Yik7XHJcbiAgICAgICAgbmV4dEluZGV4ID0gbmV4dEluZGV4ICsgMTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gIC8vIFNlZSBodHRwczovL2dpdGhpYi5jb20vaW5leG9yYWJsZXRhc2gvdWF0ZSBmb3IgYSBtb3JlIHVzZWZ1bCB2ZXJzaW9uLlxyXG5cclxuICAvLyAyMS4xLjMgUHJvcGVydGllcyBvZiB0aGUgU3RyaW5nIFByb3RvdHlwZSBPYmplY3RcclxuICAvLyAyMS4xLjMuMSBTdHJpbmcucHJvdG90eXBlLmNoYXJBdCAoIHBvcyApXHJcbiAgLy8gMjEuMS4zLjIgU3RyaW5nLnByb3RvdHlwZS5jaGFyQ29kZUF0ICggcG9zIClcclxuXHJcbiAgLy8gMjEuMS4zLjMgU3RyaW5nLnByb3RvdHlwZS5jb2RlUG9pbnRBdCAoIHBvcyApXHJcbiAgZGVmaW5lKFxyXG4gICAgU3RyaW5nLnByb3RvdHlwZSwgJ2NvZGVQb2ludEF0JyxcclxuICAgIGZ1bmN0aW9uIGNvZGVQb2ludEF0KHBvcykge1xyXG4gICAgICB2YXIgbyA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgdmFyIHMgPSBTdHJpbmcobyk7XHJcbiAgICAgIHZhciBwb3NpdGlvbiA9IFRvSW50ZWdlcihwb3MpO1xyXG4gICAgICB2YXIgc2l6ZSA9IHMubGVuZ3RoO1xyXG4gICAgICBpZiAocG9zaXRpb24gPCAwIHx8IHBvc2l0aW9uID49IHNpemUpIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgIHZhciBmaXJzdCA9IHMuY2hhckNvZGVBdChwb3NpdGlvbik7XHJcbiAgICAgIGlmIChmaXJzdCA8IDB4RDgwMCB8fCBmaXJzdCA+IDB4REJGRiB8fCBwb3NpdGlvbiArIDEgPT09IHNpemUpIHJldHVybiBmaXJzdDtcclxuICAgICAgdmFyIHNlY29uZCA9IHMuY2hhckNvZGVBdChwb3NpdGlvbiArIDEpO1xyXG4gICAgICBpZiAoc2Vjb25kIDwgMHhEQzAwIHx8IHNlY29uZCA+IDB4REZGRikgcmV0dXJuIGZpcnN0O1xyXG4gICAgICByZXR1cm4gKChmaXJzdCAtIDB4RDgwMCkgKiAxMDI0KSArIChzZWNvbmQgLSAweERDMDApICsgMHgxMDAwMDtcclxuICAgIH0pO1xyXG5cclxuICAvLyAyMS4xLjMuNCBTdHJpbmcucHJvdG90eXBlLmNvbmNhdCAoIC4uLmFyZ3MgKVxyXG4gIC8vIDIxLjEuMy41IFN0cmluZy5wcm90b3R5cGUuY29uc3RydWN0b3JcclxuXHJcbiAgLy8gMjEuMS4zLjYgU3RyaW5nLnByb3RvdHlwZS5lbmRzV2l0aCAoIHNlYXJjaFN0cmluZyBbICwgZW5kUG9zaXRpb25dIClcclxuICBkZWZpbmUoXHJcbiAgICBTdHJpbmcucHJvdG90eXBlLCAnZW5kc1dpdGgnLFxyXG4gICAgZnVuY3Rpb24gZW5kc1dpdGgoc2VhcmNoU3RyaW5nKSB7XHJcbiAgICAgIHZhciBlbmRQb3NpdGlvbiA9IGFyZ3VtZW50c1sxXTtcclxuXHJcbiAgICAgIHZhciBvID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICB2YXIgcyA9IFN0cmluZyhvKTtcclxuICAgICAgdmFyIHNlYXJjaFN0ciA9IFN0cmluZyhzZWFyY2hTdHJpbmcpO1xyXG4gICAgICB2YXIgbGVuID0gcy5sZW5ndGg7XHJcbiAgICAgIHZhciBwb3MgPSAoZW5kUG9zaXRpb24gPT09IHVuZGVmaW5lZCkgPyBsZW4gOiBUb0ludGVnZXIoZW5kUG9zaXRpb24pO1xyXG4gICAgICB2YXIgZW5kID0gbWluKG1heChwb3MsIDApLCBsZW4pO1xyXG4gICAgICB2YXIgc2VhcmNoTGVuZ3RoID0gc2VhcmNoU3RyLmxlbmd0aDtcclxuICAgICAgdmFyIHN0YXJ0ID0gZW5kIC0gc2VhcmNoTGVuZ3RoO1xyXG4gICAgICBpZiAoc3RhcnQgPCAwKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgIGlmIChzLnN1YnN0cmluZyhzdGFydCwgc3RhcnQgKyBzZWFyY2hMZW5ndGgpID09PSBzZWFyY2hTdHIpIHJldHVybiB0cnVlO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9KTtcclxuXHJcbiAgLy8gMjEuMS4zLjcgU3RyaW5nLnByb3RvdHlwZS5pbmNsdWRlcyAoIHNlYXJjaFN0cmluZyBbICwgcG9zaXRpb24gXSApXHJcbiAgZGVmaW5lKFxyXG4gICAgU3RyaW5nLnByb3RvdHlwZSwgJ2luY2x1ZGVzJyxcclxuICAgIGZ1bmN0aW9uIGluY2x1ZGVzKHNlYXJjaFN0cmluZykge1xyXG4gICAgICB2YXIgcG9zaXRpb24gPSBhcmd1bWVudHNbMV07XHJcblxyXG4gICAgICB2YXIgbyA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgdmFyIHMgPSBTdHJpbmcobyk7XHJcbiAgICAgIHZhciBzZWFyY2hTdHIgPSBTdHJpbmcoc2VhcmNoU3RyaW5nKTtcclxuICAgICAgdmFyIHBvcyA9IFRvSW50ZWdlcihwb3NpdGlvbik7XHJcbiAgICAgIHZhciBsZW4gPSBzLmxlbmd0aDtcclxuICAgICAgdmFyIHN0YXJ0ID0gbWluKG1heChwb3MsIDApLCBsZW4pO1xyXG4gICAgICByZXR1cm4gcy5pbmRleE9mKHNlYXJjaFN0ciwgc3RhcnQpICE9PSAtMTtcclxuICAgIH0pO1xyXG5cclxuICAvLyAyMS4xLjMuOCBTdHJpbmcucHJvdG90eXBlLmluZGV4T2YgKCBzZWFyY2hTdHJpbmcgWyAsIHBvc2l0aW9uIF0gKVxyXG4gIC8vIDIxLjEuMy45IFN0cmluZy5wcm90b3R5cGUubGFzdEluZGV4T2YgKCBzZWFyY2hTdHJpbmcgWyAsIHBvc2l0aW9uIF0gKVxyXG4gIC8vIDIxLjEuMy4xMCBTdHJpbmcucHJvdG90eXBlLmxvY2FsZUNvbXBhcmUgKCB0aGF0IFssIHJlc2VydmVkMSBbICwgcmVzZXJ2ZWQyIF0gXSApXHJcbiAgLy8gMjEuMS4zLjExIFN0cmluZy5wcm90b3R5cGUubWF0Y2ggKCByZWdleHAgKVxyXG4gIGRlZmluZShcclxuICAgIFN0cmluZy5wcm90b3R5cGUsICdtYXRjaCcsXHJcbiAgICBmdW5jdGlvbiBtYXRjaChyZWdleHApIHtcclxuICAgICAgdmFyIG8gPSBzdHJpY3QodGhpcyk7XHJcbiAgICAgIHZhciBzID0gU3RyaW5nKG8pO1xyXG4gICAgICBpZiAoSGFzUHJvcGVydHkocmVnZXhwLCAkJG1hdGNoKSkgdmFyIHJ4ID0gcmVnZXhwO1xyXG4gICAgICBlbHNlIHJ4ID0gbmV3IFJlZ0V4cChyZWdleHApO1xyXG4gICAgICByZXR1cm4gcnhbJCRtYXRjaF0ocyk7XHJcbiAgICB9LCAhc3RyaW5nX3JlZ2V4cF9kaXNwYXRjaCk7XHJcblxyXG4gIC8vIDIxLjEuMy4xMiBTdHJpbmcucHJvdG90eXBlLm5vcm1hbGl6ZSAoIFsgZm9ybSBdIClcclxuXHJcbiAgLy8gTm90IHByYWN0aWNhbCBkdWUgdG8gdGFibGUgc2l6ZXM7IGlmIG5lZWRlZCwgcHVsbCBpbjpcclxuICAvLyBodHRwczovL2dpdGh1Yi5jb20vd2FsbGluZy91bm9ybS9cclxuXHJcbiAgLy8gMjEuMS4zLjEzIFN0cmluZy5wcm90b3R5cGUucmVwZWF0ICggY291bnQgKVxyXG4gIGRlZmluZShcclxuICAgIFN0cmluZy5wcm90b3R5cGUsICdyZXBlYXQnLFxyXG4gICAgZnVuY3Rpb24gcmVwZWF0KGNvdW50KSB7XHJcbiAgICAgIHZhciBvID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICB2YXIgcyA9IFN0cmluZyhvKTtcclxuICAgICAgdmFyIG4gPSBUb0ludGVnZXIoY291bnQpO1xyXG4gICAgICBpZiAobiA8IDApIHRocm93IFJhbmdlRXJyb3IoKTtcclxuICAgICAgaWYgKG4gPT09IEluZmluaXR5KSB0aHJvdyBSYW5nZUVycm9yKCk7XHJcbiAgICAgIHZhciB0ID0gbmV3IEFycmF5KG4gKyAxKS5qb2luKHMpO1xyXG4gICAgICByZXR1cm4gdDtcclxuICAgIH0pO1xyXG5cclxuICAvLyAyMS4xLjMuMTQgU3RyaW5nLnByb3RvdHlwZS5yZXBsYWNlIChzZWFyY2hWYWx1ZSwgcmVwbGFjZVZhbHVlIClcclxuICBkZWZpbmUoXHJcbiAgICBTdHJpbmcucHJvdG90eXBlLCAncmVwbGFjZScsXHJcbiAgICBmdW5jdGlvbiByZXBsYWNlKHNlYXJjaFZhbHVlLCByZXBsYWNlVmFsdWUpIHtcclxuICAgICAgdmFyIG8gPSBzdHJpY3QodGhpcyk7XHJcbiAgICAgIGlmIChIYXNQcm9wZXJ0eShzZWFyY2hWYWx1ZSwgJCRyZXBsYWNlKSlcclxuICAgICAgICByZXR1cm4gc2VhcmNoVmFsdWVbJCRyZXBsYWNlXShvLCByZXBsYWNlVmFsdWUpO1xyXG4gICAgICByZXR1cm4gb3JpZ19yZXBsYWNlLmNhbGwobywgc2VhcmNoVmFsdWUsIHJlcGxhY2VWYWx1ZSk7XHJcbiAgICB9LCAhc3RyaW5nX3JlZ2V4cF9kaXNwYXRjaCk7XHJcblxyXG4gIC8vIDIxLjEuMy4xNSBTdHJpbmcucHJvdG90eXBlLnNlYXJjaCAoIHJlZ2V4cCApXHJcbiAgZGVmaW5lKFxyXG4gICAgU3RyaW5nLnByb3RvdHlwZSwgJ3NlYXJjaCcsXHJcbiAgICBmdW5jdGlvbiBzZWFyY2gocmVnZXhwKSB7XHJcbiAgICAgIHZhciBvID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICB2YXIgc3RyaW5nID0gU3RyaW5nKG8pO1xyXG4gICAgICBpZiAoSGFzUHJvcGVydHkocmVnZXhwLCAkJHNlYXJjaCkpIHZhciByeCA9IHJlZ2V4cDtcclxuICAgICAgZWxzZSByeCA9IG5ldyBSZWdFeHAocmVnZXhwKTtcclxuICAgICAgcmV0dXJuIHJ4WyQkc2VhcmNoXShzdHJpbmcpO1xyXG4gICAgfSwgIXN0cmluZ19yZWdleHBfZGlzcGF0Y2gpO1xyXG5cclxuICAvLyAyMS4xLjMuMTYgU3RyaW5nLnByb3RvdHlwZS5zbGljZSAoIHN0YXJ0LCBlbmQgKVxyXG4gIC8vIDIxLjEuMy4xNyBTdHJpbmcucHJvdG90eXBlLnNwbGl0ICggc2VwYXJhdG9yLCBsaW1pdCApXHJcbiAgZGVmaW5lKFxyXG4gICAgU3RyaW5nLnByb3RvdHlwZSwgJ3NwbGl0JyxcclxuICAgIGZ1bmN0aW9uIHNwbGl0KHNlcGFyYXRvciwgbGltaXQpIHtcclxuICAgICAgdmFyIG8gPSBzdHJpY3QodGhpcyk7XHJcbiAgICAgIGlmIChIYXNQcm9wZXJ0eShzZXBhcmF0b3IsICQkc3BsaXQpKVxyXG4gICAgICAgIHJldHVybiBzZXBhcmF0b3JbJCRzcGxpdF0obywgbGltaXQpO1xyXG4gICAgICByZXR1cm4gb3JpZ19zcGxpdC5jYWxsKG8sIHNlcGFyYXRvciwgbGltaXQpO1xyXG4gICAgfSwgIXN0cmluZ19yZWdleHBfZGlzcGF0Y2gpO1xyXG5cclxuICAvLyAyMS4xLjMuMTggU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoICggc2VhcmNoU3RyaW5nIFssIHBvc2l0aW9uIF0gKVxyXG4gIGRlZmluZShcclxuICAgIFN0cmluZy5wcm90b3R5cGUsICdzdGFydHNXaXRoJyxcclxuICAgIGZ1bmN0aW9uIHN0YXJ0c1dpdGgoc2VhcmNoU3RyaW5nKSB7XHJcbiAgICAgIHZhciBwb3NpdGlvbiA9IGFyZ3VtZW50c1sxXTtcclxuXHJcbiAgICAgIHZhciBvID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICB2YXIgcyA9IFN0cmluZyhvKTtcclxuICAgICAgdmFyIHNlYXJjaFN0ciA9IFN0cmluZyhzZWFyY2hTdHJpbmcpO1xyXG4gICAgICB2YXIgcG9zID0gVG9JbnRlZ2VyKHBvc2l0aW9uKTtcclxuICAgICAgdmFyIGxlbiA9IHMubGVuZ3RoO1xyXG4gICAgICB2YXIgc3RhcnQgPSBtaW4obWF4KHBvcywgMCksIGxlbik7XHJcbiAgICAgIHZhciBzZWFyY2hMZW5ndGggPSBzZWFyY2hTdHIubGVuZ3RoO1xyXG4gICAgICBpZiAoc2VhcmNoTGVuZ3RoICsgc3RhcnQgPiBsZW4pIHJldHVybiBmYWxzZTtcclxuICAgICAgaWYgKHMuc3Vic3RyaW5nKHN0YXJ0LCBzdGFydCArIHNlYXJjaExlbmd0aCkgPT09IHNlYXJjaFN0cikgcmV0dXJuIHRydWU7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICAvLyAyMS4xLjMuMTkgU3RyaW5nLnByb3RvdHlwZS5zdWJzdHJpbmcgKCBzdGFydCwgZW5kIClcclxuICAvLyAyMS4xLjMuMjAgU3RyaW5nLnByb3RvdHlwZS50b0xvY2FsZUxvd2VyQ2FzZSAoIFsgcmVzZXJ2ZWQxIFsgLCByZXNlcnZlZDIgXSBdIClcclxuICAvLyAyMS4xLjMuMjEgU3RyaW5nLnByb3RvdHlwZS50b0xvY2FsZVVwcGVyQ2FzZSAoWyByZXNlcnZlZDEgWyAsIHJlc2VydmVkMiBdIF0gKVxyXG4gIC8vIDIxLjEuMy4yMiBTdHJpbmcucHJvdG90eXBlLnRvTG93ZXJDYXNlICggKVxyXG4gIC8vIDIxLjEuMy4yMyBTdHJpbmcucHJvdG90eXBlLnRvU3RyaW5nICggKVxyXG4gIC8vIDIxLjEuMy4yNCBTdHJpbmcucHJvdG90eXBlLnRvVXBwZXJDYXNlICggKVxyXG4gIC8vIDIxLjEuMy4yNSBTdHJpbmcucHJvdG90eXBlLnRyaW0gKCApXHJcbiAgLy8gMjEuMS4zLjI2IFN0cmluZy5wcm90b3R5cGUudmFsdWVPZiAoIClcclxuXHJcbiAgLy8gMjEuMS4zLjI3IFN0cmluZy5wcm90b3R5cGUgWyBAQGl0ZXJhdG9yIF0oIClcclxuICBkZWZpbmUoXHJcbiAgICBTdHJpbmcucHJvdG90eXBlLCAkJGl0ZXJhdG9yLFxyXG4gICAgZnVuY3Rpb24gZW50cmllcygpIHtcclxuICAgICAgcmV0dXJuIENyZWF0ZVN0cmluZ0l0ZXJhdG9yKHRoaXMsICd2YWx1ZScpO1xyXG4gICAgfSk7XHJcblxyXG4gIC8vIDIxLjEuNCBQcm9wZXJ0aWVzIG9mIFN0cmluZyBJbnN0YW5jZXNcclxuICAvLyAyMS4xLjQuMSBsZW5ndGhcclxuXHJcbiAgLy8gMjEuMS41IFN0cmluZyBJdGVyYXRvciBPYmplY3RzXHJcbiAgLyoqIEBjb25zdHJ1Y3RvciAqL1xyXG4gIGZ1bmN0aW9uIFN0cmluZ0l0ZXJhdG9yKCkge31cclxuXHJcbiAgLy8gMjEuMS41LjEgQ3JlYXRlU3RyaW5nSXRlcmF0b3IgQWJzdHJhY3QgT3BlcmF0aW9uXHJcbiAgZnVuY3Rpb24gQ3JlYXRlU3RyaW5nSXRlcmF0b3Ioc3RyaW5nLCBraW5kKSB7XHJcbiAgICB2YXIgcyA9IFN0cmluZyhzdHJpbmcpO1xyXG4gICAgdmFyIGl0ZXJhdG9yID0gbmV3IFN0cmluZ0l0ZXJhdG9yO1xyXG4gICAgc2V0X2ludGVybmFsKGl0ZXJhdG9yLCAnW1tJdGVyYXRlZFN0cmluZ11dJywgcyk7XHJcbiAgICBzZXRfaW50ZXJuYWwoaXRlcmF0b3IsICdbW1N0cmluZ0l0ZXJhdG9yTmV4dEluZGV4XV0nLCAwKTtcclxuICAgIHNldF9pbnRlcm5hbChpdGVyYXRvciwgJ1tbU3RyaW5nSXRlcmF0aW9uS2luZF1dJywga2luZCk7XHJcbiAgICByZXR1cm4gaXRlcmF0b3I7XHJcbiAgfVxyXG5cclxuICAvLyAyMS4xLjUuMiBUaGUgJVN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJSBPYmplY3RcclxuICB2YXIgJFN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJCA9IE9iamVjdC5jcmVhdGUoJEl0ZXJhdG9yUHJvdG90eXBlJCk7XHJcbiAgU3RyaW5nSXRlcmF0b3IucHJvdG90eXBlID0gJFN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJDtcclxuXHJcbiAgLy8gMjEuMS41LjIuMSAlU3RyaW5nSXRlcmF0b3JQcm90b3R5cGUlLm5leHQgKCApXHJcbiAgZGVmaW5lKFxyXG4gICAgJFN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJCwgJ25leHQnLFxyXG4gICAgZnVuY3Rpb24gbmV4dCgpIHtcclxuICAgICAgdmFyIG8gPSBUb09iamVjdCh0aGlzKTtcclxuICAgICAgdmFyIHMgPSBTdHJpbmcob1snW1tJdGVyYXRlZFN0cmluZ11dJ10pLFxyXG4gICAgICAgICAgaW5kZXggPSBvWydbW1N0cmluZ0l0ZXJhdG9yTmV4dEluZGV4XV0nXSxcclxuICAgICAgICAgIGxlbiA9IHMubGVuZ3RoO1xyXG4gICAgICBpZiAoaW5kZXggPj0gbGVuKSB7XHJcbiAgICAgICAgc2V0X2ludGVybmFsKG8sICdbW1N0cmluZ0l0ZXJhdG9yTmV4dEluZGV4XV0nLCBJbmZpbml0eSk7XHJcbiAgICAgICAgcmV0dXJuIENyZWF0ZUl0ZXJSZXN1bHRPYmplY3QodW5kZWZpbmVkLCB0cnVlKTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgY3AgPSBzLmNvZGVQb2ludEF0KGluZGV4KTtcclxuICAgICAgc2V0X2ludGVybmFsKG8sICdbW1N0cmluZ0l0ZXJhdG9yTmV4dEluZGV4XV0nLCBpbmRleCArIChjcCA+IDB4RkZGRiA/IDIgOiAxKSk7XHJcbiAgICAgIHJldHVybiBDcmVhdGVJdGVyUmVzdWx0T2JqZWN0KFN0cmluZy5mcm9tQ29kZVBvaW50KGNwKSwgZmFsc2UpO1xyXG4gICAgfSk7XHJcblxyXG4gIC8vIDIxLjEuNS4yLjIgJVN0cmluZ0l0ZXJhdG9yUHJvdG90eXBlJSBbIEBAdG9TdHJpbmdUYWcgXVxyXG4gIGRlZmluZSgkU3RyaW5nSXRlcmF0b3JQcm90b3R5cGUkLCAkJHRvU3RyaW5nVGFnLCAnU3RyaW5nIEl0ZXJhdG9yJyk7XHJcblxyXG4gIC8vIDIxLjEuNS4zIFByb3BlcnRpZXMgb2YgU3RyaW5nIEl0ZXJhdG9yIEluc3RhbmNlc1xyXG5cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyAyMS4yIFJlZ0V4cCAoUmVndWxhciBFeHByZXNzaW9uKSBPYmplY3RzXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIC8vIDIxLjIuMSBQYXR0ZXJuc1xyXG4gIC8vIDIxLjIuMiBQYXR0ZXJuIFNlbWFudGljc1xyXG4gIC8vIDIxLjIuMi4xIE5vdGF0aW9uXHJcbiAgLy8gMjEuMi4yLjIgUGF0dGVyblxyXG4gIC8vIDIxLjIuMi4zIERpc2p1bmN0aW9uXHJcbiAgLy8gMjEuMi4yLjQgQWx0ZXJuYXRpdmVcclxuICAvLyAyMS4yLjIuNSBUZXJtXHJcbiAgLy8gMjEuMi4yLjYgQXNzZXJ0aW9uXHJcbiAgLy8gMjEuMi4yLjcgUXVhbnRpZmllclxyXG4gIC8vIDIxLjIuMi44IEF0b21cclxuICAvLyAyMS4yLjIuOSBBdG9tRXNjYXBlXHJcbiAgLy8gMjEuMi4yLjEwIENoYXJhY3RlckVzY2FwZVxyXG4gIC8vIDIxLjIuMi4xMSBEZWNpbWFsRXNjYXBlXHJcbiAgLy8gMjEuMi4yLjEyIENoYXJhY3RlckNsYXNzRXNjYXBlXHJcbiAgLy8gMjEuMi4yLjEzIENoYXJhY3RlckNsYXNzXHJcbiAgLy8gMjEuMi4yLjE0IENsYXNzUmFuZ2VzXHJcbiAgLy8gMjEuMi4yLjE1IE5vbmVtcHR5Q2xhc3NSYW5nZXNcclxuICAvLyAyMS4yLjIuMTYgTm9uZW1wdHlDbGFzc1Jhbmdlc05vRGFzaFxyXG4gIC8vIDIxLjIuMi4xNyBDbGFzc0F0b21cclxuICAvLyAyMS4yLjIuMTggQ2xhc3NBdG9tTm9EYXNoXHJcbiAgLy8gMjEuMi4yLjE5IENsYXNzRXNjYXBlXHJcbiAgLy8gMjEuMi4zIFRoZSBSZWdFeHAgQ29uc3RydWN0b3JcclxuICAvLyAyMS4yLjMuMSBSZWdFeHAgKCBwYXR0ZXJuLCBmbGFncyApXHJcbiAgLy8gMjEuMi4zLjIgbmV3IFJlZ0V4cCggLi4uYXJndW1lbnRzTGlzdCApXHJcbiAgLy8gMjEuMi4zLjMgQWJzdHJhY3QgT3BlcmF0aW9ucyBmb3IgdGhlIFJlZ0V4cCBDb25zdHJ1Y3RvclxyXG4gIC8vIDIxLjIuNCBQcm9wZXJ0aWVzIG9mIHRoZSBSZWdFeHAgQ29uc3RydWN0b3JcclxuICAvLyAyMS4yLjQuMSBSZWdFeHAucHJvdG90eXBlXHJcbiAgLy8gMjEuMi41IFByb3BlcnRpZXMgb2YgdGhlIFJlZ0V4cCBQcm90b3R5cGUgT2JqZWN0XHJcbiAgLy8gMjEuMi41LjEgUmVnRXhwLnByb3RvdHlwZS5jb25zdHJ1Y3RvclxyXG4gIC8vIDIxLjIuNS4yIFJlZ0V4cC5wcm90b3R5cGUuZXhlYyAoIHN0cmluZyApXHJcblxyXG4gIC8vIDIxLjIuNS4zIGdldCBSZWdFeHAucHJvdG90eXBlLmZsYWdzXHJcbiAgaWYgKCEoJ2ZsYWdzJyBpbiBSZWdFeHAucHJvdG90eXBlKSkge1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFxyXG4gICAgICBSZWdFeHAucHJvdG90eXBlLCAnZmxhZ3MnLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHZhciBzID0gU3RyaW5nKHRoaXMpO1xyXG4gICAgICAgICAgcmV0dXJuIHMuc3Vic3RyaW5nKHMubGFzdEluZGV4T2YoJy8nKSArIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyAyMS4yLjUuNCBnZXQgUmVnRXhwLnByb3RvdHlwZS5nbG9iYWxcclxuICAvLyAyMS4yLjUuNSBnZXQgUmVnRXhwLnByb3RvdHlwZS5pZ25vcmVDYXNlXHJcblxyXG4gIC8vIDIxLjIuNS42IFJlZ0V4cC5wcm90b3R5cGUgWyBAQG1hdGNoIF0gKCBzdHJpbmcgKVxyXG4gIGRlZmluZShSZWdFeHAucHJvdG90eXBlLCAkJG1hdGNoLCBmdW5jdGlvbihzdHJpbmcpIHtcclxuICAgIHZhciBvID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgcmV0dXJuIG9yaWdfbWF0Y2guY2FsbChzdHJpbmcsIG8pO1xyXG4gIH0pO1xyXG5cclxuICAvLyAyMS4yLjUuNyBnZXQgUmVnRXhwLnByb3RvdHlwZS5tdWx0aWxpbmVcclxuXHJcbiAgLy8gMjEuMi41LjggUmVnRXhwLnByb3RvdHlwZSBbIEBAcmVwbGFjZSBdICggc3RyaW5nLCByZXBsYWNlVmFsdWUgKVxyXG4gIGRlZmluZShSZWdFeHAucHJvdG90eXBlLCAkJHJlcGxhY2UsIGZ1bmN0aW9uKHN0cmluZywgcmVwbGFjZVZhbHVlKSB7XHJcbiAgICB2YXIgbyA9IHN0cmljdCh0aGlzKTtcclxuICAgIHJldHVybiBvcmlnX3JlcGxhY2UuY2FsbChzdHJpbmcsIG8sIHJlcGxhY2VWYWx1ZSk7XHJcbiAgfSk7XHJcblxyXG4gIC8vIDIxLjIuNS45IFJlZ0V4cC5wcm90b3R5cGUgWyBAQHNlYXJjaCBdICggc3RyaW5nIClcclxuICBkZWZpbmUoUmVnRXhwLnByb3RvdHlwZSwgJCRzZWFyY2gsIGZ1bmN0aW9uKHN0cmluZykge1xyXG4gICAgdmFyIG8gPSBzdHJpY3QodGhpcyk7XHJcbiAgICByZXR1cm4gb3JpZ19zZWFyY2guY2FsbChzdHJpbmcsIG8pO1xyXG4gIH0pO1xyXG5cclxuICAvLyAyMS4yLjUuMTAgZ2V0IFJlZ0V4cC5wcm90b3R5cGUuc291cmNlXHJcblxyXG4gIC8vIDIxLjIuNS4xMSBSZWdFeHAucHJvdG90eXBlIFsgQEBzcGxpdCBdICggc3RyaW5nLCBsaW1pdCApXHJcbiAgZGVmaW5lKFJlZ0V4cC5wcm90b3R5cGUsICQkc3BsaXQsIGZ1bmN0aW9uKHN0cmluZywgbGltaXQpIHtcclxuICAgIHZhciBvID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgcmV0dXJuIG9yaWdfc3BsaXQuY2FsbChzdHJpbmcsIG8sIGxpbWl0KTtcclxuICB9KTtcclxuXHJcbiAgLy8gMjEuMi41LjEyIGdldCBSZWdFeHAucHJvdG90eXBlLnN0aWNreVxyXG4gIC8vIDIxLjIuNS4xMyBSZWdFeHAucHJvdG90eXBlLnRlc3QoIFMgKVxyXG4gIC8vIDIxLjIuNS4xNCBSZWdFeHAucHJvdG90eXBlLnRvU3RyaW5nICggKVxyXG4gIC8vIDIxLjIuNS4xNSBnZXQgUmVnRXhwLnByb3RvdHlwZS51bmljb2RlXHJcblxyXG4gIC8vIDIxLjIuNiBQcm9wZXJ0aWVzIG9mIFJlZ0V4cCBJbnN0YW5jZXNcclxuICAvLyAyMS4yLjYuMSBsYXN0SW5kZXhcclxuXHJcbiAgLy8gKE5vIHBvbHlmaWxsYWJsZSBjaGFuZ2VzIGZyb20gRVM1KVxyXG5cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyAyMiBJbmRleGVkIENvbGxlY3Rpb25zXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIDIyLjEgQXJyYXkgT2JqZWN0c1xyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvLyAyMi4xLjEgVGhlIEFycmF5IENvbnN0cnVjdG9yXHJcbiAgLy8gMjIuMS4xLjEgQXJyYXkgKCApXHJcbiAgLy8gMjIuMS4xLjIgQXJyYXkgKGxlbilcclxuICAvLyAyMi4xLjEuMyBBcnJheSAoLi4uaXRlbXMgKVxyXG5cclxuICAvLyAyMi4xLjIgUHJvcGVydGllcyBvZiB0aGUgQXJyYXkgQ29uc3RydWN0b3JcclxuXHJcbiAgLy8gMjIuMS4yLjEgQXJyYXkuZnJvbSAoIGl0ZW1zIFsgLCBtYXBmbiBbICwgdGhpc0FyZyBdIF0gKVxyXG4gIGRlZmluZShcclxuICAgIEFycmF5LCAnZnJvbScsXHJcbiAgICBmdW5jdGlvbiBmcm9tKGl0ZW1zKSB7XHJcbiAgICAgIHZhciBtYXBmbiA9IGFyZ3VtZW50c1sxXTtcclxuICAgICAgdmFyIHRoaXNBcmcgPSBhcmd1bWVudHNbMl07XHJcblxyXG4gICAgICB2YXIgYyA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgaWYgKG1hcGZuID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YXIgbWFwcGluZyA9IGZhbHNlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmICghSXNDYWxsYWJsZShtYXBmbikpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIHZhciB0ID0gdGhpc0FyZztcclxuICAgICAgICBtYXBwaW5nID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgdXNpbmdJdGVyYXRvciA9IEdldE1ldGhvZChpdGVtcywgJCRpdGVyYXRvcik7XHJcbiAgICAgIGlmICh1c2luZ0l0ZXJhdG9yICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgaWYgKElzQ29uc3RydWN0b3IoYykpIHtcclxuICAgICAgICAgIHZhciBhID0gbmV3IGMoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgYSA9IG5ldyBBcnJheSgwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGl0ZXJhdG9yID0gR2V0SXRlcmF0b3IoaXRlbXMsIHVzaW5nSXRlcmF0b3IpO1xyXG4gICAgICAgIHZhciBrID0gMDtcclxuICAgICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgICAgdmFyIG5leHQgPSBJdGVyYXRvclN0ZXAoaXRlcmF0b3IpO1xyXG4gICAgICAgICAgaWYgKG5leHQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIGEubGVuZ3RoID0gaztcclxuICAgICAgICAgICAgcmV0dXJuIGE7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB2YXIgbmV4dFZhbHVlID0gSXRlcmF0b3JWYWx1ZShuZXh0KTtcclxuICAgICAgICAgIGlmIChtYXBwaW5nKVxyXG4gICAgICAgICAgICB2YXIgbWFwcGVkVmFsdWUgPSBtYXBmbi5jYWxsKHQsIG5leHRWYWx1ZSk7XHJcbiAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIG1hcHBlZFZhbHVlID0gbmV4dFZhbHVlO1xyXG4gICAgICAgICAgYVtrXSA9IG1hcHBlZFZhbHVlO1xyXG4gICAgICAgICAgayArPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB2YXIgYXJyYXlMaWtlID0gVG9PYmplY3QoaXRlbXMpO1xyXG4gICAgICB2YXIgbGVuVmFsdWUgPSBhcnJheUxpa2UubGVuZ3RoO1xyXG4gICAgICB2YXIgbGVuID0gVG9MZW5ndGgobGVuVmFsdWUpO1xyXG4gICAgICBpZiAoSXNDb25zdHJ1Y3RvcihjKSkge1xyXG4gICAgICAgIGEgPSBuZXcgYyhsZW4pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGEgPSBuZXcgQXJyYXkobGVuKTtcclxuICAgICAgfVxyXG4gICAgICBrID0gMDtcclxuICAgICAgd2hpbGUgKGsgPCBsZW4pIHtcclxuICAgICAgICB2YXIga1ZhbHVlID0gYXJyYXlMaWtlW2tdO1xyXG4gICAgICAgIGlmIChtYXBwaW5nKVxyXG4gICAgICAgICAgbWFwcGVkVmFsdWUgPSBtYXBmbi5jYWxsKHQsIGtWYWx1ZSwgayk7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgbWFwcGVkVmFsdWUgPSBrVmFsdWU7XHJcbiAgICAgICAgYVtrXSA9IG1hcHBlZFZhbHVlO1xyXG4gICAgICAgIGsgKz0gMTtcclxuICAgICAgfVxyXG4gICAgICBhLmxlbmd0aCA9IGxlbjtcclxuICAgICAgcmV0dXJuIGE7XHJcbiAgICB9KTtcclxuXHJcbiAgLy8gMjIuMS4yLjIgQXJyYXkuaXNBcnJheSAoIGFyZyApXHJcblxyXG4gIC8vIDIyLjEuMi4zIEFycmF5Lm9mICggLi4uaXRlbXMgKVxyXG4gIGRlZmluZShcclxuICAgIEFycmF5LCAnb2YnLFxyXG4gICAgZnVuY3Rpb24gb2YoKSB7XHJcbiAgICAgIHZhciBpdGVtcyA9IGFyZ3VtZW50cztcclxuXHJcbiAgICAgIHZhciBsZW5WYWx1ZSA9IGl0ZW1zLmxlbmd0aDtcclxuICAgICAgdmFyIGxlbiA9IFRvVWludDMyKGxlblZhbHVlKTtcclxuICAgICAgdmFyIGMgPSBzdHJpY3QodGhpcyksIGE7XHJcbiAgICAgIGlmIChJc0NvbnN0cnVjdG9yKGMpKSB7XHJcbiAgICAgICAgYSA9IG5ldyBjKGxlbik7XHJcbiAgICAgICAgYSA9IFRvT2JqZWN0KGEpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGEgPSBuZXcgQXJyYXkobGVuKTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgayA9IDA7XHJcbiAgICAgIHdoaWxlIChrIDwgbGVuKSB7XHJcbiAgICAgICAgYVtrXSA9IGl0ZW1zW2tdO1xyXG4gICAgICAgIGsgKz0gMTtcclxuICAgICAgfVxyXG4gICAgICBhLmxlbmd0aCA9IGxlbjtcclxuICAgICAgcmV0dXJuIGE7XHJcbiAgICB9KTtcclxuXHJcbiAgLy8gMjIuMS4yLjQgQXJyYXkucHJvdG90eXBlXHJcbiAgLy8gMjIuMS4yLjUgZ2V0IEFycmF5IFsgQEBzcGVjaWVzIF1cclxuICAvLyAyMi4xLjMgUHJvcGVydGllcyBvZiB0aGUgQXJyYXkgUHJvdG90eXBlIE9iamVjdFxyXG4gIC8vIDIyLjEuMy4xIEFycmF5LnByb3RvdHlwZS5jb25jYXQgKCAuLi5hcmd1bWVudHMgKVxyXG4gIC8vIDIyLjEuMy4xLjEgUnVudGltZSBTZW1hbnRpY3M6IElzQ29uY2F0U3ByZWFkYWJsZSAoIE8gKVxyXG4gIC8vIDIyLjEuMy4yIEFycmF5LnByb3RvdHlwZS5jb25zdHJ1Y3RvclxyXG4gIC8vIDIyLjEuMy4zIEFycmF5LnByb3RvdHlwZS5jb3B5V2l0aGluICh0YXJnZXQsIHN0YXJ0IFsgLCBlbmQgXSApXHJcbiAgZGVmaW5lKFxyXG4gICAgQXJyYXkucHJvdG90eXBlLCAnY29weVdpdGhpbicsXHJcbiAgICBmdW5jdGlvbiBjb3B5V2l0aGluKHRhcmdldCwgc3RhcnQvKiwgZW5kKi8pIHtcclxuICAgICAgdmFyIGVuZCA9IGFyZ3VtZW50c1syXTtcclxuXHJcbiAgICAgIHZhciBvID0gVG9PYmplY3QodGhpcyk7XHJcbiAgICAgIHZhciBsZW5WYWwgPSBvLmxlbmd0aDtcclxuICAgICAgdmFyIGxlbiA9IFRvTGVuZ3RoKGxlblZhbCk7XHJcbiAgICAgIGxlbiA9IG1heChsZW4sIDApO1xyXG4gICAgICB2YXIgcmVsYXRpdmVUYXJnZXQgPSBUb0ludGVnZXIodGFyZ2V0KTtcclxuICAgICAgdmFyIHRvO1xyXG4gICAgICBpZiAocmVsYXRpdmVUYXJnZXQgPCAwKVxyXG4gICAgICAgIHRvID0gbWF4KGxlbiArIHJlbGF0aXZlVGFyZ2V0LCAwKTtcclxuICAgICAgZWxzZVxyXG4gICAgICAgIHRvID0gbWluKHJlbGF0aXZlVGFyZ2V0LCBsZW4pO1xyXG4gICAgICB2YXIgcmVsYXRpdmVTdGFydCA9IFRvSW50ZWdlcihzdGFydCk7XHJcbiAgICAgIHZhciBmcm9tO1xyXG4gICAgICBpZiAocmVsYXRpdmVTdGFydCA8IDApXHJcbiAgICAgICAgZnJvbSA9IG1heChsZW4gKyByZWxhdGl2ZVN0YXJ0LCAwKTtcclxuICAgICAgZWxzZVxyXG4gICAgICAgIGZyb20gPSBtaW4ocmVsYXRpdmVTdGFydCwgbGVuKTtcclxuICAgICAgdmFyIHJlbGF0aXZlRW5kO1xyXG4gICAgICBpZiAoZW5kID09PSB1bmRlZmluZWQpXHJcbiAgICAgICAgcmVsYXRpdmVFbmQgPSBsZW47XHJcbiAgICAgIGVsc2VcclxuICAgICAgICByZWxhdGl2ZUVuZCA9IFRvSW50ZWdlcihlbmQpO1xyXG4gICAgICB2YXIgZmluYWw7XHJcbiAgICAgIGlmIChyZWxhdGl2ZUVuZCA8IDApXHJcbiAgICAgICAgZmluYWwgPSBtYXgobGVuICsgcmVsYXRpdmVFbmQsIDApO1xyXG4gICAgICBlbHNlXHJcbiAgICAgICAgZmluYWwgPSBtaW4ocmVsYXRpdmVFbmQsIGxlbik7XHJcbiAgICAgIHZhciBjb3VudCA9IG1pbihmaW5hbCAtIGZyb20sIGxlbiAtIHRvKTtcclxuICAgICAgdmFyIGRpcmVjdGlvbjtcclxuICAgICAgaWYgKGZyb20gPCB0byAmJiB0byA8IGZyb20gKyBjb3VudCkge1xyXG4gICAgICAgIGRpcmVjdGlvbiA9IC0xO1xyXG4gICAgICAgIGZyb20gPSBmcm9tICsgY291bnQgLSAxO1xyXG4gICAgICAgIHRvID0gdG8gKyBjb3VudCAtIDE7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZGlyZWN0aW9uID0gMTtcclxuICAgICAgfVxyXG4gICAgICB3aGlsZSAoY291bnQgPiAwKSB7XHJcbiAgICAgICAgdmFyIGZyb21LZXkgPSBTdHJpbmcoZnJvbSk7XHJcbiAgICAgICAgdmFyIHRvS2V5ID0gU3RyaW5nKHRvKTtcclxuICAgICAgICB2YXIgZnJvbVByZXNlbnQgPSBIYXNQcm9wZXJ0eShvLCBmcm9tS2V5KTtcclxuICAgICAgICBpZiAoZnJvbVByZXNlbnQpIHtcclxuICAgICAgICAgIHZhciBmcm9tVmFsID0gb1tmcm9tS2V5XTtcclxuICAgICAgICAgIG9bdG9LZXldID0gZnJvbVZhbDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgZGVsZXRlIG9bdG9LZXldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmcm9tID0gZnJvbSArIGRpcmVjdGlvbjtcclxuICAgICAgICB0byA9IHRvICsgZGlyZWN0aW9uO1xyXG4gICAgICAgIGNvdW50ID0gY291bnQgLSAxO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBvO1xyXG4gICAgfSk7XHJcblxyXG4gIC8vIDIyLjEuMy40IEFycmF5LnByb3RvdHlwZS5lbnRyaWVzICggKVxyXG4gIHZhciBuYXRpdmVBcnJheUl0ZXJhdG9yTWV0aG9kcyA9XHJcbiAgICAgICAgKCdlbnRyaWVzJyBpbiBBcnJheS5wcm90b3R5cGUgJiYgJ25leHQnIGluIFtdLmVudHJpZXMoKSk7XHJcblxyXG4gIGRlZmluZShcclxuICAgIEFycmF5LnByb3RvdHlwZSwgJ2VudHJpZXMnLFxyXG4gICAgZnVuY3Rpb24gZW50cmllcygpIHtcclxuICAgICAgcmV0dXJuIENyZWF0ZUFycmF5SXRlcmF0b3IodGhpcywgJ2tleSt2YWx1ZScpO1xyXG4gICAgfSwgIW5hdGl2ZUFycmF5SXRlcmF0b3JNZXRob2RzKTtcclxuXHJcbiAgLy8gMjIuMS4zLjUgQXJyYXkucHJvdG90eXBlLmV2ZXJ5ICggY2FsbGJhY2tmbiBbICwgdGhpc0FyZ10gKVxyXG5cclxuICAvLyAyMi4xLjMuNiBBcnJheS5wcm90b3R5cGUuZmlsbCAodmFsdWUgWyAsIHN0YXJ0IFsgLCBlbmQgXSBdIClcclxuICBkZWZpbmUoXHJcbiAgICBBcnJheS5wcm90b3R5cGUsICdmaWxsJyxcclxuICAgIGZ1bmN0aW9uIGZpbGwodmFsdWUvKiwgc3RhcnQsIGVuZCovKSB7XHJcbiAgICAgIHZhciBzdGFydCA9IGFyZ3VtZW50c1sxXSxcclxuICAgICAgICAgIGVuZCA9IGFyZ3VtZW50c1syXTtcclxuXHJcbiAgICAgIHZhciBvID0gVG9PYmplY3QodGhpcyk7XHJcbiAgICAgIHZhciBsZW5WYWwgPSBvLmxlbmd0aDtcclxuICAgICAgdmFyIGxlbiA9IFRvTGVuZ3RoKGxlblZhbCk7XHJcbiAgICAgIGxlbiA9IG1heChsZW4sIDApO1xyXG4gICAgICB2YXIgcmVsYXRpdmVTdGFydCA9IFRvSW50ZWdlcihzdGFydCk7XHJcbiAgICAgIHZhciBrO1xyXG4gICAgICBpZiAocmVsYXRpdmVTdGFydCA8IDApXHJcbiAgICAgICAgayA9IG1heCgobGVuICsgcmVsYXRpdmVTdGFydCksIDApO1xyXG4gICAgICBlbHNlXHJcbiAgICAgICAgayA9IG1pbihyZWxhdGl2ZVN0YXJ0LCBsZW4pO1xyXG4gICAgICB2YXIgcmVsYXRpdmVFbmQ7XHJcbiAgICAgIGlmIChlbmQgPT09IHVuZGVmaW5lZClcclxuICAgICAgICByZWxhdGl2ZUVuZCA9IGxlbjtcclxuICAgICAgZWxzZVxyXG4gICAgICAgIHJlbGF0aXZlRW5kID0gVG9JbnRlZ2VyKGVuZCk7XHJcbiAgICAgIHZhciBmaW5hbDtcclxuICAgICAgaWYgKHJlbGF0aXZlRW5kIDwgMClcclxuICAgICAgICBmaW5hbCA9IG1heCgobGVuICsgcmVsYXRpdmVFbmQpLCAwKTtcclxuICAgICAgZWxzZVxyXG4gICAgICAgIGZpbmFsID0gbWluKHJlbGF0aXZlRW5kLCBsZW4pO1xyXG4gICAgICB3aGlsZSAoayA8IGZpbmFsKSB7XHJcbiAgICAgICAgdmFyIHBrID0gU3RyaW5nKGspO1xyXG4gICAgICAgIG9bcGtdID0gdmFsdWU7XHJcbiAgICAgICAgayArPSAxO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBvO1xyXG4gICAgfSk7XHJcblxyXG4gIC8vIDIyLjEuMy43IEFycmF5LnByb3RvdHlwZS5maWx0ZXIgKCBjYWxsYmFja2ZuIFsgLCB0aGlzQXJnIF0gKVxyXG5cclxuICAvLyAyMi4xLjMuOCBBcnJheS5wcm90b3R5cGUuZmluZCAoIHByZWRpY2F0ZSBbICwgdGhpc0FyZyBdIClcclxuICBkZWZpbmUoXHJcbiAgICBBcnJheS5wcm90b3R5cGUsICdmaW5kJyxcclxuICAgIGZ1bmN0aW9uIGZpbmQocHJlZGljYXRlKSB7XHJcbiAgICAgIHZhciBvID0gVG9PYmplY3QodGhpcyk7XHJcbiAgICAgIHZhciBsZW5WYWx1ZSA9IG8ubGVuZ3RoO1xyXG4gICAgICB2YXIgbGVuID0gVG9JbnRlZ2VyKGxlblZhbHVlKTtcclxuICAgICAgaWYgKCFJc0NhbGxhYmxlKHByZWRpY2F0ZSkpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICB2YXIgdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkO1xyXG4gICAgICB2YXIgayA9IDA7XHJcbiAgICAgIHdoaWxlIChrIDwgbGVuKSB7XHJcbiAgICAgICAgdmFyIHBrID0gU3RyaW5nKGspO1xyXG4gICAgICAgIHZhciBrUHJlc2VudCA9IEhhc1Byb3BlcnR5KG8sIHBrKTtcclxuICAgICAgICBpZiAoa1ByZXNlbnQpIHtcclxuICAgICAgICAgIHZhciBrVmFsdWUgPSBvW3BrXTtcclxuICAgICAgICAgIHZhciB0ZXN0UmVzdWx0ID0gcHJlZGljYXRlLmNhbGwodCwga1ZhbHVlLCBrLCBvKTtcclxuICAgICAgICAgIGlmIChCb29sZWFuKHRlc3RSZXN1bHQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBrVmFsdWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgICsraztcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfSk7XHJcblxyXG4gIC8vIDIyLjEuMy45IEFycmF5LnByb3RvdHlwZS5maW5kSW5kZXggKCBwcmVkaWNhdGUgWyAsIHRoaXNBcmcgXSApXHJcbiAgZGVmaW5lKFxyXG4gICAgQXJyYXkucHJvdG90eXBlLCAnZmluZEluZGV4JyxcclxuICAgIGZ1bmN0aW9uIGZpbmRJbmRleChwcmVkaWNhdGUpIHtcclxuICAgICAgdmFyIG8gPSBUb09iamVjdCh0aGlzKTtcclxuICAgICAgdmFyIGxlblZhbHVlID0gby5sZW5ndGg7XHJcbiAgICAgIHZhciBsZW4gPSBUb0xlbmd0aChsZW5WYWx1ZSk7XHJcbiAgICAgIGlmICghSXNDYWxsYWJsZShwcmVkaWNhdGUpKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgdmFyIHQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDtcclxuICAgICAgdmFyIGsgPSAwO1xyXG4gICAgICB3aGlsZSAoayA8IGxlbikge1xyXG4gICAgICAgIHZhciBwayA9IFN0cmluZyhrKTtcclxuICAgICAgICB2YXIga1ByZXNlbnQgPSBIYXNQcm9wZXJ0eShvLCBwayk7XHJcbiAgICAgICAgaWYgKGtQcmVzZW50KSB7XHJcbiAgICAgICAgICB2YXIga1ZhbHVlID0gb1twa107XHJcbiAgICAgICAgICB2YXIgdGVzdFJlc3VsdCA9IHByZWRpY2F0ZS5jYWxsKHQsIGtWYWx1ZSwgaywgbyk7XHJcbiAgICAgICAgICBpZiAoQm9vbGVhbih0ZXN0UmVzdWx0KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgKytrO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiAtMTtcclxuICAgIH0pO1xyXG5cclxuICAvLyAyMi4xLjMuMTAgQXJyYXkucHJvdG90eXBlLmZvckVhY2ggKCBjYWxsYmFja2ZuIFsgLCB0aGlzQXJnIF0gKVxyXG4gIC8vIDIyLjEuMy4xMSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZiAoIHNlYXJjaEVsZW1lbnQgWyAsIGZyb21JbmRleCBdIClcclxuICAvLyAyMi4xLjMuMTIgQXJyYXkucHJvdG90eXBlLmpvaW4gKHNlcGFyYXRvcilcclxuXHJcbiAgLy8gMjIuMS4zLjEzIEFycmF5LnByb3RvdHlwZS5rZXlzICggKVxyXG4gIGRlZmluZShcclxuICAgIEFycmF5LnByb3RvdHlwZSwgJ2tleXMnLFxyXG4gICAgZnVuY3Rpb24ga2V5cygpIHtcclxuICAgICAgcmV0dXJuIENyZWF0ZUFycmF5SXRlcmF0b3IodGhpcywgJ2tleScpO1xyXG4gICAgfSwgIW5hdGl2ZUFycmF5SXRlcmF0b3JNZXRob2RzKTtcclxuXHJcbiAgLy8gMjIuMS4zLjE0IEFycmF5LnByb3RvdHlwZS5sYXN0SW5kZXhPZiAoIHNlYXJjaEVsZW1lbnQgWyAsIGZyb21JbmRleCBdIClcclxuICAvLyAyMi4xLjMuMTUgQXJyYXkucHJvdG90eXBlLm1hcCAoIGNhbGxiYWNrZm4gWyAsIHRoaXNBcmcgXSApXHJcbiAgLy8gMjIuMS4zLjE2IEFycmF5LnByb3RvdHlwZS5wb3AgKCApXHJcbiAgLy8gMjIuMS4zLjE3IEFycmF5LnByb3RvdHlwZS5wdXNoICggLi4uaXRlbXMgKVxyXG4gIC8vIDIyLjEuMy4xOCBBcnJheS5wcm90b3R5cGUucmVkdWNlICggY2FsbGJhY2tmbiBbICwgaW5pdGlhbFZhbHVlIF0gKVxyXG4gIC8vIDIyLjEuMy4xOSBBcnJheS5wcm90b3R5cGUucmVkdWNlUmlnaHQgKCBjYWxsYmFja2ZuIFsgLCBpbml0aWFsVmFsdWUgXSApXHJcbiAgLy8gMjIuMS4zLjIwIEFycmF5LnByb3RvdHlwZS5yZXZlcnNlICggKVxyXG4gIC8vIDIyLjEuMy4yMSBBcnJheS5wcm90b3R5cGUuc2hpZnQgKCApXHJcbiAgLy8gMjIuMS4zLjIyIEFycmF5LnByb3RvdHlwZS5zbGljZSAoc3RhcnQsIGVuZClcclxuICAvLyAyMi4xLjMuMjMgQXJyYXkucHJvdG90eXBlLnNvbWUgKCBjYWxsYmFja2ZuIFsgLCB0aGlzQXJnIF0gKVxyXG4gIC8vIDIyLjEuMy4yNCBBcnJheS5wcm90b3R5cGUuc29ydCAoY29tcGFyZWZuKVxyXG4gIC8vIDIyLjEuMy4yNSBBcnJheS5wcm90b3R5cGUuc3BsaWNlIChzdGFydCwgZGVsZXRlQ291bnQgLCAuLi5pdGVtcyApXHJcbiAgLy8gMjIuMS4zLjI2IEFycmF5LnByb3RvdHlwZS50b0xvY2FsZVN0cmluZyAoIFsgcmVzZXJ2ZWQxIFsgLCByZXNlcnZlZDIgXSBdIClcclxuICAvLyAyMi4xLjMuMjcgQXJyYXkucHJvdG90eXBlLnRvU3RyaW5nICggKVxyXG4gIC8vIDIyLjEuMy4yOCBBcnJheS5wcm90b3R5cGUudW5zaGlmdCAoIC4uLml0ZW1zIClcclxuXHJcbiAgLy8gMjIuMS4zLjI5IEFycmF5LnByb3RvdHlwZS52YWx1ZXMgKCApXHJcbiAgZGVmaW5lKFxyXG4gICAgQXJyYXkucHJvdG90eXBlLCAndmFsdWVzJyxcclxuICAgIGZ1bmN0aW9uIHZhbHVlcygpIHtcclxuICAgICAgcmV0dXJuIENyZWF0ZUFycmF5SXRlcmF0b3IodGhpcywgJ3ZhbHVlJyk7XHJcbiAgICB9LCAhbmF0aXZlQXJyYXlJdGVyYXRvck1ldGhvZHMpO1xyXG5cclxuICAvLyAyMi4xLjMuMzAgQXJyYXkucHJvdG90eXBlIFsgQEBpdGVyYXRvciBdICggKVxyXG4gIGRlZmluZShcclxuICAgIEFycmF5LnByb3RvdHlwZSwgJCRpdGVyYXRvcixcclxuICAgIEFycmF5LnByb3RvdHlwZS52YWx1ZXNcclxuICAgICk7XHJcblxyXG4gIC8vIDIyLjEuMy4zMSBBcnJheS5wcm90b3R5cGUgWyBAQHVuc2NvcGFibGVzIF1cclxuICAvLyAyMi4xLjQgUHJvcGVydGllcyBvZiBBcnJheSBJbnN0YW5jZXNcclxuICAvLyAyMi4xLjQuMSBsZW5ndGhcclxuXHJcbiAgLy8gMjIuMS41IEFycmF5IEl0ZXJhdG9yIE9iamVjdHNcclxuICBmdW5jdGlvbiBBcnJheUl0ZXJhdG9yKCkge31cclxuXHJcbiAgLy8gMjIuMS41LjEgQ3JlYXRlQXJyYXlJdGVyYXRvciBBYnN0cmFjdCBPcGVyYXRpb25cclxuICBmdW5jdGlvbiBDcmVhdGVBcnJheUl0ZXJhdG9yKGFycmF5LCBraW5kKSB7XHJcbiAgICB2YXIgbyA9IFRvT2JqZWN0KGFycmF5KTtcclxuICAgIHZhciBpdGVyYXRvciA9IG5ldyBBcnJheUl0ZXJhdG9yO1xyXG4gICAgc2V0X2ludGVybmFsKGl0ZXJhdG9yLCAnW1tJdGVyYXRlZE9iamVjdF1dJywgbyk7XHJcbiAgICBzZXRfaW50ZXJuYWwoaXRlcmF0b3IsICdbW0FycmF5SXRlcmF0b3JOZXh0SW5kZXhdXScsIDApO1xyXG4gICAgc2V0X2ludGVybmFsKGl0ZXJhdG9yLCAnW1tBcnJheUl0ZXJhdGlvbktpbmRdXScsIGtpbmQpO1xyXG4gICAgcmV0dXJuIGl0ZXJhdG9yO1xyXG4gIH1cclxuXHJcbiAgLy8gMjIuMS41LjIgVGhlICVBcnJheUl0ZXJhdG9yUHJvdG90eXBlJSBPYmplY3RcclxuICB2YXIgJEFycmF5SXRlcmF0b3JQcm90b3R5cGUkID0gT2JqZWN0LmNyZWF0ZSgkSXRlcmF0b3JQcm90b3R5cGUkKTtcclxuICBBcnJheUl0ZXJhdG9yLnByb3RvdHlwZSA9ICRBcnJheUl0ZXJhdG9yUHJvdG90eXBlJDtcclxuXHJcbiAgLy8gMjIuMS41LjIuMSAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUuIG5leHQoIClcclxuICBkZWZpbmUoXHJcbiAgICAkQXJyYXlJdGVyYXRvclByb3RvdHlwZSQsICduZXh0JyxcclxuICAgIGZ1bmN0aW9uIG5leHQoKSB7XHJcbiAgICAgIHZhciBvID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICBpZiAoVHlwZShvKSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICB2YXIgYSA9IG9bJ1tbSXRlcmF0ZWRPYmplY3RdXSddLFxyXG4gICAgICAgICAgaW5kZXggPSBvWydbW0FycmF5SXRlcmF0b3JOZXh0SW5kZXhdXSddLFxyXG4gICAgICAgICAgaXRlbUtpbmQgPSBvWydbW0FycmF5SXRlcmF0aW9uS2luZF1dJ10sXHJcbiAgICAgICAgICBsZW5WYWx1ZSA9IGEubGVuZ3RoLFxyXG4gICAgICAgICAgbGVuID0gVG9VaW50MzIobGVuVmFsdWUpLFxyXG4gICAgICAgICAgZWxlbWVudEtleSxcclxuICAgICAgICAgIGVsZW1lbnRWYWx1ZTtcclxuICAgICAgaWYgKGl0ZW1LaW5kLmluZGV4T2YoJ3NwYXJzZScpICE9PSAtMSkge1xyXG4gICAgICAgIHZhciBmb3VuZCA9IGZhbHNlO1xyXG4gICAgICAgIHdoaWxlICghZm91bmQgJiYgaW5kZXggPCBsZW4pIHtcclxuICAgICAgICAgIGVsZW1lbnRLZXkgPSBTdHJpbmcoaW5kZXgpO1xyXG4gICAgICAgICAgZm91bmQgPSBIYXNQcm9wZXJ0eShhLCBlbGVtZW50S2V5KTtcclxuICAgICAgICAgIGlmICghZm91bmQpIHtcclxuICAgICAgICAgICAgaW5kZXggKz0gMTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGluZGV4ID49IGxlbikge1xyXG4gICAgICAgIHNldF9pbnRlcm5hbChvLCAnW1tBcnJheUl0ZXJhdG9yTmV4dEluZGV4XV0nLCBJbmZpbml0eSk7XHJcbiAgICAgICAgcmV0dXJuIENyZWF0ZUl0ZXJSZXN1bHRPYmplY3QodW5kZWZpbmVkLCB0cnVlKTtcclxuICAgICAgfVxyXG4gICAgICBlbGVtZW50S2V5ID0gaW5kZXg7XHJcbiAgICAgIHNldF9pbnRlcm5hbChvLCAnW1tBcnJheUl0ZXJhdG9yTmV4dEluZGV4XV0nLCBpbmRleCArIDEpO1xyXG4gICAgICBpZiAoaXRlbUtpbmQuaW5kZXhPZigndmFsdWUnKSAhPT0gLTEpXHJcbiAgICAgICAgZWxlbWVudFZhbHVlID0gYVtlbGVtZW50S2V5XTtcclxuICAgICAgaWYgKGl0ZW1LaW5kLmluZGV4T2YoJ2tleSt2YWx1ZScpICE9PSAtMSlcclxuICAgICAgICByZXR1cm4gQ3JlYXRlSXRlclJlc3VsdE9iamVjdChbZWxlbWVudEtleSwgZWxlbWVudFZhbHVlXSwgZmFsc2UpO1xyXG4gICAgICBpZiAoaXRlbUtpbmQuaW5kZXhPZigna2V5JykgIT09IC0xKVxyXG4gICAgICAgIHJldHVybiBDcmVhdGVJdGVyUmVzdWx0T2JqZWN0KGVsZW1lbnRLZXksIGZhbHNlKTtcclxuICAgICAgaWYgKGl0ZW1LaW5kID09PSAndmFsdWUnKVxyXG4gICAgICAgIHJldHVybiBDcmVhdGVJdGVyUmVzdWx0T2JqZWN0KGVsZW1lbnRWYWx1ZSwgZmFsc2UpO1xyXG4gICAgICB0aHJvdyBFcnJvcignSW50ZXJuYWwgZXJyb3InKTtcclxuICAgIH0pO1xyXG5cclxuICAvLyAyMi4xLjUuMi4yICVBcnJheUl0ZXJhdG9yUHJvdG90eXBlJSBbIEBAdG9TdHJpbmdUYWcgXVxyXG4gIGRlZmluZSgkQXJyYXlJdGVyYXRvclByb3RvdHlwZSQsICQkdG9TdHJpbmdUYWcsICdBcnJheSBJdGVyYXRvcicpO1xyXG5cclxuICAvLyAyMi4xLjUuMyBQcm9wZXJ0aWVzIG9mIEFycmF5IEl0ZXJhdG9yIEluc3RhbmNlc1xyXG5cclxuXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gMjIuMiBUeXBlZEFycmF5IE9iamVjdHNcclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgLy8gU2VlIHR5cGVkYXJyYXkuanMgZm9yIFR5cGVkQXJyYXkgcG9seWZpbGxcclxuXHJcbiAgWydJbnQ4QXJyYXknLCAnVWludDhBcnJheScsICdVaW50OENsYW1wZWRBcnJheScsXHJcbiAgICdJbnQxNkFycmF5JywgJ1VpbnQxNkFycmF5JyxcclxuICAgJ0ludDMyQXJyYXknLCAnVWludDMyQXJyYXknLFxyXG4gICAnRmxvYXQzMkFycmF5JywgJ0Zsb2F0NjRBcnJheSddLmZvckVhY2goZnVuY3Rpb24gKCRUeXBlZEFycmF5TmFtZSQpIHtcclxuICAgICBpZiAoISgkVHlwZWRBcnJheU5hbWUkIGluIGdsb2JhbCkpXHJcbiAgICAgICByZXR1cm47XHJcbiAgICAgdmFyICRUeXBlZEFycmF5JCA9IGdsb2JhbFskVHlwZWRBcnJheU5hbWUkXTtcclxuXHJcbiAgICAgLy8gMjIuMi4xIFRoZSAlVHlwZWRBcnJheSUgSW50cmluc2ljIE9iamVjdFxyXG4gICAgIC8vIDIyLjIuMS4xICVUeXBlZEFycmF5JSAoIGxlbmd0aCApXHJcbiAgICAgLy8gMjIuMi4xLjIgJVR5cGVkQXJyYXklICggdHlwZWRBcnJheSApXHJcbiAgICAgLy8gMjIuMi4xLjMgJVR5cGVkQXJyYXklICggb2JqZWN0IClcclxuICAgICAvLyAyMi4yLjEuNCAlVHlwZWRBcnJheSUgKCBidWZmZXIgWyAsIGJ5dGVPZmZzZXQgWyAsIGxlbmd0aCBdIF0gKVxyXG4gICAgIC8vIDIyLjIuMS41ICVUeXBlZEFycmF5JSAoIGFsbCBvdGhlciBhcmd1bWVudCBjb21iaW5hdGlvbnMgKVxyXG4gICAgIC8vIDIyLjIuMiBQcm9wZXJ0aWVzIG9mIHRoZSAlVHlwZWRBcnJheSUgSW50cmluc2ljIE9iamVjdFxyXG5cclxuICAgICAvLyAyMi4yLjIuMSAlVHlwZWRBcnJheSUuZnJvbSAoIHNvdXJjZSBbICwgbWFwZm4gWyAsIHRoaXNBcmcgXSBdIClcclxuICAgICBkZWZpbmUoXHJcbiAgICAgICAkVHlwZWRBcnJheSQsICdmcm9tJyxcclxuICAgICAgIGZ1bmN0aW9uIGZyb20oc291cmNlKSB7XHJcbiAgICAgICAgIHZhciBtYXBmbiA9IGFyZ3VtZW50c1sxXTtcclxuICAgICAgICAgdmFyIHRoaXNBcmcgPSBhcmd1bWVudHNbMl07XHJcblxyXG4gICAgICAgICB2YXIgYyA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgICAgaWYgKCFJc0NvbnN0cnVjdG9yKGMpKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICAgaWYgKG1hcGZuID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICB2YXIgbWFwcGluZyA9IGZhbHNlO1xyXG4gICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgIGlmIChJc0NhbGxhYmxlKG1hcGZuKSkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgdmFyIHQgPSB0aGlzQXJnO1xyXG4gICAgICAgICAgIG1hcHBpbmcgPSB0cnVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHZhciB1c2luZ0l0ZXJhdG9yID0gR2V0TWV0aG9kKHNvdXJjZSwgJCRpdGVyYXRvcik7XHJcbiAgICAgICAgIGlmICh1c2luZ0l0ZXJhdG9yICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICB2YXIgaXRlcmF0b3IgPSBHZXRJdGVyYXRvcihzb3VyY2UsIHVzaW5nSXRlcmF0b3IpO1xyXG4gICAgICAgICAgIHZhciB2YWx1ZXMgPSBbXTtcclxuICAgICAgICAgICB2YXIgbmV4dCA9IHRydWU7XHJcbiAgICAgICAgICAgd2hpbGUgKG5leHQgIT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICBuZXh0ID0gSXRlcmF0b3JTdGVwKGl0ZXJhdG9yKTtcclxuICAgICAgICAgICAgIGlmIChuZXh0ICE9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICB2YXIgbmV4dFZhbHVlID0gSXRlcmF0b3JWYWx1ZShuZXh0KTtcclxuICAgICAgICAgICAgICAgdmFsdWVzLnB1c2gobmV4dFZhbHVlKTtcclxuICAgICAgICAgICAgIH1cclxuICAgICAgICAgICB9XHJcbiAgICAgICAgICAgdmFyIGxlbiA9IHZhbHVlcy5sZW5ndGg7XHJcbiAgICAgICAgICAgdmFyIG5ld09iaiA9IG5ldyBjKGxlbik7XHJcbiAgICAgICAgICAgdmFyIGsgPSAwO1xyXG4gICAgICAgICAgIHdoaWxlIChrIDwgbGVuKSB7XHJcbiAgICAgICAgICAgICB2YXIga1ZhbHVlID0gdmFsdWVzLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgICBpZiAobWFwcGluZykge1xyXG4gICAgICAgICAgICAgICB2YXIgbWFwcGVkVmFsdWUgPSBtYXBmbi5jYWxsKHQsIGtWYWx1ZSk7XHJcbiAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICBtYXBwZWRWYWx1ZSA9IGtWYWx1ZTtcclxuICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgIG5ld09ialtrXSA9IG1hcHBlZFZhbHVlO1xyXG4gICAgICAgICAgICAgKytrO1xyXG4gICAgICAgICAgIH1cclxuICAgICAgICAgICBjb25zb2xlLmFzc2VydCh2YWx1ZXMubGVuZ3RoID09PSAwKTtcclxuICAgICAgICAgICByZXR1cm4gbmV3T2JqO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHZhciBhcnJheUxpa2UgPSBUb09iamVjdChzb3VyY2UpO1xyXG4gICAgICAgICB2YXIgbGVuVmFsdWUgPSBhcnJheUxpa2UubGVuZ3RoO1xyXG4gICAgICAgICBsZW4gPSBUb0xlbmd0aChsZW5WYWx1ZSk7XHJcbiAgICAgICAgIG5ld09iaiA9IG5ldyBjKGxlbik7XHJcbiAgICAgICAgIGsgPSAwO1xyXG4gICAgICAgICB3aGlsZSAoayA8IGxlbikge1xyXG4gICAgICAgICAgIGtWYWx1ZSA9IGFycmF5TGlrZVtrXTtcclxuICAgICAgICAgICBpZiAobWFwcGluZykge1xyXG4gICAgICAgICAgICAgbWFwcGVkVmFsdWUgPSBtYXBmbi5jYWxsKHQsIGtWYWx1ZSwgayk7XHJcbiAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgIG1hcHBlZFZhbHVlID0ga1ZhbHVlO1xyXG4gICAgICAgICAgIH1cclxuICAgICAgICAgICBuZXdPYmpba10gPSBtYXBwZWRWYWx1ZTtcclxuICAgICAgICAgICArK2s7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgcmV0dXJuIG5ld09iajtcclxuICAgICAgIH0pO1xyXG5cclxuICAgICAvLyAyMi4yLjIuMiAlVHlwZWRBcnJheSUub2YgKCAuLi5pdGVtcyApXHJcbiAgICAgZGVmaW5lKFxyXG4gICAgICAgJFR5cGVkQXJyYXkkLCAnb2YnLFxyXG4gICAgICAgZnVuY3Rpb24gb2YoKSB7XHJcbiAgICAgICAgIHZhciBpdGVtcyA9IGFyZ3VtZW50cztcclxuXHJcbiAgICAgICAgIHZhciBsZW4gPSBpdGVtcy5sZW5ndGg7XHJcbiAgICAgICAgIHZhciBjID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICAgICB2YXIgbmV3T2JqID0gbmV3IGMobGVuKTtcclxuICAgICAgICAgdmFyIGsgPSAwO1xyXG4gICAgICAgICB3aGlsZSAoayA8IGxlbikge1xyXG4gICAgICAgICAgIG5ld09ialtrXSA9IGl0ZW1zW2tdO1xyXG4gICAgICAgICAgICsraztcclxuICAgICAgICAgfVxyXG4gICAgICAgICByZXR1cm4gbmV3T2JqO1xyXG4gICAgICAgfSk7XHJcblxyXG4gICAgIC8vIDIyLjIuMi4zICVUeXBlZEFycmF5JS5wcm90b3R5cGVcclxuICAgICAvLyAyMi4yLjIuNCBnZXQgJVR5cGVkQXJyYXklIFsgQEBzcGVjaWVzIF1cclxuICAgICAvLyAyMi4yLjMgUHJvcGVydGllcyBvZiB0aGUgJVR5cGVkQXJyYXlQcm90b3R5cGUlIE9iamVjdFxyXG4gICAgIC8vIDIyLjIuMy4xIGdldCAlVHlwZWRBcnJheSUucHJvdG90eXBlLmJ1ZmZlclxyXG4gICAgIC8vIDIyLjIuMy4yIGdldCAlVHlwZWRBcnJheSUucHJvdG90eXBlLmJ5dGVMZW5ndGhcclxuICAgICAvLyAyMi4yLjMuMyBnZXQgJVR5cGVkQXJyYXklLnByb3RvdHlwZS5ieXRlT2Zmc2V0XHJcbiAgICAgLy8gMjIuMi4zLjQgJVR5cGVkQXJyYXklLnByb3RvdHlwZS5jb25zdHJ1Y3RvclxyXG5cclxuICAgICAvLyAyMi4yLjMuNSAlVHlwZWRBcnJheSUucHJvdG90eXBlLmNvcHlXaXRoaW4gKHRhcmdldCwgc3RhcnQgWywgZW5kIF0gKVxyXG4gICAgIGRlZmluZSgkVHlwZWRBcnJheSQucHJvdG90eXBlLCAnY29weVdpdGhpbicsIEFycmF5LnByb3RvdHlwZS5jb3B5V2l0aGluKTtcclxuXHJcbiAgICAgLy8gMjIuMi4zLjYgJVR5cGVkQXJyYXklLnByb3RvdHlwZS5lbnRyaWVzICggKVxyXG4gICAgIGRlZmluZSgkVHlwZWRBcnJheSQucHJvdG90eXBlLCAnZW50cmllcycsIEFycmF5LnByb3RvdHlwZS5lbnRyaWVzKTtcclxuXHJcbiAgICAgLy8gMjIuMi4zLjcgJVR5cGVkQXJyYXklLnByb3RvdHlwZS5ldmVyeSAoIGNhbGxiYWNrZm4gWyAsIHRoaXNBcmcgXSApXHJcbiAgICAgZGVmaW5lKCRUeXBlZEFycmF5JC5wcm90b3R5cGUsICdldmVyeScsIEFycmF5LnByb3RvdHlwZS5ldmVyeSk7XHJcblxyXG4gICAgIC8vIDIyLjIuMy44ICVUeXBlZEFycmF5JS5wcm90b3R5cGUuZmlsbCAodmFsdWUgWyAsIHN0YXJ0IFsgLCBlbmQgXSBdIClcclxuICAgICBkZWZpbmUoXHJcbiAgICAgICAkVHlwZWRBcnJheSQucHJvdG90eXBlLCAnZmlsbCcsXHJcbiAgICAgICAvL0FycmF5LnByb3RvdHlwZS5maWxsIC8vIERvZXNuJ3Qgd29yayBpbiBTYWZhcmkgN1xyXG4gICAgICAgZnVuY3Rpb24gZmlsbCh2YWx1ZS8qLCBzdGFydCwgZW5kKi8pIHtcclxuICAgICAgICAgdmFyIHN0YXJ0ID0gYXJndW1lbnRzWzFdLFxyXG4gICAgICAgICAgICAgZW5kID0gYXJndW1lbnRzWzJdO1xyXG5cclxuICAgICAgICAgdmFyIG8gPSBUb09iamVjdCh0aGlzKTtcclxuICAgICAgICAgdmFyIGxlblZhbCA9IG8ubGVuZ3RoO1xyXG4gICAgICAgICB2YXIgbGVuID0gVG9MZW5ndGgobGVuVmFsKTtcclxuICAgICAgICAgbGVuID0gbWF4KGxlbiwgMCk7XHJcbiAgICAgICAgIHZhciByZWxhdGl2ZVN0YXJ0ID0gVG9JbnRlZ2VyKHN0YXJ0KTtcclxuICAgICAgICAgdmFyIGs7XHJcbiAgICAgICAgIGlmIChyZWxhdGl2ZVN0YXJ0IDwgMCkgayA9IG1heCgobGVuICsgcmVsYXRpdmVTdGFydCksIDApO1xyXG4gICAgICAgICBlbHNlIGsgPSBtaW4ocmVsYXRpdmVTdGFydCwgbGVuKTtcclxuICAgICAgICAgdmFyIHJlbGF0aXZlRW5kO1xyXG4gICAgICAgICBpZiAoZW5kID09PSB1bmRlZmluZWQpIHJlbGF0aXZlRW5kID0gbGVuO1xyXG4gICAgICAgICBlbHNlIHJlbGF0aXZlRW5kID0gVG9JbnRlZ2VyKGVuZCk7XHJcbiAgICAgICAgIHZhciBmaW5hbDtcclxuICAgICAgICAgaWYgKHJlbGF0aXZlRW5kIDwgMCkgZmluYWwgPSBtYXgoKGxlbiArIHJlbGF0aXZlRW5kKSwgMCk7XHJcbiAgICAgICAgIGVsc2UgZmluYWwgPSBtaW4ocmVsYXRpdmVFbmQsIGxlbik7XHJcbiAgICAgICAgIHdoaWxlIChrIDwgZmluYWwpIHtcclxuICAgICAgICAgICB2YXIgcGsgPSBTdHJpbmcoayk7XHJcbiAgICAgICAgICAgb1twa10gPSB2YWx1ZTtcclxuICAgICAgICAgICBrICs9IDE7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgcmV0dXJuIG87XHJcbiAgICAgICB9KTtcclxuXHJcbiAgICAgLy8gMjIuMi4zLjkgJVR5cGVkQXJyYXklLnByb3RvdHlwZS5maWx0ZXIgKCBjYWxsYmFja2ZuIFsgLCB0aGlzQXJnIF0gKVxyXG4gICAgIGRlZmluZShcclxuICAgICAgICRUeXBlZEFycmF5JC5wcm90b3R5cGUsICdmaWx0ZXInLFxyXG4gICAgICAgZnVuY3Rpb24gZmlsdGVyKGNhbGxiYWNrZm4pIHtcclxuICAgICAgICAgdmFyIHRoaXNBcmcgPSBhcmd1bWVudHNbMV07XHJcblxyXG4gICAgICAgICB2YXIgbyA9IFRvT2JqZWN0KHRoaXMpO1xyXG4gICAgICAgICB2YXIgbGVuVmFsID0gby5sZW5ndGg7XHJcbiAgICAgICAgIHZhciBsZW4gPSBUb0xlbmd0aChsZW5WYWwpO1xyXG4gICAgICAgICBpZiAoIUlzQ2FsbGFibGUoY2FsbGJhY2tmbikpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICB2YXIgdCA9IHRoaXNBcmc7XHJcbiAgICAgICAgIHZhciBjID0gby5jb25zdHJ1Y3RvcjtcclxuICAgICAgICAgdmFyIGtlcHQgPSBbXTtcclxuICAgICAgICAgdmFyIGsgPSAwO1xyXG4gICAgICAgICB2YXIgY2FwdHVyZWQgPSAwO1xyXG4gICAgICAgICB3aGlsZSAoayA8IGxlbikge1xyXG4gICAgICAgICAgIHZhciBrVmFsdWUgPSBvW2tdO1xyXG4gICAgICAgICAgIHZhciBzZWxlY3RlZCA9IGNhbGxiYWNrZm4uY2FsbCh0LCBrVmFsdWUsIGssIG8pO1xyXG4gICAgICAgICAgIGlmIChzZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAga2VwdC5wdXNoKGtWYWx1ZSk7XHJcbiAgICAgICAgICAgICArK2NhcHR1cmVkO1xyXG4gICAgICAgICAgIH1cclxuICAgICAgICAgICArK2s7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdmFyIGEgPSBuZXcgYyhjYXB0dXJlZCk7XHJcbiAgICAgICAgIHZhciBuID0gMDtcclxuICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXB0Lmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgdmFyIGUgPSBrZXB0W2ldO1xyXG4gICAgICAgICAgIGFbbl0gPSBlO1xyXG4gICAgICAgICAgICsrbjtcclxuICAgICAgICAgfVxyXG4gICAgICAgICByZXR1cm4gYTtcclxuICAgICAgIH0pO1xyXG5cclxuICAgICAvLyAyMi4yLjMuMTAgJVR5cGVkQXJyYXklLnByb3RvdHlwZS5maW5kIChwcmVkaWNhdGUgWyAsIHRoaXNBcmcgXSApXHJcbiAgICAgZGVmaW5lKCRUeXBlZEFycmF5JC5wcm90b3R5cGUsICdmaW5kJywgQXJyYXkucHJvdG90eXBlLmZpbmQpO1xyXG5cclxuICAgICAvLyAyMi4yLjMuMTEgJVR5cGVkQXJyYXklLnByb3RvdHlwZS5maW5kSW5kZXggKCBwcmVkaWNhdGUgWyAsIHRoaXNBcmcgXSApXHJcbiAgICAgZGVmaW5lKCRUeXBlZEFycmF5JC5wcm90b3R5cGUsICdmaW5kSW5kZXgnLCBBcnJheS5wcm90b3R5cGUuZmluZEluZGV4KTtcclxuXHJcbiAgICAgLy8gMjIuMi4zLjEyICVUeXBlZEFycmF5JS5wcm90b3R5cGUuZm9yRWFjaCAoIGNhbGxiYWNrZm4gWyAsIHRoaXNBcmcgXSApXHJcbiAgICAgZGVmaW5lKCRUeXBlZEFycmF5JC5wcm90b3R5cGUsICdmb3JFYWNoJywgQXJyYXkucHJvdG90eXBlLmZvckVhY2gpO1xyXG5cclxuICAgICAvLyAyMi4yLjMuMTMgJVR5cGVkQXJyYXklLnByb3RvdHlwZS5pbmRleE9mIChzZWFyY2hFbGVtZW50IFsgLCBmcm9tSW5kZXggXSApXHJcbiAgICAgZGVmaW5lKCRUeXBlZEFycmF5JC5wcm90b3R5cGUsICdpbmRleE9mJywgQXJyYXkucHJvdG90eXBlLmluZGV4T2YpO1xyXG5cclxuICAgICAvLyAyMi4yLjMuMTQgJVR5cGVkQXJyYXklLnByb3RvdHlwZS5qb2luICggc2VwYXJhdG9yIClcclxuICAgICBkZWZpbmUoJFR5cGVkQXJyYXkkLnByb3RvdHlwZSwgJ2pvaW4nLCBBcnJheS5wcm90b3R5cGUuam9pbik7XHJcblxyXG4gICAgIC8vIDIyLjIuMy4xNSAlVHlwZWRBcnJheSUucHJvdG90eXBlLmtleXMgKCApXHJcbiAgICAgZGVmaW5lKCRUeXBlZEFycmF5JC5wcm90b3R5cGUsICdrZXlzJywgQXJyYXkucHJvdG90eXBlLmtleXMpO1xyXG5cclxuICAgICAvLyAyMi4yLjMuMTYgJVR5cGVkQXJyYXklLnByb3RvdHlwZS5sYXN0SW5kZXhPZiAoIHNlYXJjaEVsZW1lbnQgWyAsIGZyb21JbmRleCBdIClcclxuICAgICBkZWZpbmUoJFR5cGVkQXJyYXkkLnByb3RvdHlwZSwgJ2xhc3RJbmRleE9mJywgQXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mKTtcclxuXHJcbiAgICAgLy8gMjIuMi4zLjE3IGdldCAlVHlwZWRBcnJheSUucHJvdG90eXBlLmxlbmd0aFxyXG5cclxuICAgICAvLyAyMi4yLjMuMTggJVR5cGVkQXJyYXklLnByb3RvdHlwZS5tYXAgKCBjYWxsYmFja2ZuIFsgLCB0aGlzQXJnIF0gKVxyXG4gICAgIGRlZmluZShcclxuICAgICAgICRUeXBlZEFycmF5JC5wcm90b3R5cGUsICdtYXAnLFxyXG4gICAgICAgZnVuY3Rpb24gbWFwKGNhbGxiYWNrZm4pIHtcclxuICAgICAgICAgdmFyIHRoaXNBcmcgPSBhcmd1bWVudHNbMV07XHJcblxyXG4gICAgICAgICB2YXIgbyA9IFRvT2JqZWN0KHRoaXMpO1xyXG4gICAgICAgICB2YXIgbGVuVmFsdWUgPSBvLmxlbmd0aDtcclxuICAgICAgICAgdmFyIGxlbiA9IFRvTGVuZ3RoKGxlblZhbHVlKTtcclxuICAgICAgICAgaWYgKCFJc0NhbGxhYmxlKGNhbGxiYWNrZm4pKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICAgdmFyIHQgPSB0aGlzQXJnO1xyXG4gICAgICAgICB2YXIgYSA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgdmFyIGMgPSBvLmNvbnN0cnVjdG9yO1xyXG4gICAgICAgICBpZiAoSXNDb25zdHJ1Y3RvcihjKSlcclxuICAgICAgICAgICBhID0gbmV3IGMobGVuKTtcclxuICAgICAgICAgaWYgKGEgPT09IHVuZGVmaW5lZClcclxuICAgICAgICAgICBhID0gbmV3IEFycmF5KGxlbik7XHJcbiAgICAgICAgIHZhciBrID0gMDtcclxuICAgICAgICAgd2hpbGUgKGsgPCBsZW4pIHtcclxuICAgICAgICAgICB2YXIga1ByZXNlbnQgPSBIYXNQcm9wZXJ0eShvLCBrKTtcclxuICAgICAgICAgICBpZiAoa1ByZXNlbnQpIHtcclxuICAgICAgICAgICAgIHZhciBrVmFsdWUgPSBvW2tdO1xyXG4gICAgICAgICAgICAgdmFyIG1hcHBlZFZhbHVlID0gY2FsbGJhY2tmbi5jYWxsKHQsIGtWYWx1ZSwgaywgbyk7XHJcbiAgICAgICAgICAgICBhW2tdID0gbWFwcGVkVmFsdWU7XHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgICAgICsraztcclxuICAgICAgICAgfVxyXG4gICAgICAgICByZXR1cm4gYTtcclxuICAgICAgIH0pO1xyXG5cclxuICAgICAvLyAyMi4yLjMuMTkgJVR5cGVkQXJyYXklLnByb3RvdHlwZS5yZWR1Y2UgKCBjYWxsYmFja2ZuIFssIGluaXRpYWxWYWx1ZV0gKVxyXG4gICAgIGRlZmluZSgkVHlwZWRBcnJheSQucHJvdG90eXBlLCAncmVkdWNlJywgQXJyYXkucHJvdG90eXBlLnJlZHVjZSk7XHJcblxyXG4gICAgIC8vIDIyLjIuMy4yMCAlVHlwZWRBcnJheSUucHJvdG90eXBlLnJlZHVjZVJpZ2h0ICggY2FsbGJhY2tmbiBbLCBpbml0aWFsVmFsdWVdIClcclxuICAgICBkZWZpbmUoJFR5cGVkQXJyYXkkLnByb3RvdHlwZSwgJ3JlZHVjZVJpZ2h0JywgQXJyYXkucHJvdG90eXBlLnJlZHVjZVJpZ2h0KTtcclxuXHJcbiAgICAgLy8gMjIuMi4zLjIxICVUeXBlZEFycmF5JS5wcm90b3R5cGUucmV2ZXJzZSAoIClcclxuICAgICBkZWZpbmUoJFR5cGVkQXJyYXkkLnByb3RvdHlwZSwgJ3JldmVyc2UnLCBBcnJheS5wcm90b3R5cGUucmV2ZXJzZSk7XHJcblxyXG4gICAgIC8vIDIyLjIuMy4yMiAlVHlwZWRBcnJheSUucHJvdG90eXBlLnNldCAoIG92ZXJsb2FkZWQgWyAsIG9mZnNldCBdKVxyXG4gICAgIC8vIDIyLjIuMy4yMi4xICVUeXBlZEFycmF5JS5wcm90b3R5cGUuc2V0IChhcnJheSBbICwgb2Zmc2V0IF0gKVxyXG4gICAgIC8vIDIyLjIuMy4yMi4yICVUeXBlZEFycmF5JS5wcm90b3R5cGUuc2V0KHR5cGVkQXJyYXkgWywgb2Zmc2V0IF0gKVxyXG5cclxuICAgICAvLyAyMi4yLjMuMjMgJVR5cGVkQXJyYXklLnByb3RvdHlwZS5zbGljZSAoIHN0YXJ0LCBlbmQgKVxyXG4gICAgIGRlZmluZShcclxuICAgICAgICRUeXBlZEFycmF5JC5wcm90b3R5cGUsICdzbGljZScsXHJcbiAgICAgICBmdW5jdGlvbiBzbGljZShzdGFydCwgZW5kKSB7XHJcbiAgICAgICAgIHZhciBvID0gVG9PYmplY3QodGhpcyk7XHJcbiAgICAgICAgIHZhciBsZW5WYWwgPSBvLmxlbmd0aDtcclxuICAgICAgICAgdmFyIGxlbiA9IFRvTGVuZ3RoKGxlblZhbCk7XHJcbiAgICAgICAgIHZhciByZWxhdGl2ZVN0YXJ0ID0gVG9JbnRlZ2VyKHN0YXJ0KTtcclxuICAgICAgICAgdmFyIGsgPSAocmVsYXRpdmVTdGFydCA8IDApID8gbWF4KGxlbiArIHJlbGF0aXZlU3RhcnQsIDApIDogbWluKHJlbGF0aXZlU3RhcnQsIGxlbik7XHJcbiAgICAgICAgIHZhciByZWxhdGl2ZUVuZCA9IChlbmQgPT09IHVuZGVmaW5lZCkgPyBsZW4gOiBUb0ludGVnZXIoZW5kKTtcclxuICAgICAgICAgdmFyIGZpbmFsID0gKHJlbGF0aXZlRW5kIDwgMCkgPyBtYXgobGVuICsgcmVsYXRpdmVFbmQsIDApIDogbWluKHJlbGF0aXZlRW5kLCBsZW4pO1xyXG4gICAgICAgICB2YXIgY291bnQgPSBmaW5hbCAtIGs7XHJcbiAgICAgICAgIHZhciBjID0gby5jb25zdHJ1Y3RvcjtcclxuICAgICAgICAgaWYgKElzQ29uc3RydWN0b3IoYykpIHtcclxuICAgICAgICAgICB2YXIgYSA9IG5ldyBjKGNvdW50KTtcclxuICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB2YXIgbiA9IDA7XHJcbiAgICAgICAgIHdoaWxlIChrIDwgZmluYWwpIHtcclxuICAgICAgICAgICB2YXIga1ZhbHVlID0gb1trXTtcclxuICAgICAgICAgICBhW25dID0ga1ZhbHVlO1xyXG4gICAgICAgICAgICsraztcclxuICAgICAgICAgICArK247XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgcmV0dXJuIGE7XHJcbiAgICAgICB9KTtcclxuXHJcbiAgICAgLy8gMjIuMi4zLjI0ICVUeXBlZEFycmF5JS5wcm90b3R5cGUuc29tZSAoIGNhbGxiYWNrZm4gWyAsIHRoaXNBcmcgXSApXHJcbiAgICAgZGVmaW5lKCRUeXBlZEFycmF5JC5wcm90b3R5cGUsICdzb21lJywgQXJyYXkucHJvdG90eXBlLnNvbWUpO1xyXG5cclxuICAgICAvLyAyMi4yLjMuMjUgJVR5cGVkQXJyYXklLnByb3RvdHlwZS5zb3J0ICggY29tcGFyZWZuIClcclxuICAgICBkZWZpbmUoXHJcbiAgICAgICAkVHlwZWRBcnJheSQucHJvdG90eXBlLCAnc29ydCcsXHJcbiAgICAgICBmdW5jdGlvbiBzb3J0KCkge1xyXG4gICAgICAgICB2YXIgY29tcGFyZWZuID0gYXJndW1lbnRzWzBdO1xyXG5cclxuICAgICAgICAgZnVuY3Rpb24gc29ydENvbXBhcmUoeCwgeSkge1xyXG4gICAgICAgICAgIGNvbnNvbGUuYXNzZXJ0KFR5cGUoeCkgPT09ICdudW1iZXInICYmIFR5cGUoeSkgPT09ICdudW1iZXInKTtcclxuICAgICAgICAgICBpZiAoeCAhPT0geCAmJiB5ICE9PSB5KSByZXR1cm4gKzA7XHJcbiAgICAgICAgICAgaWYgKHggIT09IHgpIHJldHVybiAxO1xyXG4gICAgICAgICAgIGlmICh5ICE9PSB5KSByZXR1cm4gLTE7XHJcbiAgICAgICAgICAgaWYgKGNvbXBhcmVmbiAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICByZXR1cm4gY29tcGFyZWZuKHgsIHkpO1xyXG4gICAgICAgICAgIH1cclxuICAgICAgICAgICBpZiAoeCA8IHkpIHJldHVybiAtMTtcclxuICAgICAgICAgICBpZiAoeCA+IHkpIHJldHVybiAxO1xyXG4gICAgICAgICAgIHJldHVybiArMDtcclxuICAgICAgICAgfVxyXG4gICAgICAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNvcnQuY2FsbCh0aGlzLCBzb3J0Q29tcGFyZSk7XHJcbiAgICAgICB9KTtcclxuXHJcbiAgICAgLy8gMjIuMi4zLjI2ICVUeXBlZEFycmF5JS5wcm90b3R5cGUuc3ViYXJyYXkoIFsgYmVnaW4gWyAsIGVuZCBdIF0gKVxyXG4gICAgIC8vIDIyLjIuMy4yNyAlVHlwZWRBcnJheSUucHJvdG90eXBlLnRvTG9jYWxlU3RyaW5nIChbIHJlc2VydmVkMSBbICwgcmVzZXJ2ZWQyIF0gXSlcclxuICAgICAvLyAyMi4yLjMuMjggJVR5cGVkQXJyYXklLnByb3RvdHlwZS50b1N0cmluZyAoIClcclxuXHJcbiAgICAgLy8gMjIuMi4zLjI5ICVUeXBlZEFycmF5JS5wcm90b3R5cGUudmFsdWVzICggKVxyXG4gICAgIGRlZmluZSgkVHlwZWRBcnJheSQucHJvdG90eXBlLCAndmFsdWVzJywgQXJyYXkucHJvdG90eXBlLnZhbHVlcyk7XHJcblxyXG4gICAgIC8vIDIyLjIuMy4zMCAlVHlwZWRBcnJheSUucHJvdG90eXBlIFsgQEBpdGVyYXRvciBdICggKVxyXG4gICAgIGRlZmluZShcclxuICAgICAgICRUeXBlZEFycmF5JC5wcm90b3R5cGUsICQkaXRlcmF0b3IsXHJcbiAgICAgICAkVHlwZWRBcnJheSQucHJvdG90eXBlLnZhbHVlc1xyXG4gICAgICk7XHJcblxyXG4gICAgIC8vIDIyLjIuMy4zMSBnZXQgJVR5cGVkQXJyYXklLnByb3RvdHlwZSBbIEBAdG9TdHJpbmdUYWcgXVxyXG4gICAgIGRlZmluZSgkVHlwZWRBcnJheSQucHJvdG90eXBlLCAkJHRvU3RyaW5nVGFnLCAkVHlwZWRBcnJheU5hbWUkKTtcclxuXHJcbiAgICAgLy8gMjIuMi40IFRoZSBUeXBlZEFycmF5IENvbnN0cnVjdG9yc1xyXG4gICAgIC8vIDIyLjIuNC4xVHlwZWRBcnJheSggLi4uIGFyZ3VtZW50c0xpc3QpXHJcbiAgICAgLy8gMjIuMi41IFByb3BlcnRpZXMgb2YgdGhlIFR5cGVkQXJyYXkgQ29uc3RydWN0b3JzXHJcbiAgICAgLy8gMjIuMi41LjEgVHlwZWRBcnJheS5CWVRFU19QRVJfRUxFTUVOVFxyXG4gICAgIC8vIDIyLjIuNS4yIFR5cGVkQXJyYXkucHJvdG90eXBlXHJcbiAgICAgLy8gMjIuMi42IFByb3BlcnRpZXMgb2YgVHlwZWRBcnJheSBQcm90b3R5cGUgT2JqZWN0c1xyXG4gICAgIC8vIDIyLjIuNi4xIFR5cGVkQXJyYXkucHJvdG90eXBlLkJZVEVTX1BFUl9FTEVNRU5UXHJcbiAgICAgLy8gMjIuMi42LjIgVHlwZWRBcnJheS5wcm90b3R5cGUuY29uc3RydWN0b3JcclxuICAgICAvLyAyMi4yLjcgUHJvcGVydGllcyBvZiBUeXBlZEFycmF5IEluc3RhbmNlc1xyXG4gICB9KTtcclxuXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gMjMgS2V5ZWQgQ29sbGVjdGlvblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyAyMy4xIE1hcCBPYmplY3RzXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIChmdW5jdGlvbigpIHtcclxuICAgIC8vIDIzLjEuMSBUaGUgTWFwIENvbnN0cnVjdG9yXHJcblxyXG4gICAgLy8gMjMuMS4xLjEgTWFwICggWyBpdGVyYWJsZSBdIClcclxuICAgIC8qKiBAY29uc3RydWN0b3IgKi9cclxuICAgIGZ1bmN0aW9uIE1hcCgvKml0ZXJhYmxlKi8pIHtcclxuICAgICAgdmFyIG1hcCA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgdmFyIGl0ZXJhYmxlID0gYXJndW1lbnRzWzBdO1xyXG5cclxuICAgICAgaWYgKFR5cGUobWFwKSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICBpZiAoJ1tbTWFwRGF0YV1dJyBpbiBtYXApIHRocm93IFR5cGVFcnJvcigpO1xyXG5cclxuICAgICAgaWYgKGl0ZXJhYmxlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YXIgYWRkZXIgPSBtYXBbJ3NldCddO1xyXG4gICAgICAgIGlmICghSXNDYWxsYWJsZShhZGRlcikpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIHZhciBpdGVyID0gR2V0SXRlcmF0b3IoVG9PYmplY3QoaXRlcmFibGUpKTtcclxuICAgICAgfVxyXG4gICAgICBzZXRfaW50ZXJuYWwobWFwLCAnW1tNYXBEYXRhXV0nLCB7IGtleXM6IFtdLCB2YWx1ZXM6IFtdIH0pO1xyXG4gICAgICBpZiAoaXRlciA9PT0gdW5kZWZpbmVkKSByZXR1cm4gbWFwO1xyXG4gICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgIHZhciBuZXh0ID0gSXRlcmF0b3JTdGVwKGl0ZXIpO1xyXG4gICAgICAgIGlmIChuZXh0ID09PSBmYWxzZSlcclxuICAgICAgICAgIHJldHVybiBtYXA7XHJcbiAgICAgICAgdmFyIG5leHRJdGVtID0gSXRlcmF0b3JWYWx1ZShuZXh0KTtcclxuICAgICAgICBpZiAoVHlwZShuZXh0SXRlbSkgIT09ICdvYmplY3QnKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICB2YXIgayA9IG5leHRJdGVtWzBdO1xyXG4gICAgICAgIHZhciB2ID0gbmV4dEl0ZW1bMV07XHJcbiAgICAgICAgYWRkZXIuY2FsbChtYXAsIGssIHYpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gbWFwO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghKCdNYXAnIGluIGdsb2JhbCkgfHwgT1ZFUlJJREVfTkFUSVZFX0ZPUl9URVNUSU5HIHx8XHJcbiAgICAgICAgKGZ1bmN0aW9uKCkgeyB0cnkgeyBuZXcgZ2xvYmFsLk1hcChbXSk7IHJldHVybiBmYWxzZTsgfSBjYXRjaCAoXykgeyByZXR1cm4gdHJ1ZTsgfSB9KCkpIHx8XHJcbiAgICAgICAgKGZ1bmN0aW9uKCkgeyB0cnkgeyByZXR1cm4gIW5ldyBnbG9iYWwuTWFwKCkuZW50cmllcygpLm5leHQ7IH0gY2F0Y2ggKF8pIHsgcmV0dXJuIHRydWU7IH0gfSgpKSB8fFxyXG4gICAgICAgIChuZXcgZ2xvYmFsLk1hcChbWydhJywgMV1dKS5zaXplICE9PSAxKSlcclxuICAgICAgZ2xvYmFsLk1hcCA9IE1hcDtcclxuXHJcblxyXG4gICAgZnVuY3Rpb24gTWFwRGF0YUluZGV4T2YobWFwRGF0YSwga2V5KSB7XHJcbiAgICAgIHZhciBpO1xyXG4gICAgICBpZiAoa2V5ID09PSBrZXkpIHJldHVybiBtYXBEYXRhLmtleXMuaW5kZXhPZihrZXkpO1xyXG4gICAgICAvLyBTbG93IGNhc2UgZm9yIE5hTlxyXG4gICAgICBmb3IgKGkgPSAwOyBpIDwgbWFwRGF0YS5rZXlzLmxlbmd0aDsgaSArPSAxKVxyXG4gICAgICAgIGlmIChTYW1lVmFsdWVaZXJvKG1hcERhdGEua2V5c1tpXSwga2V5KSkgcmV0dXJuIGk7XHJcbiAgICAgIHJldHVybiAtMTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAyMy4xLjEuMiBuZXcgTWFwICggLi4uIGFyZ3VtZW50c0xpc3QgKVxyXG4gICAgLy8gMjMuMS4yIFByb3BlcnRpZXMgb2YgdGhlIE1hcCBDb25zdHJ1Y3RvclxyXG4gICAgLy8gMjMuMS4yLjEgTWFwLnByb3RvdHlwZVxyXG4gICAgdmFyICRNYXBQcm90b3R5cGUkID0ge307XHJcbiAgICBNYXAucHJvdG90eXBlID0gJE1hcFByb3RvdHlwZSQ7XHJcblxyXG4gICAgLy8gMjMuMS4yLjIgZ2V0IE1hcCBbIEBAc3BlY2llcyBdXHJcblxyXG4gICAgLy8gMjMuMS4zIFByb3BlcnRpZXMgb2YgdGhlIE1hcCBQcm90b3R5cGUgT2JqZWN0XHJcbiAgICAvLyAyMy4xLjMuMSBNYXAucHJvdG90eXBlLmNsZWFyICgpXHJcbiAgICBkZWZpbmUoXHJcbiAgICAgIE1hcC5wcm90b3R5cGUsICdjbGVhcicsXHJcbiAgICAgIGZ1bmN0aW9uIGNsZWFyKCkge1xyXG4gICAgICAgIHZhciBtID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICAgIGlmIChUeXBlKG0pICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgaWYgKCEoJ1tbTWFwRGF0YV1dJyBpbiBtKSkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgaWYgKG1bJ1tbTWFwRGF0YV1dJ10gPT09IHVuZGVmaW5lZCkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgdmFyIGVudHJpZXMgPSBtWydbW01hcERhdGFdXSddO1xyXG4gICAgICAgIGVudHJpZXMua2V5cy5sZW5ndGggPSAwO1xyXG4gICAgICAgIGVudHJpZXMudmFsdWVzLmxlbmd0aCA9IDA7XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgLy8gMjMuMS4zLjIgTWFwLnByb3RvdHlwZS5jb25zdHJ1Y3RvclxyXG5cclxuICAgIC8vIDIzLjEuMy4zIE1hcC5wcm90b3R5cGUuZGVsZXRlICgga2V5IClcclxuICAgIGRlZmluZShcclxuICAgICAgTWFwLnByb3RvdHlwZSwgJ2RlbGV0ZScsXHJcbiAgICAgIGZ1bmN0aW9uIGRlbGV0ZV8oa2V5KSB7XHJcbiAgICAgICAgdmFyIG0gPSBzdHJpY3QodGhpcyk7XHJcbiAgICAgICAgaWYgKFR5cGUobSkgIT09ICdvYmplY3QnKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICBpZiAoISgnW1tNYXBEYXRhXV0nIGluIG0pKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICBpZiAobVsnW1tNYXBEYXRhXV0nXSA9PT0gdW5kZWZpbmVkKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICB2YXIgZW50cmllcyA9IG1bJ1tbTWFwRGF0YV1dJ107XHJcbiAgICAgICAgdmFyIGkgPSBNYXBEYXRhSW5kZXhPZihlbnRyaWVzLCBrZXkpO1xyXG4gICAgICAgIGlmIChpIDwgMCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIGVudHJpZXMua2V5c1tpXSA9IGVtcHR5O1xyXG4gICAgICAgIGVudHJpZXMudmFsdWVzW2ldID0gZW1wdHk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8vIDIzLjEuMy40IE1hcC5wcm90b3R5cGUuZW50cmllcyAoIClcclxuICAgIGRlZmluZShcclxuICAgICAgTWFwLnByb3RvdHlwZSwgJ2VudHJpZXMnLFxyXG4gICAgICBmdW5jdGlvbiBlbnRyaWVzKCkge1xyXG4gICAgICAgIHZhciBtID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICAgIGlmIChUeXBlKG0pICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgcmV0dXJuIENyZWF0ZU1hcEl0ZXJhdG9yKG0sICdrZXkrdmFsdWUnKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgLy8gMjMuMS4zLjUgTWFwLnByb3RvdHlwZS5mb3JFYWNoICggY2FsbGJhY2tmbiBbICwgdGhpc0FyZyBdIClcclxuICAgIGRlZmluZShcclxuICAgICAgTWFwLnByb3RvdHlwZSwgJ2ZvckVhY2gnLFxyXG4gICAgICBmdW5jdGlvbiBmb3JFYWNoKGNhbGxiYWNrZm4gLyosIHRoaXNBcmcqLykge1xyXG4gICAgICAgIHZhciB0aGlzQXJnID0gYXJndW1lbnRzWzFdO1xyXG5cclxuICAgICAgICB2YXIgbSA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgICBpZiAoVHlwZShtKSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIGlmICghKCdbW01hcERhdGFdXScgaW4gbSkpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIGlmIChtWydbW01hcERhdGFdXSddID09PSB1bmRlZmluZWQpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIHZhciBlbnRyaWVzID0gbVsnW1tNYXBEYXRhXV0nXTtcclxuXHJcbiAgICAgICAgaWYgKCFJc0NhbGxhYmxlKGNhbGxiYWNrZm4pKSB7XHJcbiAgICAgICAgICB0aHJvdyBUeXBlRXJyb3IoJ0ZpcnN0IGFyZ3VtZW50IHRvIGZvckVhY2ggaXMgbm90IGNhbGxhYmxlLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVudHJpZXMua2V5cy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgaWYgKGVudHJpZXMua2V5c1tpXSAhPT0gZW1wdHkpIHtcclxuICAgICAgICAgICAgY2FsbGJhY2tmbi5jYWxsKHRoaXNBcmcsIGVudHJpZXMudmFsdWVzW2ldLCBlbnRyaWVzLmtleXNbaV0sIG0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyAyMy4xLjMuNiBNYXAucHJvdG90eXBlLmdldCAoIGtleSApXHJcbiAgICBkZWZpbmUoXHJcbiAgICAgIE1hcC5wcm90b3R5cGUsICdnZXQnLFxyXG4gICAgICBmdW5jdGlvbiBnZXQoa2V5KSB7XHJcbiAgICAgICAgdmFyIG0gPSBzdHJpY3QodGhpcyk7XHJcbiAgICAgICAgaWYgKFR5cGUobSkgIT09ICdvYmplY3QnKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICBpZiAoISgnW1tNYXBEYXRhXV0nIGluIG0pKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICBpZiAobVsnW1tNYXBEYXRhXV0nXSA9PT0gdW5kZWZpbmVkKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICB2YXIgZW50cmllcyA9IG1bJ1tbTWFwRGF0YV1dJ107XHJcbiAgICAgICAgdmFyIGkgPSBNYXBEYXRhSW5kZXhPZihlbnRyaWVzLCBrZXkpO1xyXG4gICAgICAgIGlmIChpID49IDApIHJldHVybiBlbnRyaWVzLnZhbHVlc1tpXTtcclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyAyMy4xLjMuNyBNYXAucHJvdG90eXBlLmhhcyAoIGtleSApXHJcbiAgICBkZWZpbmUoXHJcbiAgICAgIE1hcC5wcm90b3R5cGUsICdoYXMnLFxyXG4gICAgICBmdW5jdGlvbiBoYXMoa2V5KSB7XHJcbiAgICAgICAgdmFyIG0gPSBzdHJpY3QodGhpcyk7XHJcbiAgICAgICAgaWYgKFR5cGUobSkgIT09ICdvYmplY3QnKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICBpZiAoISgnW1tNYXBEYXRhXV0nIGluIG0pKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICBpZiAobVsnW1tNYXBEYXRhXV0nXSA9PT0gdW5kZWZpbmVkKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICB2YXIgZW50cmllcyA9IG1bJ1tbTWFwRGF0YV1dJ107XHJcbiAgICAgICAgaWYgKE1hcERhdGFJbmRleE9mKGVudHJpZXMsIGtleSkgPj0gMCkgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyAyMy4xLjMuOCBNYXAucHJvdG90eXBlLmtleXMgKCApXHJcbiAgICBkZWZpbmUoXHJcbiAgICAgIE1hcC5wcm90b3R5cGUsICdrZXlzJyxcclxuICAgICAgZnVuY3Rpb24ga2V5cygpIHtcclxuICAgICAgICB2YXIgbSA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgICBpZiAoVHlwZShtKSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIHJldHVybiBDcmVhdGVNYXBJdGVyYXRvcihtLCAna2V5Jyk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8vIDIzLjEuMy45IE1hcC5wcm90b3R5cGUuc2V0ICgga2V5ICwgdmFsdWUgKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICBNYXAucHJvdG90eXBlLCAnc2V0JyxcclxuICAgICAgZnVuY3Rpb24gc2V0KGtleSwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgbSA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgICBpZiAoVHlwZShtKSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIGlmICghKCdbW01hcERhdGFdXScgaW4gbSkpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIGlmIChtWydbW01hcERhdGFdXSddID09PSB1bmRlZmluZWQpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIHZhciBlbnRyaWVzID0gbVsnW1tNYXBEYXRhXV0nXTtcclxuICAgICAgICB2YXIgaSA9IE1hcERhdGFJbmRleE9mKGVudHJpZXMsIGtleSk7XHJcbiAgICAgICAgaWYgKGkgPCAwKSBpID0gZW50cmllcy5rZXlzLmxlbmd0aDtcclxuICAgICAgICBpZiAoU2FtZVZhbHVlKGtleSwgLTApKSBrZXkgPSAwO1xyXG4gICAgICAgIGVudHJpZXMua2V5c1tpXSA9IGtleTtcclxuICAgICAgICBlbnRyaWVzLnZhbHVlc1tpXSA9IHZhbHVlO1xyXG4gICAgICAgIHJldHVybiBtO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyAyMy4xLjMuMTAgZ2V0IE1hcC5wcm90b3R5cGUuc2l6ZVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFxyXG4gICAgICBNYXAucHJvdG90eXBlLCAnc2l6ZScsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgdmFyIG0gPSBzdHJpY3QodGhpcyk7XHJcbiAgICAgICAgICBpZiAoVHlwZShtKSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgaWYgKCEoJ1tbTWFwRGF0YV1dJyBpbiBtKSkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICBpZiAobVsnW1tNYXBEYXRhXV0nXSA9PT0gdW5kZWZpbmVkKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICAgIHZhciBlbnRyaWVzID0gbVsnW1tNYXBEYXRhXV0nXTtcclxuICAgICAgICAgIHZhciBjb3VudCA9IDA7XHJcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVudHJpZXMua2V5cy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICBpZiAoZW50cmllcy5rZXlzW2ldICE9PSBlbXB0eSlcclxuICAgICAgICAgICAgICBjb3VudCA9IGNvdW50ICsgMTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiBjb3VudDtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8vIDIzLjEuMy4xMSBNYXAucHJvdG90eXBlLnZhbHVlcyAoIClcclxuICAgIGRlZmluZShcclxuICAgICAgTWFwLnByb3RvdHlwZSwgJ3ZhbHVlcycsXHJcbiAgICAgIGZ1bmN0aW9uIHZhbHVlcygpIHtcclxuICAgICAgICB2YXIgbSA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgICBpZiAoVHlwZShtKSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIHJldHVybiBDcmVhdGVNYXBJdGVyYXRvcihtLCAndmFsdWUnKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgLy8gMjMuMS4zLjEyIE1hcC5wcm90b3R5cGUgWyBAQGl0ZXJhdG9yIF0oIClcclxuICAgIGRlZmluZShcclxuICAgICAgTWFwLnByb3RvdHlwZSwgJCRpdGVyYXRvcixcclxuICAgICAgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIG0gPSBzdHJpY3QodGhpcyk7XHJcbiAgICAgICAgaWYgKFR5cGUobSkgIT09ICdvYmplY3QnKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICByZXR1cm4gQ3JlYXRlTWFwSXRlcmF0b3IobSwgJ2tleSt2YWx1ZScpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyAyMy4xLjMuMTMgTWFwLnByb3RvdHlwZSBbIEBAdG9TdHJpbmdUYWcgXVxyXG4gICAgZGVmaW5lKGdsb2JhbC5NYXAucHJvdG90eXBlLCAkJHRvU3RyaW5nVGFnLCAnTWFwJyk7XHJcblxyXG4gICAgLy8gMjMuMS40IFByb3BlcnRpZXMgb2YgTWFwIEluc3RhbmNlc1xyXG4gICAgLy8gMjMuMS41IE1hcCBJdGVyYXRvciBPYmplY3RzXHJcblxyXG4gICAgLyoqIEBjb25zdHJ1Y3RvciAqL1xyXG4gICAgZnVuY3Rpb24gTWFwSXRlcmF0b3IoKSB7fVxyXG5cclxuICAgIC8vIDIzLjEuNS4xIENyZWF0ZU1hcEl0ZXJhdG9yIEFic3RyYWN0IE9wZXJhdGlvblxyXG4gICAgZnVuY3Rpb24gQ3JlYXRlTWFwSXRlcmF0b3IobWFwLCBraW5kKSB7XHJcbiAgICAgIGlmIChUeXBlKG1hcCkgIT09ICdvYmplY3QnKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgaWYgKCEoJ1tbTWFwRGF0YV1dJyBpbiBtYXApKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgaWYgKG1hcFsnW1tNYXBEYXRhXV0nXSA9PT0gdW5kZWZpbmVkKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgdmFyIGl0ZXJhdG9yID0gbmV3IE1hcEl0ZXJhdG9yO1xyXG4gICAgICBzZXRfaW50ZXJuYWwoaXRlcmF0b3IsICdbW01hcF1dJywgbWFwKTtcclxuICAgICAgc2V0X2ludGVybmFsKGl0ZXJhdG9yLCAnW1tNYXBOZXh0SW5kZXhdXScsIDApO1xyXG4gICAgICBzZXRfaW50ZXJuYWwoaXRlcmF0b3IsICdbW01hcEl0ZXJhdGlvbktpbmRdXScsIGtpbmQpO1xyXG4gICAgICByZXR1cm4gaXRlcmF0b3I7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMjMuMS41LjIgVGhlICVNYXBJdGVyYXRvclByb3RvdHlwZSUgT2JqZWN0XHJcbiAgICB2YXIgJE1hcEl0ZXJhdG9yUHJvdG90eXBlJCA9IE9iamVjdC5jcmVhdGUoJEl0ZXJhdG9yUHJvdG90eXBlJCk7XHJcbiAgICBNYXBJdGVyYXRvci5wcm90b3R5cGUgPSAkTWFwSXRlcmF0b3JQcm90b3R5cGUkO1xyXG5cclxuICAgIC8vIDIzLjEuNS4yLjEgJU1hcEl0ZXJhdG9yUHJvdG90eXBlJS5uZXh0ICggKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICAkTWFwSXRlcmF0b3JQcm90b3R5cGUkLCAnbmV4dCcsXHJcbiAgICAgIGZ1bmN0aW9uIG5leHQoKSB7XHJcbiAgICAgICAgdmFyIG8gPSBzdHJpY3QodGhpcyk7XHJcbiAgICAgICAgaWYgKFR5cGUobykgIT09ICdvYmplY3QnKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICB2YXIgbSA9IG9bJ1tbTWFwXV0nXSxcclxuICAgICAgICAgICAgaW5kZXggPSBvWydbW01hcE5leHRJbmRleF1dJ10sXHJcbiAgICAgICAgICAgIGl0ZW1LaW5kID0gb1snW1tNYXBJdGVyYXRpb25LaW5kXV0nXSxcclxuICAgICAgICAgICAgZW50cmllcyA9IG1bJ1tbTWFwRGF0YV1dJ107XHJcbiAgICAgICAgd2hpbGUgKGluZGV4IDwgZW50cmllcy5rZXlzLmxlbmd0aCkge1xyXG4gICAgICAgICAgdmFyIGUgPSB7a2V5OiBlbnRyaWVzLmtleXNbaW5kZXhdLCB2YWx1ZTogZW50cmllcy52YWx1ZXNbaW5kZXhdfTtcclxuICAgICAgICAgIGluZGV4ID0gaW5kZXggKz0gMTtcclxuICAgICAgICAgIHNldF9pbnRlcm5hbChvLCAnW1tNYXBOZXh0SW5kZXhdXScsIGluZGV4KTtcclxuICAgICAgICAgIGlmIChlLmtleSAhPT0gZW1wdHkpIHtcclxuICAgICAgICAgICAgaWYgKGl0ZW1LaW5kID09PSAna2V5Jykge1xyXG4gICAgICAgICAgICAgIHJldHVybiBDcmVhdGVJdGVyUmVzdWx0T2JqZWN0KGUua2V5LCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXRlbUtpbmQgPT09ICd2YWx1ZScpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gQ3JlYXRlSXRlclJlc3VsdE9iamVjdChlLnZhbHVlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIENyZWF0ZUl0ZXJSZXN1bHRPYmplY3QoW2Uua2V5LCBlLnZhbHVlXSwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBDcmVhdGVJdGVyUmVzdWx0T2JqZWN0KHVuZGVmaW5lZCwgdHJ1ZSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8vIDIzLjEuNS4yLjIgJU1hcEl0ZXJhdG9yUHJvdG90eXBlJSBbIEBAdG9TdHJpbmdUYWcgXVxyXG4gICAgZGVmaW5lKCRNYXBJdGVyYXRvclByb3RvdHlwZSQsICQkdG9TdHJpbmdUYWcsICdNYXAgSXRlcmF0b3InKTtcclxuXHJcbiAgICAvLyAyMy4xLjUuMyBQcm9wZXJ0aWVzIG9mIE1hcCBJdGVyYXRvciBJbnN0YW5jZXNcclxuICB9KCkpO1xyXG5cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyAyMy4yIFNldCBPYmplY3RzXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIChmdW5jdGlvbigpIHtcclxuICAgIC8vIDIzLjIuMSBUaGUgU2V0IENvbnN0cnVjdG9yXHJcbiAgICAvLyAyMy4yLjEuMSBTZXQgKCBbIGl0ZXJhYmxlIF0gKVxyXG5cclxuICAgIC8qKiBAY29uc3RydWN0b3IgKi9cclxuICAgIGZ1bmN0aW9uIFNldCgvKml0ZXJhYmxlKi8pIHtcclxuICAgICAgdmFyIHNldCA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgdmFyIGl0ZXJhYmxlID0gYXJndW1lbnRzWzBdO1xyXG5cclxuICAgICAgaWYgKFR5cGUoc2V0KSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICBpZiAoJ1tbU2V0RGF0YV1dJyBpbiBzZXQpIHRocm93IFR5cGVFcnJvcigpO1xyXG5cclxuICAgICAgaWYgKGl0ZXJhYmxlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YXIgYWRkZXIgPSBzZXRbJ2FkZCddO1xyXG4gICAgICAgIGlmICghSXNDYWxsYWJsZShhZGRlcikpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIHZhciBpdGVyID0gR2V0SXRlcmF0b3IoVG9PYmplY3QoaXRlcmFibGUpKTtcclxuICAgICAgfVxyXG4gICAgICBzZXRfaW50ZXJuYWwoc2V0LCAnW1tTZXREYXRhXV0nLCBbXSk7XHJcbiAgICAgIGlmIChpdGVyID09PSB1bmRlZmluZWQpIHJldHVybiBzZXQ7XHJcbiAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgdmFyIG5leHQgPSBJdGVyYXRvclN0ZXAoaXRlcik7XHJcbiAgICAgICAgaWYgKG5leHQgPT09IGZhbHNlKVxyXG4gICAgICAgICAgcmV0dXJuIHNldDtcclxuICAgICAgICB2YXIgbmV4dFZhbHVlID0gSXRlcmF0b3JWYWx1ZShuZXh0KTtcclxuICAgICAgICBhZGRlci5jYWxsKHNldCwgbmV4dFZhbHVlKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHNldDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoISgnU2V0JyBpbiBnbG9iYWwpIHx8IE9WRVJSSURFX05BVElWRV9GT1JfVEVTVElORyB8fFxyXG4gICAgICAgIChmdW5jdGlvbigpIHsgdHJ5IHsgcmV0dXJuICFuZXcgZ2xvYmFsLlNldCgpLmVudHJpZXMoKS5uZXh0OyB9IGNhdGNoIChfKSB7IHJldHVybiB0cnVlOyB9IH0oKSkgfHxcclxuICAgICAgICAobmV3IGdsb2JhbC5TZXQoWzFdKS5zaXplICE9PSAxKSlcclxuICAgICAgZ2xvYmFsLlNldCA9IFNldDtcclxuXHJcbiAgICBmdW5jdGlvbiBTZXREYXRhSW5kZXhPZihzZXREYXRhLCBrZXkpIHtcclxuICAgICAgdmFyIGk7XHJcbiAgICAgIGlmIChrZXkgPT09IGtleSlcclxuICAgICAgICByZXR1cm4gc2V0RGF0YS5pbmRleE9mKGtleSk7XHJcbiAgICAgIC8vIFNsb3cgY2FzZSBmb3IgTmFOXHJcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBzZXREYXRhLmxlbmd0aDsgaSArPSAxKVxyXG4gICAgICAgIGlmIChTYW1lVmFsdWVaZXJvKHNldERhdGFbaV0sIGtleSkpIHJldHVybiBpO1xyXG4gICAgICByZXR1cm4gLTE7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMjMuMi4xLjIgbmV3IFNldCAoIC4uLmFyZ3VtZW50c0xpc3QgKVxyXG4gICAgLy8gMjMuMi4yIFByb3BlcnRpZXMgb2YgdGhlIFNldCBDb25zdHJ1Y3RvclxyXG5cclxuICAgIC8vIDIzLjIuMi4xIFNldC5wcm90b3R5cGVcclxuICAgIHZhciAkU2V0UHJvdG90eXBlJCA9ICB7fTtcclxuICAgIFNldC5wcm90b3R5cGUgPSAkU2V0UHJvdG90eXBlJDtcclxuXHJcbiAgICAvLyAyMy4yLjIuMiBnZXQgU2V0IFsgQEBzcGVjaWVzIF1cclxuICAgIC8vIDIzLjIuMyBQcm9wZXJ0aWVzIG9mIHRoZSBTZXQgUHJvdG90eXBlIE9iamVjdFxyXG5cclxuICAgIC8vIDIzLjIuMy4xIFNldC5wcm90b3R5cGUuYWRkICh2YWx1ZSApXHJcbiAgICBkZWZpbmUoXHJcbiAgICAgIFNldC5wcm90b3R5cGUsICdhZGQnLFxyXG4gICAgICBmdW5jdGlvbiBhZGQodmFsdWUpIHtcclxuICAgICAgICB2YXIgcyA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgICBpZiAoVHlwZShzKSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIGlmICghKCdbW1NldERhdGFdXScgaW4gcykpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIGlmIChzWydbW1NldERhdGFdXSddID09PSB1bmRlZmluZWQpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIGlmIChTYW1lVmFsdWUodmFsdWUsIC0wKSkgdmFsdWUgPSAwO1xyXG4gICAgICAgIHZhciBlbnRyaWVzID0gc1snW1tTZXREYXRhXV0nXTtcclxuICAgICAgICB2YXIgaSA9IFNldERhdGFJbmRleE9mKGVudHJpZXMsIHZhbHVlKTtcclxuICAgICAgICBpZiAoaSA8IDApIGkgPSBzWydbW1NldERhdGFdXSddLmxlbmd0aDtcclxuICAgICAgICBzWydbW1NldERhdGFdXSddW2ldID0gdmFsdWU7XHJcblxyXG4gICAgICAgIHJldHVybiBzO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyAyMy4yLjMuMiBTZXQucHJvdG90eXBlLmNsZWFyICgpXHJcbiAgICBkZWZpbmUoXHJcbiAgICAgIFNldC5wcm90b3R5cGUsICdjbGVhcicsXHJcbiAgICAgIGZ1bmN0aW9uIGNsZWFyKCkge1xyXG4gICAgICAgIHZhciBzID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICAgIGlmIChUeXBlKHMpICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgaWYgKCEoJ1tbU2V0RGF0YV1dJyBpbiBzKSkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgaWYgKHNbJ1tbU2V0RGF0YV1dJ10gPT09IHVuZGVmaW5lZCkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgdmFyIGVudHJpZXMgPSBzWydbW1NldERhdGFdXSddO1xyXG4gICAgICAgIGVudHJpZXMubGVuZ3RoID0gMDtcclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyAyMy4yLjMuMyBTZXQucHJvdG90eXBlLmNvbnN0cnVjdG9yXHJcbiAgICAvLyAyMy4yLjMuNCBTZXQucHJvdG90eXBlLmRlbGV0ZSAoIHZhbHVlIClcclxuICAgIGRlZmluZShcclxuICAgICAgU2V0LnByb3RvdHlwZSwgJ2RlbGV0ZScsXHJcbiAgICAgIGZ1bmN0aW9uIGRlbGV0ZV8odmFsdWUpIHtcclxuICAgICAgICB2YXIgcyA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgICBpZiAoVHlwZShzKSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIGlmICghKCdbW1NldERhdGFdXScgaW4gcykpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIGlmIChzWydbW1NldERhdGFdXSddID09PSB1bmRlZmluZWQpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIHZhciBlbnRyaWVzID0gc1snW1tTZXREYXRhXV0nXTtcclxuICAgICAgICB2YXIgaSA9IFNldERhdGFJbmRleE9mKGVudHJpZXMsIHZhbHVlKTtcclxuICAgICAgICBpZiAoaSA8IDApIHJldHVybiBmYWxzZTtcclxuICAgICAgICBlbnRyaWVzW2ldID0gZW1wdHk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8vIDIzLjIuMy41IFNldC5wcm90b3R5cGUuZW50cmllcyAoIClcclxuICAgIGRlZmluZShcclxuICAgICAgU2V0LnByb3RvdHlwZSwgJ2VudHJpZXMnLFxyXG4gICAgICBmdW5jdGlvbiBlbnRyaWVzKCkge1xyXG4gICAgICAgIHZhciBzID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICAgIGlmIChUeXBlKHMpICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgcmV0dXJuIENyZWF0ZVNldEl0ZXJhdG9yKHMsICdrZXkrdmFsdWUnKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgLy8gMjMuMi4zLjYgU2V0LnByb3RvdHlwZS5mb3JFYWNoICggY2FsbGJhY2tmbiBbICwgdGhpc0FyZyBdIClcclxuICAgIGRlZmluZShcclxuICAgICAgU2V0LnByb3RvdHlwZSwgJ2ZvckVhY2gnLFxyXG4gICAgICBmdW5jdGlvbiBmb3JFYWNoKGNhbGxiYWNrZm4vKiwgdGhpc0FyZyovKSB7XHJcbiAgICAgICAgdmFyIHRoaXNBcmcgPSBhcmd1bWVudHNbMV07XHJcblxyXG4gICAgICAgIHZhciBzID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICAgIGlmIChUeXBlKHMpICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgaWYgKCEoJ1tbU2V0RGF0YV1dJyBpbiBzKSkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgaWYgKHNbJ1tbU2V0RGF0YV1dJ10gPT09IHVuZGVmaW5lZCkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgdmFyIGVudHJpZXMgPSBzWydbW1NldERhdGFdXSddO1xyXG5cclxuICAgICAgICBpZiAoIUlzQ2FsbGFibGUoY2FsbGJhY2tmbikpIHtcclxuICAgICAgICAgIHRocm93IFR5cGVFcnJvcignRmlyc3QgYXJndW1lbnQgdG8gZm9yRWFjaCBpcyBub3QgY2FsbGFibGUuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZW50cmllcy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgaWYgKGVudHJpZXNbaV0gIT09IGVtcHR5KSB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrZm4uY2FsbCh0aGlzQXJnLCBlbnRyaWVzW2ldLCBlbnRyaWVzW2ldLCBzKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8vIDIzLjIuMy43IFNldC5wcm90b3R5cGUuaGFzICggdmFsdWUgKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICBTZXQucHJvdG90eXBlLCAnaGFzJyxcclxuICAgICAgZnVuY3Rpb24gaGFzKGtleSkge1xyXG4gICAgICAgIHZhciBzID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICAgIGlmIChUeXBlKHMpICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgaWYgKCEoJ1tbU2V0RGF0YV1dJyBpbiBzKSkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgaWYgKHNbJ1tbU2V0RGF0YV1dJ10gPT09IHVuZGVmaW5lZCkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgdmFyIGVudHJpZXMgPSBzWydbW1NldERhdGFdXSddO1xyXG4gICAgICAgIHJldHVybiBTZXREYXRhSW5kZXhPZihlbnRyaWVzLCBrZXkpICE9PSAtMTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgLy8gMjMuMi4zLjggU2V0LnByb3RvdHlwZS5rZXlzICggKVxyXG4gICAgLy8gU2VlIFNldC5wcm90b3R5cGUudmFsdWVzXHJcblxyXG4gICAgLy8gMjMuMi4zLjkgZ2V0IFNldC5wcm90b3R5cGUuc2l6ZVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFxyXG4gICAgICBTZXQucHJvdG90eXBlLCAnc2l6ZScsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgdmFyIHMgPSBzdHJpY3QodGhpcyk7XHJcbiAgICAgICAgICBpZiAoVHlwZShzKSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgaWYgKCEoJ1tbU2V0RGF0YV1dJyBpbiBzKSkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICBpZiAoc1snW1tTZXREYXRhXV0nXSA9PT0gdW5kZWZpbmVkKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICAgIHZhciBlbnRyaWVzID0gc1snW1tTZXREYXRhXV0nXTtcclxuICAgICAgICAgIHZhciBjb3VudCA9IDA7XHJcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVudHJpZXMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgaWYgKGVudHJpZXNbaV0gIT09IGVtcHR5KVxyXG4gICAgICAgICAgICAgIGNvdW50ID0gY291bnQgKyAxO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIGNvdW50O1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgLy8gMjMuMi4zLjEwIFNldC5wcm90b3R5cGUudmFsdWVzICggKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICBTZXQucHJvdG90eXBlLCAndmFsdWVzJyxcclxuICAgICAgZnVuY3Rpb24gdmFsdWVzKCkge1xyXG4gICAgICAgIHZhciBzID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICAgIGlmIChUeXBlKHMpICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgcmV0dXJuIENyZWF0ZVNldEl0ZXJhdG9yKHMsICd2YWx1ZScpO1xyXG4gICAgICB9KTtcclxuICAgIC8vIE5PVEU6IGZ1bmN0aW9uIG5hbWUgaXMgc3RpbGwgJ3ZhbHVlcyc6XHJcbiAgICBTZXQucHJvdG90eXBlLmtleXMgPSBTZXQucHJvdG90eXBlLnZhbHVlcztcclxuXHJcbiAgICAvLyAyMy4yLjMuMTEgU2V0LnByb3RvdHlwZSBbQEBpdGVyYXRvciBdICggKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICBTZXQucHJvdG90eXBlLCAkJGl0ZXJhdG9yLFxyXG4gICAgICBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgcyA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgICBpZiAoVHlwZShzKSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIHJldHVybiBDcmVhdGVTZXRJdGVyYXRvcihzKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgLy8gMjMuMi4zLjEyIFNldC5wcm90b3R5cGUgWyBAQHRvU3RyaW5nVGFnIF1cclxuICAgIGRlZmluZShnbG9iYWwuU2V0LnByb3RvdHlwZSwgJCR0b1N0cmluZ1RhZywgJ1NldCcpO1xyXG5cclxuICAgIC8vIDIzLjIuNCBQcm9wZXJ0aWVzIG9mIFNldCBJbnN0YW5jZXNcclxuICAgIC8vIDIzLjIuNSBTZXQgSXRlcmF0b3IgT2JqZWN0c1xyXG4gICAgLyoqIEBjb25zdHJ1Y3RvciAqL1xyXG4gICAgZnVuY3Rpb24gU2V0SXRlcmF0b3IoKSB7fVxyXG5cclxuICAgIC8vIDIzLjIuNS4xIENyZWF0ZVNldEl0ZXJhdG9yIEFic3RyYWN0IE9wZXJhdGlvblxyXG4gICAgZnVuY3Rpb24gQ3JlYXRlU2V0SXRlcmF0b3Ioc2V0LCBraW5kKSB7XHJcbiAgICAgIGlmIChUeXBlKHNldCkgIT09ICdvYmplY3QnKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgaWYgKCEoJ1tbU2V0RGF0YV1dJyBpbiBzZXQpKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgaWYgKHNldFsnW1tTZXREYXRhXV0nXSA9PT0gdW5kZWZpbmVkKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgdmFyIGl0ZXJhdG9yID0gbmV3IFNldEl0ZXJhdG9yO1xyXG4gICAgICBzZXRfaW50ZXJuYWwoaXRlcmF0b3IsICdbW0l0ZXJhdGVkU2V0XV0nLCBzZXQpO1xyXG4gICAgICBzZXRfaW50ZXJuYWwoaXRlcmF0b3IsICdbW1NldE5leHRJbmRleF1dJywgMCk7XHJcbiAgICAgIHNldF9pbnRlcm5hbChpdGVyYXRvciwgJ1tbU2V0SXRlcmF0aW9uS2luZF1dJywga2luZCk7XHJcbiAgICAgIHJldHVybiBpdGVyYXRvcjtcclxuICAgIH1cclxuXHJcbiAgICAvLyAyMy4yLjUuMiBUaGUgJVNldEl0ZXJhdG9yUHJvdG90eXBlJSBPYmplY3RcclxuICAgIHZhciAkU2V0SXRlcmF0b3JQcm90b3R5cGUkID0gT2JqZWN0LmNyZWF0ZSgkSXRlcmF0b3JQcm90b3R5cGUkKTtcclxuICAgIFNldEl0ZXJhdG9yLnByb3RvdHlwZSA9ICRTZXRJdGVyYXRvclByb3RvdHlwZSQ7XHJcblxyXG4gICAgLy8gMjMuMi41LjIuMSAlU2V0SXRlcmF0b3JQcm90b3R5cGUlLm5leHQoIClcclxuICAgIGRlZmluZShcclxuICAgICAgJFNldEl0ZXJhdG9yUHJvdG90eXBlJCwgJ25leHQnLFxyXG4gICAgICBmdW5jdGlvbiBuZXh0KCkge1xyXG4gICAgICAgIHZhciBvID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICAgIGlmIChUeXBlKG8pICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgdmFyIHMgPSBvWydbW0l0ZXJhdGVkU2V0XV0nXSxcclxuICAgICAgICAgICAgaW5kZXggPSBvWydbW1NldE5leHRJbmRleF1dJ10sXHJcbiAgICAgICAgICAgIGl0ZW1LaW5kID0gb1snW1tTZXRJdGVyYXRpb25LaW5kXV0nXSxcclxuICAgICAgICAgICAgZW50cmllcyA9IHNbJ1tbU2V0RGF0YV1dJ107XHJcbiAgICAgICAgd2hpbGUgKGluZGV4IDwgZW50cmllcy5sZW5ndGgpIHtcclxuICAgICAgICAgIHZhciBlID0gZW50cmllc1tpbmRleF07XHJcbiAgICAgICAgICBpbmRleCA9IGluZGV4ICs9IDE7XHJcbiAgICAgICAgICBzZXRfaW50ZXJuYWwobywgJ1tbU2V0TmV4dEluZGV4XV0nLCBpbmRleCk7XHJcbiAgICAgICAgICBpZiAoZSAhPT0gZW1wdHkpIHtcclxuICAgICAgICAgICAgaWYgKGl0ZW1LaW5kID09PSAna2V5K3ZhbHVlJylcclxuICAgICAgICAgICAgICByZXR1cm4gQ3JlYXRlSXRlclJlc3VsdE9iamVjdChbZSwgZV0sIGZhbHNlKTtcclxuICAgICAgICAgICAgcmV0dXJuIENyZWF0ZUl0ZXJSZXN1bHRPYmplY3QoZSwgZmFsc2UpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gQ3JlYXRlSXRlclJlc3VsdE9iamVjdCh1bmRlZmluZWQsIHRydWUpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyAyMy4yLjUuMi4yICVTZXRJdGVyYXRvclByb3RvdHlwZSUgWyBAQHRvU3RyaW5nVGFnIF1cclxuICAgIGRlZmluZSgkU2V0SXRlcmF0b3JQcm90b3R5cGUkLCAkJHRvU3RyaW5nVGFnLCAnU2V0IEl0ZXJhdG9yJyk7XHJcblxyXG4gICAgLy8gMjMuMi41LjMgUHJvcGVydGllcyBvZiBTZXQgSXRlcmF0b3IgSW5zdGFuY2VzXHJcblxyXG4gIH0oKSk7XHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIDIzLjMgV2Vha01hcCBPYmplY3RzXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIChmdW5jdGlvbigpIHtcclxuICAgIC8vIDIzLjMuMSBUaGUgV2Vha01hcCBDb25zdHJ1Y3RvclxyXG4gICAgLy8gMjMuMy4xLjEgV2Vha01hcCAoIFsgaXRlcmFibGUgXSApXHJcbiAgICAvKiogQGNvbnN0cnVjdG9yICovXHJcbiAgICBmdW5jdGlvbiBXZWFrTWFwKC8qaXRlcmFibGUqLykge1xyXG4gICAgICB2YXIgbWFwID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICB2YXIgaXRlcmFibGUgPSBhcmd1bWVudHNbMF07XHJcblxyXG4gICAgICBpZiAoVHlwZShtYXApICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgIGlmICgnW1tXZWFrTWFwRGF0YV1dJyBpbiBtYXApIHRocm93IFR5cGVFcnJvcigpO1xyXG5cclxuICAgICAgaWYgKGl0ZXJhYmxlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YXIgYWRkZXIgPSBtYXBbJ3NldCddO1xyXG4gICAgICAgIGlmICghSXNDYWxsYWJsZShhZGRlcikpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIHZhciBpdGVyID0gR2V0SXRlcmF0b3IoVG9PYmplY3QoaXRlcmFibGUpKTtcclxuICAgICAgfVxyXG4gICAgICBzZXRfaW50ZXJuYWwobWFwLCAnW1tXZWFrTWFwRGF0YV1dJywgbmV3IEVwaGVtZXJvblRhYmxlKTtcclxuICAgICAgaWYgKGl0ZXIgPT09IHVuZGVmaW5lZCkgcmV0dXJuIG1hcDtcclxuICAgICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgICB2YXIgbmV4dCA9IEl0ZXJhdG9yU3RlcChpdGVyKTtcclxuICAgICAgICBpZiAobmV4dCA9PT0gZmFsc2UpXHJcbiAgICAgICAgICByZXR1cm4gbWFwO1xyXG4gICAgICAgIHZhciBuZXh0VmFsdWUgPSBJdGVyYXRvclZhbHVlKG5leHQpO1xyXG4gICAgICAgIGlmIChUeXBlKG5leHRWYWx1ZSkgIT09ICdvYmplY3QnKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICB2YXIgayA9IG5leHRWYWx1ZVswXTtcclxuICAgICAgICB2YXIgdiA9IG5leHRWYWx1ZVsxXTtcclxuICAgICAgICBhZGRlci5jYWxsKG1hcCwgaywgdik7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBtYXA7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCEoJ1dlYWtNYXAnIGluIGdsb2JhbCkgfHwgT1ZFUlJJREVfTkFUSVZFX0ZPUl9URVNUSU5HKVxyXG4gICAgICBnbG9iYWwuV2Vha01hcCA9IFdlYWtNYXA7XHJcblxyXG4gICAgLy8gMjMuMy4yIFByb3BlcnRpZXMgb2YgdGhlIFdlYWtNYXAgQ29uc3RydWN0b3JcclxuICAgIC8vIDIzLjMuMi4xIFdlYWtNYXAucHJvdG90eXBlXHJcbiAgICB2YXIgJFdlYWtNYXBQcm90b3R5cGUkID0ge307XHJcbiAgICBXZWFrTWFwLnByb3RvdHlwZSA9ICRXZWFrTWFwUHJvdG90eXBlJDtcclxuXHJcblxyXG5cclxuICAgLy8gMjMuMy4yLjIgV2Vha01hcFsgQEBjcmVhdGUgXSAoIClcclxuICAgIC8vIDIzLjMuMyBQcm9wZXJ0aWVzIG9mIHRoZSBXZWFrTWFwIFByb3RvdHlwZSBPYmplY3RcclxuXHJcbiAgICAvLyAyMy4zLjMuMSBXZWFrTWFwLnByb3RvdHlwZS5jb25zdHJ1Y3RvclxyXG5cclxuICAgIC8vIDIzLjMuMy4yIFdlYWtNYXAucHJvdG90eXBlLmRlbGV0ZSAoIGtleSApXHJcbiAgICBkZWZpbmUoXHJcbiAgICAgIFdlYWtNYXAucHJvdG90eXBlLCAnZGVsZXRlJyxcclxuICAgICAgZnVuY3Rpb24gZGVsZXRlXyhrZXkpIHtcclxuICAgICAgICB2YXIgTSA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgICBpZiAoVHlwZShNKSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIGlmIChNWydbW1dlYWtNYXBEYXRhXV0nXSA9PT0gdW5kZWZpbmVkKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICBpZiAoVHlwZShrZXkpICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCdFeHBlY3RlZCBvYmplY3QnKTtcclxuICAgICAgICByZXR1cm4gTVsnW1tXZWFrTWFwRGF0YV1dJ10ucmVtb3ZlKGtleSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8vIDIzLjMuMy4zIFdlYWtNYXAucHJvdG90eXBlLmdldCAoIGtleSApXHJcbiAgICBkZWZpbmUoXHJcbiAgICAgIFdlYWtNYXAucHJvdG90eXBlLCAnZ2V0JyxcclxuICAgICAgZnVuY3Rpb24gZ2V0KGtleSwgZGVmYXVsdFZhbHVlKSB7XHJcbiAgICAgICAgdmFyIE0gPSBzdHJpY3QodGhpcyk7XHJcbiAgICAgICAgaWYgKFR5cGUoTSkgIT09ICdvYmplY3QnKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICBpZiAoTVsnW1tXZWFrTWFwRGF0YV1dJ10gPT09IHVuZGVmaW5lZCkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgaWYgKFR5cGUoa2V5KSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcignRXhwZWN0ZWQgb2JqZWN0Jyk7XHJcbiAgICAgICAgcmV0dXJuIE1bJ1tbV2Vha01hcERhdGFdXSddLmdldChrZXksIGRlZmF1bHRWYWx1ZSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8vIDIzLjMuMy40IFdlYWtNYXAucHJvdG90eXBlLmhhcyAoIGtleSApXHJcbiAgICBkZWZpbmUoXHJcbiAgICAgIFdlYWtNYXAucHJvdG90eXBlLCAnaGFzJyxcclxuICAgICAgZnVuY3Rpb24gaGFzKGtleSkge1xyXG4gICAgICAgIHZhciBNID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICAgIGlmIChUeXBlKE0pICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgaWYgKE1bJ1tbV2Vha01hcERhdGFdXSddID09PSB1bmRlZmluZWQpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIGlmIChUeXBlKGtleSkgIT09ICdvYmplY3QnKSB0aHJvdyBUeXBlRXJyb3IoJ0V4cGVjdGVkIG9iamVjdCcpO1xyXG4gICAgICAgIHJldHVybiBNWydbW1dlYWtNYXBEYXRhXV0nXS5oYXMoa2V5KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgLy8gMjMuMy4zLjUgV2Vha01hcC5wcm90b3R5cGUuc2V0ICgga2V5ICwgdmFsdWUgKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICBXZWFrTWFwLnByb3RvdHlwZSwgJ3NldCcsXHJcbiAgICAgIGZ1bmN0aW9uIHNldChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIE0gPSBzdHJpY3QodGhpcyk7XHJcbiAgICAgICAgaWYgKFR5cGUoTSkgIT09ICdvYmplY3QnKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICBpZiAoTVsnW1tXZWFrTWFwRGF0YV1dJ10gPT09IHVuZGVmaW5lZCkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgaWYgKFR5cGUoa2V5KSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcignRXhwZWN0ZWQgb2JqZWN0Jyk7XHJcbiAgICAgICAgTVsnW1tXZWFrTWFwRGF0YV1dJ10uc2V0KGtleSwgdmFsdWUpO1xyXG4gICAgICAgIHJldHVybiBNO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyAyMy4zLjMuNiBXZWFrTWFwLnByb3RvdHlwZSBbIEBAdG9TdHJpbmdUYWcgXVxyXG4gICAgZGVmaW5lKGdsb2JhbC5XZWFrTWFwLnByb3RvdHlwZSwgJCR0b1N0cmluZ1RhZywgJ1dlYWtNYXAnKTtcclxuXHJcbiAgICAvLyAyMy4zLjQgUHJvcGVydGllcyBvZiBXZWFrTWFwIEluc3RhbmNlc1xyXG5cclxuICAgIC8vIFBvbHlmaWxscyBmb3IgaW5jb21wbGV0ZSBuYXRpdmUgaW1wbGVtZW50YXRpb25zOlxyXG4gICAgKGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgd20gPSBuZXcgZ2xvYmFsLldlYWtNYXAoKTtcclxuICAgICAgdmFyIG9yaWcgPSBnbG9iYWwuV2Vha01hcC5wcm90b3R5cGUuc2V0O1xyXG4gICAgICBkZWZpbmUoZ2xvYmFsLldlYWtNYXAucHJvdG90eXBlLCAnc2V0JywgZnVuY3Rpb24gc2V0KCkge1xyXG4gICAgICAgIG9yaWcuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgfSwgd20uc2V0KHt9LCAwKSAhPT0gd20pO1xyXG4gICAgfSgpKTtcclxuICB9KCkpO1xyXG5cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyAyMy40IFdlYWtTZXQgT2JqZWN0c1xyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAoZnVuY3Rpb24oKSB7XHJcbiAgICAvLyAyMy40LjEgVGhlIFdlYWtTZXQgQ29uc3RydWN0b3JcclxuICAgIC8vIDIzLjQuMS4xIFdlYWtTZXQgKCBbIGl0ZXJhYmxlIF0gKVxyXG4gICAgLyoqIEBjb25zdHJ1Y3RvciAqL1xyXG4gICAgZnVuY3Rpb24gV2Vha1NldCgvKml0ZXJhYmxlKi8pIHtcclxuICAgICAgdmFyIHNldCA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgdmFyIGl0ZXJhYmxlID0gYXJndW1lbnRzWzBdO1xyXG5cclxuICAgICAgaWYgKFR5cGUoc2V0KSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICBpZiAoJ1tbV2Vha1NldERhdGFdXScgaW4gc2V0KSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuXHJcbiAgICAgIGlmIChpdGVyYWJsZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdmFyIGFkZGVyID0gc2V0WydhZGQnXTtcclxuICAgICAgICBpZiAoIUlzQ2FsbGFibGUoYWRkZXIpKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICB2YXIgaXRlciA9IEdldEl0ZXJhdG9yKFRvT2JqZWN0KGl0ZXJhYmxlKSk7XHJcbiAgICAgIH1cclxuICAgICAgc2V0X2ludGVybmFsKHNldCwgJ1tbV2Vha1NldERhdGFdXScsIG5ldyBFcGhlbWVyb25UYWJsZSk7XHJcbiAgICAgIGlmIChpdGVyID09PSB1bmRlZmluZWQpIHJldHVybiBzZXQ7XHJcbiAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgdmFyIG5leHQgPSBJdGVyYXRvclN0ZXAoaXRlcik7XHJcbiAgICAgICAgaWYgKG5leHQgPT09IGZhbHNlKVxyXG4gICAgICAgICAgcmV0dXJuIHNldDtcclxuICAgICAgICB2YXIgbmV4dFZhbHVlID0gSXRlcmF0b3JWYWx1ZShuZXh0KTtcclxuICAgICAgICBhZGRlci5jYWxsKHNldCwgbmV4dFZhbHVlKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHNldDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoISgnV2Vha1NldCcgaW4gZ2xvYmFsKSB8fCBPVkVSUklERV9OQVRJVkVfRk9SX1RFU1RJTkcpXHJcbiAgICAgIGdsb2JhbC5XZWFrU2V0ID0gV2Vha1NldDtcclxuXHJcbiAgICAvLyAyMy40LjIgUHJvcGVydGllcyBvZiB0aGUgV2Vha1NldCBDb25zdHJ1Y3RvclxyXG4gICAgLy8gMjMuNC4yLjEgV2Vha1NldC5wcm90b3R5cGVcclxuICAgIHZhciAkV2Vha1NldFByb3RvdHlwZSQgPSB7fTtcclxuICAgIFdlYWtTZXQucHJvdG90eXBlID0gJFdlYWtTZXRQcm90b3R5cGUkO1xyXG5cclxuICAgIC8vIDIzLjQuMyBQcm9wZXJ0aWVzIG9mIHRoZSBXZWFrU2V0IFByb3RvdHlwZSBPYmplY3RcclxuICAgIC8vIDIzLjQuMy4xIFdlYWtTZXQucHJvdG90eXBlLmFkZCAodmFsdWUgKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICBXZWFrU2V0LnByb3RvdHlwZSwgJ2FkZCcsXHJcbiAgICAgIGZ1bmN0aW9uIGFkZCh2YWx1ZSkge1xyXG4gICAgICAgIHZhciBTID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICAgIGlmIChUeXBlKFMpICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgaWYgKFNbJ1tbV2Vha1NldERhdGFdXSddID09PSB1bmRlZmluZWQpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIGlmIChUeXBlKHZhbHVlKSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcignRXhwZWN0ZWQgb2JqZWN0Jyk7XHJcbiAgICAgICAgU1snW1tXZWFrU2V0RGF0YV1dJ10uc2V0KHZhbHVlLCB0cnVlKTtcclxuICAgICAgICByZXR1cm4gUztcclxuICAgICAgfSk7XHJcblxyXG4gICAgLy8gMjMuNC4zLjIgV2Vha1NldC5wcm90b3R5cGUuY29uc3RydWN0b3JcclxuICAgIC8vIDIzLjQuMy4zIFdlYWtTZXQucHJvdG90eXBlLmRlbGV0ZSAoIHZhbHVlIClcclxuICAgIGRlZmluZShcclxuICAgICAgV2Vha1NldC5wcm90b3R5cGUsICdkZWxldGUnLFxyXG4gICAgICBmdW5jdGlvbiBkZWxldGVfKHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIFMgPSBzdHJpY3QodGhpcyk7XHJcbiAgICAgICAgaWYgKFR5cGUoUykgIT09ICdvYmplY3QnKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICBpZiAoU1snW1tXZWFrU2V0RGF0YV1dJ10gPT09IHVuZGVmaW5lZCkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgaWYgKFR5cGUodmFsdWUpICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCdFeHBlY3RlZCBvYmplY3QnKTtcclxuICAgICAgICByZXR1cm4gU1snW1tXZWFrU2V0RGF0YV1dJ10ucmVtb3ZlKHZhbHVlKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgLy8gMjMuNC4zLjQgV2Vha1NldC5wcm90b3R5cGUuaGFzICggdmFsdWUgKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICBXZWFrU2V0LnByb3RvdHlwZSwgJ2hhcycsXHJcbiAgICAgIGZ1bmN0aW9uIGhhcyhrZXkpIHtcclxuICAgICAgICB2YXIgUyA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgICBpZiAoVHlwZShTKSAhPT0gJ29iamVjdCcpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIGlmIChTWydbW1dlYWtTZXREYXRhXV0nXSA9PT0gdW5kZWZpbmVkKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgICBpZiAoVHlwZShrZXkpICE9PSAnb2JqZWN0JykgdGhyb3cgVHlwZUVycm9yKCdFeHBlY3RlZCBvYmplY3QnKTtcclxuICAgICAgICByZXR1cm4gU1snW1tXZWFrU2V0RGF0YV1dJ10uaGFzKGtleSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8vIDIzLjQuMy41IFdlYWtTZXQucHJvdG90eXBlIFsgQEB0b1N0cmluZ1RhZyBdXHJcbiAgICBkZWZpbmUoZ2xvYmFsLldlYWtTZXQucHJvdG90eXBlLCAkJHRvU3RyaW5nVGFnLCAnV2Vha1NldCcpO1xyXG5cclxuICAgIC8vIDIzLjQuNCBQcm9wZXJ0aWVzIG9mIFdlYWtTZXQgSW5zdGFuY2VzXHJcblxyXG4gICAgLy8gUG9seWZpbGxzIGZvciBpbmNvbXBsZXRlIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbnM6XHJcbiAgICAoZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciB3cyA9IG5ldyBnbG9iYWwuV2Vha1NldCgpO1xyXG4gICAgICB2YXIgb3JpZyA9IGdsb2JhbC5XZWFrU2V0LnByb3RvdHlwZS5hZGQ7XHJcbiAgICAgIGRlZmluZShnbG9iYWwuV2Vha1NldC5wcm90b3R5cGUsICdhZGQnLCBmdW5jdGlvbiBhZGQoKSB7XHJcbiAgICAgICAgb3JpZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICB9LCB3cy5hZGQoe30pICE9PSB3cyk7XHJcbiAgICB9KCkpO1xyXG4gIH0oKSk7XHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIDI0IFN0cnVjdHVyZWQgRGF0YVxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyAyNC4xIEFycmF5QnVmZmVyIE9iamVjdHNcclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgLy8gU2VlIHR5cGVkYXJyYXkuanMgZm9yIFR5cGVkQXJyYXkgcG9seWZpbGxcclxuXHJcbiAgKGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKCEoJ0FycmF5QnVmZmVyJyBpbiBnbG9iYWwpKVxyXG4gICAgICByZXR1cm47XHJcblxyXG4gICAgLy8gMjQuMS4xIEFic3RyYWN0IE9wZXJhdGlvbnMgRm9yIEFycmF5QnVmZmVyIE9iamVjdHNcclxuICAgIC8vIDI0LjEuMS4xIEFsbG9jYXRlQXJyYXlCdWZmZXIoIGNvbnN0cnVjdG9yLCBieXRlTGVuZ3RoIClcclxuICAgIC8vIDI0LjEuMS4yIElzRGV0YWNoZWRCdWZmZXIoIGFycmF5QnVmZmVyIClcclxuICAgIC8vIDI0LjEuMS4zIERldGFjaEFycmF5QnVmZmVyKCBhcnJheUJ1ZmZlciApXHJcbiAgICAvLyAyNC4xLjEuNCBDbG9uZUFycmF5QnVmZmVyKCBzcmNCdWZmZXIsIHNyY0J5dGVPZmZzZXQgWywgY2xvbmVDb25zdHJ1Y3Rvcl0gKVxyXG4gICAgLy8gMjQuMS4xLjUgR2V0VmFsdWVGcm9tQnVmZmVyICggYXJyYXlCdWZmZXIsIGJ5dGVJbmRleCwgdHlwZSwgaXNMaXR0bGVFbmRpYW4gKVxyXG4gICAgLy8gMjQuMS4xLjYgU2V0VmFsdWVJbkJ1ZmZlciAoIGFycmF5QnVmZmVyLCBieXRlSW5kZXgsIHR5cGUsIHZhbHVlLCBpc0xpdHRsZUVuZGlhbiApXHJcbiAgICAvLyAyNC4xLjIgVGhlIEFycmF5QnVmZmVyIENvbnN0cnVjdG9yXHJcbiAgICAvLyAyNC4xLjIuMSBBcnJheUJ1ZmZlciggbGVuZ3RoIClcclxuICAgIC8vIDI0LjEuMyBQcm9wZXJ0aWVzIG9mIHRoZSBBcnJheUJ1ZmZlciBDb25zdHJ1Y3RvclxyXG5cclxuICAgIC8vIDI0LjEuMy4xIEFycmF5QnVmZmVyLmlzVmlldyAoIGFyZyApXHJcbiAgICBkZWZpbmUoXHJcbiAgICAgIEFycmF5QnVmZmVyLCAnaXNWaWV3JyxcclxuICAgICAgZnVuY3Rpb24gaXNWaWV3KGFyZykge1xyXG4gICAgICAgIGlmIChUeXBlKGFyZykgIT09ICdvYmplY3QnKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgaWYgKCdidWZmZXInIGluIGFyZyAmJiBhcmcuYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHJldHVybiB0cnVlO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgLy8gMjQuMS4zLjIgQXJyYXlCdWZmZXIucHJvdG90eXBlXHJcbiAgICAvLyAyNC4xLjMuMyBnZXQgQXJyYXlCdWZmZXIgWyBAQHNwZWNpZXMgXVxyXG4gICAgLy8gMjQuMS40IFByb3BlcnRpZXMgb2YgdGhlIEFycmF5QnVmZmVyIFByb3RvdHlwZSBPYmplY3RcclxuICAgIC8vIDI0LjEuNC4xIGdldCBBcnJheUJ1ZmZlci5wcm90b3R5cGUuYnl0ZUxlbmd0aFxyXG4gICAgLy8gMjQuMS40LjIgQXJyYXlCdWZmZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yXHJcbiAgICAvLyAyNC4xLjQuMyBBcnJheUJ1ZmZlci5wcm90b3R5cGUuc2xpY2UgKCBzdGFydCAsIGVuZClcclxuXHJcbiAgICAvLyAyNC4xLjQuNCBBcnJheUJ1ZmZlci5wcm90b3R5cGUgWyBAQHRvU3RyaW5nVGFnIF1cclxuICAgIGRlZmluZShBcnJheUJ1ZmZlci5wcm90b3R5cGUsICQkdG9TdHJpbmdUYWcsICdBcnJheUJ1ZmZlcicpO1xyXG5cclxuICAgIC8vIDI0LjEuNSBQcm9wZXJ0aWVzIG9mIHRoZSBBcnJheUJ1ZmZlciBJbnN0YW5jZXNcclxuICB9KCkpO1xyXG5cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyAyNC4yIERhdGFWaWV3IE9iamVjdHNcclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgLy8gU2VlIHR5cGVkYXJyYXkuanMgZm9yIFR5cGVkQXJyYXkgcG9seWZpbGxcclxuXHJcbiAgKGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKCEoJ0RhdGFWaWV3JyBpbiBnbG9iYWwpKVxyXG4gICAgICByZXR1cm47XHJcblxyXG4gICAgLy8gMjQuMi4xIEFic3RyYWN0IE9wZXJhdGlvbnMgRm9yIERhdGFWaWV3IE9iamVjdHNcclxuICAgIC8vIDI0LjIuMS4xIEdldFZpZXdWYWx1ZSh2aWV3LCByZXF1ZXN0SW5kZXgsIGlzTGl0dGxlRW5kaWFuLCB0eXBlKVxyXG4gICAgLy8gMjQuMi4xLjIgU2V0Vmlld1ZhbHVlKHZpZXcsIHJlcXVlc3RJbmRleCwgaXNMaXR0bGVFbmRpYW4sIHR5cGUsIHZhbHVlKVxyXG4gICAgLy8gMjQuMi4yIFRoZSBEYXRhVmlldyBDb25zdHJ1Y3RvclxyXG4gICAgLy8gMjQuMi4yLjEgRGF0YVZpZXcgKGJ1ZmZlciBbICwgYnl0ZU9mZnNldCBbICwgYnl0ZUxlbmd0aCBdIF0gKVxyXG4gICAgLy8gMjQuMi4zIFByb3BlcnRpZXMgb2YgdGhlIERhdGFWaWV3IENvbnN0cnVjdG9yXHJcbiAgICAvLyAyNC4yLjMuMSBEYXRhVmlldy5wcm90b3R5cGVcclxuICAgIC8vIDI0LjIuNCBQcm9wZXJ0aWVzIG9mIHRoZSBEYXRhVmlldyBQcm90b3R5cGUgT2JqZWN0XHJcbiAgICAvLyAyNC4yLjQuMSBnZXQgRGF0YVZpZXcucHJvdG90eXBlLmJ1ZmZlclxyXG4gICAgLy8gMjQuMi40LjIgZ2V0IERhdGFWaWV3LnByb3RvdHlwZS5ieXRlTGVuZ3RoXHJcbiAgICAvLyAyNC4yLjQuMyBnZXQgRGF0YVZpZXcucHJvdG90eXBlLmJ5dGVPZmZzZXRcclxuICAgIC8vIDI0LjIuNC40IERhdGFWaWV3LnByb3RvdHlwZS5jb25zdHJ1Y3RvclxyXG4gICAgLy8gMjQuMi40LjUgRGF0YVZpZXcucHJvdG90eXBlLmdldEZsb2F0MzIgKCBieXRlT2Zmc2V0IFsgLCBsaXR0bGVFbmRpYW4gXSApXHJcbiAgICAvLyAyNC4yLjQuNiBEYXRhVmlldy5wcm90b3R5cGUuZ2V0RmxvYXQ2NCAoIGJ5dGVPZmZzZXQgWyAsIGxpdHRsZUVuZGlhbiBdIClcclxuICAgIC8vIDI0LjIuNC43IERhdGFWaWV3LnByb3RvdHlwZS5nZXRJbnQ4ICggYnl0ZU9mZnNldCApXHJcbiAgICAvLyAyNC4yLjQuOCBEYXRhVmlldy5wcm90b3R5cGUuZ2V0SW50MTYgKCBieXRlT2Zmc2V0IFsgLCBsaXR0bGVFbmRpYW4gXSApXHJcbiAgICAvLyAyNC4yLjQuOSBEYXRhVmlldy5wcm90b3R5cGUuZ2V0SW50MzIgKCBieXRlT2Zmc2V0IFsgLCBsaXR0bGVFbmRpYW4gXSApXHJcbiAgICAvLyAyNC4yLjQuMTAgRGF0YVZpZXcucHJvdG90eXBlLmdldFVpbnQ4ICggYnl0ZU9mZnNldCApXHJcbiAgICAvLyAyNC4yLjQuMTEgRGF0YVZpZXcucHJvdG90eXBlLmdldFVpbnQxNiAoIGJ5dGVPZmZzZXQgWyAsIGxpdHRsZUVuZGlhbiBdIClcclxuICAgIC8vIDI0LjIuNC4xMiBEYXRhVmlldy5wcm90b3R5cGUuZ2V0VWludDMyICggYnl0ZU9mZnNldCBbICwgbGl0dGxlRW5kaWFuIF0gKVxyXG4gICAgLy8gMjQuMi40LjEzIERhdGFWaWV3LnByb3RvdHlwZS5zZXRGbG9hdDMyICggYnl0ZU9mZnNldCwgdmFsdWUgWyAsIGxpdHRsZUVuZGlhbiBdIClcclxuICAgIC8vIDI0LjIuNC4xNCBEYXRhVmlldy5wcm90b3R5cGUuc2V0RmxvYXQ2NCAoIGJ5dGVPZmZzZXQsIHZhbHVlIFsgLCBsaXR0bGVFbmRpYW4gXSApXHJcbiAgICAvLyAyNC4yLjQuMTUgRGF0YVZpZXcucHJvdG90eXBlLnNldEludDggKCBieXRlT2Zmc2V0LCB2YWx1ZSApXHJcbiAgICAvLyAyNC4yLjQuMTYgRGF0YVZpZXcucHJvdG90eXBlLnNldEludDE2ICggYnl0ZU9mZnNldCwgdmFsdWUgWyAsIGxpdHRsZUVuZGlhbiBdIClcclxuICAgIC8vIDI0LjIuNC4xNyBEYXRhVmlldy5wcm90b3R5cGUuc2V0SW50MzIgKCBieXRlT2Zmc2V0LCB2YWx1ZSBbICwgbGl0dGxlRW5kaWFuIF0gKVxyXG4gICAgLy8gMjQuMi40LjE4IERhdGFWaWV3LnByb3RvdHlwZS5zZXRVaW50OCAoIGJ5dGVPZmZzZXQsIHZhbHVlIClcclxuICAgIC8vIDI0LjIuNC4xOSBEYXRhVmlldy5wcm90b3R5cGUuc2V0VWludDE2ICggYnl0ZU9mZnNldCwgdmFsdWUgWyAsIGxpdHRsZUVuZGlhbiBdIClcclxuICAgIC8vIDI0LjIuNC4yMCBEYXRhVmlldy5wcm90b3R5cGUuc2V0VWludDMyICggYnl0ZU9mZnNldCwgdmFsdWUgWyAsIGxpdHRsZUVuZGlhbiBdIClcclxuXHJcbiAgICAvLyAyNC4yLjQuMjEgRGF0YVZpZXcucHJvdG90eXBlWyBAQHRvU3RyaW5nVGFnIF1cclxuICAgIGRlZmluZShEYXRhVmlldy5wcm90b3R5cGUsICQkdG9TdHJpbmdUYWcsICdEYXRhVmlldycpO1xyXG5cclxuICAgIC8vIDI0LjIuNSBQcm9wZXJ0aWVzIG9mIERhdGFWaWV3IEluc3RhbmNlc1xyXG4gIH0oKSk7XHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIDI0LjMgVGhlIEpTT04gT2JqZWN0XHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIC8vIDI0LjMuMSBKU09OLnBhcnNlICggdGV4dCBbICwgcmV2aXZlciBdIClcclxuICAvLyAyNC4zLjIgSlNPTi5zdHJpbmdpZnkgKCB2YWx1ZSBbICwgcmVwbGFjZXIgWyAsIHNwYWNlIF0gXSApXHJcbiAgLy8gMjQuMy4zIEpTT04gWyBAQHRvU3RyaW5nVGFnIF1cclxuICBkZWZpbmUoSlNPTiwgJCR0b1N0cmluZ1RhZywgJ0pTT04nKTtcclxuXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gMjUuMSBJdGVyYXRpb25cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgLy8gMjUuMS4xIENvbW1vbiBJdGVyYXRpb24gSW50ZXJmYWNlc1xyXG4gIC8vIDI1LjEuMS4xIFRoZSBJdGVyYWJsZSBJbnRlcmZhY2VcclxuICAvLyAyNS4xLjEuMiBUaGUgSXRlcmF0b3IgSW50ZXJmYWNlXHJcbiAgLy8gMjUuMS4xLjMgVGhlIEl0ZXJhdG9yUmVzdWx0IEludGVyZmFjZVxyXG5cclxuICAvLyAyNS4xLjIgVGhlICVJdGVyYXRvclByb3RvdHlwZSUgT2JqZWN0XHJcbiAgLy8gRGVmaW5lZCBlYXJsaWVyLCBzbyBvdGhlciBwcm90b3R5cGVzIGNhbiByZWZlcmVuY2UgaXQuXHJcbiAgLy8gMjUuMS4yLjEgJUl0ZXJhdG9yUHJvdG90eXBlJSBbIEBAaXRlcmF0b3IgXSAoIClcclxuICBkZWZpbmUoJEl0ZXJhdG9yUHJvdG90eXBlJCwgJCRpdGVyYXRvciwgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9KTtcclxuXHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIDI1LjQgUHJvbWlzZSBPYmplY3RzXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIChmdW5jdGlvbigpIHtcclxuICAgIC8vIDI1LjQgUHJvbWlzZSBPYmplY3RzXHJcblxyXG4gICAgLy8gMjUuNC4xIFByb21pc2UgQWJzdHJhY3QgT3BlcmF0aW9uc1xyXG5cclxuICAgIC8vIDI1LjQuMS4xIFByb21pc2VDYXBhYmlsaXR5IFJlY29yZHNcclxuICAgIC8vIDI1LjQuMS4xLjEgSWZBYnJ1cHRSZWplY3RQcm9taXNlICggdmFsdWUsIGNhcGFiaWxpdHkgKVxyXG5cclxuICAgIGZ1bmN0aW9uIElmQWJydXB0UmVqZWN0UHJvbWlzZSh2YWx1ZSwgY2FwYWJpbGl0eSkge1xyXG4gICAgICB2YXIgcmVqZWN0UmVzdWx0ID0gY2FwYWJpbGl0eVsnW1tSZWplY3RdXSddLmNhbGwodW5kZWZpbmVkLCB2YWx1ZSk7XHJcbiAgICAgIHJldHVybiBjYXBhYmlsaXR5WydbW1Byb21pc2VdXSddO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDI1LjQuMS4yIFByb21pc2VSZWFjdGlvbiBSZWNvcmRzXHJcblxyXG4gICAgLy8gMjUuNC4xLjMgQ3JlYXRlUmVzb2x2aW5nRnVuY3Rpb25zICggcHJvbWlzZSApXHJcblxyXG4gICAgZnVuY3Rpb24gQ3JlYXRlUmVzb2x2aW5nRnVuY3Rpb25zKHByb21pc2UpIHtcclxuICAgICAgdmFyIGFscmVhZHlSZXNvbHZlZCA9IHsnW1t2YWx1ZV1dJzogZmFsc2V9O1xyXG4gICAgICB2YXIgcmVzb2x2ZSA9IFByb21pc2VSZXNvbHZlRnVuY3Rpb24oKTtcclxuICAgICAgc2V0X2ludGVybmFsKHJlc29sdmUsICdbW1Byb21pc2VdXScsICBwcm9taXNlKTtcclxuICAgICAgc2V0X2ludGVybmFsKHJlc29sdmUsICdbW0FscmVhZHlSZXNvbHZlZF1dJywgYWxyZWFkeVJlc29sdmVkKTtcclxuICAgICAgdmFyIHJlamVjdCA9IFByb21pc2VSZWplY3RGdW5jdGlvbigpO1xyXG4gICAgICBzZXRfaW50ZXJuYWwocmVqZWN0LCAnW1tQcm9taXNlXV0nLCBwcm9taXNlKTtcclxuICAgICAgc2V0X2ludGVybmFsKHJlamVjdCwgJ1tbQWxyZWFkeVJlc29sdmVkXV0nLCBhbHJlYWR5UmVzb2x2ZWQpO1xyXG4gICAgICByZXR1cm4geyAnW1tSZXNvbHZlXV0nOiByZXNvbHZlLCAnW1tSZWplY3RdXSc6IHJlamVjdH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMjUuNC4xLjMuMSBQcm9taXNlIFJlamVjdCBGdW5jdGlvbnNcclxuXHJcbiAgICBmdW5jdGlvbiBQcm9taXNlUmVqZWN0RnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBGID0gZnVuY3Rpb24ocmVhc29uKSB7XHJcbiAgICAgICAgY29uc29sZS5hc3NlcnQoVHlwZShGWydbW1Byb21pc2VdXSddKSA9PT0gJ29iamVjdCcpO1xyXG4gICAgICAgIHZhciBwcm9taXNlID0gRlsnW1tQcm9taXNlXV0nXTtcclxuICAgICAgICB2YXIgYWxyZWFkeVJlc29sdmVkID0gRlsnW1tBbHJlYWR5UmVzb2x2ZWRdXSddO1xyXG4gICAgICAgIGlmIChhbHJlYWR5UmVzb2x2ZWRbJ1tbdmFsdWVdXSddKSByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIHNldF9pbnRlcm5hbChhbHJlYWR5UmVzb2x2ZWQsICdbW3ZhbHVlXV0nLCB0cnVlKTtcclxuICAgICAgICByZXR1cm4gUmVqZWN0UHJvbWlzZShwcm9taXNlLCByZWFzb24pO1xyXG4gICAgICB9O1xyXG4gICAgICByZXR1cm4gRjtcclxuICAgIH1cclxuXHJcbiAgICAvLyAyNS40LjEuMy4yIFByb21pc2UgUmVzb2x2ZSBGdW5jdGlvbnNcclxuXHJcbiAgICBmdW5jdGlvbiBQcm9taXNlUmVzb2x2ZUZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgRiA9IGZ1bmN0aW9uKHJlc29sdXRpb24pIHtcclxuICAgICAgICBjb25zb2xlLmFzc2VydChUeXBlKEZbJ1tbUHJvbWlzZV1dJ10pID09PSAnb2JqZWN0Jyk7XHJcbiAgICAgICAgdmFyIHByb21pc2UgPSBGWydbW1Byb21pc2VdXSddO1xyXG4gICAgICAgIHZhciBhbHJlYWR5UmVzb2x2ZWQgPSBGWydbW0FscmVhZHlSZXNvbHZlZF1dJ107XHJcbiAgICAgICAgaWYgKGFscmVhZHlSZXNvbHZlZFsnW1t2YWx1ZV1dJ10pIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgc2V0X2ludGVybmFsKGFscmVhZHlSZXNvbHZlZCwgJ1tbdmFsdWVdXScsIHRydWUpO1xyXG5cclxuICAgICAgICBpZiAoU2FtZVZhbHVlKHJlc29sdXRpb24sIHByb21pc2UpKSAge1xyXG4gICAgICAgICAgdmFyIHNlbGZSZXNvbHV0aW9uRXJyb3IgPSBUeXBlRXJyb3IoKTtcclxuICAgICAgICAgIHJldHVybiBSZWplY3RQcm9taXNlKHByb21pc2UsIHNlbGZSZXNvbHV0aW9uRXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoVHlwZShyZXNvbHV0aW9uKSAhPT0gJ29iamVjdCcpXHJcbiAgICAgICAgICByZXR1cm4gRnVsZmlsbFByb21pc2UocHJvbWlzZSwgcmVzb2x1dGlvbik7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIHZhciB0aGVuID0gcmVzb2x1dGlvblsndGhlbiddO1xyXG4gICAgICAgIH0gY2F0Y2godGhlbikge1xyXG4gICAgICAgICAgcmV0dXJuIFJlamVjdFByb21pc2UocHJvbWlzZSwgdGhlbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghSXNDYWxsYWJsZSh0aGVuKSlcclxuICAgICAgICAgIHJldHVybiBGdWxmaWxsUHJvbWlzZShwcm9taXNlLCByZXNvbHV0aW9uKTtcclxuICAgICAgICBFbnF1ZXVlSm9iKCdQcm9taXNlSm9icycsIFByb21pc2VSZXNvbHZlVGhlbmFibGVKb2IsIFtwcm9taXNlLCByZXNvbHV0aW9uLCB0aGVuXSk7XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgfTtcclxuICAgICAgcmV0dXJuIEY7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMjUuNC4xLjQgRnVsZmlsbFByb21pc2UgKCBwcm9taXNlLCB2YWx1ZSApXHJcblxyXG4gICAgZnVuY3Rpb24gRnVsZmlsbFByb21pc2UocHJvbWlzZSwgdmFsdWUpIHtcclxuICAgICAgY29uc29sZS5hc3NlcnQocHJvbWlzZVsnW1tQcm9taXNlU3RhdGVdXSddID09PSAncGVuZGluZycpO1xyXG4gICAgICB2YXIgcmVhY3Rpb25zID0gcHJvbWlzZVsnW1tQcm9taXNlRnVsZmlsbFJlYWN0aW9uc11dJ107XHJcbiAgICAgIHNldF9pbnRlcm5hbChwcm9taXNlLCAnW1tQcm9taXNlUmVzdWx0XV0nLCB2YWx1ZSk7XHJcbiAgICAgIHNldF9pbnRlcm5hbChwcm9taXNlLCAnW1tQcm9taXNlRnVsZmlsbFJlYWN0aW9uc11dJywgdW5kZWZpbmVkKTtcclxuICAgICAgc2V0X2ludGVybmFsKHByb21pc2UsICdbW1Byb21pc2VSZWplY3RSZWFjdGlvbnNdXScsIHVuZGVmaW5lZCk7XHJcbiAgICAgIHNldF9pbnRlcm5hbChwcm9taXNlLCAnW1tQcm9taXNlU3RhdGVdXScsICdmdWxmaWxsZWQnKTtcclxuICAgICAgcmV0dXJuIFRyaWdnZXJQcm9taXNlUmVhY3Rpb25zKHJlYWN0aW9ucywgdmFsdWUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDI1LjQuMS41IE5ld1Byb21pc2VDYXBhYmlsaXR5ICggQyApXHJcblxyXG4gICAgZnVuY3Rpb24gTmV3UHJvbWlzZUNhcGFiaWxpdHkoYykge1xyXG4gICAgICAvLyBUbyBrZWVwIFByb21pc2UgaGVybWV0aWMsIHRoaXMgZG9lc24ndCBsb29rIG11Y2ggbGlrZSB0aGUgc3BlYy5cclxuICAgICAgcmV0dXJuIENyZWF0ZVByb21pc2VDYXBhYmlsaXR5UmVjb3JkKHVuZGVmaW5lZCwgYyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMjUuNC4xLjUuMSBDcmVhdGVQcm9taXNlQ2FwYWJpbGl0eVJlY29yZCAoIHByb21pc2UsIGNvbnN0cnVjdG9yIClcclxuXHJcbiAgICBmdW5jdGlvbiBDcmVhdGVQcm9taXNlQ2FwYWJpbGl0eVJlY29yZChwcm9taXNlLCBjb25zdHJ1Y3Rvcikge1xyXG4gICAgICAvLyBUbyBrZWVwIFByb21pc2UgaGVybWV0aWMsIHRoaXMgZG9lc24ndCBsb29rIG11Y2ggbGlrZSB0aGUgc3BlYy5cclxuICAgICAgY29uc29sZS5hc3NlcnQoSXNDb25zdHJ1Y3Rvcihjb25zdHJ1Y3RvcikpO1xyXG4gICAgICB2YXIgcHJvbWlzZUNhcGFiaWxpdHkgPSB7fTtcclxuICAgICAgc2V0X2ludGVybmFsKHByb21pc2VDYXBhYmlsaXR5LCAnW1tQcm9taXNlXV0nLCBwcm9taXNlKTtcclxuICAgICAgc2V0X2ludGVybmFsKHByb21pc2VDYXBhYmlsaXR5LCAnW1tSZXNvbHZlXV0nLCB1bmRlZmluZWQpO1xyXG4gICAgICBzZXRfaW50ZXJuYWwocHJvbWlzZUNhcGFiaWxpdHksICdbW1JlamVjdF1dJywgdW5kZWZpbmVkKTtcclxuICAgICAgdmFyIGV4ZWN1dG9yID0gR2V0Q2FwYWJpbGl0aWVzRXhlY3V0b3IoKTtcclxuICAgICAgc2V0X2ludGVybmFsKGV4ZWN1dG9yLCAnW1tDYXBhYmlsaXR5XV0nLCBwcm9taXNlQ2FwYWJpbGl0eSk7XHJcblxyXG4gICAgICAvLyBOT1RFOiBEaWZmZXJzIGZyb20gc3BlYzsgb2JqZWN0IGlzIGNvbnN0cnVjdGVkIGhlcmVcclxuICAgICAgdmFyIGNvbnN0cnVjdG9yUmVzdWx0ID0gcHJvbWlzZSA9IG5ldyBjb25zdHJ1Y3RvcihleGVjdXRvcik7XHJcbiAgICAgIHNldF9pbnRlcm5hbChwcm9taXNlQ2FwYWJpbGl0eSwgJ1tbUHJvbWlzZV1dJywgcHJvbWlzZSk7XHJcblxyXG4gICAgICBpZiAoIUlzQ2FsbGFibGUocHJvbWlzZUNhcGFiaWxpdHlbJ1tbUmVzb2x2ZV1dJ10pKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgaWYgKCFJc0NhbGxhYmxlKHByb21pc2VDYXBhYmlsaXR5WydbW1JlamVjdF1dJ10pKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuICAgICAgaWYgKFR5cGUoY29uc3RydWN0b3JSZXN1bHQpID09PSAnb2JqZWN0JyAmJiAhU2FtZVZhbHVlKHByb21pc2UsIGNvbnN0cnVjdG9yUmVzdWx0KSkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgIHJldHVybiBwcm9taXNlQ2FwYWJpbGl0eTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAyNS40LjEuNS4yIEdldENhcGFiaWxpdGllc0V4ZWN1dG9yIEZ1bmN0aW9uc1xyXG5cclxuICAgIGZ1bmN0aW9uIEdldENhcGFiaWxpdGllc0V4ZWN1dG9yKCkge1xyXG4gICAgICB2YXIgRiA9IGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGNvbnNvbGUuYXNzZXJ0KEZbJ1tbQ2FwYWJpbGl0eV1dJ10pO1xyXG4gICAgICAgIHZhciBwcm9taXNlQ2FwYWJpbGl0eSA9IEZbJ1tbQ2FwYWJpbGl0eV1dJ107XHJcbiAgICAgICAgaWYgKHByb21pc2VDYXBhYmlsaXR5WydbW1Jlc29sdmVdXSddICE9PSB1bmRlZmluZWQpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIGlmIChwcm9taXNlQ2FwYWJpbGl0eVsnW1tSZWplY3RdXSddICE9PSB1bmRlZmluZWQpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIHNldF9pbnRlcm5hbChwcm9taXNlQ2FwYWJpbGl0eSwgJ1tbUmVzb2x2ZV1dJywgcmVzb2x2ZSk7XHJcbiAgICAgICAgc2V0X2ludGVybmFsKHByb21pc2VDYXBhYmlsaXR5LCAnW1tSZWplY3RdXScsIHJlamVjdCk7XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgfTtcclxuICAgICAgcmV0dXJuIEY7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMjUuNC4xLjYgSXNQcm9taXNlICggeCApXHJcblxyXG4gICAgZnVuY3Rpb24gSXNQcm9taXNlKHgpIHtcclxuICAgICAgaWYgKFR5cGUoeCkgIT09ICdvYmplY3QnKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgIGlmICghKCdbW1Byb21pc2VTdGF0ZV1dJyBpbiB4KSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICBpZiAoeFsnW1tQcm9taXNlU3RhdGVdXSddID09PSB1bmRlZmluZWQpIHJldHVybiBmYWxzZTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMjUuNC4xLjcgUmVqZWN0UHJvbWlzZSAoIHByb21pc2UsIHJlYXNvbiApXHJcblxyXG4gICAgZnVuY3Rpb24gUmVqZWN0UHJvbWlzZShwcm9taXNlLCByZWFzb24pIHtcclxuICAgICAgY29uc29sZS5hc3NlcnQocHJvbWlzZVsnW1tQcm9taXNlU3RhdGVdXSddID09PSAncGVuZGluZycpO1xyXG4gICAgICB2YXIgcmVhY3Rpb25zID0gcHJvbWlzZVsnW1tQcm9taXNlUmVqZWN0UmVhY3Rpb25zXV0nXTtcclxuICAgICAgc2V0X2ludGVybmFsKHByb21pc2UsICdbW1Byb21pc2VSZXN1bHRdXScsIHJlYXNvbik7XHJcbiAgICAgIHNldF9pbnRlcm5hbChwcm9taXNlLCAnW1tQcm9taXNlRnVsZmlsbFJlYWN0aW9uc11dJywgdW5kZWZpbmVkKTtcclxuICAgICAgc2V0X2ludGVybmFsKHByb21pc2UsICdbW1Byb21pc2VSZWplY3RSZWFjdGlvbnNdXScsIHVuZGVmaW5lZCk7XHJcbiAgICAgIHNldF9pbnRlcm5hbChwcm9taXNlLCAnW1tQcm9taXNlU3RhdGVdXScsICdyZWplY3RlZCcpO1xyXG4gICAgICByZXR1cm4gVHJpZ2dlclByb21pc2VSZWFjdGlvbnMocmVhY3Rpb25zLCByZWFzb24pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDI1LjQuMS44IFRyaWdnZXJQcm9taXNlUmVhY3Rpb25zICggcmVhY3Rpb25zLCBhcmd1bWVudCApXHJcblxyXG4gICAgZnVuY3Rpb24gVHJpZ2dlclByb21pc2VSZWFjdGlvbnMocmVhY3Rpb25zLCBhcmd1bWVudCkge1xyXG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcmVhY3Rpb25zLmxlbmd0aDsgaSA8IGxlbjsgKytpKVxyXG4gICAgICAgIEVucXVldWVKb2IoJ1Byb21pc2VKb2JzJywgUHJvbWlzZVJlYWN0aW9uSm9iLCBbcmVhY3Rpb25zW2ldLCBhcmd1bWVudF0pO1xyXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDI1LjQuMiBQcm9taXNlIEpvYnNcclxuXHJcbiAgICAvLyAyNS40LjIuMSBQcm9taXNlUmVhY3Rpb25Kb2IgKCByZWFjdGlvbiwgYXJndW1lbnQgKVxyXG5cclxuICAgIGZ1bmN0aW9uIFByb21pc2VSZWFjdGlvbkpvYihyZWFjdGlvbiwgYXJndW1lbnQpIHtcclxuICAgICAgdmFyIHByb21pc2VDYXBhYmlsaXR5ID0gcmVhY3Rpb25bJ1tbQ2FwYWJpbGl0aWVzXV0nXTtcclxuICAgICAgdmFyIGhhbmRsZXIgPSByZWFjdGlvblsnW1tIYW5kbGVyXV0nXTtcclxuICAgICAgdmFyIGhhbmRsZXJSZXN1bHQsIHN0YXR1cztcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBpZiAoaGFuZGxlciA9PT0gJ0lkZW50aXR5JykgaGFuZGxlclJlc3VsdCA9IGFyZ3VtZW50O1xyXG4gICAgICAgIGVsc2UgaWYgKGhhbmRsZXIgPT09ICdUaHJvd2VyJykgdGhyb3cgYXJndW1lbnQ7XHJcbiAgICAgICAgZWxzZSBoYW5kbGVyUmVzdWx0ID0gaGFuZGxlci5jYWxsKHVuZGVmaW5lZCwgYXJndW1lbnQpO1xyXG4gICAgICB9IGNhdGNoIChoYW5kbGVyUmVzdWx0KSB7XHJcbiAgICAgICAgc3RhdHVzID0gcHJvbWlzZUNhcGFiaWxpdHlbJ1tbUmVqZWN0XV0nXS5jYWxsKHVuZGVmaW5lZCwgaGFuZGxlclJlc3VsdCk7XHJcbiAgICAgICAgTmV4dEpvYihzdGF0dXMpOyByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgc3RhdHVzID0gcHJvbWlzZUNhcGFiaWxpdHlbJ1tbUmVzb2x2ZV1dJ10uY2FsbCh1bmRlZmluZWQsIGhhbmRsZXJSZXN1bHQpO1xyXG4gICAgICBOZXh0Sm9iKHN0YXR1cyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMjUuNC4yLjIgUHJvbWlzZVJlc29sdmVUaGVuYWJsZUpvYiAoIHByb21pc2VUb1Jlc29sdmUsIHRoZW5hYmxlLCB0aGVuKVxyXG5cclxuICAgIGZ1bmN0aW9uIFByb21pc2VSZXNvbHZlVGhlbmFibGVKb2IocHJvbWlzZVRvUmVzb2x2ZSwgdGhlbmFibGUsIHRoZW4pIHtcclxuICAgICAgLy8gU1BFQyBCVUc6IHByb21pc2UgdnMuIHByb21pc2VUb1Jlc29sdmVcclxuICAgICAgdmFyIHJlc29sdmluZ0Z1bmN0aW9ucyA9IENyZWF0ZVJlc29sdmluZ0Z1bmN0aW9ucyhwcm9taXNlVG9SZXNvbHZlKTtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICB2YXIgdGhlbkNhbGxSZXN1bHQgPSB0aGVuLmNhbGwodGhlbmFibGUsIHJlc29sdmluZ0Z1bmN0aW9uc1snW1tSZXNvbHZlXV0nXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2aW5nRnVuY3Rpb25zWydbW1JlamVjdF1dJ10pO1xyXG4gICAgICB9IGNhdGNoICh0aGVuQ2FsbFJlc3VsdCkge1xyXG4gICAgICAgIHZhciBzdGF0dXMgPSByZXNvbHZpbmdGdW5jdGlvbnNbJ1tbUmVqZWN0XV0nXS5jYWxsKHVuZGVmaW5lZCwgdGhlbkNhbGxSZXN1bHQpO1xyXG4gICAgICAgIE5leHRKb2Ioc3RhdHVzKTsgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIE5leHRKb2IodGhlbkNhbGxSZXN1bHQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDI1LjQuMyBUaGUgUHJvbWlzZSBDb25zdHJ1Y3RvclxyXG5cclxuICAgIC8vIDI1LjQuMy4xIFByb21pc2UgKCBleGVjdXRvciApXHJcblxyXG4gICAgZnVuY3Rpb24gUHJvbWlzZShleGVjdXRvcikge1xyXG4gICAgICB2YXIgY29uZmlnID0geyBjb25maWd1cmFibGU6IGZhbHNlLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIHZhbHVlOiB1bmRlZmluZWQgfTtcclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdbW1Byb21pc2VTdGF0ZV1dJywgY29uZmlnKTtcclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdbW1Byb21pc2VDb25zdHJ1Y3Rvcl1dJywgY29uZmlnKTtcclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdbW1Byb21pc2VSZXN1bHRdXScsIGNvbmZpZyk7XHJcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnW1tQcm9taXNlRnVsZmlsbFJlYWN0aW9uc11dJywgY29uZmlnKTtcclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdbW1Byb21pc2VSZWplY3RSZWFjdGlvbnNdXScsIGNvbmZpZyk7XHJcblxyXG4gICAgICB2YXIgcHJvbWlzZSA9IHRoaXM7XHJcbiAgICAgIGlmIChUeXBlKHByb21pc2UpICE9PSAnb2JqZWN0JykgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICBpZiAoISgnW1tQcm9taXNlU3RhdGVdXScgaW4gcHJvbWlzZSkpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICBpZiAocHJvbWlzZVsnW1tQcm9taXNlU3RhdGVdXSddICE9PSB1bmRlZmluZWQpIHRocm93IFR5cGVFcnJvcigpO1xyXG4gICAgICBpZiAoIUlzQ2FsbGFibGUoZXhlY3V0b3IpKSB0aHJvdyBUeXBlRXJyb3IoKTtcclxuXHJcbiAgICAgIHNldF9pbnRlcm5hbChwcm9taXNlLCAnW1tQcm9taXNlQ29uc3RydWN0b3JdXScsIFByb21pc2UpO1xyXG5cclxuICAgICAgcmV0dXJuIEluaXRpYWxpemVQcm9taXNlKHByb21pc2UsIGV4ZWN1dG9yKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAyNS40LjMuMS4xIEluaXRpYWxpemVQcm9taXNlICggcHJvbWlzZSwgZXhlY3V0b3IgKVxyXG5cclxuICAgIGZ1bmN0aW9uIEluaXRpYWxpemVQcm9taXNlKHByb21pc2UsIGV4ZWN1dG9yKSB7XHJcbiAgICAgIGNvbnNvbGUuYXNzZXJ0KCdbW1Byb21pc2VTdGF0ZV1dJyBpbiBwcm9taXNlKTtcclxuICAgICAgY29uc29sZS5hc3NlcnQoSXNDYWxsYWJsZShleGVjdXRvcikpO1xyXG4gICAgICBzZXRfaW50ZXJuYWwocHJvbWlzZSwgJ1tbUHJvbWlzZVN0YXRlXV0nLCAncGVuZGluZycpO1xyXG4gICAgICBzZXRfaW50ZXJuYWwocHJvbWlzZSwgJ1tbUHJvbWlzZUZ1bGZpbGxSZWFjdGlvbnNdXScsIFtdKTtcclxuICAgICAgc2V0X2ludGVybmFsKHByb21pc2UsICdbW1Byb21pc2VSZWplY3RSZWFjdGlvbnNdXScsIFtdKTtcclxuICAgICAgdmFyIHJlc29sdmluZ0Z1bmN0aW9ucyA9IENyZWF0ZVJlc29sdmluZ0Z1bmN0aW9ucyhwcm9taXNlKTtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICB2YXIgY29tcGxldGlvbiA9IGV4ZWN1dG9yLmNhbGwodW5kZWZpbmVkLCByZXNvbHZpbmdGdW5jdGlvbnNbJ1tbUmVzb2x2ZV1dJ10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmluZ0Z1bmN0aW9uc1snW1tSZWplY3RdXSddKTtcclxuICAgICAgfSBjYXRjaCAoY29tcGxldGlvbikge1xyXG4gICAgICAgIHZhciBzdGF0dXMgPSByZXNvbHZpbmdGdW5jdGlvbnNbJ1tbUmVqZWN0XV0nXS5jYWxsKHVuZGVmaW5lZCwgY29tcGxldGlvbik7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHByb21pc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMjUuNC40IFByb3BlcnRpZXMgb2YgdGhlIFByb21pc2UgQ29uc3RydWN0b3JcclxuICAgIC8vIDI1LjQuNC4xIFByb21pc2UuYWxsICggaXRlcmFibGUgKVxyXG5cclxuICAgIGRlZmluZShQcm9taXNlLCAnYWxsJywgZnVuY3Rpb24gYWxsKGl0ZXJhYmxlKSB7XHJcbiAgICAgIHZhciBjID0gc3RyaWN0KHRoaXMpO1xyXG4gICAgICB2YXIgcHJvbWlzZUNhcGFiaWxpdHkgPSBOZXdQcm9taXNlQ2FwYWJpbGl0eShjKTtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICB2YXIgaXRlcmF0b3IgPSBHZXRJdGVyYXRvcihpdGVyYWJsZSk7XHJcbiAgICAgIH0gY2F0Y2ggKHZhbHVlKSB7XHJcbiAgICAgICAgcHJvbWlzZUNhcGFiaWxpdHlbJ1tbUmVqZWN0XV0nXS5jYWxsKHVuZGVmaW5lZCwgdmFsdWUpO1xyXG4gICAgICAgIHJldHVybiBwcm9taXNlQ2FwYWJpbGl0eVsnW1tQcm9taXNlXV0nXTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgdmFsdWVzID0gW107XHJcbiAgICAgIHZhciByZW1haW5pbmdFbGVtZW50c0NvdW50ID0geyB2YWx1ZTogMSB9O1xyXG4gICAgICB2YXIgaW5kZXggPSAwO1xyXG4gICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICB2YXIgbmV4dCA9IEl0ZXJhdG9yU3RlcChpdGVyYXRvcik7XHJcbiAgICAgICAgfSBjYXRjaCAodmFsdWUpIHtcclxuICAgICAgICAgIHByb21pc2VDYXBhYmlsaXR5WydbW1JlamVjdF1dJ10uY2FsbCh1bmRlZmluZWQsIHZhbHVlKTtcclxuICAgICAgICAgIHJldHVybiBwcm9taXNlQ2FwYWJpbGl0eVsnW1tQcm9taXNlXV0nXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFuZXh0KSB7XHJcbiAgICAgICAgICByZW1haW5pbmdFbGVtZW50c0NvdW50LnZhbHVlIC09IDE7XHJcbiAgICAgICAgICBpZiAocmVtYWluaW5nRWxlbWVudHNDb3VudC52YWx1ZSA9PT0gMCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzb2x2ZVJlc3VsdCA9IHByb21pc2VDYXBhYmlsaXR5WydbW1Jlc29sdmVdXSddLmFwcGx5KHVuZGVmaW5lZCwgdmFsdWVzKTtcclxuXHJcblxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIHByb21pc2VDYXBhYmlsaXR5WydbW1Byb21pc2VdXSddO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgdmFyIG5leHRWYWx1ZSA9IEl0ZXJhdG9yVmFsdWUobmV4dCk7XHJcbiAgICAgICAgfSBjYXRjaCAodmFsdWUpIHtcclxuICAgICAgICAgIHByb21pc2VDYXBhYmlsaXR5WydbW1JlamVjdF1dJ10uY2FsbCh1bmRlZmluZWQsIHZhbHVlKTtcclxuICAgICAgICAgIHJldHVybiBwcm9taXNlQ2FwYWJpbGl0eVsnW1tQcm9taXNlXV0nXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIHZhciBuZXh0UHJvbWlzZSA9IGMucmVzb2x2ZShuZXh0VmFsdWUpO1xyXG4gICAgICAgIH0gY2F0Y2ggKHZhbHVlKSB7XHJcbiAgICAgICAgICBwcm9taXNlQ2FwYWJpbGl0eVsnW1tSZWplY3RdXSddLmNhbGwodW5kZWZpbmVkLCB2YWx1ZSk7XHJcbiAgICAgICAgICByZXR1cm4gcHJvbWlzZUNhcGFiaWxpdHlbJ1tbUHJvbWlzZV1dJ107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZXNvbHZlRWxlbWVudCA9IFByb21pc2VBbGxSZXNvbHZlRWxlbWVudEZ1bmN0aW9uKCk7XHJcbiAgICAgICAgc2V0X2ludGVybmFsKHJlc29sdmVFbGVtZW50LCAnW1tBbHJlYWR5Q2FsbGVkXV0nLCB7IHZhbHVlOiBmYWxzZSB9KTtcclxuICAgICAgICBzZXRfaW50ZXJuYWwocmVzb2x2ZUVsZW1lbnQsICdbW0luZGV4XV0nLCBpbmRleCk7XHJcbiAgICAgICAgc2V0X2ludGVybmFsKHJlc29sdmVFbGVtZW50LCAnW1tWYWx1ZXNdXScsIHZhbHVlcyk7XHJcbiAgICAgICAgc2V0X2ludGVybmFsKHJlc29sdmVFbGVtZW50LCAnW1tDYXBhYmlsaXRpZXNdXScsIHByb21pc2VDYXBhYmlsaXR5KTtcclxuICAgICAgICBzZXRfaW50ZXJuYWwocmVzb2x2ZUVsZW1lbnQsICdbW1JlbWFpbmluZ0VsZW1lbnRzXV0nLCByZW1haW5pbmdFbGVtZW50c0NvdW50KTtcclxuICAgICAgICByZW1haW5pbmdFbGVtZW50c0NvdW50LnZhbHVlICs9IDE7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIHZhciByZXN1bHQgPSBuZXh0UHJvbWlzZS50aGVuKHJlc29sdmVFbGVtZW50LCBwcm9taXNlQ2FwYWJpbGl0eVsnW1tSZWplY3RdXSddKTtcclxuICAgICAgICB9IGNhdGNoICh2YWx1ZSkge1xyXG4gICAgICAgICAgcHJvbWlzZUNhcGFiaWxpdHlbJ1tbUmVqZWN0XV0nXS5jYWxsKHVuZGVmaW5lZCwgdmFsdWUpO1xyXG4gICAgICAgICAgcmV0dXJuIHByb21pc2VDYXBhYmlsaXR5WydbW1Byb21pc2VdXSddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpbmRleCArPSAxO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyAyNS40LjQuMS4xIFByb21pc2UuYWxsIFJlc29sdmUgRWxlbWVudCBGdW5jdGlvbnNcclxuXHJcbiAgICBmdW5jdGlvbiBQcm9taXNlQWxsUmVzb2x2ZUVsZW1lbnRGdW5jdGlvbigpIHtcclxuICAgICAgdmFyIEYgPSBmdW5jdGlvbih4KSB7XHJcbiAgICAgICAgdmFyIGFscmVhZHlDYWxsZWQgPSBGWydbW0FscmVhZHlDYWxsZWRdXSddO1xyXG4gICAgICAgIGlmIChhbHJlYWR5Q2FsbGVkLnZhbHVlKSByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIGFscmVhZHlDYWxsZWQudmFsdWUgPSB0cnVlO1xyXG4gICAgICAgIHZhciBpbmRleCA9IEZbJ1tbSW5kZXhdXSddO1xyXG4gICAgICAgIHZhciB2YWx1ZXMgPSBGWydbW1ZhbHVlc11dJ107XHJcbiAgICAgICAgdmFyIHByb21pc2VDYXBhYmlsaXR5ID0gRlsnW1tDYXBhYmlsaXRpZXNdXSddO1xyXG4gICAgICAgIHZhciByZW1haW5pbmdFbGVtZW50c0NvdW50ID0gRlsnW1tSZW1haW5pbmdFbGVtZW50c11dJ107XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIHZhbHVlc1tpbmRleF0gPSB4O1xyXG4gICAgICAgIH0gY2F0Y2ggKHJlc3VsdCkge1xyXG4gICAgICAgICAgcHJvbWlzZUNhcGFiaWxpdHlbJ1tbUmVqZWN0XV0nXS5jYWxsKHVuZGVmaW5lZCwgcmVzdWx0KTtcclxuICAgICAgICAgIHJldHVybiBwcm9taXNlQ2FwYWJpbGl0eVsnW1tQcm9taXNlXV0nXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmVtYWluaW5nRWxlbWVudHNDb3VudC52YWx1ZSAtPSAxO1xyXG4gICAgICAgIGlmIChyZW1haW5pbmdFbGVtZW50c0NvdW50LnZhbHVlID09PSAwKVxyXG4gICAgICAgICAgcmV0dXJuIHByb21pc2VDYXBhYmlsaXR5WydbW1Jlc29sdmVdXSddLmNhbGwodW5kZWZpbmVkLCB2YWx1ZXMpO1xyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgIH07XHJcbiAgICAgIHJldHVybiBGO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIDI1LjQuNC4yIFByb21pc2UucHJvdG90eXBlXHJcblxyXG4gICAgUHJvbWlzZS5wcm90b3R5cGUgPSB7fTtcclxuXHJcbiAgICAvLyAyNS40LjQuMyBQcm9taXNlLnJhY2UgKCBpdGVyYWJsZSApXHJcblxyXG4gICAgZGVmaW5lKFByb21pc2UsICdyYWNlJywgZnVuY3Rpb24gcmFjZShpdGVyYWJsZSkge1xyXG4gICAgICB2YXIgYyA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgdmFyIHByb21pc2VDYXBhYmlsaXR5ID0gTmV3UHJvbWlzZUNhcGFiaWxpdHkoYyk7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgdmFyIGl0ZXJhdG9yID0gR2V0SXRlcmF0b3IoaXRlcmFibGUpO1xyXG4gICAgICB9IGNhdGNoICh2YWx1ZSkge1xyXG4gICAgICAgIHByb21pc2VDYXBhYmlsaXR5WydbW1JlamVjdF1dJ10uY2FsbCh1bmRlZmluZWQsIHZhbHVlKTtcclxuICAgICAgICByZXR1cm4gcHJvbWlzZUNhcGFiaWxpdHlbJ1tbUHJvbWlzZV1dJ107XHJcbiAgICAgIH1cclxuICAgICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgdmFyIG5leHQgPSBJdGVyYXRvclN0ZXAoaXRlcmF0b3IpO1xyXG4gICAgICAgIH0gY2F0Y2ggKHZhbHVlKSB7XHJcbiAgICAgICAgICBwcm9taXNlQ2FwYWJpbGl0eVsnW1tSZWplY3RdXSddLmNhbGwodW5kZWZpbmVkLCB2YWx1ZSk7XHJcbiAgICAgICAgICByZXR1cm4gcHJvbWlzZUNhcGFiaWxpdHlbJ1tbUHJvbWlzZV1dJ107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghbmV4dCkgcmV0dXJuIHByb21pc2VDYXBhYmlsaXR5WydbW1Byb21pc2VdXSddO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICB2YXIgbmV4dFZhbHVlID0gSXRlcmF0b3JWYWx1ZShuZXh0KTtcclxuICAgICAgICB9IGNhdGNoICh2YWx1ZSkge1xyXG4gICAgICAgICAgcHJvbWlzZUNhcGFiaWxpdHlbJ1tbUmVqZWN0XV0nXS5jYWxsKHVuZGVmaW5lZCwgdmFsdWUpO1xyXG4gICAgICAgICAgcmV0dXJuIHByb21pc2VDYXBhYmlsaXR5WydbW1Byb21pc2VdXSddO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgdmFyIG5leHRQcm9taXNlID0gYy5yZXNvbHZlKG5leHRWYWx1ZSk7XHJcbiAgICAgICAgfSBjYXRjaCAodmFsdWUpIHtcclxuICAgICAgICAgIHByb21pc2VDYXBhYmlsaXR5WydbW1JlamVjdF1dJ10uY2FsbCh1bmRlZmluZWQsIHZhbHVlKTtcclxuICAgICAgICAgIHJldHVybiBwcm9taXNlQ2FwYWJpbGl0eVsnW1tQcm9taXNlXV0nXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIG5leHRQcm9taXNlLnRoZW4ocHJvbWlzZUNhcGFiaWxpdHlbJ1tbUmVzb2x2ZV1dJ10sIHByb21pc2VDYXBhYmlsaXR5WydbW1JlamVjdF1dJ10pO1xyXG4gICAgICAgIH0gY2F0Y2ggKHZhbHVlKSB7XHJcbiAgICAgICAgICBwcm9taXNlQ2FwYWJpbGl0eVsnW1tSZWplY3RdXSddLmNhbGwodW5kZWZpbmVkLCB2YWx1ZSk7XHJcbiAgICAgICAgICByZXR1cm4gcHJvbWlzZUNhcGFiaWxpdHlbJ1tbUHJvbWlzZV1dJ107XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyAyNS40LjQuNCBQcm9taXNlLnJlamVjdCAoIHIgKVxyXG5cclxuICAgIGRlZmluZShQcm9taXNlLCAncmVqZWN0JywgZnVuY3Rpb24gcmVqZWN0KHIpIHtcclxuICAgICAgdmFyIGMgPSBzdHJpY3QodGhpcyk7XHJcbiAgICAgIHZhciBwcm9taXNlQ2FwYWJpbGl0eSA9IE5ld1Byb21pc2VDYXBhYmlsaXR5KGMpO1xyXG4gICAgICB2YXIgcmVqZWN0UmVzdWx0ID0gcHJvbWlzZUNhcGFiaWxpdHlbJ1tbUmVqZWN0XV0nXS5jYWxsKHVuZGVmaW5lZCwgcik7XHJcbiAgICAgIHJldHVybiBwcm9taXNlQ2FwYWJpbGl0eVsnW1tQcm9taXNlXV0nXTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIDI1LjQuNC41IFByb21pc2UucmVzb2x2ZSAoIHggKVxyXG5cclxuICAgIGRlZmluZShQcm9taXNlLCAncmVzb2x2ZScsIGZ1bmN0aW9uIHJlc29sdmUoeCkge1xyXG4gICAgICB2YXIgYyA9IHN0cmljdCh0aGlzKTtcclxuICAgICAgaWYgKElzUHJvbWlzZSh4KSkge1xyXG4gICAgICAgIHZhciBjb25zdHJ1Y3RvciA9IHhbJ1tbUHJvbWlzZUNvbnN0cnVjdG9yXV0nXTtcclxuICAgICAgICBpZiAoU2FtZVZhbHVlKGNvbnN0cnVjdG9yLCBjKSkgcmV0dXJuIHg7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIHByb21pc2VDYXBhYmlsaXR5ID0gTmV3UHJvbWlzZUNhcGFiaWxpdHkoYyk7XHJcbiAgICAgIHZhciByZXNvbHZlUmVzdWx0ID0gcHJvbWlzZUNhcGFiaWxpdHlbJ1tbUmVzb2x2ZV1dJ10uY2FsbCh1bmRlZmluZWQsIHgpO1xyXG4gICAgICByZXR1cm4gcHJvbWlzZUNhcGFiaWxpdHlbJ1tbUHJvbWlzZV1dJ107XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyAyNS40LjQuNiBQcm9taXNlIFsgQEBjcmVhdGUgXSAoIClcclxuICAgIC8vIDI1LjQuNC42LjEgQWxsb2NhdGVQcm9taXNlICggY29uc3RydWN0b3IgKVxyXG4gICAgLy8gMjUuNC41IFByb3BlcnRpZXMgb2YgdGhlIFByb21pc2UgUHJvdG90eXBlIE9iamVjdFxyXG4gICAgLy8gMjUuNC41LjEgUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2ggKCBvblJlamVjdGVkIClcclxuXHJcbiAgICBkZWZpbmUoUHJvbWlzZS5wcm90b3R5cGUsICdjYXRjaCcsIGZ1bmN0aW9uIGNhdGNoXyhvblJlamVjdGVkKSB7XHJcbiAgICAgIHZhciBwcm9taXNlID0gdGhpcztcclxuICAgICAgcmV0dXJuIHByb21pc2UudGhlbih1bmRlZmluZWQsIG9uUmVqZWN0ZWQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gMjUuNC41LjIgUHJvbWlzZS5wcm90b3R5cGUuY29uc3RydWN0b3JcclxuXHJcbiAgICBQcm9taXNlLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFByb21pc2U7XHJcblxyXG4gICAgLy8gMjUuNC41LjMgUHJvbWlzZS5wcm90b3R5cGUudGhlbiAoIG9uRnVsZmlsbGVkICwgb25SZWplY3RlZCApXHJcblxyXG4gICAgZGVmaW5lKFByb21pc2UucHJvdG90eXBlLCAndGhlbicsIGZ1bmN0aW9uIHRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpIHtcclxuICAgICAgdmFyIHByb21pc2UgPSB0aGlzO1xyXG4gICAgICBpZiAoIUlzUHJvbWlzZShwcm9taXNlKSkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgIGlmICghSXNDYWxsYWJsZShvbkZ1bGZpbGxlZCkpIG9uRnVsZmlsbGVkID0gJ0lkZW50aXR5JztcclxuICAgICAgaWYgKCFJc0NhbGxhYmxlKG9uUmVqZWN0ZWQpKSBvblJlamVjdGVkID0gJ1Rocm93ZXInO1xyXG4gICAgICB2YXIgYyA9IHByb21pc2UuY29uc3RydWN0b3I7XHJcbiAgICAgIHZhciBwcm9taXNlQ2FwYWJpbGl0eSA9IE5ld1Byb21pc2VDYXBhYmlsaXR5KGMpO1xyXG4gICAgICB2YXIgZnVsZmlsbFJlYWN0aW9uID0geyAnW1tDYXBhYmlsaXRpZXNdXSc6IHByb21pc2VDYXBhYmlsaXR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnW1tIYW5kbGVyXV0nOiBvbkZ1bGZpbGxlZCB9O1xyXG4gICAgICB2YXIgcmVqZWN0UmVhY3Rpb24gPSB7ICdbW0NhcGFiaWxpdGllc11dJzogcHJvbWlzZUNhcGFiaWxpdHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1tbSGFuZGxlcl1dJzogb25SZWplY3RlZCB9O1xyXG4gICAgICBpZiAocHJvbWlzZVsnW1tQcm9taXNlU3RhdGVdXSddID09PSAncGVuZGluZycpIHtcclxuICAgICAgICBwcm9taXNlWydbW1Byb21pc2VGdWxmaWxsUmVhY3Rpb25zXV0nXS5wdXNoKGZ1bGZpbGxSZWFjdGlvbik7XHJcbiAgICAgICAgcHJvbWlzZVsnW1tQcm9taXNlUmVqZWN0UmVhY3Rpb25zXV0nXS5wdXNoKHJlamVjdFJlYWN0aW9uKTtcclxuICAgICAgfSBlbHNlIGlmIChwcm9taXNlWydbW1Byb21pc2VTdGF0ZV1dJ10gPT09ICdmdWxmaWxsZWQnKSB7XHJcbiAgICAgICAgdmFyIHZhbHVlID0gcHJvbWlzZVsnW1tQcm9taXNlUmVzdWx0XV0nXTtcclxuICAgICAgICBFbnF1ZXVlSm9iKCdQcm9taXNlSm9icycsIFByb21pc2VSZWFjdGlvbkpvYiwgW2Z1bGZpbGxSZWFjdGlvbiwgdmFsdWVdKTtcclxuICAgICAgfSBlbHNlIGlmIChwcm9taXNlWydbW1Byb21pc2VTdGF0ZV1dJ10gPT09ICdyZWplY3RlZCcpIHtcclxuICAgICAgICB2YXIgcmVhc29uID0gcHJvbWlzZVsnW1tQcm9taXNlUmVzdWx0XV0nXTtcclxuICAgICAgICBFbnF1ZXVlSm9iKCdQcm9taXNlSm9icycsIFByb21pc2VSZWFjdGlvbkpvYiwgW3JlamVjdFJlYWN0aW9uLCByZWFzb25dKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gcHJvbWlzZUNhcGFiaWxpdHlbJ1tbUHJvbWlzZV1dJ107XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyAyNS40LjYgUHJvcGVydGllcyBvZiBQcm9taXNlIEluc3RhbmNlc1xyXG5cclxuICAgIGlmICghKCdQcm9taXNlJyBpbiBnbG9iYWwpIHx8IE9WRVJSSURFX05BVElWRV9GT1JfVEVTVElORylcclxuICAgICAgZ2xvYmFsLlByb21pc2UgPSBQcm9taXNlO1xyXG5cclxuICAgIC8vIFBhdGNoIGVhcmx5IFByb21pc2UuY2FzdCB2cy4gUHJvbWlzZS5yZXNvbHZlIGltcGxlbWVudGF0aW9uc1xyXG4gICAgaWYgKCdjYXN0JyBpbiBnbG9iYWwuUHJvbWlzZSkgZ2xvYmFsLlByb21pc2UucmVzb2x2ZSA9IGdsb2JhbC5Qcm9taXNlLmNhc3Q7XHJcbiAgfSgpKTtcclxuXHJcbiAgLy8gMjUuNC41LjEgUHJvbWlzZS5wcm90b3R5cGUgWyBAQHRvU3RyaW5nVGFnIF1cclxuICBkZWZpbmUoUHJvbWlzZS5wcm90b3R5cGUsICQkdG9TdHJpbmdUYWcsICdQcm9taXNlJyk7XHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIDI2IFJlZmxlY3Rpb25cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgKGZ1bmN0aW9uKCkge1xyXG4gICAgLy8gMjYuMSBUaGUgUmVmbGVjdCBPYmplY3RcclxuICAgIGlmICghKCdSZWZsZWN0JyBpbiBnbG9iYWwpIHx8IE9WRVJSSURFX05BVElWRV9GT1JfVEVTVElORylcclxuICAgICAgZ2xvYmFsLlJlZmxlY3QgPSB7fTtcclxuXHJcbiAgICAvLyAyNi4xLjEgUmVmbGVjdC5hcHBseSAoIHRhcmdldCwgdGhpc0FyZ3VtZW50LCBhcmd1bWVudHNMaXN0IClcclxuICAgIGRlZmluZShcclxuICAgICAgUmVmbGVjdCwgJ2FwcGx5JyxcclxuICAgICAgZnVuY3Rpb24gYXBwbHkodGFyZ2V0LCB0aGlzQXJndW1lbnQsIGFyZ3VtZW50c0xpc3QpIHtcclxuICAgICAgICBpZiAoIUlzQ2FsbGFibGUodGFyZ2V0KSkgdGhyb3cgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgcmV0dXJuIEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseS5jYWxsKHRhcmdldCwgdGhpc0FyZ3VtZW50LCBhcmd1bWVudHNMaXN0KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgLy8gMjYuMS4yIFJlZmxlY3QuY29uc3RydWN0ICggdGFyZ2V0LCBhcmd1bWVudHNMaXN0IFssIG5ld1RhcmdldF0gKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICBSZWZsZWN0LCAnY29uc3RydWN0JyxcclxuICAgICAgZnVuY3Rpb24gY29uc3RydWN0KHRhcmdldCwgYXJndW1lbnRzTGlzdCkge1xyXG4gICAgICAgIHJldHVybiBfX2NvbnModGFyZ2V0LCBhcmd1bWVudHNMaXN0KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgLy8gMjYuMS4zIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkgKCB0YXJnZXQsIHByb3BlcnR5S2V5LCBhdHRyaWJ1dGVzIClcclxuICAgIGRlZmluZShcclxuICAgICAgUmVmbGVjdCwgJ2RlZmluZVByb3BlcnR5JyxcclxuICAgICAgZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eUtleSwgYXR0cmlidXRlcykge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eUtleSwgYXR0cmlidXRlcyk7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9IGNhdGNoIChfKSB7XHJcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyAyNi4xLjQgUmVmbGVjdC5kZWxldGVQcm9wZXJ0eSAoIHRhcmdldCwgcHJvcGVydHlLZXkgKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICBSZWZsZWN0LCAnZGVsZXRlUHJvcGVydHknLFxyXG4gICAgICBmdW5jdGlvbiBkZWxldGVQcm9wZXJ0eSh0YXJnZXQsbmFtZSkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBkZWxldGUgdGFyZ2V0W25hbWVdO1xyXG4gICAgICAgICAgcmV0dXJuICFIYXNPd25Qcm9wZXJ0eSh0YXJnZXQsIG5hbWUpO1xyXG4gICAgICAgIH0gY2F0Y2ggKF8pIHtcclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8vIDI2LjEuNSBSZWZsZWN0LmVudW1lcmF0ZSAoIHRhcmdldCApXHJcbiAgICBkZWZpbmUoXHJcbiAgICAgIFJlZmxlY3QsICdlbnVtZXJhdGUnLFxyXG4gICAgICBmdW5jdGlvbiBlbnVtZXJhdGUodGFyZ2V0KSB7XHJcbiAgICAgICAgdGFyZ2V0ID0gVG9PYmplY3QodGFyZ2V0KTtcclxuICAgICAgICB2YXIgaXRlcmF0b3IgPSBFbnVtZXJhdGUodGFyZ2V0KTtcclxuICAgICAgICByZXR1cm4gaXRlcmF0b3I7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8vIDI2LjEuNiBSZWZsZWN0LmdldCAoIHRhcmdldCwgcHJvcGVydHlLZXkgWyAsIHJlY2VpdmVyIF0pXHJcbiAgICBkZWZpbmUoXHJcbiAgICAgIFJlZmxlY3QsICdnZXQnLFxyXG4gICAgICBmdW5jdGlvbiBnZXQodGFyZ2V0LCBuYW1lLCByZWNlaXZlcikge1xyXG4gICAgICAgIHRhcmdldCA9IFRvT2JqZWN0KHRhcmdldCk7XHJcbiAgICAgICAgbmFtZSA9IFN0cmluZyhuYW1lKTtcclxuICAgICAgICByZWNlaXZlciA9IChyZWNlaXZlciA9PT0gdW5kZWZpbmVkKSA/IHRhcmdldCA6IFRvT2JqZWN0KHJlY2VpdmVyKTtcclxuICAgICAgICB2YXIgZGVzYyA9IGdldFByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIG5hbWUpO1xyXG4gICAgICAgIGlmIChkZXNjICYmICdnZXQnIGluIGRlc2MpXHJcbiAgICAgICAgICByZXR1cm4gRnVuY3Rpb24ucHJvdG90eXBlLmNhbGwuY2FsbChkZXNjWydnZXQnXSwgcmVjZWl2ZXIpO1xyXG4gICAgICAgIHJldHVybiB0YXJnZXRbbmFtZV07XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8vIDI2LjEuNyBSZWZsZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciAoIHRhcmdldCwgcHJvcGVydHlLZXkgKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICBSZWZsZWN0LCAnZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yJyxcclxuICAgICAgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcik7XHJcblxyXG4gICAgLy8gMjYuMS44IFJlZmxlY3QuZ2V0UHJvdG90eXBlT2YgKCB0YXJnZXQgKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICBSZWZsZWN0LCAnZ2V0UHJvdG90eXBlT2YnLFxyXG4gICAgICBPYmplY3QuZ2V0UHJvdG90eXBlT2YpO1xyXG5cclxuICAgIC8vIDI2LjEuOSBSZWZsZWN0LmhhcyAoIHRhcmdldCwgcHJvcGVydHlLZXkgKVxyXG4gICAgZGVmaW5lKFxyXG4gICAgICBSZWZsZWN0LCAnaGFzJyxcclxuICAgICAgZnVuY3Rpb24gaGFzKHRhcmdldCxuYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIFN0cmluZyhuYW1lKSBpbiBUb09iamVjdCh0YXJnZXQpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyAyNi4xLjEwIFJlZmxlY3QuaXNFeHRlbnNpYmxlICh0YXJnZXQpXHJcbiAgICBkZWZpbmUoXHJcbiAgICAgIFJlZmxlY3QsICdpc0V4dGVuc2libGUnLFxyXG4gICAgICBPYmplY3QuaXNFeHRlbnNpYmxlKTtcclxuXHJcbiAgICAvLyAyNi4xLjExIFJlZmxlY3Qub3duS2V5cyAoIHRhcmdldCApXHJcbiAgICBkZWZpbmUoXHJcbiAgICAgIFJlZmxlY3QsICdvd25LZXlzJyxcclxuICAgICAgZnVuY3Rpb24gb3duS2V5cyh0YXJnZXQpIHtcclxuICAgICAgICB2YXIgb2JqID0gVG9PYmplY3QodGFyZ2V0KTtcclxuICAgICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMob2JqKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgLy8gMjYuMS4xMiBSZWZsZWN0LnByZXZlbnRFeHRlbnNpb25zICggdGFyZ2V0IClcclxuICAgIGRlZmluZShcclxuICAgICAgUmVmbGVjdCwgJ3ByZXZlbnRFeHRlbnNpb25zJyxcclxuICAgICAgZnVuY3Rpb24gcHJldmVudEV4dGVuc2lvbnModGFyZ2V0KSB7XHJcbiAgICAgICAgdHJ5IHsgT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zKHRhcmdldCk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChfKSB7IHJldHVybiBmYWxzZTsgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyAyNi4xLjEzIFJlZmxlY3Quc2V0ICggdGFyZ2V0LCBwcm9wZXJ0eUtleSwgViBbICwgcmVjZWl2ZXIgXSApXHJcbiAgICBkZWZpbmUoXHJcbiAgICAgIFJlZmxlY3QsICdzZXQnLFxyXG4gICAgICBmdW5jdGlvbiBzZXQodGFyZ2V0LCBuYW1lLCB2YWx1ZSwgcmVjZWl2ZXIpIHtcclxuICAgICAgICB0YXJnZXQgPSBUb09iamVjdCh0YXJnZXQpO1xyXG4gICAgICAgIG5hbWUgPSBTdHJpbmcobmFtZSk7XHJcbiAgICAgICAgcmVjZWl2ZXIgPSAocmVjZWl2ZXIgPT09IHVuZGVmaW5lZCkgPyB0YXJnZXQgOiBUb09iamVjdChyZWNlaXZlcik7XHJcbiAgICAgICAgdmFyIGRlc2MgPSBnZXRQcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBuYW1lKTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgaWYgKGRlc2MgJiYgJ3NldCcgaW4gZGVzYylcclxuICAgICAgICAgICAgRnVuY3Rpb24ucHJvdG90eXBlLmNhbGwuY2FsbChkZXNjWydzZXQnXSwgcmVjZWl2ZXIsIHZhbHVlKTtcclxuICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgdGFyZ2V0W25hbWVdID0gdmFsdWU7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9IGNhdGNoIChfKSB7XHJcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAvLyAyNi4xLjE0IFJlZmxlY3Quc2V0UHJvdG90eXBlT2YgKCB0YXJnZXQsIHByb3RvIClcclxuICAgIGRlZmluZShcclxuICAgICAgUmVmbGVjdCwgJ3NldFByb3RvdHlwZU9mJyxcclxuICAgICAgZnVuY3Rpb24gc2V0UHJvdG90eXBlT2YodGFyZ2V0LCBwcm90bykge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICB0YXJnZXQuX19wcm90b19fID0gcHJvdG87XHJcbiAgICAgICAgICByZXR1cm4gUmVmbGVjdC5nZXRQcm90b3R5cGVPZih0YXJnZXQpID09PSBwcm90bztcclxuICAgICAgICB9IGNhdGNoKF8pIHtcclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICB9KCkpO1xyXG5cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyAyNi4yIFByb3h5IE9iamVjdHNcclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgLy8gTm90IHBvbHlmaWxsYWJsZS5cclxuXHJcbn0oc2VsZikpO1xyXG5cclxuLy8gVGhpcyBoZWxwZXIgaXMgZGVmaW5lZCBvdXRzaWRlIHRoZSBtYWluIHNjb3BlIHNvIHRoYXQgdGhlIHVzZSBvZlxyXG4vLyAnZXZhbCcgZG9lcyBub3QgdGFpbnQgdGhlIHNjb3BlIGZvciBtaW5pZmllcnMuXHJcbmZ1bmN0aW9uIF9fY29ucyh0LCBhKSB7XHJcbiAgcmV0dXJuIGV2YWwoJ25ldyB0KCcgKyBhLm1hcChmdW5jdGlvbihfLCBpKSB7IHJldHVybiAnYVsnICsgaSArICddJzsgfSkuam9pbignLCcpICsgJyknKTtcclxufVxyXG4iLCJyZXF1aXJlKFwiLi9zaGltL2FycmF5XCIpXHJcbnJlcXVpcmUoXCIuL3NoaW0vb2JqZWN0XCIpXHJcbiIsIi8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWFycmF5LnByb3RvdHlwZS5pbmNsdWRlc1xyXG5pZiAoIUFycmF5LnByb3RvdHlwZS5pbmNsdWRlcykge1xyXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdpbmNsdWRlcycsIHtcclxuICAgIHZhbHVlOiBmdW5jdGlvbihzZWFyY2hFbGVtZW50LCBmcm9tSW5kZXgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuaW5kZXhPZihzZWFyY2hFbGVtZW50LCBmcm9tSW5kZXgpICE9PSAtMVxyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcbiIsIi8vaHR0cHM6Ly90YzM5LmVzL3Byb3Bvc2FsLW9iamVjdC12YWx1ZXMtZW50cmllcy9cclxuLy9odHRwczovL2dpdGh1Yi5jb20vdGMzOS9wcm9wb3NhbC1vYmplY3QtdmFsdWVzLWVudHJpZXNcclxuaWYgKCFPYmplY3QuZW50cmllcykge1xyXG4gIE9iamVjdC5lbnRyaWVzID0gZnVuY3Rpb24oIG9iaiApe1xyXG4gICAgdmFyIG93blByb3BzID0gT2JqZWN0LmtleXMoIG9iaiApLFxyXG4gICAgICBpID0gb3duUHJvcHMubGVuZ3RoLFxyXG4gICAgICByZXNBcnJheSA9IG5ldyBBcnJheShpKTsgLy8gcHJlYWxsb2NhdGUgdGhlIEFycmF5XHJcbiAgICB3aGlsZSAoaS0tKSB7XHJcbiAgICAgIHJlc0FycmF5W2ldID0gW293blByb3BzW2ldLCBvYmpbb3duUHJvcHNbaV1dXTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHJlc0FycmF5O1xyXG4gIH07XHJcbn1cclxuIiwibGV0IHJoID0gcmVxdWlyZShcIi4vcmhcIilcclxubGV0IGNvbnN0cyA9IHJoLmNvbnN0c1xyXG5cclxuY29uc3RzKCdSSE1BUElEJywgJ3JobWFwaWQnKTtcclxuY29uc3RzKCdSSF9GVUxMX0xBWU9VVF9QQVJBTScsICdyaGZ1bGxsYXlvdXQnKTtcclxuXHJcbmNvbnN0cygnRVZUX1RPUElDX1dJREdFVF9MT0FERUQnLCAnLmUudG9waWNfd2lkZ2V0X2xvYWRlZCcpO1xyXG5jb25zdHMoJ0VWVF9DTE9TRV9TRUFSQ0hfU1VHR0VTVElPTicsICcuZS5jbG9zZV9zZWFyY2hfc3VnZ2VzdGlvbicpO1xyXG5cclxuY29uc3RzKCdLRVlfVE9DX0JSRUFEQ1JVTUJTJywgJy5wLnRvY19icmVhZGNydW1icycpO1xyXG5jb25zdHMoJ0tFWV9UT0NfU0VMRUNUX0lURU0nLCAnLnAudG9jX3NlbGVjdF9pdGVtJyk7XHJcbmNvbnN0cygnS0VZX1RPQ19CQUNLX0JVVFRPTl9QUkVTU0VEJywgJy5wLnRvY19iYWNrX3ByZXNzZWRfYnV0dG9uJyk7XHJcbmNvbnN0cygnS0VZX1NIT1dfVE9DX0JBQ0tfQlVUVE9OJywgJy5wLnNob3dfdG9jX2JhY2tfYnV0dG9uJyk7XHJcblxyXG5cclxuY29uc3RzKCdLRVlfVE9DX09SREVSJywgJy5wLnRvY19vcmRlcicpO1xyXG5jb25zdHMoJ0tFWV9UT0NfQ0hJTERfT1JERVInLCAnLnAudG9jX2NoaWxkX29yZGVyJyk7XHJcbi8vU2VhcmNoIHNwZWNpZmljXHJcbmNvbnN0cygnU0VBUkNIX01BUF9BRERSJywgXCJ3aHhkYXRhL3NlYXJjaF9hdXRvX21hcF8wLmpzXCIpO1xyXG5jb25zdHMoJ1NFQVJDSF9NQVBfQUREUl9PTEQnLCBcIndoeGRhdGEvc2VhcmNoQXV0b19NYXBfMC5qc1wiKTtcclxuY29uc3RzKCdTRUFSQ0hfTU9ERUxfQUREUicsIFwid2h4ZGF0YS9zZWFyY2hfYXV0b19tb2RlbF9cIik7XHJcbmNvbnN0cygnU0VBUkNIX01PREVMX0FERFJfT0xEJywgXCJ3aHhkYXRhL3NlYXJjaEF1dG9fTW9kZWxfXCIpO1xyXG5jb25zdHMoJ1NFQVJDSF9JTkRFWF9EQVRBJywgXCIubC5zZWFyY2hfaW5kZXhfZGF0YVwiKTtcclxuY29uc3RzKCdTRUFSQ0hfSU5ERVhfRklMRScsIFwid2h4ZGF0YS9zZWFyY2hfYXV0b19pbmRleC5qc1wiKTtcclxuY29uc3RzKCdTRUFSQ0hfSU5ERVhfRklMRV9PTEQnLCBcIndoeGRhdGEvc2VhcmNoQXV0b19JbmRleC5qc1wiKTtcclxuY29uc3RzKCdTRUFSQ0hfREJfRklMRScsIFwid2h4ZGF0YS9zZWFyY2hfZGIuanNcIik7XHJcbmNvbnN0cygnU0VBUkNIX01FVEFEQVRBX0ZJTEUnLCBcIndoeGRhdGEvc2VhcmNoX3RvcGljcy5qc1wiKVxyXG5jb25zdHMoJ1NFQVJDSF9URVhUX0ZJTEUnLCBcIndoeGRhdGEvdGV4dFwiKVxyXG5jb25zdHMoJ1NFQVJDSF9USU5ZX1NFR01FTlRFUicsIFwid2h4ZGF0YS9sYW5ndWFnZXMvdGlueXNlZ21lbnRlci5qc1wiKVxyXG5jb25zdHMoJ1NFQVJDSF9TVEVNTUVSX1NVUFBPUlQnLCBcIndoeGRhdGEvbGFuZ3VhZ2VzL3N0ZW1tZXIuanNcIilcclxuY29uc3RzKCdTRUFSQ0hfTE5HX1NVUFBPUlQnLCBcIndoeGRhdGEvbGFuZ3VhZ2VzL2xuZ19zdXBwb3J0LmpzXCIpXHJcblxyXG5cclxuXHJcbmNvbnN0cygnU0VBUkNIX01PREVMX0tFWScsJy5sLnNlYXJjaF9tb2RlbC4nKTtcclxuY29uc3RzKCdTRUFSQ0hfTUFQX0tFWScsICcubC5zZWFyY2hfbWFwLicpO1xyXG5jb25zdHMoJ1NFQVJDSF9NQVhfVE9QSUNTJywgMjApO1xyXG5jb25zdHMoJ1NFQVJDSF9SRVNVTFRTX0tFWScsICdzZWFyY2hfcmVzdWx0cycpO1xyXG5jb25zdHMoJ1NUT1BfTkFWSUdBVEVfVE9fVE9QSUMnLCAnLmwuc3RvcHRvcGljbmF2Jyk7XHJcbmNvbnN0cygnU0VBUkNIX1dPUkRTX01BUCcsICcubC5zZWFyY2hfd29yZHNfbWFwJyk7XHJcbmNvbnN0cyhcIk1BWF9TRUFSQ0hfSU5QVVRcIiwgMyk7XHJcbmNvbnN0cyhcIktFWV9CUkVBRENSVU1CU1wiLCAnLmwuYnJlYWRjcnVtYnMnKTtcclxuY29uc3RzKCdIQVNIX0hPTUVQQUdFX01PREUnLCAnaG9tZXBhZ2UnKTtcclxuY29uc3RzKCdLRVlfVklFV19NT0RFJywgJy5sLm1vZGUnKTtcclxuY29uc3RzKCdIRUxQX0xBWU9VVF9NT0RFJywgJ2xheW91dCcpO1xyXG5jb25zdHMoJ0hFTFBfU0VBUkNIX01PREUnLCAnc2VhcmNoJyk7XHJcbmNvbnN0cygnSEVMUF9UT1BJQ19NT0RFJywgJ3RvcGljJyk7XHJcbmNvbnN0cygnUFJFVl9TRUFSQ0hfS0VZJywgJ2RhdGEtcHJldi1zZWFyY2gnKTtcclxuY29uc3RzKCdLRVlfU1VCU1RSX1NFQVJDSCcsICcuc3Vic3RyX3NlYXJjaCcpO1xyXG5jb25zdHMoJ0tFWV9TSE9XX0NPTlRFWFQnLCAnLnNob3dfc3J4aF9jdHh0Jyk7XHJcblxyXG5cdC8qIGZhdm9yaXRlcyBjb25zdGFudHMgKi9cclxuY29uc3RzKCdGQVZBVFRSSUJVVEUnLCdkYXRhLWZhdndpZGdldCcpO1xyXG5jb25zdHMoJ0ZBVkJVVFRPTicsJ2Zhdi1idXR0b24nKTtcclxuY29uc3RzKCdGQVZMSVNUJywnZmF2LWxpc3QnKTtcclxuY29uc3RzKCdGQVZTVE9SQUdFJywgJ2Zhdi1zdG9yZScpO1xyXG5cclxuY29uc3RzKCdGQVZMSU5LQ0xBU1MnLCdmYXZvcml0ZScpO1xyXG5jb25zdHMoJ1VORkFWTElOS0NMQVNTJywndW5mYXZvcml0ZScpO1xyXG5jb25zdHMoJ0ZBVlRBQkxFQ0xBU1MnLCAnZmF2b3JpdGVzaG9sZGVyJyk7XHJcbmNvbnN0cygnRkFWVEFCTEVUSVRMRUNMQVNTJywgJ2Zhdm9yaXRlJyk7XHJcbmNvbnN0cygnRkFWVEFCTEVSRU1PVkVDTEFTUycsICdyZW1vdmVsaW5rJyk7XHJcbmNvbnN0cygnRkFWTElTVElOVFJPQ0xBU1MnLCAnZmF2b3JpdGVzaW50cm8nKTtcclxuY29uc3RzKCdGQVZMSVNUVEFCTEVJTlRST0NMQVNTJywgJ2Zhdm9yaXRlc3RhYmxlaW50cm8nKTtcclxuY29uc3RzKCdFVkVOVEZBVkNIQU5HRScsICdmYXZvcml0ZS1jaGFuZ2VkLWluLXNjcmlwdCcpO1xyXG5jb25zdHMoJ1RPUElDX0ZBVk9SSVRFJywgJy5sLnRvcGljX2Zhdm9yaXRlJyk7XHJcbmNvbnN0cygnS0VZX0ZBVk9SSVRFUycsICcubC5mYXZvcml0ZXMnKTtcclxuY29uc3RzKCdGQVZPUklURVNfQlVUVE9OX1RJVExFJywgJy5sLmZhdm9yaXRlc190aXRsZScpO1xyXG5jb25zdHMoJ0tFWV9HTE9TU0FSWV9SRVNVTFQnLCAnLnAuZ2xvc3Nhcnlfc2VhcmNoX3Jlc3VsdCcpO1xyXG5jb25zdHMoJ0tFWV9HTE9TU0FSWV9SRVNVTFRfVEVSTScsICcucC5nbG9zc2FyeV9zZWFyY2hfdGVybScpO1xyXG5cclxuXHJcbmNvbnN0cygnRVZUX1dJTkRPV19MT0FERUQnLCAnLmUud2luX2xvYWRlZCcpXHJcblxyXG5jb25zdHMoJ0tFWV9TSE9XX1NDUk9MTF9UT19UT1AnLCAnLmwuc2hvd19zY3JvbGxfdG9fdG9wJyk7XHJcbmNvbnN0cygnS0VZX0RPX05PVF9QUkVTRVJWRV9BUicsICAgICAgICAnLmwuZG9fbm90X3ByZXNlcnZlX2FyJyk7XHJcbmNvbnN0cygnS0VZX0xOR19OQU1FJywgJy5wLmxuZ19uYW1lJyk7XHJcbmNvbnN0cygnU0hPV19NT0RBTCcsICcubC5zaG93X21vZGFsJylcclxuY29uc3RzKCdTSE9XX01PREFMX0lOX1RPUElDJywgJy5sLnNob3dfbW9kYWxfaW5fdG9waWMnKVxyXG5cclxuY29uc3RzKCdLRVlfSEVBREVSX0xPR09fUEFUSCcsICcubC5oZWFkZXIubG9nbycpO1xyXG5jb25zdHMoJ0tFWV9IRUFERVJfVElUTEUnLCAnLmwuaGVhZGVyLnRpdGxlJyk7XHJcbmNvbnN0cygnS0VZX0hFQURFUl9USVRMRV9DT0xPUicsICcubC5oZWFkZXIudGl0bGVfY29sb3InKTtcclxuY29uc3RzKCdLRVlfSEVBREVSX0JBQ0tHUk9VTkRfQ09MT1InLCAnLmwuaGVhZGVyLmJhY2tncm91bmRfY29sb3InKTtcclxuY29uc3RzKCdLRVlfTEFZT1VUX0ZPTlRfRkFNSUxZJywgJy5sLmxheW91dC5mb250X2ZhbWlseScpO1xyXG5jb25zdHMoJ0tFWV9IRUFERVJfSFRNTCcsICcubC5oZWFkZXIuaHRtbCcpO1xyXG5jb25zdHMoJ0tFWV9IRUFERVJfQ1NTJywgJy5sLmhlYWRlci5jc3MnKTtcclxuY29uc3RzKCdLRVlfSEVBREVSX0RFRkFVTFRfQkFDS0dST1VORF9DT0xPUicsICcubC5oZWFkZXIuZGVmYXVsdF9iYWNrZ3JvdW5kX2NvbG9yJyk7XHJcbmNvbnN0cygnS0VZX0hFQURFUl9ERUZBVUxUX1RJVExFX0NPTE9SJywgJy5sLmhlYWRlci5kZWZhdWx0X3RpdGxlX2NvbG9yJyk7XHJcbmNvbnN0cygnS0VZX0xBWU9VVF9ERUZBVUxUX0ZPTlRfRkFNSUxZJywgJy5sLmxheW91dC5kZWZhdWx0X2ZvbnRfZmFtaWx5Jyk7XHJcblxyXG5jb25zdHMoJ0tFWV9DVVNUT01fQlVUVE9OUycsICcubC5jdXN0b21fYnV0dG9ucycpO1xyXG5jb25zdHMoJ0tFWV9DVVNUT01fQlVUVE9OU19DT05GSUcnLCAnLmwuY3VzdG9tX2J1dHRvbnNfY29uZmlnJyk7XHJcbmNvbnN0cygnS0VZX1NFQVJDSF9ISUdITElHSFRfQ09MT1InLCAnLmwuc2VhcmNoX3Jlc3VsdC5oaWdobGlnaHRfY29sb3InKTtcclxuY29uc3RzKCdLRVlfU0VBUkNIX0JHX0NPTE9SJywgJy5sLnNlYXJjaF9yZXN1bHQuaGlnaGxpZ2h0X2JjY29sb3InKTtcclxuY29uc3RzKCdUT1BJQ19ISUdITElHSFRFRCcsICcubC5zZWFyY2hfcmVzdWx0LnRvcGljX2hpZ2hsaWdodGVkJyk7XHJcbmNvbnN0cygnRVZUX1JFTU9WRV9ISUdITElHSFQnLCAnLmUucmVtb3ZlX2hpZ2hsaWdodCcpO1xyXG5cclxuXHJcbmNvbnN0cygnRVZUX0VYUEFORF9DT0xMQVBTRV9BTEwnLCAnLmUuZXhwYW5kX2NvbGxhcHNlX2FsbCcpO1xyXG5jb25zdHMoJ0VWVF9FWFBBTkRfQUxMJywgJy5lLmV4cGFuZF9hbGwnKTtcclxuY29uc3RzKCdFVlRfQ09MTEFQU0VfQUxMJywgJy5lLmNvbGxhcHNlX2FsbCcpO1xyXG5jb25zdHMoJ0FMTF9BUkVfRVhQQU5ERUQnLCAnLmwuYWxsX2FyZV9leHBhbmRlZCcpO1xyXG5jb25zdHMoJ0tFWV9DTEFTU0lDX09VVFBVVCcsICcucC5jbGFzc2ljX291dHB1dCcpO1xyXG5cclxuIiwicmVxdWlyZSgnLi4vZnJhbWV3b3Jrcy9zaGltJylcclxucmVxdWlyZSgnanMtcG9seWZpbGxzL2VzNScpXHJcbnJlcXVpcmUoJ2pzLXBvbHlmaWxscy9lczYnKVxyXG5cclxuaWYgKGdsb2JhbC5yaCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgZ2xvYmFsLnJoID0ge307XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZ2xvYmFsLnJoXHJcbiIsInJlcXVpcmUoXCIuLi9saWIvcmhcIilcclxucmVxdWlyZShcIi4uLy4uL2xlbmllbnRfc3JjL3V0aWxzL3NoaW1cIilcclxucmVxdWlyZShcIi4uLy4uL2xlbmllbnRfc3JjL3JvYm9oZWxwL2NvbW1vbi9yaF9jb25zdHNcIilcclxucmVxdWlyZShcIi4uLy4uL2xlbmllbnRfc3JjL3JvYm9oZWxwL2NvbW1vbi90YWdfZXhwcmVzc2lvbl91dGlsc1wiKVxyXG5yZXF1aXJlKFwiLi4vLi4vbGVuaWVudF9zcmMvcm9ib2hlbHAvY29tbW9uL2hvb2tfY2xpY2tcIilcclxucmVxdWlyZShcIi4uLy4uL2xlbmllbnRfc3JjL3JvYm9oZWxwL2NvbW1vbi9jb250ZW50X2ZpbHRlclwiKVxyXG5yZXF1aXJlKFwiLi4vLi4vbGVuaWVudF9zcmMvcm9ib2hlbHAvY29tbW9uL2VkX3dpZGdldHNcIilcclxucmVxdWlyZShcIi4uLy4uL2xlbmllbnRfc3JjL3JvYm9oZWxwL2NvbW1vbi9lZF93aWRnZXRfY29uZmlnc1wiKVxyXG5yZXF1aXJlKFwiLi4vLi4vbGVuaWVudF9zcmMvcm9ib2hlbHAvY29tbW9uL3VybF91dGlsc1wiKVxyXG5yZXF1aXJlKFwiLi4vLi4vbGVuaWVudF9zcmMvcm9ib2hlbHAvY29tbW9uL3RhZ19leHByZXNzaW9uX3V0aWxzXCIpXHJcbnJlcXVpcmUoXCIuLi8uLi9sZW5pZW50X3NyYy9yb2JvaGVscC9jb21tb24vaG9va19jbGlja1wiKVxyXG5yZXF1aXJlKFwiLi4vLi4vbGVuaWVudF9zcmMvcm9ib2hlbHAvY29tbW9uL2NvbnRlbnRfZmlsdGVyXCIpXHJcbnJlcXVpcmUoXCIuLi8uLi9sZW5pZW50X3NyYy9yb2JvaGVscC9jb21tb24vZWRfd2lkZ2V0c1wiKVxyXG5yZXF1aXJlKFwiLi4vLi4vbGVuaWVudF9zcmMvcm9ib2hlbHAvY29tbW9uL2VkX3dpZGdldF9jb25maWdzXCIpXHJcbnJlcXVpcmUoXCIuLi9saWIvY29uc3RzXCIpXHJcbnJlcXVpcmUoXCIuLi8uLi9sZW5pZW50X3NyYy9yb2JvaGVscC9jb21tb24vdXJsX3V0aWxzXCIpXHJcbnJlcXVpcmUoXCIuL3V0aWxzL2hvbWVfdXRpbHNcIilcclxucmVxdWlyZShcIi4vdXRpbHMvdXJsX3V0aWxzXCIpXHJcbnJlcXVpcmUoXCIuL3V0aWxzL2lvX3V0aWxzXCIpXHJcbnJlcXVpcmUoXCIuL3V0aWxzL2h0bWxfcmVzb2x2ZXJcIilcclxucmVxdWlyZShcIi4vdXRpbHMvaWZyYW1lX3V0aWxzXCIpXHJcbnJlcXVpcmUoXCIuL2xheW91dC9kYXRhX2F0dHJzL3BvcHVwX2ltYWdlXCIpXHJcbnJlcXVpcmUoXCIuL2xheW91dC9kYXRhX2F0dHJzL2ZvY3VzaWZcIilcclxucmVxdWlyZShcIi4vY29tbW9uL2luaXRcIilcclxuIiwibGV0IHJoID0gcmVxdWlyZShcIi4uLy4uL2xpYi9yaFwiKTtcclxubGV0IGNvbnN0cyA9IHJoLmNvbnN0cztcclxubGV0ICQgPSByaC4kO1xyXG5sZXQgbW9kZWwgPSByaC5tb2RlbDtcclxuXHJcbm1vZGVsLnN1YnNjcmliZShjb25zdHMoJ0VWVF9QUk9KRUNUX0xPQURFRCcpLCAoKSA9PntcclxuICBsZXQgJGh0bWwgPSAkKCdodG1sJywwKTtcclxuICBsZXQgbGFuZyA9IG1vZGVsLmdldChjb25zdHMoJ0tFWV9MTkdfTkFNRScpKVxyXG4gIGlmKCRodG1sICYmIGxhbmcgJiYgbGFuZyAhPT0gJycpeyAgXHJcbiAgICAkLnNldEF0dHJpYnV0ZSgkaHRtbCwgJ2xhbmcnLCBsYW5nKVxyXG4gIH1cclxufSlcclxuXHJcbm1vZGVsLnN1YnNjcmliZShjb25zdHMoJ0tFWV9BTkRfU0VBUkNIJyksIHZhbHVlID0+IHZhbHVlID09PSAnJyAmJiBtb2RlbC5wdWJsaXNoKGNvbnN0cygnS0VZX0FORF9TRUFSQ0gnKSwgJzEnKSlcclxuIiwiY29uc3QgcmggPSByZXF1aXJlKFwiLi4vLi4vLi4vbGliL3JoXCIpXHJcblxyXG5jbGFzcyBGb2N1c2lmIHtcclxuICBjb25zdHJ1Y3RvciAod2lkZ2V0LCBub2RlLCByYXdFeHByKSB7XHJcbiAgICB3aWRnZXQuc3Vic2NyaWJlRGF0YUV4cHIocmF3RXhwciwgcmVzdWx0ID0+IHtcclxuICAgICAgaWYocmVzdWx0KSB7XHJcbiAgICAgICAgbm9kZS5mb2N1cygpXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG59XHJcblxyXG5yaC5yZWdpc3RlckRhdGFBdHRyKCdmb2N1c2lmJywgRm9jdXNpZikiLCJjb25zdCByaCA9IHJlcXVpcmUoXCIuLi8uLi8uLi9saWIvcmhcIilcclxuY29uc3QgXyA9IHJoLl87XHJcbmxldCAkID0gcmguJDtcclxubGV0IEh0bWxSZXNvbHZlciA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy9odG1sX3Jlc29sdmVyXCIpXHJcbmxldCBub2RlVXRpbHMgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvbm9kZV91dGlsc1wiKVxyXG5cclxuXHJcbmNsYXNzIFBvcHVwSW1hZ2Uge1xyXG4gIGNvbnN0cnVjdG9yKHdpZGdldCwgbm9kZSwgcmF3RXhwcikge1xyXG4gICAgJC5hZGRDbGFzcyhub2RlLCBcInBvcHVwLWltYWdlLXRodW1ibmFpbFwiKVxyXG4gICAgdGhpcy5ub2RlID0gbm9kZTtcclxuICAgIHJoLm1vZGVsLmNzdWJzY3JpYmUoJ0VWVF9QUk9KRUNUX0xPQURFRCcsIHRoaXMuX2FkZEVubGFyZ2VCdXR0b24uYmluZCh0aGlzKSlcclxuICAgIHRoaXMucmF3RXhwciA9IHJhd0V4cHJcclxuICAgIF8uYWRkRXZlbnRMaXN0ZW5lcihub2RlLCBcImNsaWNrXCIsIHRoaXMuX2dldENsaWNrRm4uYmluZCh0aGlzKSk7XHJcbiAgfVxyXG5cclxuICBfY29udGVudChyYXdFeHByKSB7XHJcbiAgICBsZXQgbm9kZXMgPSBbXVxyXG4gICAgbGV0IGltZ05vZGUgPSAkLmNyZWF0ZUVsZW1lbnQoJ2ltZycpXHJcbiAgICAkLnNldEF0dHJpYnV0ZShpbWdOb2RlLCAnc3JjJywgcmF3RXhwcilcclxuICAgIG5vZGVzLnB1c2goaW1nTm9kZSlcclxuXHJcbiAgICBpZiAoJC5oYXNBdHRyaWJ1dGUodGhpcy5ub2RlLCBcInVzZW1hcFwiKSkge1xyXG4gICAgICBsZXQgbWFwSWQgPSAkLmdldEF0dHJpYnV0ZSh0aGlzLm5vZGUsIFwidXNlbWFwXCIpXHJcbiAgICAgICQuc2V0QXR0cmlidXRlKGltZ05vZGUsICd1c2VtYXAnLCBtYXBJZClcclxuICAgICAgbm9kZXMucHVzaCgkKG1hcElkLCAwKSlcclxuICAgIH1cclxuXHJcbiAgICBsZXQgaHRtbF9yZXNvbHZlciA9IG5ldyBIdG1sUmVzb2x2ZXIoKTtcclxuICAgIGxldCBpc0luSUZyYW1lID0gXy5pc0lmcmFtZSgpXHJcbiAgICBpZiAoaXNJbklGcmFtZSkge1xyXG4gICAgICByZXR1cm4geyBjb250ZW50OiBodG1sX3Jlc29sdmVyLnJlc29sdmUoXy5tYXAobm9kZXMsIG5vZGUgPT4gbm9kZVV0aWxzLm91dGVySFRNTChub2RlKSkuam9pbignICcpKSwgc2hvd0luVG9waWM6ICFpc0luSUZyYW1lIH1cclxuICAgIH1cclxuICAgIHJldHVybiB7IGNvbnRlbnQ6IF8ubWFwKG5vZGVzLCBub2RlID0+IG5vZGVVdGlscy5vdXRlckhUTUwobm9kZSkpLmpvaW4oJyAnKSwgc2hvd0luVG9waWM6ICFpc0luSUZyYW1lIH1cclxuICB9XHJcblxyXG4gIF9nZXRDbGlja0ZuKCkge1xyXG4gICAgbGV0IHsgY29udGVudCwgc2hvd0luVG9waWMgfSA9IHRoaXMuX2NvbnRlbnQodGhpcy5yYXdFeHByKVxyXG4gICAgaWYgKCFzaG93SW5Ub3BpYykge1xyXG4gICAgICByaC5tb2RlbC5jcHVibGlzaCgnU0hPV19NT0RBTCcsIHsgY29udGVudCwgaXNJbWFnZTogdHJ1ZSB9KVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHJoLm1vZGVsLmNwdWJsaXNoKCdTSE9XX01PREFMX0lOX1RPUElDJywgeyBjb250ZW50LCBpc0ltYWdlOiB0cnVlIH0pXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfYWRkRW5sYXJnZUJ1dHRvbigpIHtcclxuXHJcbiAgICBsZXQgaW1nID0gJC5jcmVhdGVFbGVtZW50KCdpbWcnLCB0aGlzLm5vZGUpXHJcbiAgICAkLnNldEF0dHJpYnV0ZShpbWcsIFwic3JjXCIsIHRoaXMuZXhwYW5kSW1hZ2VQYXRoKVxyXG4gICAgJC5hZGRDbGFzcyhpbWcsIFwicmgtZXhwYW5kLWljb25cIilcclxuICAgIG5vZGVVdGlscy5pbnNlcnRBZnRlcih0aGlzLm5vZGUsIGltZylcclxuICAgIF8uYWRkRXZlbnRMaXN0ZW5lcihpbWcsIFwiY2xpY2tcIiwgdGhpcy5fZ2V0Q2xpY2tGbi5iaW5kKHRoaXMpKTtcclxuICB9XHJcbiAgZ2V0IGV4cGFuZEltYWdlUGF0aCgpIHtcclxuICAgIGxldCBodG1sX3Jlc29sdmVyID0gbmV3IEh0bWxSZXNvbHZlcigpO1xyXG4gICAgbGV0IGZ1bGxJbWFnZVBhdGggPSBodG1sX3Jlc29sdmVyLm1ha2VGdWxsUGF0aCgndGVtcGxhdGUvaW1hZ2VzL2V4cGFuZC5wbmcnLCBfLmdldFJvb3RVcmwoKSlcclxuICAgIHJldHVybiBfLm1ha2VSZWxhdGl2ZVVybChmdWxsSW1hZ2VQYXRoKVxyXG4gIH1cclxufVxyXG5cclxucmgucmVnaXN0ZXJEYXRhQXR0cigncG9wdXBpbWFnZScsIFBvcHVwSW1hZ2UpIiwibGV0IHJoID0gcmVxdWlyZShcIi4uLy4uL2xpYi9yaFwiKVxyXG5sZXQgXyA9IHJoLl9cclxubGV0IGNvbnN0cyA9IHJoLmNvbnN0c1xyXG5cclxuXy5nb1RvSG9tZSA9IChoYXNoX21hcCwgcGFyYW1zX21hcCkgPT4ge1xyXG4gIGxldCBob21lX3BhdGggPSBjb25zdHMoJ0hPTUVfRklMRVBBVEgnKVxyXG4gIGlmKGhvbWVfcGF0aCkge1xyXG4gICAgbGV0IGhvbWVfdXJsID0gXy5tYWtlRnVsbFVybChob21lX3BhdGgpXHJcbiAgICBsZXQgcGFyYW1zU3RyID0gKHBhcmFtc19tYXAgPT09IHVuZGVmaW5lZCk/ICcnIDogJz8nKyBfLm1hcFRvRW5jb2RlZFN0cmluZyhwYXJhbXNfbWFwKVxyXG4gICAgbGV0IGhhc2hTdHIgPSAoaGFzaF9tYXAgPT09IHVuZGVmaW5lZCk/ICcnIDogJyMnKyBfLm1hcFRvRW5jb2RlZFN0cmluZyhoYXNoX21hcClcclxuXHJcbiAgICBob21lX3VybCA9IGAke2hvbWVfdXJsfSR7cGFyYW1zU3RyfSR7aGFzaFN0cn1gXHJcbiAgICBkb2N1bWVudC5sb2NhdGlvbiA9IGhvbWVfdXJsXHJcbiAgfVxyXG59O1xyXG5cclxuXy5pc0hvbWVVcmwgPSh1cmwpID0+e1xyXG4gIGxldCBob21lX3BhdGggPSBjb25zdHMoJ0hPTUVfRklMRVBBVEgnKVxyXG4gIGxldCByb290VXJsID0gXy5nZXRSb290VXJsKClcclxuICBsZXQgcmVsYXRpdmVQYXRoID0gXy5tYWtlUmVsYXRpdmVQYXRoKHVybCwgcm9vdFVybClcclxuICBsZXQgZmlsZVBhdGggPSBfLmZpbGVQYXRoKHJlbGF0aXZlUGF0aClcclxuICByZXR1cm4gKGhvbWVfcGF0aCA9PT0gZmlsZVBhdGgpXHJcbn1cclxuXHJcbl8uY29tcGFyZSA9ICh3b3JkMSwgd29yZDIpID0+IHtcclxuICByZXR1cm4gKHdvcmQxID09PSB3b3JkMikgPyAwIDotMTtcclxufTtcclxuIiwibGV0IHJoID0gcmVxdWlyZShcIi4uLy4uL2xpYi9yaFwiKVxyXG5sZXQgJCA9IHJoLiRcclxubGV0IF8gPSByaC5fXHJcbmxldCBub2RlVXRpbHMgPSByZXF1aXJlKFwiLi9ub2RlX3V0aWxzXCIpXHJcbmNvbnN0IHV0aWwgPSB7IFxyXG4gIHNjaGVtZSh1cmwpIHtcclxuICAgIGxldCBpbmRleCwgc2NoZW1lXHJcbiAgICBpbmRleCA9IHVybC5pbmRleE9mKCc6JylcclxuICAgIGlmIChpbmRleCAhPT0gLTEpIHtcclxuICAgICAgc2NoZW1lID0gdXJsLnN1YnN0cmluZygwLCBpbmRleCArIDEpLnRvTG93ZXJDYXNlKCkudHJpbSgpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gc2NoZW1lXHJcbiAgfVxyXG59XHJcbmNsYXNzIEh0bWxSZXNvbHZlciB7XHJcblxyXG4gIGdldCBwYXRocygpe1xyXG4gICAgcmV0dXJuIFsnc3JjJywgJ2hyZWYnXTtcclxuICB9XHJcblxyXG4gIGdldCBsaW5rcygpe1xyXG4gICAgcmV0dXJuIFsnaHJlZiddO1xyXG4gIH1cclxuXHJcbiAgY29uc3RydWN0b3IoKXtcclxuICB9XHJcbiAgXHJcbiAgcmVzb2x2ZShodG1sKXtcclxuICAgIGxldCBub2RlcyA9IG5vZGVVdGlscy50b0h0bWxOb2RlKGh0bWwpXHJcbiAgICBfLmVhY2gobm9kZXMsIG5vZGUgPT4ge1xyXG4gICAgICBpZihub2RlVXRpbHMuaXNFbGVtZW50Tm9kZShub2RlKSkge1xyXG4gICAgICAgICQudHJhdmVyc2VOb2RlKG5vZGUsIG5vZGUgPT4gdGhpcy5yZXNvbHZlTm9kZShub2RlKSlcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIHJldHVybiBfLnJlZHVjZShub2RlcywgKHJlc3VsdCwgbm9kZSkgPT4ge1xyXG4gICAgICByZXN1bHQgKz0gbm9kZVV0aWxzLm91dGVySFRNTChub2RlKVxyXG4gICAgICByZXR1cm4gcmVzdWx0XHJcbiAgICB9LCAnJylcclxuICB9XHJcblxyXG4gIHJlc29sdmVOb2RlKG5vZGUpe1xyXG4gICAgXy5lYWNoKHRoaXMucGF0aHMsIGF0dHJpYnV0ZSA9PiB0aGlzLnJlc292ZVBhdGhzKG5vZGUsIGF0dHJpYnV0ZSkpXHJcbiAgICBfLmVhY2godGhpcy5saW5rcywgYXR0cmlidXRlID0+IHRoaXMucmVzb3ZlTGlua3Mobm9kZSwgYXR0cmlidXRlKSlcclxuICAgIHJldHVybiB0cnVlXHJcbiAgfVxyXG5cclxuICByZXNvdmVQYXRocyhub2RlLCBhdHRyaWJ1dGUpIHtcclxuICAgIGlmKCEkLmhhc0F0dHJpYnV0ZShub2RlLCBhdHRyaWJ1dGUpKSB7XHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG4gICAgbGV0IHZhbHVlID0gJC5nZXRBdHRyaWJ1dGUobm9kZSwgYXR0cmlidXRlKVxyXG4gICAgJC5zZXRBdHRyaWJ1dGUobm9kZSwgYXR0cmlidXRlLCB0aGlzLnJlc292ZVBhdGgodmFsdWUpKSAgXHJcbiAgfVxyXG5cclxuICByZXNvdmVMaW5rcyhub2RlLCBhdHRyaWJ1dGUpe1xyXG4gICAgaWYoISQuaGFzQXR0cmlidXRlKG5vZGUsIGF0dHJpYnV0ZSkpIHtcclxuICAgICAgcmV0dXJuXHJcbiAgICB9XHJcbiAgICAkLnNldEF0dHJpYnV0ZShub2RlLCBcImRhdGEtY2xpY2tcIiwgXCJAY2xvc2UodHJ1ZSlcIilcclxuICB9XHJcblxyXG4gIHJlc292ZVBhdGgocGF0aCkge1xyXG4gICAgaWYoIV8uaXNSZWxhdGl2ZVVybChwYXRoKSl7XHJcbiAgICAgIHJldHVybiBwYXRoO1xyXG4gICAgfVxyXG4gICAgbGV0IGJhc2VVcmwgPSBfLmdldFJvb3RVcmwoKTtcclxuICAgIGxldCBmdWxsVXJsID0gXy5tYWtlRnVsbFVybChwYXRoKTtcclxuICAgIHJldHVybiBfLm1ha2VSZWxhdGl2ZVVybChmdWxsVXJsLCBiYXNlVXJsKTtcclxuICB9XHJcbiAgbWFrZUZ1bGxQYXRoKHJlbFVybCwgYmFzZVVybCkge1xyXG4gICAgaWYoIXRoaXMuaXNSZWxhdGl2ZVVybChyZWxVcmwpIHx8IHRoaXMuaXNSZWxhdGl2ZVVybChiYXNlVXJsKSkge1xyXG4gICAgICByZXR1cm4gcmVsVXJsXHJcbiAgICB9XHJcbiAgICBsZXQgYmFzZVBhcnRzID0gdGhpcy5maWxlUGF0aChiYXNlVXJsKS5zcGxpdCgnLycpLFxyXG4gICAgICByZWxQYXRoID0gdGhpcy5maWxlUGF0aChyZWxVcmwpLFxyXG4gICAgICBwYXJhbXMgPSByZWxVcmwuc3Vic3RyaW5nKHJlbFBhdGgubGVuZ3RoKSxcclxuICAgICAgcmVsUGFydHMgPSByZWxQYXRoLnNwbGl0KCcvJylcclxuXHJcbiAgICBpZihyZWxQYXJ0cy5sZW5ndGggPiAxIHx8IHJlbFBhcnRzWzBdKSB7XHJcbiAgICAgIGJhc2VQYXJ0cy5wb3AoKVxyXG4gICAgICBfLmVhY2gocmVsUGFydHMsIHJlbFBhcnQgPT4ge1xyXG4gICAgICAgIGlmKHJlbFBhcnQgPT09ICcuLicpIHtcclxuICAgICAgICAgIGJhc2VQYXJ0cy5wb3AoKVxyXG4gICAgICAgIH0gZWxzZSBpZihyZWxQYXJ0ICE9PSAnLicpIHtcclxuICAgICAgICAgIGJhc2VQYXJ0cy5wdXNoKHJlbFBhcnQpXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gYCR7YmFzZVBhcnRzLmpvaW4oJy8nKX0ke3BhcmFtc31gXHJcbiAgfVxyXG4gIFxyXG4gIGlzUmVsYXRpdmVVcmwodXJsKSB7XHJcbiAgICByZXR1cm4gIXVybCB8fCAhdXRpbC5zY2hlbWUodXJsKSAmJiB1cmwudHJpbSgpLmluZGV4T2YoJy8nKVxyXG4gIH1cclxuXHJcbiAgZmlsZVBhdGgodXJsKSB7XHJcbiAgICBsZXQgaW5kZXg7XHJcbiAgICB1cmwgPSB1cmwgfHwgJydcclxuICAgIGluZGV4ID0gdXJsLmluZGV4T2YoJz8nKVxyXG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xyXG4gICAgICB1cmwgPSB1cmwuc3Vic3RyaW5nKDAsIGluZGV4KVxyXG4gICAgfVxyXG4gICAgaW5kZXggPSB1cmwuaW5kZXhPZignIycpXHJcbiAgICBpZiAoaW5kZXggIT09IC0xKSB7XHJcbiAgICAgIHVybCA9IHVybC5zdWJzdHJpbmcoMCwgaW5kZXgpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdXJsXHJcbiAgfVxyXG5cclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBIdG1sUmVzb2x2ZXI7IiwibGV0IHJoID0gcmVxdWlyZSgnLi4vLi4vbGliL3JoJyksXHJcbiAgXyA9IHJoLl8sXHJcbiAgJCA9IHJoLiRcclxuXHJcbl8ucmVzZXRJZnJhbWVTaXplID0gc2VsZWN0b3IgPT4ge1xyXG4gIGxldCBpZnJhbWUgPSAkKHNlbGVjdG9yLCAwKVxyXG4gIHJldHVybiBpZnJhbWVcclxufVxyXG4iLCJsZXQgcmggPSByZXF1aXJlKFwiLi4vLi4vbGliL3JoXCIpXHJcbmxldCBfID0gcmguX1xyXG5sZXQga2V5SGFzaCA9IHtcclxuICA4OiAgXCJiYWNrc3BhY2VcIixcclxuICAxMzogXCJyZXR1cm5cIixcclxuICAyNzogXCJlc2NhcGVcIixcclxuICAzODogXCJkb3duXCIsXHJcbiAgNDA6IFwidXBcIixcclxuICAzOTogXCJyaWdodFwiXHJcbn1cclxuXHJcbl8uZ2V0S2V5SW5kZXggPSAoa2V5Q29kZSkgPT4ge1xyXG4gIGlmKGtleUhhc2hba2V5Q29kZV0pIHtcclxuICAgIHJldHVybiBrZXlIYXNoW2tleUNvZGVdXHJcbiAgfSBlbHNlIHtcclxuICAgIHJldHVybiBcImRlZmF1bHRcIlxyXG4gIH1cclxufVxyXG4iLCJsZXQgcmggPSByZXF1aXJlKFwiLi4vLi4vbGliL3JoXCIpXHJcbmxldCAkID0gcmguJFxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuXHJcbiAgbm9kZVR5cGU6IHtcclxuICAgIEVMRU1FTlRfTk9ERTogMSxcclxuICAgIEFUVFJJQlVURV9OT0RFOiAyLFxyXG4gICAgVEVYVF9OT0RFOiAzLFxyXG4gICAgQ0RBVEFfU0VDVElPTl9OT0RFOiA0LFxyXG4gICAgRU5USVRZX1JFRkVSRU5DRV9OT0RFOiA1LFxyXG4gICAgRU5USVRZX05PREU6IDYsXHJcbiAgICBQUk9DRVNTSU5HX0lOU1RSVUNUSU9OX05PREU6IDcsXHJcbiAgICBDT01NRU5UX05PREU6IDgsXHJcbiAgICBET0NVTUVOVF9OT0RFOiA5LFxyXG4gICAgRE9DVU1FTlRfVFlQRV9OT0RFOiAxMCxcclxuICAgIERPQ1VNRU5UX0ZSQUdNRU5UX05PREU6IDExLFxyXG4gICAgTk9UQVRJT05fTk9ERTogMTJcclxuICB9LFxyXG5cclxuICByZW1vdmVDaGlsZChub2RlLCBwYXJlbnQgPSB0aGlzLnBhcmVudE5vZGUobm9kZSkpIHtcclxuICAgIHJldHVybiBwYXJlbnQgJiYgcGFyZW50LnJlbW92ZUNoaWxkICYmIHBhcmVudC5yZW1vdmVDaGlsZChub2RlKVxyXG4gIH0sXHJcbiAgYXBwZW5kQ2hpbGQocGFyZW50LCBuZXdOb2RlKSB7XHJcbiAgICByZXR1cm4gcGFyZW50ICYmIHBhcmVudC5hcHBlbmRDaGlsZCAmJiBwYXJlbnQuYXBwZW5kQ2hpbGQobmV3Tm9kZSlcclxuICB9LFxyXG4gIHBhcmVudE5vZGUobm9kZSkge1xyXG4gICAgcmV0dXJuIG5vZGUgJiYgbm9kZS5wYXJlbnROb2RlXHJcbiAgfSxcclxuICBjaGlsZE5vZGVzKG5vZGUpIHtcclxuICAgIHJldHVybiBub2RlICYmIG5vZGUuY2hpbGROb2RlcyB8fCBbXVxyXG4gIH0sXHJcbiAgdG9IdG1sTm9kZShodG1sKSB7XHJcbiAgICByZXR1cm4gdGhpcy5jaGlsZE5vZGVzKCQuY3JlYXRlRWxlbWVudCgnZGl2JywgaHRtbCkpXHJcbiAgfSxcclxuICBvdXRlckhUTUwobm9kZSkge1xyXG4gICAgcmV0dXJuIG5vZGUgJiYgbm9kZS5vdXRlckhUTUwgfHwgJydcclxuICB9LFxyXG4gIGluc2VydEFmdGVyKG5vZGUsIG5ld05vZGUpe1xyXG4gICAgcmV0dXJuIG5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobmV3Tm9kZSwgbm9kZS5uZXh0U2libGluZylcclxuICB9LFxyXG4gIHZhbHVlKG5vZGUpIHtcclxuICAgIHJldHVybiBub2RlICYmIG5vZGUubm9kZVZhbHVlXHJcbiAgfSxcclxuICBuYW1lKG5vZGUpIHtcclxuICAgIHJldHVybiBub2RlICYmIG5vZGUubm9kZU5hbWVcclxuICB9LFxyXG4gIHR5cGUobm9kZSkge1xyXG4gICAgcmV0dXJuIG5vZGUgJiYgbm9kZS5ub2RlVHlwZVxyXG4gIH0sXHJcbiAgaXNFbGVtZW50Tm9kZShub2RlKSB7XHJcbiAgICByZXR1cm4gdGhpcy50eXBlKG5vZGUpID09PSB0aGlzLm5vZGVUeXBlLkVMRU1FTlRfTk9ERVxyXG4gIH0sXHJcbiAgaXNUZXh0Tm9kZShub2RlKSB7XHJcbiAgICByZXR1cm4gdGhpcy50eXBlKG5vZGUpID09PSB0aGlzLm5vZGVUeXBlLlRFWFRfTk9ERVxyXG4gIH1cclxufSIsImxldCByaCA9IHJlcXVpcmUoXCIuLi8uLi9saWIvcmhcIilcclxubGV0IF8gPSByaC5fXHJcblxyXG5fLmFkZFBhcmFtID0gKHVybCwga2V5LCB2YWx1ZSkgPT4ge1xyXG4gIGxldCBoYXNoU3RyID0gXy5leHRyYWN0SGFzaFN0cmluZyh1cmwpXHJcbiAgbGV0IHBhcmFtc1N0ciA9IF8uZXh0cmFjdFBhcmFtU3RyaW5nKHVybClcclxuICBsZXQgcGFyYW1zTWFwID0gXy51cmxQYXJhbXMocGFyYW1zU3RyKVxyXG4gIHBhcmFtc01hcFtrZXldID0gdmFsdWVcclxuICBsZXQgc3RyaXBwZWRVcmwgPSBfLnN0cmlwQm9va21hcmsodXJsKVxyXG4gIHN0cmlwcGVkVXJsID0gXy5zdHJpcFBhcmFtKHN0cmlwcGVkVXJsKVxyXG5cclxuICBsZXQgdXJsSGFzaFN0ciA9IChoYXNoU3RyID09PSAnJyk/IGhhc2hTdHIgOiAnIycrIGhhc2hTdHJcclxuXHJcbiAgbGV0IHVwZGF0ZWRQYXJhbXNTdHIgPSByaC5fLm1hcFRvRW5jb2RlZFN0cmluZyhwYXJhbXNNYXApXHJcbiAgbGV0IHVybFBhcmFtc1N0ciA9ICh1cGRhdGVkUGFyYW1zU3RyID09PSAnJyk/dXBkYXRlZFBhcmFtc1N0cjogJz8nICsgdXBkYXRlZFBhcmFtc1N0clxyXG4gIHJldHVybiBzdHJpcHBlZFVybCArIHVybFBhcmFtc1N0ciArIHVybEhhc2hTdHJcclxufVxyXG5cclxuXy5yZW1vdmVQYXJhbSA9ICh1cmwsIHBhcmFtKSA9PiB7XHJcbiAgbGV0IGhhc2hTdHIgPSBfLmV4dHJhY3RIYXNoU3RyaW5nKHVybClcclxuICBsZXQgcGFyYW1zU3RyID0gXy5leHRyYWN0UGFyYW1TdHJpbmcodXJsKVxyXG4gIGxldCBwYXJhbXNNYXAgPSBfLnVybFBhcmFtcyhwYXJhbXNTdHIpXHJcbiAgcGFyYW1zTWFwW3BhcmFtXSA9IG51bGxcclxuICBsZXQgc3RyaXBwZWRVcmwgPSBfLnN0cmlwQm9va21hcmsodXJsKVxyXG4gIHN0cmlwcGVkVXJsID0gXy5zdHJpcFBhcmFtKHN0cmlwcGVkVXJsKVxyXG5cclxuICBsZXQgdXJsSGFzaFN0ciA9IChoYXNoU3RyID09PSAnJyk/IGhhc2hTdHIgOiAnIycrIGhhc2hTdHJcclxuXHJcbiAgbGV0IHVwZGF0ZWRQYXJhbXNTdHIgPSByaC5fLm1hcFRvRW5jb2RlZFN0cmluZyhwYXJhbXNNYXApXHJcbiAgbGV0IHVybFBhcmFtc1N0ciA9ICh1cGRhdGVkUGFyYW1zU3RyID09PSAnJyk/dXBkYXRlZFBhcmFtc1N0cjogJz8nICsgdXBkYXRlZFBhcmFtc1N0clxyXG4gIHJldHVybiBzdHJpcHBlZFVybCArIHVybFBhcmFtc1N0ciArIHVybEhhc2hTdHJcclxufVxyXG5cclxuXy5jcmVhdGVIYXNoZWRVcmwgPSAodXJsKSA9PntcclxuICAvL2xldCBoYXNoZWRVcmwgPSB1cmxcclxuICBsZXQgcmVsVXJsLCBwYXJhbXNcclxuICBpZighXy5pc1Jvb3RVcmwodXJsKSl7XHJcbiAgICBsZXQgcm9vdFVybCA9IF8uZ2V0Um9vdFVybCgpXHJcbiAgICBpZihfLmlzRXh0ZXJuYWxVcmwodXJsKSl7XHJcbiAgICAgIHJlbFVybCA9IHVybFxyXG4gICAgfVxyXG4gICAgZWxzZXtcclxuICAgICAgcGFyYW1zID0gXy5nZXRQYXJhbXNGb3JSb290KHVybCwgdHJ1ZSlcclxuICAgICAgcmVsVXJsID0gXy5maXhSZWxhdGl2ZVVybCggXy5tYWtlUmVsYXRpdmVQYXRoICh1cmwsIHJvb3RVcmwpKVxyXG4gICAgICB1cmwgPSBgJHtyb290VXJsfSR7cGFyYW1zfSN0PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHJlbFVybCl9YFxyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gdXJsXHJcbn1cclxuXHJcbl8uZ2V0T3JpZ2luID0gKHNyY1dpbmRvdykgPT4ge1xyXG4gIHJldHVybiBfLmlzTG9jYWwoKSB8fCAhc3JjV2luZG93ID8gJyonIDogc3JjV2luZG93LmxvY2F0aW9uLm9yaWdpblxyXG59XHJcbiJdfQ==
